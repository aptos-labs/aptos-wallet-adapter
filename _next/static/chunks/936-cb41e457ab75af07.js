(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[936],{39362:function(){},73935:function(t,e,n){"use strict";n.d(e,{$q:function(){return a},X3:function(){return c},YW:function(){return A},_1:function(){return k},at:function(){return m},d1:function(){return y},il:function(){return h},it:function(){return S},kE:function(){return o},nq:function(){return v},ud:function(){return p},yS:function(){return u}});var i=n(61149),r=n(93747);function a(t,e,n){try{if(!(0,i.Qps)(t))throw Error("Invalid authentication function ".concat(t));let[r,a,s]=t.split("::"),c=new i.ei2;i.kxK.fromString(r).serialize(c),c.serializeStr(a),c.serializeStr(s);let u=new i.ei2,l=new o(e,n);u.serializeBytes(l.bcsToBytes());let h=new Uint8Array([5]),d=(0,i.Pqj)([c.toUint8Array(),u.toUint8Array(),h]);return new i.nZq({data:d})}catch(t){throw"Error computing domain authentication key: ".concat(t)}}var o=class t extends i.iVQ{serialize(t){t.serializeStr(this.identity),t.serializeStr(this.domain)}static deserialize(e){return new t(e.deserializeStr(),e.deserializeStr())}constructor(t,e){super(),this.identity=t,this.domain=e}};function s(t){for(let[e,n]of Object.entries(i.mdu))if(n===t)return e;return"custom network: ".concat(t)}function c(t){let{message:e,chainId:n}=t,i=e.replaceAll("\n","\\n"),r=n?" (".concat(s(n),")"):"";return"To sign the following message".concat(" on Aptos blockchain".concat(r),": ").concat(i)}function u(t,e){let n=function(t){if(!(t instanceof i.AT1))return;let e=t.entryFunction.module_name.address.toString(),n=t.entryFunction.module_name.name.identifier,r=t.entryFunction.function_name.identifier;return"".concat(e,"::").concat(n,"::").concat(r)}(t.rawTransaction.payload),r=s(t.rawTransaction.chain_id.chainId);return"Please confirm you explicitly initiated this request from ".concat(e||window.location.host,". You are approving to execute transaction").concat(n?" ".concat(n):"").concat(" on Aptos blockchain (".concat(r,")"),".")}var l="APTOS";function h(t){let{address:e,application:n,chainId:i,message:r,nonce:a}=t,o=[];void 0!==e&&o.push("address: ".concat(e)),void 0!==n&&o.push("application: ".concat(n)),void 0!==i&&o.push("chainId: ".concat(i));let s=[l,"message: ".concat(r),"nonce: ".concat(a),...o].join("\n");return new TextEncoder().encode(s)}function d(t,e){let n="".concat(e,": ");return t.startsWith(n)?t.slice(n.length):void 0}function f(t,e){return t.slice(0,e.length)===e}var g=(0,i.Pqj)([i.eCk]),w=(0,i.Pqj)([i.FMR]);function y(t){let e=i.pUe.fromHexInput(t).toUint8Array(),n=function(t){if(f(t,g)){let e=t.slice(g.length),n=new i.ZKs(e);return i.S75.deserialize(n)}if(f(t,w)){let e=t.slice(w.length),n=new i.ZKs(e);return i.CkR.deserialize(n)}}(e);if(n){let t;if(n instanceof i.S75)t=new i._tO(n);else if(n instanceof i.gAz)t=new i.OqU(n.raw_txn,n.secondary_signer_addresses);else if(n instanceof i.A63){let{raw_txn:e,secondary_signer_addresses:r,fee_payer_address:a}=n;t=r.length>0?new i.OqU(e,r,a):new i._tO(e,a)}else throw Error("Unsupported raw transaction");return{type:"transaction",rawTransaction:t}}try{let t=function(t){let[e,...n]=new TextDecoder().decode(t).split("\n");if(e!==l)throw Error("Invalid message prefix");let i=0,r=d(n[0],"address");void 0!==r&&(i+=1);let a=d(n[i],"application");void 0!==a&&(i+=1);let o=d(n[i],"chainId");void 0!==o&&(i+=1);let s=d(n[n.length-1],"nonce");if(!s)throw Error("Expected nonce");let c=d(n.slice(i,n.length-1).join("\n"),"message");if(!c)throw Error("Expected message");return{address:r,application:a,chainId:o?Number(o):void 0,message:c,nonce:s}}(e);return{type:"structuredMessage",structuredMessage:t}}catch(t){return}}function p(t){return{status:r.qk.APPROVED,args:t}}function v(){return{status:r.qk.REJECTED}}function A(t,e){if(t.status===r.qk.REJECTED)return v();let n=e(t.args);return n instanceof Promise?n.then(t=>p(t)):p(n)}function m(t){return new r.wP({publicKey:t,address:t.authKey().derivedAddress()})}function S(t){return"_isNull"in t&&!0===t._isNull}var k=async()=>{let t=new i.gZG;return await t.getChainId()}},56693:function(t,e,n){"use strict";n.r(e),n.d(e,{SIGNATURE_TYPE:function(){return v},SolanaDerivedPublicKey:function(){return y},SolanaDerivedWallet:function(){return k},createAccountAuthenticatorForSolanaTransaction:function(){return m},createMessageForSolanaTransaction:function(){return S},createSiwsEnvelope:function(){return f},createSiwsEnvelopeForAptosStructuredMessage:function(){return g},createSiwsEnvelopeForAptosTransaction:function(){return w},setupAutomaticSolanaWalletDerivation:function(){return E},signAptosMessageWithSolana:function(){return p},signAptosTransactionWithSolana:function(){return A}});var i=n(27927),r=n(17827),a=n(35992),o=n(73935),s=n(61149),c=n(93747),u=n(49476),l=n(39799),h=n(93814);async function d(t){try{let e=await t;return(0,o.ud)(e)}catch(t){if(t instanceof u.lj&&"User rejected the request."===t.message)return(0,o.nq)();throw t}}function f(t){let{solanaPublicKey:e,signingMessageDigest:n,statement:i,domain:r}=t,a=s.pUe.fromHexInput(n).toString();return{address:e.toString(),domain:r,nonce:a,statement:i}}function g(t){let{structuredMessage:e,...n}=t,i=(0,o.X3)(e);return f({...n,statement:i})}function w(t){let{rawTransaction:e,domain:n,...i}=t,r=(0,o.yS)(e,n);return f({...i,statement:r,domain:n})}var y=class t extends s.M0X{authKey(){return this._authKey}verifySignature(t){let e,{message:n,signature:i}=t,r=(0,o.d1)(n);if(!r||!(i instanceof s.AoU))return!1;let a={solanaPublicKey:this.solanaPublicKey,signingMessageDigest:(0,s.Pqj)([n])};if("structuredMessage"===r.type)e=(0,o.il)(r.structuredMessage);else{let t=w({...r,...a,domain:this.domain});e=(0,l.SW)(t)}return new s.EZS(this.solanaPublicKey.toBytes()).verifySignature({message:e,signature:i})}async verifySignatureAsync(t){return this.verifySignature({message:t.message,signature:t.signature})}serialize(t){t.serializeStr(this.domain),t.serializeFixedBytes(this.solanaPublicKey.toBytes()),t.serializeStr(this.authenticationFunction)}static deserialize(e){let n=e.deserializeStr(),i=e.deserializeFixedBytes(32);return new t({domain:n,solanaPublicKey:new h.nh(i),authenticationFunction:e.deserializeStr()})}static isInstance(t){return"domain"in t&&"solanaPublicKey"in t&&"authenticationFunction"in t}constructor(t){super();let{domain:e,solanaPublicKey:n,authenticationFunction:i}=t;this.domain=e,this.solanaPublicKey=n,this.authenticationFunction=i,this._authKey=(0,o.$q)(i,n.toBase58(),e)}};async function p(t){let{solanaWallet:e,authenticationFunction:n,messageInput:i,domain:r}=t;if(!e.signMessage)throw Error("solana:signMessage not available");let a=e.publicKey;if(!a)throw Error("Account not connected");let c=new y({domain:r,solanaPublicKey:a,authenticationFunction:n}),{message:u,nonce:l,chainId:h,...f}=i,g=f.address?c.authKey().derivedAddress():void 0,w=f.application?window.location.origin:void 0,p={address:null==g?void 0:g.toString(),application:w,chainId:h,message:u,nonce:l},v=(0,o.il)(p),A=await d(e.signMessage(v));return(0,o.YW)(A,t=>{let e=new s.AoU(t);return{prefix:"APTOS",fullMessage:new TextDecoder().decode(v),message:u,nonce:l,signature:e}})}var v=0;async function A(t){let{solanaWallet:e,authenticationFunction:n,rawTransaction:i,domain:r}=t,a=e.publicKey;if(!a)throw Error("Account not connected");let{siwsInput:s,signingMessageDigest:c}=S({rawTransaction:i,authenticationFunction:n,solanaPublicKey:a,domain:r});if(e.signIn){let t=await d(e.signIn(s));return(0,o.YW)(t,t=>{if(t.signatureType&&"ed25519"!==t.signatureType)throw Error("Unsupported signature type");return m(t.signature,a,r,n,c)})}if(e.signMessage){let t=await d(e.signMessage((0,l.SW)(s)));return(0,o.YW)(t,t=>m(t,a,r,n,c))}throw Error("".concat(e.name," does not support SIWS or signMessage"))}function m(t,e,n,i,r){let a=new s.AoU(t),c=new s.ei2;c.serializeU8(v),c.serializeBytes(a.toUint8Array());let u=c.toUint8Array(),l=new o.kE(e.toBase58(),n);return new s.f3j(i,r,u,l.bcsToBytes())}function S(t){let{rawTransaction:e,authenticationFunction:n,solanaPublicKey:i,domain:r}=t,a=(0,s.ogJ)(e),o=s.Aak.generateAccountAbstractionMessage(a,n),c=(0,s.Pqj)([o]);return{siwsInput:w({solanaPublicKey:i,rawTransaction:e,signingMessageDigest:c,domain:r}),signingMessageDigest:c}}var k=class{derivePublicKey(t){return new y({domain:this.domain,solanaPublicKey:t,authenticationFunction:this.authenticationFunction})}async connect(){if(await this.solanaWallet.connect(),!this.solanaWallet.publicKey)return{status:c.qk.REJECTED};let t=this.derivePublicKey(this.solanaWallet.publicKey);return{args:(0,o.at)(t),status:c.qk.APPROVED}}async disconnect(){await this.solanaWallet.disconnect()}getActivePublicKey(){if(!this.solanaWallet.publicKey)throw Error("Account not connected");return this.derivePublicKey(this.solanaWallet.publicKey)}async getActiveAccount(){let t=this.getActivePublicKey();return(0,o.at)(t)}onActiveAccountChange(t){(0,o.it)(t)?this.solanaWallet.off("connect"):this.solanaWallet.on("connect",e=>{let n=this.derivePublicKey(e);t((0,o.at)(n))})}async getActiveNetwork(){let t=s.mdu[this.defaultNetwork],e=s.sAp[this.defaultNetwork];return{name:this.defaultNetwork,chainId:t,url:e}}async changeNetwork(t){let{name:e,chainId:n,url:i}=t;if(e===s.ZcK.CUSTOM)throw Error("Custom network not currently supported");for(let t of(this.defaultNetwork=e,this.onActiveNetworkChangeListeners))t({name:e,chainId:null!=n?n:s.mdu[e],url:null!=i?i:s.sAp[e]});return{status:c.qk.APPROVED,args:{success:!0}}}onActiveNetworkChange(t){(0,o.it)(t)?this.onActiveNetworkChangeListeners.clear():this.onActiveNetworkChangeListeners.add(t)}async signMessage(t){let e=t.chainId?this.defaultNetwork===s.ZcK.DEVNET?await (0,o._1)():s.mdu[this.defaultNetwork]:void 0;return p({solanaWallet:this.solanaWallet,authenticationFunction:this.authenticationFunction,messageInput:{...t,chainId:e},domain:this.domain})}async signTransaction(t,e){return A({solanaWallet:this.solanaWallet,authenticationFunction:this.authenticationFunction,rawTransaction:t,domain:this.domain})}constructor(t,e={}){var n=this;this.version="1.0.0",this.accounts=[],this.chains=c.xE,this.features={"aptos:connect":{version:"1.0.0",connect:()=>this.connect()},"aptos:disconnect":{version:"1.0.0",disconnect:()=>this.disconnect()},"aptos:account":{version:"1.0.0",account:()=>this.getActiveAccount()},"aptos:onAccountChange":{version:"1.0.0",onAccountChange:async t=>this.onActiveAccountChange(t)},"aptos:network":{version:"1.0.0",network:()=>this.getActiveNetwork()},"aptos:changeNetwork":{version:"1.0.0",changeNetwork:t=>this.changeNetwork(t)},"aptos:onNetworkChange":{version:"1.0.0",onNetworkChange:async t=>this.onActiveNetworkChange(t)},"aptos:signMessage":{version:"1.0.0",signMessage:t=>this.signMessage(t)},"aptos:signTransaction":{version:"1.0.0",signTransaction:function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return n.signTransaction(...e)}}},this.onActiveNetworkChangeListeners=new Set;let{authenticationFunction:i="0x1::solana_derivable_account::authenticate",defaultNetwork:r=s.ZcK.MAINNET}=e;this.solanaWallet=t,this.domain=window.location.host,this.authenticationFunction=i,this.defaultNetwork=r,this.name="".concat(t.name," (Solana)"),this.icon=t.icon,this.url=t.url}};function E(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,a.M)(),n={},o=t=>!0,s=i=>{let a=new k(new r.t({wallet:i}),t);n[i.name]=e.register(a)};for(let t of e.get())(0,i.N)(t)&&o(t)&&s(t);let c=e.on("register",t=>{(0,i.N)(t)&&o(t)&&s(t)}),u=e.on("unregister",t=>{if((0,i.N)(t)){let e=n[t.name];e&&(e(),delete n[t.name])}});return()=>{for(let t of(c(),u(),Object.values(n)))t()}}}}]);