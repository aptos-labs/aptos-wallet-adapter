"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[82],{10475:function(e,t,i){let r,n,s,a,o,c,u,l,d,f,p,h,g,y,m,_,w,A,b,v,E,z,S,T,x,C,U,k,I,P,K,N,$,F;i.d(t,{mRj:function(){return r9},kxK:function(){return ef},gZG:function(){return ot},ScN:function(){return iF},qN7:function(){return tv},sFe:function(){return ea},ZcK:function(){return iK},PMf:function(){return et},G90:function(){return ei}});var B,R=class extends Error{constructor(e,t){super(e),this.invalidReason=t}},D=i(61231),O=((r=O||{}).TOO_SHORT="too_short",r.INVALID_LENGTH="invalid_length",r.INVALID_HEX_CHARS="invalid_hex_chars",r),L=class e{constructor(e){this.data=e}toUint8Array(){return this.data}toStringWithoutPrefix(){return(0,D.ci)(this.data)}toString(){return`0x${this.toStringWithoutPrefix()}`}static fromHexString(t){let i=t;if(i.startsWith("0x")&&(i=i.slice(2)),0===i.length)throw new R("Hex string is too short, must be at least 1 char long, excluding the optional leading 0x.","too_short");if(i.length%2!=0)throw new R("Hex string must be an even number of hex characters.","invalid_length");try{return new e((0,D.nr)(i))}catch(e){throw new R(`Hex string contains invalid hex characters: ${e?.message}`,"invalid_hex_chars")}}static fromHexInput(t){return t instanceof Uint8Array?new e(t):e.fromHexString(t)}static hexInputToUint8Array(t){return t instanceof Uint8Array?t:e.fromHexString(t).toUint8Array()}static hexInputToString(t){return e.fromHexInput(t).toString()}static hexInputToStringWithoutPrefix(t){return e.fromHexInput(t).toStringWithoutPrefix()}static isValid(t){try{return e.fromHexString(t),{valid:!0}}catch(e){return{valid:!1,invalidReason:e?.invalidReason,invalidReasonMessage:e?.message}}}equals(e){return this.data.length===e.data.length&&this.data.every((t,i)=>t===e.data[i])}},V=e=>new TextDecoder().decode(L.fromHexInput(e).toUint8Array()),q=Object.defineProperty,H=Object.getOwnPropertyDescriptor,M=(e,t,i,r)=>{for(var n,s=r>1?void 0:r?H(t,i):t,a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r?n(t,i,s):n(s))||s);return r&&s&&q(t,i,s),s},G=class{bcsToBytes(){let e=new j;return this.serialize(e),e.toUint8Array()}bcsToHex(){let e=this.bcsToBytes();return L.fromHexInput(e)}toStringWithoutPrefix(){return this.bcsToHex().toStringWithoutPrefix()}toString(){return`0x${this.toStringWithoutPrefix()}`}},j=class{constructor(e=64){if(e<=0)throw Error("Length needs to be greater than 0");this.buffer=new ArrayBuffer(e),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){let e=new ArrayBuffer(2*this.buffer.byteLength);new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e}}appendToBuffer(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,t,i){this.ensureBufferWillHandleSize(t);let r=new DataView(this.buffer,this.offset);e.apply(r,[0,i,!0]),this.offset+=t}serializeStr(e){let t=new TextEncoder;this.serializeBytes(t.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.appendToBuffer(e)}serializeFixedBytes(e){this.appendToBuffer(e)}serializeBool(e){W(e),this.appendToBuffer(new Uint8Array([e?1:0]))}serializeU8(e){this.appendToBuffer(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){let t=BigInt(e)&BigInt(4294967295),i=BigInt(e)>>BigInt(32);this.serializeU32(Number(t)),this.serializeU32(Number(i))}serializeU128(e){let t=0xffffffffffffffffn&BigInt(e),i=BigInt(e)>>BigInt(64);this.serializeU64(t),this.serializeU64(i)}serializeU256(e){let t=0xffffffffffffffffffffffffffffffffn&BigInt(e),i=BigInt(e)>>BigInt(128);this.serializeU128(t),this.serializeU128(i)}serializeU32AsUleb128(e){let t=e,i=[];for(;t>>>7;)i.push(127&t|128),t>>>=7;i.push(t),this.appendToBuffer(new Uint8Array(i))}toUint8Array(){return new Uint8Array(this.buffer).slice(0,this.offset)}serialize(e){e.serialize(this)}serializeVector(e){this.serializeU32AsUleb128(e.length),e.forEach(e=>{e.serialize(this)})}serializeOption(e,t){let i=void 0!==e;this.serializeBool(i),i&&("string"==typeof e?this.serializeStr(e):e instanceof Uint8Array?void 0!==t?this.serializeFixedBytes(e):this.serializeBytes(e):e.serialize(this))}serializeOptionStr(e){void 0===e?this.serializeU32AsUleb128(0):(this.serializeU32AsUleb128(1),this.serializeStr(e))}};function W(e){if("boolean"!=typeof e)throw Error(`${e} is not a boolean value`)}M([X(0,255)],j.prototype,"serializeU8",1),M([X(0,65535)],j.prototype,"serializeU16",1),M([X(0,4294967295)],j.prototype,"serializeU32",1),M([X(BigInt(0),0xffffffffffffffffn)],j.prototype,"serializeU64",1),M([X(BigInt(0),0xffffffffffffffffffffffffffffffffn)],j.prototype,"serializeU128",1),M([X(BigInt(0),0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn)],j.prototype,"serializeU256",1),M([X(0,4294967295)],j.prototype,"serializeU32AsUleb128",1);var J=(e,t,i)=>`${e} is out of range: [${t}, ${i}]`;function Y(e,t,i){let r=BigInt(e);if(r>BigInt(i)||r<BigInt(t))throw Error(J(e,t,i))}function X(e,t){return(i,r,n)=>{let s=n.value;return n.value=function(i){return Y(i,e,t),s.apply(this,[i])},n}}var Z=class e extends G{constructor(e){super(),W(e),this.value=e}serialize(e){e.serializeBool(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(5),e.serialize(this)}deserialize(e){return new en(e.deserializeU256())}static deserialize(t){return new e(t.deserializeBool())}},Q=class e extends G{constructor(e){super(),Y(e,0,255),this.value=e}serialize(e){e.serializeU8(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(0),e.serialize(this)}static deserialize(t){return new e(t.deserializeU8())}},ee=class e extends G{constructor(e){super(),Y(e,0,65535),this.value=e}serialize(e){e.serializeU16(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(6),e.serialize(this)}static deserialize(t){return new e(t.deserializeU16())}},et=class e extends G{constructor(e){super(),Y(e,0,4294967295),this.value=e}serialize(e){e.serializeU32(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(7),e.serialize(this)}static deserialize(t){return new e(t.deserializeU32())}},ei=class e extends G{constructor(e){super(),Y(e,BigInt(0),0xffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU64(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(1),e.serialize(this)}static deserialize(t){return new e(t.deserializeU64())}},er=class e extends G{constructor(e){super(),Y(e,BigInt(0),0xffffffffffffffffffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU128(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(2),e.serialize(this)}static deserialize(t){return new e(t.deserializeU128())}},en=class e extends G{constructor(e){super(),Y(e,BigInt(0),0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU256(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(8),e.serialize(this)}static deserialize(t){return new e(t.deserializeU256())}},es=class e{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}static fromHex(t){return new e(L.hexInputToUint8Array(t))}read(e){if(this.offset+e>this.buffer.byteLength)throw Error("Reached to the end of buffer");let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}remaining(){return this.buffer.byteLength-this.offset}assertFinished(){if(0!==this.remaining())throw Error("Buffer has remaining bytes")}deserializeStr(){let e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeOptionStr(){return this.deserializeOption("string")}deserializeOption(e,t){if(this.deserializeBool()){if("string"===e)return this.deserializeStr();if("bytes"===e)return this.deserializeBytes();if("fixedBytes"===e){if(void 0===t)throw Error("Fixed bytes length not provided");return this.deserializeFixedBytes(t)}return this.deserialize(e)}}deserializeBytes(){let e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){let e=new Uint8Array(this.read(1))[0];if(1!==e&&0!==e)throw Error("Invalid boolean value");return 1===e}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){let e=this.deserializeU32();return BigInt(BigInt(this.deserializeU32())<<BigInt(32)|BigInt(e))}deserializeU128(){let e=this.deserializeU64();return BigInt(this.deserializeU64()<<BigInt(64)|e)}deserializeU256(){let e=this.deserializeU128();return BigInt(this.deserializeU128()<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<4294967295;){let i=this.deserializeU8();if(e|=BigInt(127&i)<<BigInt(t),(128&i)==0)break;t+=7}if(e>4294967295)throw Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}deserialize(e){return e.deserialize(this)}deserializeVector(e){let t=this.deserializeUleb128AsU32(),i=[];for(let r=0;r<t;r+=1)i.push(this.deserialize(e));return i}},ea=class e extends G{constructor(e){super(),this.values=e}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){if(void 0!==this.values[0]&&!(this.values[0]instanceof Q)){new eo(this.bcsToBytes()).serializeForScriptFunction(e);return}e.serializeU32AsUleb128(4),e.serialize(this)}static U8(t){let i;if(Array.isArray(t)&&0===t.length)i=[];else if(Array.isArray(t)&&"number"==typeof t[0])i=t;else if("string"==typeof t)i=Array.from(L.fromHexInput(t).toUint8Array());else if(t instanceof Uint8Array)i=Array.from(t);else throw Error("Invalid input type, must be an number[], Uint8Array, or hex string");return new e(i.map(e=>new Q(e)))}static U16(t){return new e(t.map(e=>new ee(e)))}static U32(t){return new e(t.map(e=>new et(e)))}static U64(t){return new e(t.map(e=>new ei(e)))}static U128(t){return new e(t.map(e=>new er(e)))}static U256(t){return new e(t.map(e=>new en(e)))}static Bool(t){return new e(t.map(e=>new Z(e)))}static MoveString(t){return new e(t.map(e=>new ec(e)))}serialize(e){e.serializeVector(this.values)}static deserialize(t,i){let r=t.deserializeUleb128AsU32(),n=[];for(let e=0;e<r;e+=1)n.push(i.deserialize(t));return new e(n)}},eo=class e extends G{constructor(e){super(),this.value=L.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}serializeForEntryFunction(e){this.serialize(e)}serializeForScriptFunction(e){e.serializeU32AsUleb128(9),this.serialize(e)}static deserialize(t){return new e(t.deserializeBytes())}toMoveVector(e){let t=new es(this.bcsToBytes());return t.deserializeUleb128AsU32(),new ea(t.deserializeVector(e))}},ec=class e extends G{constructor(e){super(),this.value=e}serialize(e){e.serializeStr(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){let t=new TextEncoder().encode(this.value);ea.U8(t).serializeForScriptFunction(e)}static deserialize(t){return new e(t.deserializeStr())}},eu=class e extends G{constructor(e){super(),"u">typeof e&&null!==e?this.vec=new ea([e]):this.vec=new ea([]),[this.value]=this.vec.values}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}unwrap(){if(this.isSome())return this.vec.values[0];throw Error("Called unwrap on a MoveOption with no value")}isSome(){return 1===this.vec.values.length}serialize(e){this.vec.serialize(e)}static U8(t){return new e(null!=t?new Q(t):void 0)}static U16(t){return new e(null!=t?new ee(t):void 0)}static U32(t){return new e(null!=t?new et(t):void 0)}static U64(t){return new e(null!=t?new ei(t):void 0)}static U128(t){return new e(null!=t?new er(t):void 0)}static U256(t){return new e(null!=t?new en(t):void 0)}static Bool(t){return new e(null!=t?new Z(t):void 0)}static MoveString(t){return new e(null!=t?new ec(t):void 0)}static deserialize(t,i){return new e(ea.deserialize(t,i).values[0])}},el=((n=el||{}).INCORRECT_NUMBER_OF_BYTES="incorrect_number_of_bytes",n.INVALID_HEX_CHARS="invalid_hex_chars",n.TOO_SHORT="too_short",n.TOO_LONG="too_long",n.LEADING_ZERO_X_REQUIRED="leading_zero_x_required",n.LONG_FORM_REQUIRED_UNLESS_SPECIAL="long_form_required_unless_special",n.INVALID_PADDING_ZEROES="INVALID_PADDING_ZEROES",n.INVALID_PADDING_STRICTNESS="INVALID_PADDING_STRICTNESS",n),ed=class e extends G{constructor(t){if(super(),t.length!==e.LENGTH)throw new R("AccountAddress data should be exactly 32 bytes long","incorrect_number_of_bytes");this.data=t}isSpecial(){return this.data.slice(0,this.data.length-1).every(e=>0===e)&&this.data[this.data.length-1]<16}toString(){return`0x${this.toStringWithoutPrefix()}`}toStringWithoutPrefix(){let e=(0,D.ci)(this.data);return this.isSpecial()&&(e=e[e.length-1]),e}toStringLong(){return`0x${this.toStringLongWithoutPrefix()}`}toStringLongWithoutPrefix(){return(0,D.ci)(this.data)}toStringShort(){return`0x${this.toStringShortWithoutPrefix()}`}toStringShortWithoutPrefix(){let e=(0,D.ci)(this.data).replace(/^0+/,"");return""===e?"0":e}toUint8Array(){return this.data}serialize(e){e.serializeFixedBytes(this.data)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(3),e.serialize(this)}static deserialize(t){let i=t.deserializeFixedBytes(e.LENGTH);return new e(i)}static fromStringStrict(t){if(!t.startsWith("0x"))throw new R("Hex string must start with a leading 0x.","leading_zero_x_required");let i=e.fromString(t);if(t.length!==e.LONG_STRING_LENGTH+2){if(i.isSpecial()){if(3!==t.length)throw new R(`The given hex string ${t} is a special address not in LONG form, it must be 0x0 to 0xf without padding zeroes.`,"INVALID_PADDING_ZEROES")}else throw new R(`The given hex string ${t} is not a special address, it must be represented as 0x + 64 chars.`,"long_form_required_unless_special")}return i}static fromString(t,{maxMissingChars:i=4}={}){let r,n=t;if(t.startsWith("0x")&&(n=t.slice(2)),0===n.length)throw new R("Hex string is too short, must be 1 to 64 chars long, excluding the leading 0x.","too_short");if(n.length>64)throw new R("Hex string is too long, must be 1 to 64 chars long, excluding the leading 0x.","too_long");if(i>63||i<0)throw new R(`maxMissingChars must be between or equal to 0 and 63. Received ${i}`,"INVALID_PADDING_STRICTNESS");try{r=(0,D.nr)(n.padStart(64,"0"))}catch(e){throw new R(`Hex characters are invalid: ${e?.message}`,"invalid_hex_chars")}let s=new e(r);if(n.length<64-i&&!s.isSpecial())throw new R(`Hex string is too short, must be ${64-i} to 64 chars long, excluding the leading 0x. You may need to fix 
the addresss by padding it with 0s before passing it to \`fromString\` (e.g. <addressString>.padStart(64, '0')). 
Received ${t}`,"too_short");return s}static from(t,{maxMissingChars:i=4}={}){return"string"==typeof t?e.fromString(t,{maxMissingChars:i}):t instanceof Uint8Array?new e(t):t}static fromStrict(t){return"string"==typeof t?e.fromStringStrict(t):t instanceof Uint8Array?new e(t):t}static isValid(t){try{return t.strict?e.fromStrict(t.input):e.from(t.input),{valid:!0}}catch(e){return{valid:!1,invalidReason:e?.invalidReason,invalidReasonMessage:e?.message}}}equals(e){return this.data.length===e.data.length&&this.data.every((t,i)=>t===e.data[i])}};ed.LENGTH=32,ed.LONG_STRING_LENGTH=64,ed.ZERO=ed.from("0x0"),ed.ONE=ed.from("0x1"),ed.TWO=ed.from("0x2"),ed.THREE=ed.from("0x3"),ed.FOUR=ed.from("0x4"),ed.A=ed.from("0xA");var ef=ed,ep=class extends G{constructor(e){super(),this.accountAddress=ef.ONE,this.moduleName=new ec("account"),this.structName=new ec("RotationProofChallenge"),this.sequenceNumber=new ei(e.sequenceNumber),this.originator=e.originator,this.currentAuthKey=e.currentAuthKey,this.newPublicKey=ea.U8(e.newPublicKey.toUint8Array())}serialize(e){e.serialize(this.accountAddress),e.serialize(this.moduleName),e.serialize(this.structName),e.serialize(this.sequenceNumber),e.serialize(this.originator),e.serialize(this.currentAuthKey),e.serialize(this.newPublicKey)}},eh=class{constructor(){this.queue=[],this.pendingDequeue=[],this.cancelled=!1}enqueue(e){if(this.cancelled=!1,this.pendingDequeue.length>0){this.pendingDequeue.shift()?.resolve(e);return}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise((e,t)=>{this.pendingDequeue.push({resolve:e,reject:t})})}isEmpty(){return 0===this.queue.length}cancel(){this.cancelled=!0,this.pendingDequeue.forEach(async({reject:e})=>{e(new eg("Task cancelled"))}),this.pendingDequeue=[],this.queue.length=0}isCancelled(){return this.cancelled}pendingDequeueLength(){return this.pendingDequeue.length}},eg=class extends Error{},ey=class e extends G{constructor(e){super(),this.chainId=e}serialize(e){e.serializeU8(this.chainId)}static deserialize(t){return new e(t.deserializeU8())}},em=class e extends G{constructor(e){super(),this.identifier=e}serialize(e){e.serializeStr(this.identifier)}static deserialize(t){return new e(t.deserializeStr())}},e_=e=>"string"==typeof e?L.isValid(e).valid?e:new TextEncoder().encode(e):e,ew=i(19846),eA=i(62640),eb=i(98628),ev=/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'?$/,eE=/^m\/44'\/637'\/[0-9]+'\/[0-9]+\/[0-9]+$/,ez=((s=ez||{}).ED25519="ed25519 seed",s),eS=(e,t)=>{let i=ew.b.create(eA.o,e).update(t).digest();return{key:i.slice(0,32),chainCode:i.slice(32)}},eT=({key:e,chainCode:t},i)=>{let r=new ArrayBuffer(4);new DataView(r).setUint32(0,i);let n=new Uint8Array(r),s=new Uint8Array([0]);return eS(t,new Uint8Array([...s,...e,...n]))},ex=e=>e.replace(/'/g,""),eC=e=>e.split("/").slice(1).map(ex),eU=e=>{let t=e.trim().split(/\s+/).map(e=>e.toLowerCase()).join(" ");return eb.Z1(t)},ek=class e{static formatPrivateKey(t,i){let r=e.AIP80_PREFIXES[i],n=t;return"string"==typeof n&&n.startsWith(r)&&(n=n.split("-")[2]),`${r}${L.fromHexInput(n).toString()}`}static parseHexInput(t,i,r){let n,s=e.AIP80_PREFIXES[i];if("string"==typeof t){if(r||t.startsWith(s)){if(t.startsWith(s))n=L.fromHexString(t.split("-")[2]);else throw r?Error("Invalid HexString input while parsing private key. Must AIP-80 compliant string."):Error("Invalid HexString input while parsing private key.")}else n=L.fromHexInput(t),!1!==r&&console.warn("[Aptos SDK] It is recommended that private keys are AIP-80 compliant (https://github.com/aptos-foundation/AIPs/blob/main/aips/aip-80.md). You can fix the private key by formatting it with `PrivateKey.formatPrivateKey(privateKey: string, type: 'ed25519' | 'secp256k1'): string`.")}else n=L.fromHexInput(t);return n}};ek.AIP80_PREFIXES={ed25519:"ed25519-priv-",secp256k1:"secp256k1-priv-"};var eI=class extends G{async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return L.fromHexInput(e).toString()}},eP=class extends eI{},eK=class extends G{toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return L.fromHexInput(e).toString()}},eN=i(94890),e$=i(61688),eF=i(81748),eB=class e extends eI{constructor(t){super();let i=L.fromHexInput(t),{length:r}=i.toUint8Array();if(r===e.LENGTH)this.key=i;else if(r===e.COMPRESSED_LENGTH){let e=e$.kA.ProjectivePoint.fromHex(i.toUint8Array());this.key=L.fromHexInput(e.toRawBytes(!1))}else throw Error(`PublicKey length should be ${e.LENGTH} or ${e.COMPRESSED_LENGTH}, received ${r}`)}verifySignature(e){let{message:t,signature:i}=e,r=e_(t),n=L.fromHexInput(r).toUint8Array(),s=(0,eN.DZ)(n),a=i.toUint8Array();return e$.kA.verify(a,s,this.key.toUint8Array(),{lowS:!0})}async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}deserialize(e){return new eO(e.deserializeBytes())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&t.key?.data?.length===e.LENGTH}};eB.LENGTH=65,eB.COMPRESSED_LENGTH=33;var eR=class e extends G{constructor(t,i){super();let r=ek.parseHexInput(t,"secp256k1",i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.key=r}static generate(){return new e(e$.kA.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,i){if(!eE.test(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,eU(i))}static fromDerivationPathInner(t,i){let{privateKey:r}=eF.B.fromMasterSeed(i).derive(t);if(null===r)throw Error("Invalid key");return new e(r,!1)}sign(e){let t=e_(e),i=L.fromHexInput(t),r=(0,eN.DZ)(i.toUint8Array());return new eO(e$.kA.sign(r,this.key.toUint8Array(),{lowS:!0}).toCompactRawBytes())}publicKey(){return new eB(e$.kA.getPublicKey(this.key.toUint8Array(),!1))}toUint8Array(){return this.key.toUint8Array()}toString(){return this.toAIP80String()}toHexString(){return this.key.toString()}toAIP80String(){return ek.formatPrivateKey(this.key.toString(),"secp256k1")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};eR.LENGTH=32;var eD=class e extends eK{constructor(t){super();let i=L.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}, received ${i.toUint8Array().length}`);this.data=i}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};eD.LENGTH=64;var eO=eD,eL=new Map;function eV(e,t,i){return async(...r)=>{if(eL.has(t)){let{value:e,timestamp:r}=eL.get(t);if(void 0===i||Date.now()-r<=i)return e}let n=await e(...r);return eL.set(t,{value:n,timestamp:Date.now()}),n}}var eq=i(67094).Buffer,eH=(e,t)=>{let i=new Uint8Array([...e.bcsToBytes(),..."string"==typeof t?eq.from(t,"utf8"):t,254]);return new ef((0,eN.DZ)(i))},eM=i(68712),eG=i(67094).Buffer;async function ej(e){return new Promise(t=>{setTimeout(t,e)})}function eW(e){return e instanceof Error?e.message:String(e)}var eJ=()=>Math.floor(Date.now()/1e3),eY=e=>{let t="";for(let i=2;i<e.length;i+=2)t+=String.fromCharCode(parseInt(e.substring(i,i+2),16));return t},eX=e=>{let{account_address:t,module_name:i,struct_name:r}=e,n=eY(i),s=eY(r);return`${t}::${n}::${s}`},eZ=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e&&"account_address"in e&&"module_name"in e&&"struct_name"in e&&"string"==typeof e.account_address&&"string"==typeof e.module_name&&"string"==typeof e.struct_name;function eQ(e){let t=e.split("::");if(3!==t.length)throw Error(`Invalid function ${e}`);return{moduleAddress:t[0],moduleName:t[1],functionName:t[2]}}function e0(e){let t=e.split("::");return 3===t.length&&ef.isValid({input:t[0]}).valid}ef.A.toStringLong();var e2=((a=e2||{})[a.API_ERROR=0]="API_ERROR",a[a.EXTERNAL_API_ERROR=1]="EXTERNAL_API_ERROR",a[a.SESSION_EXPIRED=2]="SESSION_EXPIRED",a[a.INVALID_STATE=3]="INVALID_STATE",a[a.INVALID_SIGNATURE=4]="INVALID_SIGNATURE",a[a.UNKNOWN=5]="UNKNOWN",a),e1=((o=e1||{}).REAUTHENTICATE="Re-authentiate to continue using your keyless account",o.REAUTHENTICATE_UNSURE="Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support",o.UPDATE_REQUEST_PARAMS="Update the invalid request parameters and reauthenticate.",o.RATE_LIMIT_EXCEEDED="Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest.",o.SERVER_ERROR="Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",o.CALL_PRECHECK="Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing.",o.REINSTANTIATE="Try instantiating the account again.  Avoid manipulating the account object directly",o.JOIN_SUPPORT_GROUP="For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",o.UNKNOWN="Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",o),e8=((c=e8||{})[c.EPHEMERAL_KEY_PAIR_EXPIRED=0]="EPHEMERAL_KEY_PAIR_EXPIRED",c[c.PROOF_NOT_FOUND=1]="PROOF_NOT_FOUND",c[c.ASYNC_PROOF_FETCH_FAILED=2]="ASYNC_PROOF_FETCH_FAILED",c[c.INVALID_PROOF_VERIFICATION_FAILED=3]="INVALID_PROOF_VERIFICATION_FAILED",c[c.INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND=4]="INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND",c[c.INVALID_JWT_SIG=5]="INVALID_JWT_SIG",c[c.INVALID_JWT_JWK_NOT_FOUND=6]="INVALID_JWT_JWK_NOT_FOUND",c[c.INVALID_JWT_ISS_NOT_RECOGNIZED=7]="INVALID_JWT_ISS_NOT_RECOGNIZED",c[c.INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED=8]="INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED",c[c.INVALID_TW_SIG_VERIFICATION_FAILED=9]="INVALID_TW_SIG_VERIFICATION_FAILED",c[c.INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND=10]="INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND",c[c.INVALID_EXPIRY_HORIZON=11]="INVALID_EXPIRY_HORIZON",c[c.JWT_PARSING_ERROR=12]="JWT_PARSING_ERROR",c[c.JWK_FETCH_FAILED=13]="JWK_FETCH_FAILED",c[c.JWK_FETCH_FAILED_FEDERATED=14]="JWK_FETCH_FAILED_FEDERATED",c[c.RATE_LIMIT_EXCEEDED=15]="RATE_LIMIT_EXCEEDED",c[c.PEPPER_SERVICE_INTERNAL_ERROR=16]="PEPPER_SERVICE_INTERNAL_ERROR",c[c.PEPPER_SERVICE_BAD_REQUEST=17]="PEPPER_SERVICE_BAD_REQUEST",c[c.PEPPER_SERVICE_OTHER=18]="PEPPER_SERVICE_OTHER",c[c.PROVER_SERVICE_INTERNAL_ERROR=19]="PROVER_SERVICE_INTERNAL_ERROR",c[c.PROVER_SERVICE_BAD_REQUEST=20]="PROVER_SERVICE_BAD_REQUEST",c[c.PROVER_SERVICE_OTHER=21]="PROVER_SERVICE_OTHER",c[c.FULL_NODE_CONFIG_LOOKUP_ERROR=22]="FULL_NODE_CONFIG_LOOKUP_ERROR",c[c.FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR=23]="FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR",c[c.FULL_NODE_JWKS_LOOKUP_ERROR=24]="FULL_NODE_JWKS_LOOKUP_ERROR",c[c.FULL_NODE_OTHER=25]="FULL_NODE_OTHER",c[c.SIGNATURE_TYPE_INVALID=26]="SIGNATURE_TYPE_INVALID",c[c.SIGNATURE_EXPIRED=27]="SIGNATURE_EXPIRED",c[c.MAX_EXPIRY_HORIZON_EXCEEDED=28]="MAX_EXPIRY_HORIZON_EXCEEDED",c[c.EPHEMERAL_SIGNATURE_VERIFICATION_FAILED=29]="EPHEMERAL_SIGNATURE_VERIFICATION_FAILED",c[c.TRAINING_WHEELS_SIGNATURE_MISSING=30]="TRAINING_WHEELS_SIGNATURE_MISSING",c[c.TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED=31]="TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED",c[c.PROOF_VERIFICATION_FAILED=32]="PROOF_VERIFICATION_FAILED",c[c.UNKNOWN=33]="UNKNOWN",c),e3={0:["The ephemeral keypair has expired.",2,"Re-authentiate to continue using your keyless account"],1:["The required proof could not be found.",3,"Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing."],2:["The required proof failed to fetch.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],3:["The provided proof is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],4:["The verification key used to authenticate was updated.",2,"Re-authentiate to continue using your keyless account"],5:["The JWK was found, but JWT failed verification",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],6:["The JWK required to verify the JWT could not be found. The JWK may have been rotated out.",2,"Re-authentiate to continue using your keyless account"],7:["The JWT issuer is not recognized.",3,"Update the invalid request parameters and reauthenticate."],8:["The JWT issuer is not supported by the Federated Keyless ",0,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],9:["The training wheels signature is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],10:["The public key used to verify the training wheels signature was not found.",2,"Re-authentiate to continue using your keyless account"],11:["The expiry horizon is invalid.",2,"Re-authentiate to continue using your keyless account"],13:["Failed to fetch JWKS.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],14:["Failed to fetch JWKS for Federated Keyless provider.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],15:["Rate limit exceeded. Too many requests in a short period.",0,"Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest."],16:["Internal error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],17:["Bad request sent to Pepper service.",0,"Update the invalid request parameters and reauthenticate."],18:["Unknown error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],19:["Internal error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],20:["Bad request sent to Prover service.",0,"Update the invalid request parameters and reauthenticate."],21:["Unknown error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],12:["Error when parsing JWT. This should never happen. Join https://t.me/+h5CN-W35yUFiYzkx for support",3,"Try instantiating the account again.  Avoid manipulating the account object directly"],22:["Error when looking up on-chain keyless configuration.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],23:["Error when looking up on-chain verification key.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],24:["Error when looking up on-chain JWKS.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],25:["Unknown error from full node.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],26:["The signature is not a valid Keyless signature.",4,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],27:["The ephemeral key pair used to sign the message has expired.",4,"Re-authentiate to continue using your keyless account"],28:["The expiry horizon on the signature exceeds the maximum allowed value.",4,"Re-authentiate to continue using your keyless account"],29:["Failed to verify the ephemeral signature with the ephemeral public key.",4,"Re-authentiate to continue using your keyless account"],30:["The training wheels signature is missing but is required by the Keyless configuration.",4,"Re-authentiate to continue using your keyless account"],31:["Failed to verify the training wheels signature with the training wheels public key.",4,"Re-authentiate to continue using your keyless account"],32:["The proof verification failed.",4,"Re-authentiate to continue using your keyless account"],33:["An unknown error has occurred.",5,"Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"]},e5=class e extends Error{constructor(t){let{innerError:i,category:r,resolutionTip:n,type:s,message:a=e3[s][0],details:o}=t;super(a),this.name="KeylessError",this.innerError=i,this.category=r,this.resolutionTip=n,this.type=s,this.details=o,this.message=e.constructMessage(a,n,i,o)}static constructMessage(e,t,i,r){let n=`
Message: ${e}`;return r&&(n+=`
Details: ${r}`),i instanceof e4?n+=`
AptosApiError: ${i.message}`:void 0!==i&&(n+=`
Error: ${eW(i)}`),n+=`
KeylessErrorResolutionTip: ${t}`}static fromErrorType(t){let{error:i,type:r,details:n}=t,[s,a,o]=e3[r];return new e({message:s,details:n,innerError:i,category:a,resolutionTip:o,type:r})}},e4=class extends Error{constructor({apiType:e,aptosRequest:t,aptosResponse:i}){super(function({apiType:e,aptosRequest:t,aptosResponse:i}){let r,n=i.headers?.traceparent?.split("-")[1],s=n?`(trace_id:${n}) `:"",a=`Request to [${e}]: ${t.method} ${i.url??t.url} ${s}failed with`;return"Indexer"===e&&i.data?.errors?.[0]?.message!=null?`${a}: ${i.data.errors[0].message}`:i.data?.message!=null&&i.data?.error_code!=null?`${a}: ${JSON.stringify(i.data)}`:`${a} status: ${i.statusText}(code:${i.status}) and response body: ${(r=JSON.stringify(i.data)).length<=400?r:`truncated(original_size:${r.length}): ${r.slice(0,200)}...${r.slice(-200)}`}`}({apiType:e,aptosRequest:t,aptosResponse:i})),this.name="AptosApiError",this.url=i.url,this.status=i.status,this.statusText=i.statusText,this.data=i.data,this.request=t}};async function e6(e,t){let{url:i,method:r,body:n,contentType:s,params:a,overrides:o,originMethod:c}=e,u={...o?.HEADERS,"x-aptos-client":"aptos-typescript-sdk/2.0.1","content-type":s??"application/json","x-aptos-typescript-sdk-origin-method":c};return o?.AUTH_TOKEN&&(u.Authorization=`Bearer ${o?.AUTH_TOKEN}`),o?.API_KEY&&(u.Authorization=`Bearer ${o?.API_KEY}`),t.provider({url:i,method:r,body:n,params:a,headers:u,overrides:o})}async function e9(e,t,i){let{url:r,path:n}=e,s=n?`${r}/${n}`:r,a=await e6({...e,url:s},t.client),o={status:a.status,statusText:a.statusText??"No status text provided",data:a.data,headers:a.headers,config:a.config,request:a.request,url:s};if(401===o.status)throw new e4({apiType:i,aptosRequest:e,aptosResponse:o});if("Indexer"===i){let t=o.data;if(t.errors)throw new e4({apiType:i,aptosRequest:e,aptosResponse:o});o.data=t.data}else if(("Pepper"===i||"Prover"===i)&&o.status>=400)throw new e4({apiType:i,aptosRequest:e,aptosResponse:o});if(o.status>=200&&o.status<300)return o;throw new e4({apiType:i,aptosRequest:e,aptosResponse:o})}async function e7(e){let{aptosConfig:t,overrides:i,params:r,contentType:n,acceptType:s,path:a,originMethod:o,type:c}=e;return e9({url:t.getRequestUrl(c),method:"GET",originMethod:o,path:a,contentType:n,acceptType:s,params:r,overrides:{...t.clientConfig,...i}},t,e.type)}async function te(e){let{aptosConfig:t}=e;return e7({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.fullnodeConfig?.HEADERS}}})}async function tt(e){let t=[],i,r=e.params;do{let n=await e7({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:r,overrides:e.overrides});i=n.headers["x-aptos-cursor"],delete n.headers,t.push(...n.data),r.start=i}while(null!=i);return t}async function ti(e){let t=[],i,r=e.params,n=r.limit;do{let{response:s,cursor:a}=await tr({...e});if(i=a,t.push(...s.data),e?.params&&(e.params.start=i),void 0!==n){let e=n-t.length;if(e<=0)break;r.limit=e}}while(null!=i);return t}async function tr(e){let t,i={};"string"==typeof e.params?.cursor&&(i.start=e.params.cursor),"number"==typeof e.params?.limit&&(i.limit=e.params.limit);let r=await e7({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:i,overrides:e.overrides});return t=r.headers["x-aptos-cursor"],{response:r,cursor:t}}async function tn(e){let{aptosConfig:t,accountAddress:i}=e,{data:r}=await te({aptosConfig:t,originMethod:"getInfo",path:`accounts/${ef.from(i).toString()}`});return r}async function ts(e){return e.options?.ledgerVersion!==void 0?ta(e):eV(async()=>ta(e),`module-${e.accountAddress}-${e.moduleName}`,3e5)()}async function ta(e){let{aptosConfig:t,accountAddress:i,moduleName:r,options:n}=e,{data:s}=await te({aptosConfig:t,originMethod:"getModule",path:`accounts/${ef.from(i).toString()}/module/${r}`,params:{ledger_version:n?.ledgerVersion}});return s}var to=i(32092),tc=[to.poseidon1,to.poseidon2,to.poseidon3,to.poseidon4,to.poseidon5,to.poseidon6,to.poseidon7,to.poseidon8,to.poseidon9,to.poseidon10,to.poseidon11,to.poseidon12,to.poseidon13,to.poseidon14,to.poseidon15,to.poseidon16];function tu(e,t){return function(e,t){if(e.length>t)throw Error(`Inputted bytes of length ${e} is longer than ${t}`);return tp(tl(e,t))}(new TextEncoder().encode(e),t)}function tl(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return(function(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return function(e){if(e.length>465)throw Error(`Can't pack more than 465.  Was given ${e.length} bytes`);return(function(e,t){let i=[];for(let t=0;t<e.length;t+=31)i.push(e.subarray(t,t+31));return i})(e,31).map(e=>td(e))}(function(e,t){if(t<e.length)throw Error("Padded size must be greater than or equal to the input array size.");let i=new Uint8Array(t);i.set(e);for(let r=e.length;r<t;r+=1)i[r]=0;return i}(e,t))})(e,t).concat([BigInt(e.length)])}function td(e){let t=BigInt(0);for(let i=e.length-1;i>=0;i-=1)t=t<<BigInt(8)|BigInt(e[i]);return t}function tf(e,t){let i=BigInt(e),r=new Uint8Array(t);for(let e=0;e<t;e+=1)r[e]=Number(i&BigInt(255)),i>>=BigInt(8);return r}function tp(e){if(e.length>tc.length)throw Error(`Unable to hash input of length ${e.length}.  Max input length is ${tc.length}`);return tc[e.length-1](e)}var th=class extends G{},tg=class e extends G{constructor(t){super();let{data:i}=t,r=L.fromHexInput(i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`Authentication Key length should be ${e.LENGTH}`);this.data=r}serialize(e){e.serializeFixedBytes(this.data.toUint8Array())}static deserialize(t){let i=t.deserializeFixedBytes(e.LENGTH);return new e({data:i})}toUint8Array(){return this.data.toUint8Array()}static fromSchemeAndBytes(t){let{scheme:i,input:r}=t,n=new Uint8Array([...L.fromHexInput(r).toUint8Array(),i]),s=eN.DZ.create();return s.update(n),new e({data:s.digest()})}static fromPublicKeyAndScheme(e){let{publicKey:t}=e;return t.authKey()}static fromPublicKey(e){let{publicKey:t}=e;return t.authKey()}derivedAddress(){return new ef(this.data.toUint8Array())}};tg.LENGTH=32;var ty=class e extends eK{constructor(e){super(),this.value=L.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}static deserialize(t){return new e(t.deserializeBytes())}},tm=class extends eP{constructor(e){super(),this.accountAddress=e}authKey(){return new tg({data:this.accountAddress.toUint8Array()})}verifySignature(e){throw Error("This function is not implemented for AbstractPublicKey.")}async verifySignatureAsync(e){throw Error("This function is not implemented for AbstractPublicKey.")}serialize(e){throw Error("This function is not implemented for AbstractPublicKey.")}},t_=i(205),tw=[237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16],tA=class e extends eP{constructor(t){super();let i=L.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`PublicKey length should be ${e.LENGTH}`);this.key=i}verifySignature(e){let{message:t,signature:i}=e;if(!function(e){let t=e.toUint8Array().slice(32);for(let e=tw.length-1;e>=0;e-=1){if(t[e]<tw[e])return!0;if(t[e]>tw[e])break}return!1}(i))return!1;let r=e_(t),n=L.fromHexInput(r).toUint8Array(),s=i.toUint8Array(),a=this.key.toUint8Array();return t_.UN.verify(s,n,a)}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return tg.fromSchemeAndBytes({scheme:0,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&t.key?.data?.length===e.LENGTH}};tA.LENGTH=32;var tb=class e extends G{constructor(t,i){super();let r=ek.parseHexInput(t,"ed25519",i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.signingKey=r}static generate(){return new e(t_.UN.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,i){if(!ev.test(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,eU(i))}static fromDerivationPathInner(t,i,r=2147483648){let{key:n,chainCode:s}=eS(e.SLIP_0010_SEED,i),{key:a}=eC(t).map(e=>parseInt(e,10)).reduce((e,t)=>eT(e,t+r),{key:n,chainCode:s});return new e(a,!1)}publicKey(){return new tA(t_.UN.getPublicKey(this.signingKey.toUint8Array()))}sign(e){let t=e_(e),i=L.fromHexInput(t).toUint8Array();return new tz(t_.UN.sign(i,this.signingKey.toUint8Array()))}toUint8Array(){return this.signingKey.toUint8Array()}toString(){return this.toAIP80String()}toHexString(){return this.signingKey.toString()}toAIP80String(){return ek.formatPrivateKey(this.signingKey.toString(),"ed25519")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};tb.LENGTH=32,tb.SLIP_0010_SEED="ed25519 seed";var tv=tb,tE=class e extends eK{constructor(t){super();let i=L.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}`);this.data=i}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tE.LENGTH=64;var tz=tE,tS=class e extends eI{constructor(e){super();let t=e.constructor.name;if(t===tA.name)this.publicKey=e,this.variant=0;else throw Error(`Unsupported key for EphemeralPublicKey - ${t}`)}verifySignature(e){let{message:t,signature:i}=e;return this.publicKey.verifySignature({message:t,signature:i.signature})}async verifySignatureAsync(e){return this.verifySignature(e)}serialize(e){if(this.publicKey instanceof tA)e.serializeU32AsUleb128(0),this.publicKey.serialize(e);else throw Error("Unknown public key type")}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(tA.deserialize(t));throw Error(`Unknown variant index for EphemeralPublicKey: ${i}`)}static isPublicKey(t){return t instanceof e}},tT=class e extends eK{constructor(e){super();let t=e.constructor.name;if(t===tz.name)this.signature=e;else throw Error(`Unsupported signature for EphemeralSignature - ${t}`)}static fromHex(t){let i=new es(L.fromHexInput(t).toUint8Array());return e.deserialize(i)}serialize(e){if(this.signature instanceof tz)e.serializeU32AsUleb128(0),this.signature.serialize(e);else throw Error("Unknown signature type")}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(tz.deserialize(t));throw Error(`Unknown variant index for EphemeralSignature: ${i}`)}};function tx(e,t,i){let r=i.value;return i.value=async function(...e){let[t]=e;if(t.transaction.feePayerAddress&&!t.feePayerAuthenticator)throw Error("You are submitting a Fee Payer transaction but missing the feePayerAuthenticator");return r.apply(this,e)},i}function tC(e,t,i){let r=i.value;return i.value=async function(...e){return r.apply(this,e)},i}var tU=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,tk=`
    fragment AnsTokenFragment on current_aptos_names {
  domain
  expiration_timestamp
  registered_address
  subdomain
  token_standard
  is_primary
  owner_address
  subdomain_expiration_policy
  domain_expiration_timestamp
}
    `,tI=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,tP=`
    query getAccountCoinsCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,tK=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,tN=`
    query getAccountCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,t$=`
    query getAccountOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tI}`,tF=`
    query getAccountOwnedTokensFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tI}`,tB=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,tR=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,tD=`
    query getChainTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,tO=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!) {
  current_collections_v2(where: $where_condition) {
    uri
    total_minted_v2
    token_standard
    table_handle_v1
    mutable_uri
    mutable_description
    max_supply
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    cdn_asset_uris {
      cdn_image_uri
      asset_uri
      animation_optimizer_retry_count
      cdn_animation_uri
      cdn_json_uri
      image_optimizer_retry_count
      json_parser_retry_count
      raw_animation_uri
      raw_image_uri
    }
  }
}
    `,tL=`
    query getCurrentFungibleAssetBalances($where_condition: current_fungible_asset_balances_bool_exp, $offset: Int, $limit: Int) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
  }
}
    `,tV=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,tq=`
    query getEvents($where_condition: events_bool_exp, $offset: Int, $limit: Int, $order_by: [events_order_by!]) {
  events(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    account_address
    creation_number
    data
    event_index
    sequence_number
    transaction_block_height
    transaction_version
    type
    indexed_type
  }
}
    `,tH=`
    query getFungibleAssetActivities($where_condition: fungible_asset_activities_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_activities(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    block_height
    entry_function_id_str
    event_index
    gas_fee_payer_address
    is_frozen
    is_gas_fee
    is_transaction_success
    owner_address
    storage_id
    storage_refund_amount
    token_standard
    transaction_timestamp
    transaction_version
    type
  }
}
    `,tM=`
    query getFungibleAssetMetadata($where_condition: fungible_asset_metadata_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_metadata(where: $where_condition, offset: $offset, limit: $limit) {
    icon_uri
    project_uri
    supply_aggregator_table_handle_v1
    supply_aggregator_table_key_v1
    creator_address
    asset_type
    decimals
    last_transaction_timestamp
    last_transaction_version
    name
    symbol
    token_standard
    supply_v2
    maximum_v2
  }
}
    `,tG=`
    query getNames($offset: Int, $limit: Int, $where_condition: current_aptos_names_bool_exp, $order_by: [current_aptos_names_order_by!]) {
  current_aptos_names(
    limit: $limit
    where: $where_condition
    order_by: $order_by
    offset: $offset
  ) {
    ...AnsTokenFragment
  }
}
    ${tk}`,tj=`
    query getNumberOfDelegators($where_condition: num_active_delegator_per_pool_bool_exp, $order_by: [num_active_delegator_per_pool_order_by!]) {
  num_active_delegator_per_pool(where: $where_condition, order_by: $order_by) {
    num_active_delegator
    pool_address
  }
}
    `,tW=`
    query getObjectData($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,tJ=`
    query getProcessorStatus($where_condition: processor_status_bool_exp) {
  processor_status(where: $where_condition) {
    last_success_version
    processor
    last_updated
  }
}
    `,tY=`
    query getTableItemsData($where_condition: table_items_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_items_order_by!]) {
  table_items(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    decoded_key
    decoded_value
    key
    table_handle
    transaction_version
    write_set_change_index
  }
}
    `,tX=`
    query getTableItemsMetadata($where_condition: table_metadatas_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_metadatas_order_by!]) {
  table_metadatas(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    handle
    key_type
    value_type
  }
}
    `,tZ=`
    query getTokenActivity($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${tU}`,tQ=`
    query getCurrentTokenOwnership($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tI}`,t0=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `;async function t2(e){let{type:t,originMethod:i,path:r,body:n,acceptType:s,contentType:a,params:o,aptosConfig:c,overrides:u}=e;return e9({url:c.getRequestUrl(t),method:"POST",originMethod:i,path:r,body:n,contentType:a,acceptType:s,params:o,overrides:u},c,e.type)}async function t1(e){let{aptosConfig:t}=e;return t2({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.fullnodeConfig?.HEADERS}}})}async function t8(e){let{aptosConfig:t}=e;return t2({...e,type:"Indexer",overrides:{...t.clientConfig,...t.indexerConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.indexerConfig?.HEADERS}}})}async function t3(e){let{aptosConfig:t}=e,i={...t,clientConfig:{...t.clientConfig}};return delete i?.clientConfig?.API_KEY,t2({...e,type:"Faucet",overrides:{...i.clientConfig,...i.faucetConfig,...e.overrides,HEADERS:{...i.clientConfig?.HEADERS,...i.faucetConfig?.HEADERS}}})}async function t5(e){return t2({...e,type:"Pepper"})}async function t4(e){return t2({...e,type:"Prover"})}async function t6(e){let{aptosConfig:t}=e,{data:i}=await te({aptosConfig:t,originMethod:"getLedgerInfo",path:""});return i}async function t9(e){let{aptosConfig:t,limit:i}=e;return(await t7({aptosConfig:t,query:{query:tD,variables:{limit:i}},originMethod:"getChainTopUserTransactions"})).user_transactions}async function t7(e){let{aptosConfig:t,query:i,originMethod:r}=e,{data:n}=await t8({aptosConfig:t,originMethod:r??"queryIndexer",path:"",body:i,overrides:{WITH_CREDENTIALS:!1}});return n}async function ie(e){let{aptosConfig:t}=e;return(await t7({aptosConfig:t,query:{query:tJ},originMethod:"getProcessorStatuses"})).processor_status}async function it(e){return BigInt((await ie({aptosConfig:e.aptosConfig}))[0].last_success_version)}async function ii(e){let{aptosConfig:t,processorType:i}=e;return(await t7({aptosConfig:t,query:{query:tJ,variables:{where_condition:{processor:{_eq:i}}}},originMethod:"getProcessorStatus"})).processor_status[0]}async function ir(e){let{aptosConfig:t,handle:i,data:r,options:n}=e;return(await t1({aptosConfig:t,originMethod:"getTableItem",path:`tables/${i}/item`,params:{ledger_version:n?.ledgerVersion},body:r})).data}async function is(e){let{aptosConfig:t,options:i}=e,r={query:tY,variables:{where_condition:i?.where,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:r,originMethod:"getTableItemsData"})).table_items}async function ia(e){let{aptosConfig:t,options:i}=e,r={query:tX,variables:{where_condition:i?.where,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:r,originMethod:"getTableItemsMetadata"})).table_metadatas}var io=((u=io||{}).FULLNODE="Fullnode",u.INDEXER="Indexer",u.FAUCET="Faucet",u.PEPPER="Pepper",u.PROVER="Prover",u),ic="0x1::aptos_coin::AptosCoin",iu="APTOS::RawTransactionWithData",il=((l=il||{}).ACCOUNT_TRANSACTION_PROCESSOR="account_transactions_processor",l.DEFAULT="default_processor",l.EVENTS_PROCESSOR="events_processor",l.FUNGIBLE_ASSET_PROCESSOR="fungible_asset_processor",l.STAKE_PROCESSOR="stake_processor",l.TOKEN_V2_PROCESSOR="token_v2_processor",l.USER_TRANSACTION_PROCESSOR="user_transaction_processor",l.OBJECT_PROCESSOR="objects_processor",l),id=/^https:\/\/securetoken\.google\.com\/[a-zA-Z0-9-_]+$/;async function ip(e){let{aptosConfig:t,options:i}=e;return tt({aptosConfig:t,originMethod:"getTransactions",path:"transactions",params:{start:i?.offset,limit:i?.limit}})}async function ih(e){let{aptosConfig:t}=e;return eV(async()=>{let{data:e}=await te({aptosConfig:t,originMethod:"getGasPriceEstimation",path:"estimate_gas_price"});return e},`gas-price-${t.network}`,3e5)()}async function ig(e){let{aptosConfig:t,ledgerVersion:i}=e,{data:r}=await te({aptosConfig:t,originMethod:"getTransactionByVersion",path:`transactions/by_version/${i}`});return r}async function iy(e){let{aptosConfig:t,transactionHash:i}=e,{data:r}=await te({aptosConfig:t,path:`transactions/by_hash/${i}`,originMethod:"getTransactionByHash"});return r}async function im(e){let{aptosConfig:t,transactionHash:i}=e;try{return"pending_transaction"===(await iy({aptosConfig:t,transactionHash:i})).type}catch(e){if(e?.status===404)return!0;throw e}}async function i_(e){let{aptosConfig:t,transactionHash:i}=e,{data:r}=await te({aptosConfig:t,path:`transactions/wait_by_hash/${i}`,originMethod:"longWaitForTransaction"});return r}async function iw(e){let{aptosConfig:t,transactionHash:i,options:r}=e,n=r?.timeoutSecs??20,s=r?.checkSuccess??!0,a=!0,o=0,c,u,l=200;function d(e){if(!(e instanceof e4)||(u=e,404!==e.status&&e.status>=400&&e.status<500))throw e}try{c=await iy({aptosConfig:t,transactionHash:i}),a="pending_transaction"===c.type}catch(e){d(e)}if(a){let e=Date.now();try{c=await i_({aptosConfig:t,transactionHash:i}),a="pending_transaction"===c.type}catch(e){d(e)}o=(Date.now()-e)/1e3}for(;a&&!(o>=n);){try{if(c=await iy({aptosConfig:t,transactionHash:i}),!(a="pending_transaction"===c.type))break}catch(e){d(e)}await ej(l),o+=l/1e3,l*=1.5}if(void 0===c)throw u||new ib(`Fetching transaction ${i} failed and timed out after ${n} seconds`,c);if("pending_transaction"===c.type)throw new ib(`Transaction ${i} timed out in pending state after ${n} seconds`,c);if(!s)return c;if(!c.success)throw new iv(`Transaction ${i} failed with an error: ${c.vm_status}`,c);return c}async function iA(e){let{aptosConfig:t,processorType:i}=e,r=BigInt(e.minimumLedgerVersion),n=new Date().getTime(),s=BigInt(-1);for(;s<r;){if(new Date().getTime()-n>3e3)throw Error("waitForLastSuccessIndexerVersionSync timeout");if((s=void 0===i?await it({aptosConfig:t}):(await ii({aptosConfig:t,processorType:i})).last_success_version)>=r)break;await ej(200)}}var ib=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},iv=class extends Error{constructor(e,t){super(e),this.transaction=t}};async function iE(e){let{aptosConfig:t,ledgerVersion:i,options:r}=e,{data:n}=await te({aptosConfig:t,originMethod:"getBlockByVersion",path:`blocks/by_version/${i}`,params:{with_transactions:r?.withTransactions}});return iS({block:n,...e})}async function iz(e){let{aptosConfig:t,blockHeight:i,options:r}=e,{data:n}=await te({aptosConfig:t,originMethod:"getBlockByHeight",path:`blocks/by_height/${i}`,params:{with_transactions:r?.withTransactions}});return iS({block:n,...e})}async function iS(e){let{aptosConfig:t,block:i,options:r}=e;if(r?.withTransactions){i.transactions=i.transactions??[];let e=i.transactions[i.transactions.length-1],r=BigInt(i.first_version),n=BigInt(i.last_version),s=e?.version,a;if((a=void 0===s?r-1n:BigInt(s))===n)return i;let o=[];for(let e=a+1n;e<n;e+=BigInt(100))o.push(ip({aptosConfig:t,options:{offset:e,limit:Math.min(Number(100n),Number(n-e+1n))}}));for(let e of(await Promise.all(o)))i.transactions.push(...e)}return i}async function iT(e){void 0!==e.minimumLedgerVersion&&await iA({aptosConfig:e.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:e.processorType})}var ix=class{constructor(e){this.config=e}async getTableItem(e){return ir({aptosConfig:this.config,...e})}async getTableItemsData(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),is({aptosConfig:this.config,...e})}async getTableItemsMetadata(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),ia({aptosConfig:this.config,...e})}},iC={mainnet:"https://api.mainnet.aptoslabs.com/v1/graphql",testnet:"https://api.testnet.aptoslabs.com/v1/graphql",devnet:"https://api.devnet.aptoslabs.com/v1/graphql",local:"http://127.0.0.1:8090/v1/graphql"},iU={mainnet:"https://api.mainnet.aptoslabs.com/v1",testnet:"https://api.testnet.aptoslabs.com/v1",devnet:"https://api.devnet.aptoslabs.com/v1",local:"http://127.0.0.1:8080/v1"},ik={devnet:"https://faucet.devnet.aptoslabs.com",local:"http://127.0.0.1:8081"},iI={mainnet:"https://api.mainnet.aptoslabs.com/keyless/pepper/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/pepper/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/pepper/v0",local:"https://api.devnet.aptoslabs.com/keyless/pepper/v0"},iP={mainnet:"https://api.mainnet.aptoslabs.com/keyless/prover/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/prover/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/prover/v0",local:"https://api.devnet.aptoslabs.com/keyless/prover/v0"},iK=((d=iK||{}).MAINNET="mainnet",d.TESTNET="testnet",d.DEVNET="devnet",d.LOCAL="local",d.CUSTOM="custom",d),iN={mainnet:1,testnet:2,local:4},i$=i(47457),iF=class{constructor(e){if(e?.fullnode||e?.indexer||e?.faucet||e?.pepper||e?.prover){if(e?.network==="custom")console.info("Note: using CUSTOM network will require queries to lookup ChainId");else if(!e?.network)throw Error("Custom endpoints require a network to be specified")}this.network=e?.network??"devnet",this.fullnode=e?.fullnode,this.faucet=e?.faucet,this.pepper=e?.pepper,this.prover=e?.prover,this.indexer=e?.indexer,this.client=e?.client??{provider:i$.ZP},this.clientConfig=e?.clientConfig??{},this.fullnodeConfig=e?.fullnodeConfig??{},this.indexerConfig=e?.indexerConfig??{},this.faucetConfig=e?.faucetConfig??{}}getRequestUrl(e){switch(e){case"Fullnode":if(void 0!==this.fullnode)return this.fullnode;if("custom"===this.network)throw Error("Please provide a custom full node url");return iU[this.network];case"Faucet":if(void 0!==this.faucet)return this.faucet;if("testnet"===this.network)throw Error("There is no way to programmatically mint testnet APT, you must use the minting site at https://aptos.dev/network/faucet");if("mainnet"===this.network)throw Error("There is no mainnet faucet");if("custom"===this.network)throw Error("Please provide a custom faucet url");return ik[this.network];case"Indexer":if(void 0!==this.indexer)return this.indexer;if("custom"===this.network)throw Error("Please provide a custom indexer url");return iC[this.network];case"Pepper":if(void 0!==this.pepper)return this.pepper;if("custom"===this.network)throw Error("Please provide a custom pepper service url");return iI[this.network];case"Prover":if(void 0!==this.prover)return this.prover;if("custom"===this.network)throw Error("Please provide a custom prover service url");return iP[this.network];default:throw Error(`apiType ${e} is not supported`)}}isPepperServiceRequest(e){return iI[this.network]===e}isProverServiceRequest(e){return iP[this.network]===e}},iB=class e extends G{constructor(e){super(),this.value=L.fromHexInput(e).toUint8Array()}serialize(e){e.serializeFixedBytes(this.value)}serializeForEntryFunction(e){e.serialize(this)}serializeForScriptFunction(e){e.serialize(this)}static deserialize(t,i){return new e(t.deserializeFixedBytes(i))}},iR=class e extends G{constructor(e){super(),this.value=new iB(e)}serialize(e){e.serialize(this.value)}serializeForEntryFunction(e){e.serializeU32AsUleb128(this.value.value.length),e.serialize(this)}static deserialize(t,i){return new e(iB.deserialize(t,i).value)}},iD=((f=iD||{}).JSON="application/json",f.BCS="application/x-bcs",f.BCS_SIGNED_TRANSACTION="application/x.aptos.signed_transaction+bcs",f.BCS_VIEW_FUNCTION="application/x.aptos.view_function+bcs",f),iO=((p=iO||{})[p.Bool=0]="Bool",p[p.U8=1]="U8",p[p.U64=2]="U64",p[p.U128=3]="U128",p[p.Address=4]="Address",p[p.Signer=5]="Signer",p[p.Vector=6]="Vector",p[p.Struct=7]="Struct",p[p.U16=8]="U16",p[p.U32=9]="U32",p[p.U256=10]="U256",p[p.Reference=254]="Reference",p[p.Generic=255]="Generic",p),iL=((h=iL||{})[h.U8=0]="U8",h[h.U64=1]="U64",h[h.U128=2]="U128",h[h.Address=3]="Address",h[h.U8Vector=4]="U8Vector",h[h.Bool=5]="Bool",h[h.U16=6]="U16",h[h.U32=7]="U32",h[h.U256=8]="U256",h[h.Serialized=9]="Serialized",h),iV=((g=iV||{})[g.Script=0]="Script",g[g.EntryFunction=2]="EntryFunction",g[g.Multisig=3]="Multisig",g),iq=((y=iq||{})[y.MultiAgentTransaction=0]="MultiAgentTransaction",y[y.FeePayerTransaction=1]="FeePayerTransaction",y),iH=((m=iH||{})[m.Ed25519=0]="Ed25519",m[m.MultiEd25519=1]="MultiEd25519",m[m.MultiAgent=2]="MultiAgent",m[m.FeePayer=3]="FeePayer",m[m.SingleSender=4]="SingleSender",m),iM=((_=iM||{})[_.Ed25519=0]="Ed25519",_[_.MultiEd25519=1]="MultiEd25519",_[_.SingleKey=2]="SingleKey",_[_.MultiKey=3]="MultiKey",_[_.NoAccountAuthenticator=4]="NoAccountAuthenticator",_[_.Abstraction=5]="Abstraction",_),iG=((w=iG||{}).Ed25519="ed25519",w.Secp256k1="secp256k1",w),ij=((A=ij||{})[A.Ed25519=0]="Ed25519",A[A.Secp256k1=1]="Secp256k1",A[A.Keyless=3]="Keyless",A[A.FederatedKeyless=4]="FederatedKeyless",A),iW=((b=iW||{})[b.Ed25519=0]="Ed25519",b[b.Secp256k1=1]="Secp256k1",b[b.Keyless=3]="Keyless",b),iJ=((v=iJ||{})[v.Ed25519=0]="Ed25519",v),iY=((E=iY||{})[E.Ed25519=0]="Ed25519",E),iX=((z=iX||{})[z.ZkProof=0]="ZkProof",z),iZ=((S=iZ||{})[S.Groth16=0]="Groth16",S),iQ=((T=iQ||{}).Pending="pending_transaction",T.User="user_transaction",T.Genesis="genesis_transaction",T.BlockMetadata="block_metadata_transaction",T.StateCheckpoint="state_checkpoint_transaction",T.Validator="validator_transaction",T.BlockEpilogue="block_epilogue_transaction",T),i0=((x=i0||{}).PRIVATE="private",x.PUBLIC="public",x.FRIEND="friend",x),i2=((C=i2||{}).STORE="store",C.DROP="drop",C.KEY="key",C.COPY="copy",C),i1=((U=i1||{}).VALIDATOR="validator",U.FULL_NODE="full_node",U),i8=((k=i8||{})[k.Ed25519=0]="Ed25519",k[k.MultiEd25519=1]="MultiEd25519",k[k.SingleKey=2]="SingleKey",k[k.MultiKey=3]="MultiKey",k),i3=((I=i3||{})[I.Ed25519=0]="Ed25519",I[I.Secp256k1Ecdsa=2]="Secp256k1Ecdsa",I),i5=((P=i5||{})[P.DeriveAuid=251]="DeriveAuid",P[P.DeriveObjectAddressFromObject=252]="DeriveObjectAddressFromObject",P[P.DeriveObjectAddressFromGuid=253]="DeriveObjectAddressFromGuid",P[P.DeriveObjectAddressFromSeed=254]="DeriveObjectAddressFromSeed",P[P.DeriveResourceAccountAddress=255]="DeriveResourceAccountAddress",P),i4=i(85197),i6=i(95955),i9=i(69530),i7=i(13959),re=class e extends eP{constructor(e,t){super(),this.jwkAddress=ef.from(e),this.keylessPublicKey=t}authKey(){let e=new j;return e.serializeU32AsUleb128(4),e.serializeFixedBytes(this.bcsToBytes()),tg.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return oa({...e,publicKey:this}),!0}catch{return!1}}serialize(e){this.jwkAddress.serialize(e),this.keylessPublicKey.serialize(e)}static deserialize(t){return new e(ef.deserialize(t),on.deserialize(t))}static isPublicKey(t){return t instanceof e}async verifySignatureAsync(e){return os({...e,publicKey:this})}static create(t){return new e(t.jwkAddress,on.create(t))}static fromJwtAndPepper(t){return new e(t.jwkAddress,on.fromJwtAndPepper(t))}static isInstance(e){return"jwkAddress"in e&&e.jwkAddress instanceof ef&&"keylessPublicKey"in e&&e.keylessPublicKey instanceof on}},rt=class e extends eP{constructor(e){if(super(),this.publicKey=e,e instanceof tA)this.variant=0;else if(e instanceof eB)this.variant=1;else if(e instanceof on)this.variant=3;else if(e instanceof re)this.variant=4;else throw Error("Unsupported public key type")}verifySignature(e){let{message:t,signature:i}=e;if(this.publicKey instanceof on)throw Error("Use verifySignatureAsync to verify Keyless signatures");return this.publicKey.verifySignature({message:t,signature:i.signature})}async verifySignatureAsync(e){if(!(e.signature instanceof ri)){if(e.options?.throwErrorWithReason)throw Error("Signature must be an instance of AnySignature");return!1}return await this.publicKey.verifySignatureAsync({...e,signature:e.signature.signature})}authKey(){return tg.fromSchemeAndBytes({scheme:2,input:this.toUint8Array()})}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.publicKey.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;switch(i){case 0:r=tA.deserialize(t);break;case 1:r=eB.deserialize(t);break;case 3:r=on.deserialize(t);break;case 4:r=re.deserialize(t);break;default:throw Error(`Unknown variant index for AnyPublicKey: ${i}`)}return new e(r)}static isPublicKey(t){return t instanceof e}isEd25519(){return this.publicKey instanceof tA}isSecp256k1PublicKey(){return this.publicKey instanceof eB}static isInstance(e){return"publicKey"in e&&"variant"in e}},ri=class e extends eK{constructor(e){if(super(),this.signature=e,e instanceof tz)this.variant=0;else if(e instanceof eO)this.variant=1;else if(e instanceof ou)this.variant=3;else throw Error("Unsupported signature type")}toUint8Array(){return console.warn("[Aptos SDK] Calls to AnySignature.toUint8Array() will soon return the underlying signature bytes. Use AnySignature.bcsToBytes() instead."),this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;switch(i){case 0:r=tz.deserialize(t);break;case 1:r=eO.deserialize(t);break;case 3:r=ou.deserialize(t);break;default:throw Error(`Unknown variant index for AnySignature: ${i}`)}return new e(r)}static isInstance(e){return"signature"in e&&"object"==typeof e.signature&&null!==e.signature&&"toUint8Array"in e.signature}},rr=class extends eP{constructor(e){super(),this.publicKeys=e.publicKeys}createBitmap(e){let{bits:t}=e,i=new Uint8Array([0,0,0,0]),r=new Set;return t.forEach((e,t)=>{if(t+1>this.publicKeys.length)throw Error(`Signature index ${t+1} is out of public keys range, ${this.publicKeys.length}.`);if(r.has(e))throw Error(`Duplicate bit ${e} detected.`);r.add(e);let n=Math.floor(e/8),s=i[n];s|=128>>e%8,i[n]=s}),i}getIndex(e){let t=this.publicKeys.findIndex(t=>t.toString()===e.toString());if(-1!==t)return t;throw Error(`Public key ${e} not found in multi key set ${this.publicKeys}`)}},rn=class e extends rr{constructor(e){let{publicKeys:t,signaturesRequired:i}=e;if(super({publicKeys:t}),i<1)throw Error("The number of required signatures needs to be greater than 0");if(t.length<i)throw Error(`Provided ${t.length} public keys is smaller than the ${i} required signatures`);this.publicKeys=t.map(e=>e instanceof rt?e:new rt(e)),this.signaturesRequired=i}verifySignature(e){let{message:t,signature:i}=e;if(i.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let r=i.bitMapToSignerIndices();for(let e=0;e<i.signatures.length;e+=1){let n=i.signatures[e];if(!this.publicKeys[r[e]].verifySignature({message:t,signature:n}))return!1}return!0}async verifySignatureAsync(e){let{signature:t}=e;try{if(!(t instanceof ra))throw Error("Signature is not a MultiKeySignature");if(t.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let i=t.bitMapToSignerIndices();for(let r=0;r<t.signatures.length;r+=1){let n=t.signatures[r];if(!await this.publicKeys[i[r]].verifySignatureAsync({...e,signature:n}))return!1}return!0}catch(t){if(e.options?.throwErrorWithReason)throw t;return!1}}authKey(){return tg.fromSchemeAndBytes({scheme:3,input:this.toUint8Array()})}serialize(e){e.serializeVector(this.publicKeys),e.serializeU8(this.signaturesRequired)}static deserialize(t){return new e({publicKeys:t.deserializeVector(rt),signaturesRequired:t.deserializeU8()})}getIndex(e){let t=e instanceof rt?e:new rt(e);return super.getIndex(t)}static isInstance(e){return"publicKeys"in e&&"signaturesRequired"in e}},rs=class e extends eK{constructor(t){super();let{signatures:i,bitmap:r}=t;if(i.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=i.map(e=>e instanceof ri?e:new ri(e)),r instanceof Uint8Array){if(r.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=r}else this.bitmap=e.createBitmap({bits:r});let n=this.bitmap.reduce((e,t)=>{let i;return e+(i=t,i-=i>>1&1431655765,((i=(858993459&i)+(i>>2&858993459))+(i>>4)&252645135)*16843009>>24)},0);if(n!==this.signatures.length)throw Error(`Expecting ${n} signatures from the bitmap, but got ${this.signatures.length}`)}static createBitmap(t){let{bits:i}=t,r=new Uint8Array([0,0,0,0]),n=new Set;return i.forEach(t=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");n.add(t);let i=Math.floor(t/8),s=r[i];s|=128>>t%8,r[i]=s}),r}bitMapToSignerIndices(){let e=[];for(let t=0;t<this.bitmap.length;t+=1){let i=this.bitmap[t];for(let r=0;r<8;r+=1)(i&128>>r)!=0&&e.push(8*t+r)}return e}serialize(e){e.serializeVector(this.signatures),e.serializeBytes(this.bitmap)}static deserialize(t){return new e({signatures:t.deserializeVector(ri),bitmap:t.deserializeBytes()})}};rs.BITMAP_LEN=4,rs.MAX_SIGNATURES_SUPPORTED=8*rs.BITMAP_LEN;var ra=rs,ro=class e extends rr{constructor(t){let{publicKeys:i,threshold:r}=t;if(super({publicKeys:i}),i.length>e.MAX_KEYS||i.length<e.MIN_KEYS)throw Error(`Must have between ${e.MIN_KEYS} and ${e.MAX_KEYS} public keys, inclusive`);if(r<e.MIN_THRESHOLD||r>i.length)throw Error(`Threshold must be between ${e.MIN_THRESHOLD} and ${i.length}, inclusive`);this.publicKeys=i,this.threshold=r}verifySignature(e){let{message:t,signature:i}=e;if(!(i instanceof ru))return!1;let r=[];for(let e=0;e<4;e+=1)for(let t=0;t<8;t+=1)if((i.bitmap[e]&1<<7-t)!=0){let i=8*e+t;r.push(i)}if(r.length!==i.signatures.length)throw Error("Bitmap and signatures length mismatch");if(r.length<this.threshold)throw Error("Not enough signatures");for(let e=0;e<r.length;e+=1)if(!this.publicKeys[r[e]].verifySignature({message:t,signature:i.signatures[e]}))return!1;return!0}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return tg.fromSchemeAndBytes({scheme:1,input:this.toUint8Array()})}toUint8Array(){let e=new Uint8Array(this.publicKeys.length*tA.LENGTH+1);return this.publicKeys.forEach((t,i)=>{e.set(t.toUint8Array(),i*tA.LENGTH)}),e[this.publicKeys.length*tA.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let i=t.deserializeBytes(),r=i[i.length-1],n=[];for(let e=0;e<i.length-1;e+=tA.LENGTH){let t=e;n.push(new tA(i.subarray(t,t+tA.LENGTH)))}return new e({publicKeys:n,threshold:r})}getIndex(e){return super.getIndex(e)}};ro.MAX_KEYS=32,ro.MIN_KEYS=2,ro.MIN_THRESHOLD=1;var rc=class e extends eK{constructor(t){super();let{signatures:i,bitmap:r}=t;if(i.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=i,r instanceof Uint8Array){if(r.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=r}else this.bitmap=e.createBitmap({bits:r})}toUint8Array(){let t=new Uint8Array(this.signatures.length*tz.LENGTH+e.BITMAP_LEN);return this.signatures.forEach((e,i)=>{t.set(e.toUint8Array(),i*tz.LENGTH)}),t.set(this.bitmap,this.signatures.length*tz.LENGTH),t}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let i=t.deserializeBytes(),r=i.subarray(i.length-4),n=[];for(let e=0;e<i.length-r.length;e+=tz.LENGTH){let t=e;n.push(new tz(i.subarray(t,t+tz.LENGTH)))}return new e({signatures:n,bitmap:r})}static createBitmap(t){let{bits:i}=t,r=new Uint8Array([0,0,0,0]),n=new Set;return i.forEach((t,s)=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");if(s>0&&t<=i[s-1])throw Error("The bits need to be sorted in ascending order.");n.add(t);let a=Math.floor(t/8),o=r[a];o|=128>>t%8,r[a]=o}),r}};rc.MAX_SIGNATURES_SUPPORTED=32,rc.BITMAP_LEN=4;var ru=rc,rl=class extends G{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return rd.load(e);case 1:return rf.load(e);case 2:return rp.load(e);case 3:return rh.load(e);case 4:return rg.load(e);case 5:return ry.load(e);default:throw Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}isEd25519(){return this instanceof rd}isMultiEd25519(){return this instanceof rf}isSingleKey(){return this instanceof rp}isMultiKey(){return this instanceof rh}},rd=class e extends rl{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tA.deserialize(t),tz.deserialize(t))}},rf=class e extends rl{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(ro.deserialize(t),ru.deserialize(t))}},rp=class e extends rl{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(2),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(rt.deserialize(t),ri.deserialize(t))}},rh=class e extends rl{constructor(e,t){super(),this.public_keys=e,this.signatures=t}serialize(e){e.serializeU32AsUleb128(3),this.public_keys.serialize(e),this.signatures.serialize(e)}static load(t){return new e(rn.deserialize(t),ra.deserialize(t))}},rg=class e extends rl{serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},ry=class e extends rl{constructor(e,t,i,r){if(super(),!e0(e))throw Error(`Invalid function info ${e} passed into AccountAuthenticatorAbstraction`);this.functionInfo=e,this.authenticator=i,this.signingMessageDigest=L.fromHexInput(L.fromHexInput(t).toUint8Array()),this.accountIdentity=r}serialize(e){e.serializeU32AsUleb128(5);let{moduleAddress:t,moduleName:i,functionName:r}=eQ(this.functionInfo);ef.fromString(t).serialize(e),e.serializeStr(i),e.serializeStr(r),this.accountIdentity?e.serializeU32AsUleb128(1):e.serializeU32AsUleb128(0),e.serializeBytes(this.signingMessageDigest.toUint8Array()),this.accountIdentity?e.serializeBytes(this.authenticator):e.serializeFixedBytes(this.authenticator),this.accountIdentity&&e.serializeBytes(this.accountIdentity)}static load(t){let i=ef.deserialize(t),r=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeUleb128AsU32();if(0===s)return new e(`${i}::${r}::${n}`,t.deserializeBytes(),t.deserializeFixedBytes(t.remaining()));if(1===s)return new e(`${i}::${r}::${n}`,t.deserializeBytes(),t.deserializeBytes(),t.deserializeBytes());throw Error(`Unknown variant index for AccountAuthenticatorAbstraction: ${s}`)}},rm=class e extends G{constructor(e,t){super(),this.address=e,this.name=t}static fromStr(t){let i=t.split("::");if(2!==i.length)throw Error("Invalid module id.");return new e(ef.fromString(i[0]),new em(i[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(t){return new e(ef.deserialize(t),em.deserialize(t))}},r_=class e extends G{deserialize(t){return new rP(ef.deserialize(t),em.deserialize(t),em.deserialize(t),t.deserializeVector(e))}static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return rw.load(e);case 1:return rA.load(e);case 2:return rE.load(e);case 3:return rz.load(e);case 4:return rT.load(e);case 5:return rx.load(e);case 6:return rk.load(e);case 7:return rI.load(e);case 8:return rb.load(e);case 9:return rv.load(e);case 10:return rS.load(e);case 255:return rU.load(e);default:throw Error(`Unknown variant index for TypeTag: ${t}`)}}isBool(){return this instanceof rw}isAddress(){return this instanceof rT}isGeneric(){return this instanceof rU}isSigner(){return this instanceof rx}isVector(){return this instanceof rk}isStruct(){return this instanceof rI}isU8(){return this instanceof rA}isU16(){return this instanceof rb}isU32(){return this instanceof rv}isU64(){return this instanceof rE}isU128(){return this instanceof rz}isU256(){return this instanceof rS}isPrimitive(){return this instanceof rx||this instanceof rT||this instanceof rw||this instanceof rA||this instanceof rb||this instanceof rv||this instanceof rE||this instanceof rz||this instanceof rS}},rw=class e extends r_{toString(){return"bool"}serialize(e){e.serializeU32AsUleb128(0)}static load(t){return new e}},rA=class e extends r_{toString(){return"u8"}serialize(e){e.serializeU32AsUleb128(1)}static load(t){return new e}},rb=class e extends r_{toString(){return"u16"}serialize(e){e.serializeU32AsUleb128(8)}static load(t){return new e}},rv=class e extends r_{toString(){return"u32"}serialize(e){e.serializeU32AsUleb128(9)}static load(t){return new e}},rE=class e extends r_{toString(){return"u64"}serialize(e){e.serializeU32AsUleb128(2)}static load(t){return new e}},rz=class e extends r_{toString(){return"u128"}serialize(e){e.serializeU32AsUleb128(3)}static load(t){return new e}},rS=class e extends r_{toString(){return"u256"}serialize(e){e.serializeU32AsUleb128(10)}static load(t){return new e}},rT=class e extends r_{toString(){return"address"}serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},rx=class e extends r_{toString(){return"signer"}serialize(e){e.serializeU32AsUleb128(5)}static load(t){return new e}},rC=class e extends r_{constructor(e){super(),this.value=e}toString(){return`&${this.value.toString()}`}serialize(e){e.serializeU32AsUleb128(254)}static load(t){return new e(r_.deserialize(t))}},rU=class e extends r_{constructor(e){if(super(),this.value=e,e<0)throw Error("Generic type parameter index cannot be negative")}toString(){return`T${this.value}`}serialize(e){e.serializeU32AsUleb128(255),e.serializeU32(this.value)}static load(t){return new e(t.deserializeU32())}},rk=class e extends r_{constructor(e){super(),this.value=e}toString(){return`vector<${this.value.toString()}>`}static u8(){return new e(new rA)}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(t){return new e(r_.deserialize(t))}},rI=class e extends r_{constructor(e){super(),this.value=e}toString(){let e="";return this.value.typeArgs.length>0&&(e=`<${this.value.typeArgs.map(e=>e.toString()).join(", ")}>`),`${this.value.address.toString()}::${this.value.moduleName.identifier}::${this.value.name.identifier}${e}`}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(t){return new e(rP.deserialize(t))}isTypeTag(e,t,i){return this.value.moduleName.identifier===t&&this.value.name.identifier===i&&this.value.address.equals(e)}isString(){return this.isTypeTag(ef.ONE,"string","String")}isOption(){return this.isTypeTag(ef.ONE,"option","Option")}isObject(){return this.isTypeTag(ef.ONE,"object","Object")}isDelegationKey(){return this.isTypeTag(ef.ONE,"permissioned_delegation","DelegationKey")}isRateLimiter(){return this.isTypeTag(ef.ONE,"rate_limiter","RateLimiter")}},rP=class e extends G{constructor(e,t,i,r){super(),this.address=e,this.moduleName=t,this.name=i,this.typeArgs=r}serialize(e){e.serialize(this.address),e.serialize(this.moduleName),e.serialize(this.name),e.serializeVector(this.typeArgs)}static deserialize(t){return new e(ef.deserialize(t),em.deserialize(t),em.deserialize(t),t.deserializeVector(r_))}};function rK(){return new rP(ef.ONE,new em("string"),new em("String"),[])}function rN(e){return new rP(ef.ONE,new em("object"),new em("Object"),[e])}var r$=class extends G{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return rF.load(e);case 2:return rB.load(e);case 3:return rR.load(e);default:throw Error(`Unknown variant index for TransactionPayload: ${t}`)}}},rF=class e extends r${constructor(e){super(),this.script=e}serialize(e){e.serializeU32AsUleb128(0),this.script.serialize(e)}static load(t){return new e(rO.deserialize(t))}},rB=class e extends r${constructor(e){super(),this.entryFunction=e}serialize(e){e.serializeU32AsUleb128(2),this.entryFunction.serialize(e)}static load(t){return new e(rD.deserialize(t))}},rR=class e extends r${constructor(e){super(),this.multiSig=e}serialize(e){e.serializeU32AsUleb128(3),this.multiSig.serialize(e)}static load(t){return new e(rL.deserialize(t))}},rD=class e{constructor(e,t,i,r){this.module_name=e,this.function_name=t,this.type_args=i,this.args=r}static build(t,i,r,n){return new e(rm.fromStr(t),new em(i),r,n)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForEntryFunction(e)})}static deserialize(t){let i=rm.deserialize(t),r=em.deserialize(t),n=t.deserializeVector(r_),s=t.deserializeUleb128AsU32(),a=[];for(let e=0;e<s;e+=1){let e=t.deserializeUleb128AsU32(),i=iR.deserialize(t,e);a.push(i)}return new e(i,r,n,a)}},rO=class e{constructor(e,t,i){this.bytecode=e,this.type_args=t,this.args=i}serialize(e){e.serializeBytes(this.bytecode),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForScriptFunction(e)})}static deserialize(t){let i=t.deserializeBytes(),r=t.deserializeVector(r_),n=t.deserializeUleb128AsU32(),s=[];for(let e=0;e<n;e+=1){let e=function(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return Q.deserialize(e);case 1:return ei.deserialize(e);case 2:return er.deserialize(e);case 3:return ef.deserialize(e);case 4:return ea.deserialize(e,Q);case 5:return Z.deserialize(e);case 6:return ee.deserialize(e);case 7:return et.deserialize(e);case 8:return en.deserialize(e);case 9:return eo.deserialize(e);default:throw Error(`Unknown variant index for ScriptTransactionArgument: ${t}`)}}(t);s.push(e)}return new e(i,r,s)}},rL=class e{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),void 0===this.transaction_payload?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(t){let i=ef.deserialize(t),r;return t.deserializeBool()&&(r=rV.deserialize(t)),new e(i,r)}},rV=class e extends G{constructor(e){super(),this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(t){return t.deserializeUleb128AsU32(),new e(rD.deserialize(t))}},rq=class e extends G{constructor(e,t,i,r,n,s,a){super(),this.sender=e,this.sequence_number=t,this.payload=i,this.max_gas_amount=r,this.gas_unit_price=n,this.expiration_timestamp_secs=s,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(t){return new e(ef.deserialize(t),t.deserializeU64(),r$.deserialize(t),t.deserializeU64(),t.deserializeU64(),t.deserializeU64(),ey.deserialize(t))}},rH=class extends G{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return rM.load(e);case 1:return rG.load(e);default:throw Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},rM=class e extends rH{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses)}static load(t){return new e(rq.deserialize(t),t.deserializeVector(ef))}},rG=class e extends rH{constructor(e,t,i){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=i}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses),this.fee_payer_address.serialize(e)}static load(t){return new e(rq.deserialize(t),t.deserializeVector(ef),ef.deserialize(t))}},rj=class extends G{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return rW.load(e);case 1:return rJ.load(e);case 2:return rY.load(e);case 3:return rX.load(e);case 4:return rZ.load(e);default:throw Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}isEd25519(){return this instanceof rW}isMultiEd25519(){return this instanceof rJ}isMultiAgent(){return this instanceof rY}isFeePayer(){return this instanceof rX}isSingleSender(){return this instanceof rZ}},rW=class e extends rj{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tA.deserialize(t),tz.deserialize(t))}},rJ=class e extends rj{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(ro.deserialize(t),ru.deserialize(t))}},rY=class e extends rj{constructor(e,t,i){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=i}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers)}static load(t){return new e(rl.deserialize(t),t.deserializeVector(ef),t.deserializeVector(rl))}},rX=class e extends rj{constructor(e,t,i,r){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=i,this.fee_payer=r}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(t){return new e(rl.deserialize(t),t.deserializeVector(ef),t.deserializeVector(rl),{address:ef.deserialize(t),authenticator:rl.deserialize(t)})}},rZ=class e extends rj{constructor(e){super(),this.sender=e}serialize(e){e.serializeU32AsUleb128(4),this.sender.serialize(e)}static load(t){return new e(rl.deserialize(t))}},rQ=class e extends G{constructor(e,t){super(),this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(t){return new e(rq.deserialize(t),rj.deserialize(t))}},r0=class e extends G{constructor(e,t){super(),this.rawTransaction=e,this.feePayerAddress=t}serialize(e){this.rawTransaction.serialize(e),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let i=rq.deserialize(t),r;return t.deserializeBool()&&(r=ef.deserialize(t)),new e(i,r)}},r2=class e extends G{constructor(e,t,i){super(),this.rawTransaction=e,this.feePayerAddress=i,this.secondarySignerAddresses=t}serialize(e){this.rawTransaction.serialize(e),e.serializeVector(this.secondarySignerAddresses),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let i=rq.deserialize(t),r=t.deserializeVector(ef),n;return t.deserializeBool()&&(n=ef.deserialize(t)),new e(i,r,n)}};function r1(e){return e.feePayerAddress?new rG(e.rawTransaction,e.secondarySignerAddresses??[],e.feePayerAddress):e.secondarySignerAddresses?new rM(e.rawTransaction,e.secondarySignerAddresses):e.rawTransaction}function r8(e,t){let i=eN.DZ.create();if(!t.startsWith("APTOS::"))throw Error(`Domain separator needs to start with 'APTOS::'.  Provided - ${t}`);i.update(t);let r=i.digest(),n=new Uint8Array(r.length+e.length);return n.set(r),n.set(e,r.length),n}function r3(e){let t=r1(e);return e.feePayerAddress?r8(t.bcsToBytes(),iu):e.secondarySignerAddresses?r8(t.bcsToBytes(),iu):r8(t.bcsToBytes(),"APTOS::RawTransaction")}var r5=class e{constructor(e){this.signingScheme=0;let{privateKey:t,address:i}=e;this.privateKey=t,this.publicKey=t.publicKey(),this.accountAddress=i?ef.from(i):this.publicKey.authKey().derivedAddress()}static generate(){return new e({privateKey:tv.generate()})}static fromDerivationPath(t){let{path:i,mnemonic:r}=t;return new e({privateKey:tv.fromDerivationPath(i,r)})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new rd(this.publicKey,this.privateKey.sign(e))}signTransactionWithAuthenticator(e){return new rd(this.publicKey,this.signTransaction(e))}sign(e){return this.privateKey.sign(e)}signTransaction(e){return this.sign(r3(e))}};function r4(e){return"object"==typeof e&&null!==e&&"getAnyPublicKey"in e&&"function"==typeof e.getAnyPublicKey}var r6=class e{constructor(e){this.signingScheme=2;let{privateKey:t,address:i}=e;this.privateKey=t,this.publicKey=new rt(t.publicKey()),this.accountAddress=i?ef.from(i):this.publicKey.authKey().derivedAddress()}getAnyPublicKey(){return this.publicKey}static generate(t={}){let{scheme:i=0}=t,r;switch(i){case 0:r=tv.generate();break;case 2:r=eR.generate();break;default:throw Error(`Unsupported signature scheme ${i}`)}return new e({privateKey:r})}static fromDerivationPath(t){let{scheme:i=0,path:r,mnemonic:n}=t,s;switch(i){case 0:s=tv.fromDerivationPath(r,n);break;case 2:s=eR.fromDerivationPath(r,n);break;default:throw Error(`Unsupported signature scheme ${i}`)}return new e({privateKey:s})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new rp(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new rp(this.publicKey,this.signTransaction(e))}sign(e){return new ri(this.privateKey.sign(e))}signTransaction(e){return this.sign(r3(e))}static fromEd25519Account(t){return new e({privateKey:t.privateKey,address:t.accountAddress})}},r9=class{static generate(e={}){let{scheme:t=0,legacy:i=!0}=e;return 0===t&&i?r5.generate():r6.generate({scheme:t})}static fromPrivateKey(e){let{privateKey:t,address:i,legacy:r=!0}=e;return t instanceof tv&&r?new r5({privateKey:t,address:i}):new r6({privateKey:t,address:i})}static fromPrivateKeyAndAddress(e){return this.fromPrivateKey(e)}static fromDerivationPath(e){let{scheme:t=0,mnemonic:i,path:r,legacy:n=!0}=e;return 0===t&&n?r5.fromDerivationPath({mnemonic:i,path:r}):r6.fromDerivationPath({scheme:t,mnemonic:i,path:r})}static authKey(e){let{publicKey:t}=e;return t.authKey()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync(e)}},r7=class e extends G{constructor(e){let t;super();let{privateKey:i,expiryDateSecs:r,blinder:n}=e;this.privateKey=i,this.publicKey=new tS(i.publicKey()),this.expiryDateSecs=r||((t=new Date(1e3*(eJ()+1209600))).setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),Math.floor(t.getTime()/1e3)),this.blinder=void 0!==n?L.fromHexInput(n).toUint8Array():(0,D.O6)(r7.BLINDER_LENGTH);let s=tl(this.publicKey.bcsToBytes(),93);s.push(BigInt(this.expiryDateSecs)),s.push(td(this.blinder));let a=tp(s);this.nonce=a.toString()}getPublicKey(){return this.publicKey}isExpired(){return Math.floor(Date.now()/1e3)>this.expiryDateSecs}serialize(e){e.serializeU32AsUleb128(this.publicKey.variant),e.serializeBytes(this.privateKey.toUint8Array()),e.serializeU64(this.expiryDateSecs),e.serializeFixedBytes(this.blinder)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;if(0===i)r=tv.deserialize(t);else throw Error(`Unknown variant index for EphemeralPublicKey: ${i}`);let n=t.deserializeU64(),s=t.deserializeFixedBytes(31);return new e({privateKey:r,expiryDateSecs:Number(n),blinder:s})}static fromBytes(t){return e.deserialize(new es(t))}static generate(t){return t?.scheme,new e({privateKey:tv.generate(),expiryDateSecs:t?.expiryDateSecs})}sign(e){if(this.isExpired())throw Error("EphemeralKeyPair has expired");return new tT(this.privateKey.sign(e))}};function ne(e){return null!=e&&"function"==typeof e.checkKeylessAccountValidity}r7.BLINDER_LENGTH=31;var nt=class e extends G{constructor(t){super(),this.signingScheme=2;let{address:i,ephemeralKeyPair:r,publicKey:n,uidKey:s,uidVal:a,aud:o,pepper:c,proof:u,proofFetchCallback:l,jwt:d,verificationKeyHash:f}=t;if(this.ephemeralKeyPair=r,this.publicKey=n,this.accountAddress=i?ef.from(i):this.publicKey.authKey().derivedAddress(),this.uidKey=s,this.uidVal=a,this.aud=o,this.jwt=d,this.emitter=new i7.Z,this.proofOrPromise=u,u instanceof om)this.proof=u;else{if(void 0===l)throw Error("Must provide callback for async proof fetch");this.emitter.on("proofFetchFinish",async e=>{await l(e),this.emitter.removeAllListeners()}),this.init(u)}let p=L.fromHexInput(c).toUint8Array();if(p.length!==e.PEPPER_LENGTH)throw Error(`Pepper length in bytes should be ${e.PEPPER_LENGTH}`);if(this.pepper=p,void 0!==f){if(32!==L.hexInputToUint8Array(f).length)throw Error("verificationKeyHash must be 32 bytes");this.verificationKeyHash=L.hexInputToUint8Array(f)}}getAnyPublicKey(){return new rt(this.publicKey)}async init(e){try{this.proof=await e,this.emitter.emit("proofFetchFinish",{status:"Success"})}catch(e){e instanceof Error?this.emitter.emit("proofFetchFinish",{status:"Failed",error:e.toString()}):this.emitter.emit("proofFetchFinish",{status:"Failed",error:"Unknown"})}}serialize(e){if(this.accountAddress.serialize(e),e.serializeStr(this.jwt),e.serializeStr(this.uidKey),e.serializeFixedBytes(this.pepper),this.ephemeralKeyPair.serialize(e),void 0===this.proof)throw Error("Cannot serialize - proof undefined");this.proof.serialize(e),e.serializeOption(this.verificationKeyHash,32)}static partialDeserialize(e){return{address:ef.deserialize(e),jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:r7.deserialize(e),proof:om.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}isExpired(){return this.ephemeralKeyPair.isExpired()}signWithAuthenticator(e){let t=new ri(this.sign(e));return new rp(new rt(this.publicKey),t)}signTransactionWithAuthenticator(e){let t=new ri(this.signTransaction(e));return new rp(new rt(this.publicKey),t)}async waitForProofFetch(){this.proofOrPromise instanceof Promise&&await this.proofOrPromise}async checkKeylessAccountValidity(t){if(this.isExpired())throw e5.fromErrorType({type:0});if(await this.waitForProofFetch(),void 0===this.proof)throw e5.fromErrorType({type:2});let i=(0,i4.o)(this.jwt,{header:!0});if(void 0===i.kid)throw e5.fromErrorType({type:12,details:"checkKeylessAccountValidity failed. JWT is missing 'kid' in header. This should never happen."});if(void 0!==this.verificationKeyHash){let{verificationKey:e}=await oA({aptosConfig:t});if(L.hexInputToString(e.hash())!==L.hexInputToString(this.verificationKeyHash))throw e5.fromErrorType({type:4})}else console.warn("[Aptos SDK] The verification key hash was not set. Proof may be invalid if the verification key has rotated.");await e.fetchJWK({aptosConfig:t,publicKey:this.publicKey,kid:i.kid})}sign(e){let t,i,{expiryDateSecs:r}=this.ephemeralKeyPair;if(this.isExpired())throw e5.fromErrorType({type:0});if(void 0===this.proof)throw e5.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let n=this.ephemeralKeyPair.getPublicKey(),s=this.ephemeralKeyPair.sign(e);return new ou({jwtHeader:(i=(t=this.jwt.split(".")[0].replace(/-/g,"+").replace(/_/g,"/"))+"==".substring(0,(3-t.length%3)%3),(0,eM.Jx)(i)),ephemeralCertificate:new ol(this.proof,0),expiryDateSecs:r,ephemeralPublicKey:n,ephemeralSignature:s})}signTransaction(e){if(void 0===this.proof)throw e5.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let t=new nr(r1(e),this.proof.proof).hash();return this.sign(t)}getSigningMessage(e){if(void 0===this.proof)throw e5.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});return new nr(r1(e),this.proof.proof).hash()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e})}static async fetchJWK(e){return oo(e)}};nt.PEPPER_LENGTH=31;var ni=nt,nr=class extends G{constructor(e,t){super(),this.domainSeparator="APTOS::TransactionAndProof",this.transaction=e,this.proof=t}serialize(e){e.serializeFixedBytes(this.transaction.bcsToBytes()),e.serializeOption(this.proof)}hash(){return r8(this.bcsToBytes(),this.domainSeparator)}},nn=class e extends ni{constructor(e){let t=on.create(e);super({publicKey:t,...e}),this.publicKey=t}serialize(e){super.serialize(e)}static deserialize(t){let{address:i,proof:r,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=ni.partialDeserialize(t),{iss:u,aud:l,uidVal:d}=ob({jwt:s,uidKey:a});return new e({address:i,proof:r,ephemeralKeyPair:n,iss:u,uidKey:a,uidVal:d,aud:l,pepper:o,jwt:s,verificationKeyHash:c})}static fromBytes(t){return e.deserialize(new es(L.hexInputToUint8Array(t)))}static create(t){let{address:i,proof:r,jwt:n,ephemeralKeyPair:s,pepper:a,uidKey:o="sub",proofFetchCallback:c,verificationKey:u}=t,{iss:l,aud:d,uidVal:f}=ob({jwt:n,uidKey:o});return new e({address:i,proof:r,ephemeralKeyPair:s,iss:l,uidKey:o,uidVal:f,aud:d,pepper:a,jwt:n,proofFetchCallback:c,verificationKeyHash:u?u.hash():void 0})}},ns=class e extends ni{constructor(e){let t=re.create(e);super({publicKey:t,...e}),this.publicKey=t,this.audless=e.audless??!1}serialize(e){super.serialize(e),this.publicKey.jwkAddress.serialize(e)}static deserialize(t){let{address:i,proof:r,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=ni.partialDeserialize(t),u=ef.deserialize(t),{iss:l,aud:d,uidVal:f}=ob({jwt:s,uidKey:a});return new e({address:i,proof:r,ephemeralKeyPair:n,iss:l,uidKey:a,uidVal:f,aud:d,pepper:o,jwt:s,verificationKeyHash:c,jwkAddress:u})}static fromBytes(t){return e.deserialize(es.fromHex(t))}static create(t){let{address:i,proof:r,jwt:n,ephemeralKeyPair:s,pepper:a,jwkAddress:o,uidKey:c="sub",proofFetchCallback:u,verificationKey:l}=t,{iss:d,aud:f,uidVal:p}=ob({jwt:n,uidKey:c});return new e({address:i,proof:r,ephemeralKeyPair:s,iss:d,uidKey:c,uidVal:p,aud:f,pepper:a,jwkAddress:ef.from(o),jwt:n,proofFetchCallback:u,verificationKeyHash:l?l.hash():void 0})}},na=class e{constructor(e){this.signingScheme=3;let{multiKey:t,address:i}=e,r=e.signers.map(e=>e instanceof r5?r6.fromEd25519Account(e):e);if(t.signaturesRequired>r.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${t.signaturesRequired} signers, but only ${r.length} provided`);if(t.signaturesRequired<r.length)throw Error(`More signers provided than required. Need ${t.signaturesRequired} signers, but ${r.length} provided`);this.publicKey=t,this.accountAddress=i?ef.from(i):this.publicKey.authKey().derivedAddress();let n=[];for(let e of r)n.push(this.publicKey.getIndex(e.getAnyPublicKey()));let s=r.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndicies=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}static fromPublicKeysAndSigners(t){let{address:i,publicKeys:r,signaturesRequired:n,signers:s}=t;return new e({multiKey:new rn({publicKeys:r,signaturesRequired:n}),signers:s,address:i})}static isMultiKeySigner(t){return t instanceof e}signWithAuthenticator(e){return new rh(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new rh(this.publicKey,this.signTransaction(e))}async waitForProofFetch(){let e=this.signers.filter(e=>e instanceof ni).map(async e=>e.waitForProofFetch());await Promise.all(e)}async checkKeylessAccountValidity(e){let t=this.signers.filter(e=>e instanceof ni).map(t=>t.checkKeylessAccountValidity(e));await Promise.all(t)}sign(e){let t=[];for(let i of this.signers)t.push(i.sign(e));return new ra({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){let t=[];for(let i of this.signers)t.push(i.signTransaction(e));return new ra({signatures:t,bitmap:this.signaturesBitmap})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return await this.publicKey.verifySignatureAsync(e)}},no=class{constructor(e){this.signingScheme=1;let{signers:t,publicKey:i,address:r}=e;if(this.publicKey=i,this.accountAddress=r?ef.from(r):this.publicKey.authKey().derivedAddress(),i.threshold>t.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${i.threshold} signers, but only ${t.length} provided`);if(i.threshold<t.length)throw Error(`More signers provided than required. Need ${i.threshold} signers, but ${t.length} provided`);let n=[];for(let e of t)n.push(this.publicKey.getIndex(e.publicKey()));let s=t.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndices=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new rf(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new rf(this.publicKey,this.signTransaction(e))}sign(e){let t=[];for(let i of this.signers)t.push(i.sign(e));return new ru({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){return this.sign(r3(e))}};function nc(e,t){if(t.serializeStr(e.jwt),t.serializeStr(e.uidKey),t.serializeFixedBytes(e.pepper),e.ephemeralKeyPair.serialize(t),void 0===e.proof)throw Error("Cannot serialize - proof undefined");e.proof.serialize(t),t.serializeOption(e.verificationKeyHash,32)}function nu(e){return{jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:r7.deserialize(e),proof:om.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}(e=>{function t(e){let i=new j;switch(i.serializeU32AsUleb128(e.signingScheme),e.accountAddress.serialize(i),e.signingScheme){case 0:return e.privateKey.serialize(i),i.toUint8Array();case 2:{if(!r4(e))throw Error("Account is not a SingleKeySigner");let t=e.getAnyPublicKey();switch(i.serializeU32AsUleb128(t.variant),t.variant){case 3:return nc(e,i),i.toUint8Array();case 4:return nc(e,i),e.publicKey.jwkAddress.serialize(i),i.serializeBool(e.audless),i.toUint8Array();case 1:case 0:return e.privateKey.serialize(i),i.toUint8Array();default:throw Error(`Invalid public key variant: ${t.variant}`)}}case 3:return e.publicKey.serialize(i),i.serializeU32AsUleb128(e.signers.length),e.signers.forEach(e=>{i.serializeFixedBytes(t(e))}),i.toUint8Array();default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${e.signingScheme}`)}}function i(e){let{address:t,signingScheme:r}=function(e){let t=e.deserializeUleb128AsU32();if(!Object.values(i8).includes(t))throw Error(`Deserialization of Account failed: SigningScheme variant ${t} is invalid`);return{address:ef.deserialize(e),signingScheme:t}}(e);switch(r){case 0:return new r5({privateKey:tv.deserialize(e),address:t});case 2:{let i=e.deserializeUleb128AsU32();switch(i){case 0:return new r6({privateKey:tv.deserialize(e),address:t});case 1:return new r6({privateKey:eR.deserialize(e),address:t});case 3:{let t=nu(e),i=ob(t);return new nn({...t,...i})}case 4:{let t=nu(e),i=ef.deserialize(e),r=e.deserializeBool(),n=ob(t);return new ns({...t,...n,jwkAddress:i,audless:r})}default:throw Error(`Unsupported public key variant ${i}`)}}case 3:{let r=rn.deserialize(e),n=e.deserializeUleb128AsU32(),s=[];for(let t=0;t<n;t+=1){let t=i(e);if(!r4(t)&&!(t instanceof r5))throw Error("Deserialization of MultiKeyAccount failed. Signer is not a SingleKeySigner or Ed25519Account");s.push(t)}return new na({multiKey:r,signers:s,address:t})}default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${r}`)}}function r(e){return i(es.fromHex(e))}e.toBytes=t,e.toHexStringWithoutPrefix=function(e){return L.hexInputToStringWithoutPrefix(t(e))},e.toHexString=function(e){return L.hexInputToString(t(e))},e.deserialize=i,e.keylessAccountFromHex=function(e){let t=r(e);if(!(t instanceof nn))throw Error("Deserialization of KeylessAccount failed");return t},e.federatedKeylessAccountFromHex=function(e){let t=r(e);if(!(t instanceof ns))throw Error("Deserialization of FederatedKeylessAccount failed");return t},e.multiKeyAccountFromHex=function(e){let t=r(e);if(!(t instanceof na))throw Error("Deserialization of MultiKeyAccount failed");return t},e.singleKeyAccountFromHex=function(e){let t=r(e);if(!(t instanceof r6))throw Error("Deserialization of SingleKeyAccount failed");return t},e.ed25519AccountFromHex=function(e){let t=r(e);if(!(t instanceof r5))throw Error("Deserialization of Ed25519Account failed");return t},e.fromHex=r,e.fromBytes=function(e){return r(e)}})(B||(B={}));function nl(e){return!!e.match(/^[_a-zA-Z0-9]+$/)}function nd(e){return!!e.match(/\s/)}var nf=((K=nf||{}).InvalidTypeTag="unknown type",K.UnexpectedGenericType="unexpected generic type",K.UnexpectedTypeArgumentClose="unexpected '>'",K.UnexpectedWhitespaceCharacter="unexpected whitespace character",K.UnexpectedComma="unexpected ','",K.TypeArgumentCountMismatch="type argument count doesn't match expected amount",K.MissingTypeArgumentClose="no matching '>' for '<'",K.MissingTypeArgument="no type argument before ','",K.UnexpectedPrimitiveTypeArguments="primitive types not expected to have type arguments",K.UnexpectedVectorTypeArgumentCount="vector type expected to have exactly one type argument",K.UnexpectedStructFormat="unexpected struct format, must be of the form 0xaddress::module_name::struct_name",K.InvalidModuleNameCharacter="module name must only contain alphanumeric or '_' characters",K.InvalidStructNameCharacter="struct name must only contain alphanumeric or '_' characters",K.InvalidAddress="struct address must be valid",K),np=class extends Error{constructor(e,t){super(`Failed to parse typeTag '${e}', ${t}`)}};function nh(e,t){let i=t?.allowGenerics??!1,r=[],n=[],s=[],a=0,o="",c=1;for(;a<e.length;){let t=e[a];if("<"===t)r.push({savedExpectedTypes:c,savedStr:o,savedTypes:s}),o="",s=[],c=1;else if(">"===t){if(""!==o){let e=ng(o,n,i);s.push(e)}let t=r.pop();if(void 0===t)throw new np(e,"unexpected '>'");if(c!==s.length)throw new np(e,"type argument count doesn't match expected amount");let{savedStr:a,savedTypes:u,savedExpectedTypes:l}=t;n=s,s=u,o=a,c=l}else if(","===t){if(0===r.length)throw new np(e,"unexpected ','");if(0===o.length)throw new np(e,"no type argument before ','");let t=ng(o,n,i);n=[],s.push(t),o="",c+=1}else if(nd(t)){let t=!1;if(0!==o.length){let e=ng(o,n,i);n=[],s.push(e),o="",t=!0}a=function(e,t){let i=t;for(;i<e.length&&nd(e[i]);i+=1);return i}(e,a);let r=e[a];if(a<e.length&&t&&","!==r&&">"!==r)throw new np(e,"unexpected whitespace character");continue}else o+=t;a+=1}if(r.length>0)throw new np(e,"no matching '>' for '<'");switch(s.length){case 0:return ng(o,n,i);case 1:if(""===o)return s[0];throw new np(e,"unexpected ','");default:throw new np(e,"unexpected whitespace character")}}function ng(e,t,i){let r=e.trim();if(function(e){switch(e){case"signer":case"address":case"bool":case"u8":case"u16":case"u32":case"u64":case"u128":case"u256":return!0;default:return!1}}(r.toLowerCase())&&t.length>0)throw new np(e,"primitive types not expected to have type arguments");switch(r.toLowerCase()){case"signer":return new rx;case"bool":return new rw;case"address":return new rT;case"u8":return new rA;case"u16":return new rb;case"u32":return new rv;case"u64":return new rE;case"u128":return new rz;case"u256":return new rS;case"vector":if(1!==t.length)throw new np(e,"vector type expected to have exactly one type argument");return new rk(t[0]);default:let n;if(r.match(/^&.+$/))return new rC(ng(r.substring(1),t,i));if(r.match(/^T[0-9]+$/)){if(i)return new rU(Number(r.split("T")[1]));throw new np(e,"unexpected generic type")}if(!r.match(/:/))throw new np(e,"unknown type");let s=r.split("::");if(3!==s.length)throw new np(e,"unexpected struct format, must be of the form 0xaddress::module_name::struct_name");try{n=ef.fromString(s[0])}catch{throw new np(e,"struct address must be valid")}if(!nl(s[1]))throw new np(e,"module name must only contain alphanumeric or '_' characters");if(!nl(s[2]))throw new np(e,"struct name must only contain alphanumeric or '_' characters");return new rI(new rP(n,new em(s[1]),new em(s[2]),t))}}function ny(e){return"string"==typeof e}function nm(e){return"number"==typeof e?e:ny(e)&&""!==e?Number.parseInt(e,10):void 0}function n_(e){return"number"==typeof e||"bigint"==typeof e||"string"==typeof e}function nw(e){return e instanceof Z}function nA(e){return e instanceof ef}function nb(e){return e instanceof ec}function nv(e){return e instanceof Q}function nE(e){return e instanceof ee}function nz(e){return e instanceof et}function nS(e){return e instanceof ei}function nT(e){return e instanceof er}function nx(e){return e instanceof en}function nC(e,t){throw Error(`Type mismatch for argument ${t}, expected '${e}'`)}var nU=new TextEncoder;function nk(e){return e?.map(e=>ny(e)?nh(e):e)??[]}async function nI(e,t,i){return(await n8({aptosConfig:i,accountAddress:e,moduleName:t})).abi}async function nP(e,t,i,r){let n=await nI(e,t,r);if(!n)throw Error(`Could not find module ABI for '${e}::${t}'`);return n.exposed_functions.find(e=>e.name===i)}async function nK(e,t,i,r){let n,s=await nP(e,t,i,r);if(!s)throw Error(`Could not find entry function ABI for '${e}::${t}::${i}'`);if(!s.is_entry)throw Error(`'${e}::${t}::${i}' is not an entry function`);let a=(n=s.params.findIndex(e=>"signer"!==e&&"&signer"!==e))<0?s.params.length:n,o=[];for(let e=a;e<s.params.length;e+=1)o.push(nh(s.params[e],{allowGenerics:!0}));return{signers:a,typeParameters:s.generic_type_params,parameters:o}}async function nN(e,t,i,r){let n=await nP(e,t,i,r);if(!n)throw Error(`Could not find view function ABI for '${e}::${t}::${i}'`);if(!n.is_view)throw Error(`'${e}::${t}::${i}' is not an view function`);let s=[];for(let e=0;e<n.params.length;e+=1)s.push(nh(n.params[e],{allowGenerics:!0}));let a=[];for(let e=0;e<n.return.length;e+=1)a.push(nh(n.return[e],{allowGenerics:!0}));return{typeParameters:n.generic_type_params,parameters:s,returnTypes:a}}function n$(e,t,i,r,n,s){let a;if("exposed_functions"in t){let i=t.exposed_functions.find(t=>t.name===e);if(!i)throw Error(`Could not find function ABI for '${t.address}::${t.name}::${e}'`);if(r>=i.params.length)throw Error(`Too many arguments for '${e}', expected ${i.params.length}`);a=nh(i.params[r],{allowGenerics:!0})}else{if(r>=t.parameters.length)throw Error(`Too many arguments for '${e}', expected ${t.parameters.length}`);a=t.parameters[r]}return nF(i,a,r,n,"exposed_functions"in t?t:void 0,s)}function nF(e,t,i,r,n,s){return nw(e)||nv(e)||nE(e)||nz(e)||nS(e)||nT(e)||nx(e)||nA(e)||nb(e)||e instanceof iB||e instanceof ea||e instanceof eu?(function e(t,i,r){if(t.isBool()){if(nw(i))return;nC("Bool",r)}if(t.isAddress()){if(nA(i))return;nC("AccountAddress",r)}if(t.isU8()){if(nv(i))return;nC("U8",r)}if(t.isU16()){if(nE(i))return;nC("U16",r)}if(t.isU32()){if(nz(i))return;nC("U32",r)}if(t.isU64()){if(nS(i))return;nC("U64",r)}if(t.isU128()){if(nT(i))return;nC("U128",r)}if(t.isU256()){if(nx(i))return;nC("U256",r)}if(t.isVector()){if(i instanceof ea){i.values.length>0&&e(t.value,i.values[0],r);return}nC("MoveVector",r)}if(t instanceof rI){if(t.isString()){if(nb(i))return;nC("MoveString",r)}if(t.isObject()){if(nA(i))return;nC("AccountAddress",r)}if(t.isOption()){if(i instanceof eu){void 0!==i.value&&e(t.value.typeArgs[0],i.value,r);return}nC("MoveOption",r)}}throw Error(`Type mismatch for argument ${r}, expected '${t.toString()}'`)}(t,e,i),e):function(e,t,i,r,n,s){if(t.isBool()){if("boolean"==typeof e)return new Z(e);if(ny(e)){if("true"===e)return new Z(!0);if("false"===e)return new Z(!1)}nC("boolean",i)}if(t.isAddress()){if(ny(e))return ef.fromString(e);nC("string | AccountAddress",i)}if(t.isU8()){let t=nm(e);if(void 0!==t)return new Q(t);nC("number | string",i)}if(t.isU16()){let t=nm(e);if(void 0!==t)return new ee(t);nC("number | string",i)}if(t.isU32()){let t=nm(e);if(void 0!==t)return new et(t);nC("number | string",i)}if(t.isU64()){if(n_(e))return new ei(BigInt(e));nC("bigint | number | string",i)}if(t.isU128()){if(n_(e))return new er(BigInt(e));nC("bigint | number | string",i)}if(t.isU256()){if(n_(e))return new en(BigInt(e));nC("bigint | number | string",i)}if(t.isGeneric()){let s=t.value;if(s<0||s>=r.length)throw Error(`Generic argument ${t.toString()} is invalid for argument ${i}`);return nF(e,r[s],i,r,n)}if(t.isVector()){if(t.value.isU8()){if(ny(e))return ea.U8(nU.encode(e));if(e instanceof Uint8Array)return ea.U8(e);if(e instanceof ArrayBuffer)return ea.U8(new Uint8Array(e))}if(ny(e)&&e.startsWith("["))return nF(JSON.parse(e),t,i,r);if(Array.isArray(e))return new ea(e.map(e=>nF(e,t.value,i,r,n)));throw Error(`Type mismatch for argument ${i}, type '${t.toString()}'`)}if(t.isStruct()){if(t.isString()){if(ny(e))return new ec(e);nC("string",i)}if(t.isObject()){if(ny(e))return ef.fromString(e);nC("string | AccountAddress",i)}if(t.isDelegationKey()||t.isRateLimiter()){if(e instanceof Uint8Array)return new iB(e);nC("Uint8Array",i)}if(t.isOption())return null==e?(t.value.typeArgs[0],new eu(null)):new eu(nF(e,t.value.typeArgs[0],i,r,n));if(n?.structs.find(e=>e.name===t.value.name.identifier)?.fields.length===0&&e instanceof Uint8Array)return new iB(e);if(e instanceof Uint8Array&&s?.allowUnknownStructs)return console.warn(`Unsupported struct input type for argument ${i}. Continuing since 'allowUnknownStructs' is enabled.`),new iB(e);throw Error(`Unsupported struct input type for argument ${i}, type '${t.toString()}'`)}throw Error(`Type mismatch for argument ${i}, type '${t.toString()}'`)}(e,t,i,r,n,s)}async function nB(e){if("bytecode"in e)return new rF(new rO(L.fromHexInput(e.bytecode).toUint8Array(),nk(e.typeArguments),e.functionArguments));let{moduleAddress:t,moduleName:i,functionName:r}=eQ(e.function),n=await nV({key:"entry-function",moduleAddress:t,moduleName:i,functionName:r,aptosConfig:e.aptosConfig,abi:e.abi,fetch:nK});return function(e){let t=e.abi,{moduleAddress:i,moduleName:r,functionName:n}=eQ(e.function),s=nk(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=e.functionArguments.map((i,r)=>n$(e.function,t,i,r,s));if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${i}::${r}::${n}', expected ${t.parameters.length} but got ${a.length}`);let o=rD.build(`${i}::${r}`,n,s,a);return"multisigAddress"in e?new rR(new rL(ef.from(e.multisigAddress),new rV(o))):new rB(o)}({...e,abi:n})}async function nR(e){let{moduleAddress:t,moduleName:i,functionName:r}=eQ(e.function);return function(e){let t=e.abi,{moduleAddress:i,moduleName:r,functionName:n}=eQ(e.function),s=nk(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=e?.functionArguments?.map((i,r)=>n$(e.function,t,i,r,s))??[];if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${i}::${r}::${n}', expected ${t.parameters.length} but got ${a.length}`);return rD.build(`${i}::${r}`,n,s,a)}({abi:await nV({key:"view-function",moduleAddress:t,moduleName:i,functionName:r,aptosConfig:e.aptosConfig,abi:e.abi,fetch:nN}),...e})}async function nD(e){let{aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s}=e,a=async()=>iN[t.network]?{chainId:iN[t.network]}:{chainId:(await t6({aptosConfig:t})).chain_id},o=async()=>n?.gasUnitPrice?{gasEstimate:n.gasUnitPrice}:{gasEstimate:(await ih({aptosConfig:t})).gas_estimate},c=async()=>{let e=async()=>n?.accountSequenceNumber!==void 0?n.accountSequenceNumber:(await tn({aptosConfig:t,accountAddress:i})).sequence_number;if(!(s&&ef.from(s).equals(ef.ZERO)))return e();try{return await e()}catch{return 0}},[{chainId:u},{gasEstimate:l},d]=await Promise.all([a(),o(),c()]),{maxGasAmount:f,gasUnitPrice:p,expireTimestamp:h}={maxGasAmount:n?.maxGasAmount?BigInt(n.maxGasAmount):BigInt(2e5),gasUnitPrice:n?.gasUnitPrice??BigInt(l),expireTimestamp:n?.expireTimestamp??BigInt(Math.floor(Date.now()/1e3)+20)};return new rq(ef.from(i),BigInt(d),r,BigInt(f),BigInt(p),BigInt(h),new ey(u))}async function nO(e){let{aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s}=e,a=await nD({aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s});return"secondarySignerAddresses"in e?new r2(a,e.secondarySignerAddresses?.map(e=>ef.from(e))??[],e.feePayerAddress?ef.from(e.feePayerAddress):void 0):new r0(a,e.feePayerAddress?ef.from(e.feePayerAddress):void 0)}function nL(e){if(!e)return new rg;let t=on.isInstance(e)||re.isInstance(e)||eB.isInstance(e)?new rt(e):e,i=new tz(new Uint8Array(64));if(tA.isInstance(t))return new rd(t,i);if(rt.isInstance(t))return on.isInstance(t.publicKey)?new rp(t,new ri(ou.getSimulationSignature())):new rp(t,new ri(i));if(rn.isInstance(t))return new rh(t,new ra({signatures:t.publicKeys.map(e=>new ri(on.isInstance(e.publicKey)||re.isInstance(e.publicKey)?ou.getSimulationSignature():i)),bitmap:t.createBitmap({bits:Array(t.publicKeys.length).fill(0).map((e,t)=>t)})}));throw Error("Unsupported PublicKey used for simulations")}async function nV({key:e,moduleAddress:t,moduleName:i,functionName:r,aptosConfig:n,abi:s,fetch:a}){return void 0!==s?s:eV(async()=>a(t,i,r,n),`${e}-${n.network}-${t}-${i}-${r}`,3e5)()}async function nq(e){let t=await nH(e);return nM(e,t)}async function nH(e){let{aptosConfig:t,data:i}=e,r,n;return"bytecode"in i?n=await nB(i):(r="multisigAddress"in i?{aptosConfig:t,multisigAddress:i.multisigAddress,function:i.function,functionArguments:i.functionArguments,typeArguments:i.typeArguments,abi:i.abi}:{aptosConfig:t,function:i.function,functionArguments:i.functionArguments,typeArguments:i.typeArguments,abi:i.abi},n=await nB(r)),n}async function nM(e,t){let{aptosConfig:i,sender:r,options:n}=e,s;if(!0===e.withFeePayer&&(s=ef.ZERO.toString()),"secondarySignerAddresses"in e){let{secondarySignerAddresses:a}=e;return nO({aptosConfig:i,sender:r,payload:t,options:n,secondarySignerAddresses:a,feePayerAddress:s})}return nO({aptosConfig:i,sender:r,payload:t,options:n,feePayerAddress:s})}function nG(e){let{signer:t,transaction:i}=e;return t.signTransactionWithAuthenticator(i)}function nj(e){let{signer:t,transaction:i}=e;if(!i.feePayerAddress)throw Error(`Transaction ${i} is not a Fee Payer transaction`);return i.feePayerAddress=t.accountAddress,nG({signer:t,transaction:i})}async function nW(e){let{aptosConfig:t,transaction:i,signerPublicKey:r,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}=e,o=function(e){let t,{signerPublicKey:i,transaction:r,secondarySignersPublicKeys:n,feePayerPublicKey:s}=e,a=nL(i);if(r.feePayerAddress){let e=new rG(r.rawTransaction,r.secondarySignerAddresses??[],r.feePayerAddress),t=[];r.secondarySignerAddresses&&(t=n?n.map(e=>nL(e)):Array.from({length:r.secondarySignerAddresses.length},()=>nL(void 0)));let i=nL(s),o=new rX(a,r.secondarySignerAddresses??[],t,{address:r.feePayerAddress,authenticator:i});return new rQ(e.raw_txn,o).bcsToBytes()}if(r.secondarySignerAddresses){let e=new rM(r.rawTransaction,r.secondarySignerAddresses),t=[];t=n?n.map(e=>nL(e)):Array.from({length:r.secondarySignerAddresses.length},()=>nL(void 0));let i=new rY(a,r.secondarySignerAddresses,t);return new rQ(e.raw_txn,i).bcsToBytes()}if(a instanceof rd)t=new rW(a.public_key,a.signature);else if(a instanceof rp||a instanceof rh)t=new rZ(a);else if(a instanceof rg)t=new rZ(a);else throw Error("Invalid public key");return new rQ(r.rawTransaction,t).bcsToBytes()}({transaction:i,signerPublicKey:r,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}),{data:c}=await t1({aptosConfig:t,body:o,path:"transactions/simulate",params:{estimate_gas_unit_price:e.options?.estimateGasUnitPrice??!1,estimate_max_gas_amount:e.options?.estimateMaxGasAmount??!1,estimate_prioritized_gas_unit_price:e.options?.estimatePrioritizedGasUnitPrice??!1},originMethod:"simulateTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return c}async function nJ(e){let{aptosConfig:t}=e,i=function(e){let t;let{transaction:i,feePayerAuthenticator:r,additionalSignersAuthenticators:n}=e,s=(t=new es(e.senderAuthenticator.bcsToBytes()),rl.deserialize(t)),a;if(i.feePayerAddress){if(!r)throw Error("Must provide a feePayerAuthenticator argument to generate a signed fee payer transaction");a=new rX(s,i.secondarySignerAddresses??[],n??[],{address:i.feePayerAddress,authenticator:r})}else if(i.secondarySignerAddresses){if(!n)throw Error("Must provide a additionalSignersAuthenticators argument to generate a signed multi agent transaction");a=new rY(s,i.secondarySignerAddresses,n)}else a=s instanceof rd?new rW(s.public_key,s.signature):s instanceof rf?new rJ(s.public_key,s.signature):new rZ(s);return new rQ(i.rawTransaction,a).bcsToBytes()}({...e});try{let{data:e}=await t1({aptosConfig:t,body:i,path:"transactions",originMethod:"submitTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return e}catch(r){let e=rQ.deserialize(new es(i));throw e.authenticator.isSingleSender()&&e.authenticator.sender.isSingleKey()&&(e.authenticator.sender.public_key.publicKey instanceof on||e.authenticator.sender.public_key.publicKey instanceof re)&&await ni.fetchJWK({aptosConfig:t,publicKey:e.authenticator.sender.public_key.publicKey,kid:e.authenticator.sender.signature.signature.getJwkKid()}),r}}async function nY(e){let{aptosConfig:t,signer:i,feePayer:r,transaction:n}=e;ne(i)&&await i.checkKeylessAccountValidity(t),ne(r)&&await r.checkKeylessAccountValidity(t);let s=e.feePayerAuthenticator||r&&nj({signer:r,transaction:n}),a=nG({signer:i,transaction:n});return nJ({aptosConfig:t,transaction:n,senderAuthenticator:a,feePayerAuthenticator:s})}async function nX(e){let{aptosConfig:t,senderAuthenticator:i,feePayer:r,transaction:n}=e;ne(r)&&await r.checkKeylessAccountValidity(t);let s=nj({signer:r,transaction:n});return nJ({aptosConfig:t,transaction:n,senderAuthenticator:i,feePayerAuthenticator:s})}!function(e){let t=eN.DZ.create();for(let i of e)t.update(i);t.digest()}(["APTOS::Transaction"]);var nZ={typeParameters:[],parameters:[rk.u8(),new rk(rk.u8())]};async function nQ(e){let{aptosConfig:t,account:i,metadataBytes:r,moduleBytecode:n,options:s}=e,a=n.map(e=>ea.U8(e));return nq({aptosConfig:t,sender:ef.from(i),data:{function:"0x1::code::publish_package_txn",functionArguments:[ea.U8(r),new ea(a)],abi:nZ},options:s})}async function n0(e){return tn(e)}async function n2(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return ti({aptosConfig:t,originMethod:"getModules",path:`accounts/${ef.from(i).toString()}/modules`,params:{ledger_version:r?.ledgerVersion,limit:r?.limit??1e3}})}async function n1(e){let{aptosConfig:t,accountAddress:i,options:r}=e,{response:n,cursor:s}=await tr({aptosConfig:t,originMethod:"getModulesPage",path:`accounts/${ef.from(i).toString()}/modules`,params:{ledger_version:r?.ledgerVersion,cursor:r?.cursor,limit:r?.limit??100}});return{modules:n.data,cursor:s}}async function n8(e){return ts(e)}async function n3(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return tt({aptosConfig:t,originMethod:"getTransactions",path:`accounts/${ef.from(i).toString()}/transactions`,params:{start:r?.offset,limit:r?.limit}})}async function n5(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return ti({aptosConfig:t,originMethod:"getResources",path:`accounts/${ef.from(i).toString()}/resources`,params:{ledger_version:r?.ledgerVersion,limit:r?.limit??999}})}async function n4(e){let{aptosConfig:t,accountAddress:i,options:r}=e,{response:n,cursor:s}=await tr({aptosConfig:t,originMethod:"getResourcesPage",path:`accounts/${ef.from(i).toString()}/resources`,params:{ledger_version:r?.ledgerVersion,cursor:r?.cursor,limit:r?.limit??100}});return{resources:n.data,cursor:s}}async function n6(e){let{aptosConfig:t,accountAddress:i,resourceType:r,options:n}=e,{data:s}=await te({aptosConfig:t,originMethod:"getResource",path:`accounts/${ef.from(i).toString()}/resource/${r}`,params:{ledger_version:n?.ledgerVersion}});return s.data}async function n9(e){let{aptosConfig:t,authenticationKey:i,options:r}=e,{address_map:{handle:n}}=await n6({aptosConfig:t,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:r}),s=ef.from(i);try{let e=await ir({aptosConfig:t,handle:n,data:{key:s.toString(),key_type:"address",value_type:"address"},options:r});return ef.from(e)}catch(e){if(e instanceof e4&&"table_item_not_found"===e.data.error_code)return s;throw e}}async function n7(e){let{aptosConfig:t,accountAddress:i}=e,r={owner_address:{_eq:ef.from(i).toStringLong()},amount:{_gt:0}},n=await t7({aptosConfig:t,query:{query:tB,variables:{where_condition:r}},originMethod:"getAccountTokensCount"});return n.current_token_ownerships_v2_aggregate.aggregate?n.current_token_ownerships_v2_aggregate.aggregate.count:0}async function se(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={owner_address:{_eq:ef.from(i).toStringLong()},amount:{_gt:0}};r?.tokenStandard&&(n.token_standard={_eq:r?.tokenStandard});let s={query:t$,variables:{where_condition:n,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function st(e){let{aptosConfig:t,accountAddress:i,collectionAddress:r,options:n}=e,s={owner_address:{_eq:ef.from(i).toStringLong()},current_token_data:{collection_id:{_eq:ef.from(r).toStringLong()}},amount:{_gt:0}};n?.tokenStandard&&(s.token_standard={_eq:n?.tokenStandard});let a={query:tF,variables:{where_condition:s,offset:n?.offset,limit:n?.limit,order_by:n?.orderBy}};return(await t7({aptosConfig:t,query:a,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function si(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={owner_address:{_eq:ef.from(i).toStringLong()}};r?.tokenStandard&&(n.current_collection={token_standard:{_eq:r?.tokenStandard}});let s={query:tN,variables:{where_condition:n,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function sr(e){let{aptosConfig:t,accountAddress:i}=e,r=ef.from(i).toStringLong(),n=await t7({aptosConfig:t,query:{query:tR,variables:{address:r}},originMethod:"getAccountTransactionsCount"});return n.account_transactions_aggregate.aggregate?n.account_transactions_aggregate.aggregate.count:0}async function sn(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n=ef.from(i).toStringLong(),s={query:tK,variables:{where_condition:{...r?.where,owner_address:{_eq:n}},offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountCoinsData"})).current_fungible_asset_balances}async function ss(e){let{aptosConfig:t,accountAddress:i}=e,r=ef.from(i).toStringLong(),n=await t7({aptosConfig:t,query:{query:tP,variables:{address:r}},originMethod:"getAccountCoinsCount"});if(!n.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return n.current_fungible_asset_balances_aggregate.aggregate.count}async function sa(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={query:tW,variables:{where_condition:{owner_address:{_eq:ef.from(i).toStringLong()}},offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getAccountOwnedObjects"})).current_objects}async function so(e){let{aptosConfig:t,privateKey:i}=e,r=new rt(i.publicKey());if(i instanceof eR){let e=tg.fromPublicKey({publicKey:r}).derivedAddress();return r9.fromPrivateKey({privateKey:i,address:e})}if(i instanceof tv){let e=tg.fromPublicKey({publicKey:r.publicKey});if(await sc({authKey:e,aptosConfig:t})){let t=e.derivedAddress();return r9.fromPrivateKey({privateKey:i,address:t,legacy:!0})}let n=tg.fromPublicKey({publicKey:r});if(await sc({authKey:n,aptosConfig:t})){let e=n.derivedAddress();return r9.fromPrivateKey({privateKey:i,address:e,legacy:!1})}}throw Error(`Can't derive account from private key ${i}`)}async function sc(e){let{aptosConfig:t,authKey:i}=e,r=await n9({aptosConfig:t,authenticationKey:i.derivedAddress()});try{return await n0({aptosConfig:t,accountAddress:r}),!0}catch(e){if(404===e.status)return!1;throw Error(`Error while looking for an account info ${r.toString()}`)}}var su={typeParameters:[],parameters:[new rA,rk.u8(),new rA,rk.u8(),rk.u8(),rk.u8()]};async function sl(e){let t,{aptosConfig:i,fromAccount:r,dangerouslySkipVerification:n}=e;if("toNewPrivateKey"in e)return sd({aptosConfig:i,fromAccount:r,toNewPrivateKey:e.toNewPrivateKey});if("toAccount"in e){if(e.toAccount instanceof r5)return sd({aptosConfig:i,fromAccount:r,toNewPrivateKey:e.toAccount.privateKey});if(e.toAccount instanceof no)return sd({aptosConfig:i,fromAccount:r,toAccount:e.toAccount});t=e.toAccount.publicKey.authKey()}else if("toAuthKey"in e)t=e.toAuthKey;else throw Error("Invalid arguments");let s=await sp({aptosConfig:i,fromAccount:r,toAuthKey:t});if(!0===n)return s;let a=await iw({aptosConfig:i,transactionHash:s.hash});if(!a.success)throw Error(`Failed to rotate authentication key - ${a}`);let o=await nq({aptosConfig:i,sender:r.accountAddress,data:{function:"0x1::account::set_originating_address",functionArguments:[]}});return nY({aptosConfig:i,signer:e.toAccount,transaction:o})}async function sd(e){let{aptosConfig:t,fromAccount:i}=e,r=await n0({aptosConfig:t,accountAddress:i.accountAddress}),n;n="toNewPrivateKey"in e?r9.fromPrivateKey({privateKey:e.toNewPrivateKey,legacy:!0}):e.toAccount;let s=new ep({sequenceNumber:BigInt(r.sequence_number),originator:i.accountAddress,currentAuthKey:ef.from(r.authentication_key),newPublicKey:n.publicKey}).bcsToBytes(),a=i.sign(s),o=n.sign(s),c=await nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::account::rotate_authentication_key",functionArguments:[new Q(i.signingScheme),ea.U8(i.publicKey.toUint8Array()),new Q(n.signingScheme),ea.U8(n.publicKey.toUint8Array()),ea.U8(a.toUint8Array()),ea.U8(o.toUint8Array())],abi:su}});return nY({aptosConfig:t,signer:i,transaction:c})}var sf={typeParameters:[],parameters:[rk.u8()]};async function sp(e){let{aptosConfig:t,fromAccount:i,toAuthKey:r}=e,n=await nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::account::rotate_authentication_key_call",functionArguments:[ea.U8(r.toUint8Array())],abi:sf}});return nY({aptosConfig:t,signer:i,transaction:n})}async function sh(e){let{aptosConfig:t,payload:i,options:r}=e,n=await nR({...i,aptosConfig:t}),s=new j;n.serialize(s);let a=s.toUint8Array(),{data:o}=await t1({aptosConfig:t,path:"view",originMethod:"view",contentType:"application/x.aptos.view_function+bcs",params:{ledger_version:r?.ledgerVersion},body:a});return o}async function sg(e){let{aptosConfig:t,payload:i,options:r}=e,{data:n}=await t1({aptosConfig:t,originMethod:"viewJson",path:"view",params:{ledger_version:r?.ledgerVersion},body:{function:i.function,type_arguments:i.typeArguments??[],arguments:i.functionArguments??[]}});return n}async function sy(e){let{aptosConfig:t,sender:i,authenticationFunction:r,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=eQ(r);return nq({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::add_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new rT,new rI(rK()),new rI(rK())]}},options:n})}async function sm(e){let{aptosConfig:t,sender:i,authenticationFunction:r,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=eQ(r);return nq({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::remove_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new rT,new rI(rK()),new rI(rK())]}},options:n})}async function s_(e){let{aptosConfig:t,sender:i,options:r}=e;return nq({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::remove_authenticator",typeArguments:[],functionArguments:[],abi:{typeParameters:[],parameters:[]}},options:r})}var sw=class{constructor(e){this.config=e,this.isAccountAbstractionEnabled=async e=>{let t=await this.getAuthenticationFunction(e),{moduleAddress:i,moduleName:r,functionName:n}=eQ(e.authenticationFunction);return t?.some(e=>ef.fromString(i).equals(e.moduleAddress)&&r===e.moduleName&&n===e.functionName)??!1},this.enableAccountAbstractionTransaction=this.addAuthenticationFunctionTransaction,this.disableAccountAbstractionTransaction=async e=>{let{accountAddress:t,authenticationFunction:i,options:r}=e;return i?this.removeAuthenticationFunctionTransaction({accountAddress:t,authenticationFunction:i,options:r}):this.removeDispatchableAuthenticatorTransaction({accountAddress:t,options:r})}}async addAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:i,options:r}=e;return sy({aptosConfig:this.config,authenticationFunction:i,sender:t,options:r})}async removeAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:i,options:r}=e;return sm({aptosConfig:this.config,sender:t,authenticationFunction:i,options:r})}async removeDispatchableAuthenticatorTransaction(e){let{accountAddress:t,options:i}=e;return s_({aptosConfig:this.config,sender:t,options:i})}async getAuthenticationFunction(e){let{accountAddress:t}=e,[{vec:i}]=await sh({aptosConfig:this.config,payload:{function:"0x1::account_abstraction::dispatchable_authenticator",functionArguments:[ef.from(t)],abi:{typeParameters:[],parameters:[new rT],returnTypes:[]}}});if(0!==i.length)return i[0].map(e=>({moduleAddress:ef.fromString(e.module_address),moduleName:e.module_name,functionName:e.function_name}))}},sA=class{constructor(e){this.config=e,this.abstraction=new sw(e)}async getAccountInfo(e){return n0({aptosConfig:this.config,...e})}async getAccountModules(e){return n2({aptosConfig:this.config,...e})}async getAccountModulesPage(e){return n1({aptosConfig:this.config,...e})}async getAccountModule(e){return n8({aptosConfig:this.config,...e})}async getAccountTransactions(e){return n3({aptosConfig:this.config,...e})}async getAccountResources(e){return n5({aptosConfig:this.config,...e})}async getAccountResourcesPage(e){return n4({aptosConfig:this.config,...e})}async getAccountResource(e){return n6({aptosConfig:this.config,...e})}async lookupOriginalAccountAddress(e){return n9({aptosConfig:this.config,...e})}async getAccountTokensCount(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),n7({aptosConfig:this.config,...e})}async getAccountOwnedTokens(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),se({aptosConfig:this.config,...e})}async getAccountOwnedTokensFromCollectionAddress(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),st({aptosConfig:this.config,...e})}async getAccountCollectionsWithOwnedTokens(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),si({aptosConfig:this.config,...e})}async getAccountTransactionsCount(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),sr({aptosConfig:this.config,...e})}async getAccountCoinsData(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),sn({aptosConfig:this.config,...e})}async getAccountCoinsCount(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),ss({aptosConfig:this.config,...e})}async getAccountAPTAmount(e){return this.getAccountCoinAmount({coinType:ic,faMetadataAddress:"0x000000000000000000000000000000000000000000000000000000000000000a",...e})}async getAccountCoinAmount(e){let t,{accountAddress:i,coinType:r,faMetadataAddress:n,minimumLedgerVersion:s}=e;s&&console.warn(`minimumLedgerVersion is not used anymore, here for backward 
        compatibility see https://github.com/aptos-labs/aptos-ts-sdk/pull/519, 
        will be removed in the near future`);let a=r;if(void 0===r&&void 0!==n&&(a=await eV(async()=>{try{let e=(await sh({aptosConfig:this.config,payload:{function:"0x1::coin::paired_coin",functionArguments:[n]}})).at(0);if(e.vec.length>0&&eZ(e.vec[0]))return eX(e.vec[0])}catch{}},`coin-mapping-${n.toString()}`,3e5)()),void 0!==r&&void 0!==n)t=ef.from(n).toStringLong();else if(void 0!==r&&void 0===n)t=r===ic?ef.A.toStringLong():eH(ef.A,r).toStringLong();else if(void 0===r&&void 0!==n){let e=ef.from(n);t=e.toStringLong(),e===ef.A&&(a=ic)}else throw Error("Either coinType, faMetadataAddress, or both must be provided");if(void 0!==a){let[e]=await sh({aptosConfig:this.config,payload:{function:"0x1::coin::balance",typeArguments:[a],functionArguments:[i]}});return parseInt(e,10)}let[o]=await sh({aptosConfig:this.config,payload:{function:"0x1::primary_fungible_store::balance",typeArguments:["0x1::object::ObjectCore"],functionArguments:[i,t]}});return parseInt(o,10)}async getAccountOwnedObjects(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),sa({aptosConfig:this.config,...e})}async deriveAccountFromPrivateKey(e){return so({aptosConfig:this.config,...e})}},sb={typeParameters:[{constraints:[]}],parameters:[new rT,new rE]};async function sv(e){let{aptosConfig:t,sender:i,recipient:r,amount:n,coinType:s,options:a}=e;return nq({aptosConfig:t,sender:i,data:{function:"0x1::aptos_account::transfer_coins",typeArguments:[s??ic],functionArguments:[r,n],abi:sb},options:a})}var sE=class{constructor(e){this.config=e}async transferCoinTransaction(e){return sv({aptosConfig:this.config,...e})}},sz={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",STRING:"0x1::string::String",ARRAY:"vector<u8>"},sS="0x4::token::Token";async function sT(e){let{aptosConfig:t,digitalAssetAddress:i}=e,r={token_data_id:{_eq:ef.from(i).toStringLong()}};return(await t7({aptosConfig:t,query:{query:t0,variables:{where_condition:r}},originMethod:"getDigitalAssetData"})).current_token_datas_v2[0]}async function sx(e){let{aptosConfig:t,digitalAssetAddress:i}=e,r={token_data_id:{_eq:ef.from(i).toStringLong()},amount:{_gt:0}};return(await t7({aptosConfig:t,query:{query:tQ,variables:{where_condition:r}},originMethod:"getCurrentDigitalAssetOwnership"})).current_token_ownerships_v2[0]}async function sC(e){let{aptosConfig:t,ownerAddress:i,options:r}=e,n={query:tQ,variables:{where_condition:{owner_address:{_eq:ef.from(i).toStringLong()},amount:{_gt:0}},offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getOwnedDigitalAssets"})).current_token_ownerships_v2}async function sU(e){let{aptosConfig:t,digitalAssetAddress:i,options:r}=e,n={query:tZ,variables:{where_condition:{token_data_id:{_eq:ef.from(i).toStringLong()}},offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getDigitalAssetActivity"})).token_activities_v2}var sk={typeParameters:[],parameters:[new rI(rK()),new rE,new rI(rK()),new rI(rK()),new rw,new rw,new rw,new rw,new rw,new rw,new rw,new rw,new rw,new rE,new rE]};async function sI(e){let{aptosConfig:t,options:i,creator:r}=e;return nq({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::create_collection",functionArguments:[new ec(e.description),new ei(e.maxSupply??0xffffffffffffffffn),new ec(e.name),new ec(e.uri),new Z(e.mutableDescription??!0),new Z(e.mutableRoyalty??!0),new Z(e.mutableURI??!0),new Z(e.mutableTokenDescription??!0),new Z(e.mutableTokenName??!0),new Z(e.mutableTokenProperties??!0),new Z(e.mutableTokenURI??!0),new Z(e.tokensBurnableByCreator??!0),new Z(e.tokensFreezableByCreator??!0),new ei(e.royaltyNumerator??0),new ei(e.royaltyDenominator??1)],abi:sk},options:i})}async function sP(e){let{aptosConfig:t,options:i}=e,r=i?.where;i?.tokenStandard&&(r.token_standard={_eq:i?.tokenStandard??"v2"});let n={query:tO,variables:{where_condition:r,offset:i?.offset,limit:i?.limit}};return(await t7({aptosConfig:t,query:n,originMethod:"getCollectionData"})).current_collections_v2[0]}async function sK(e){let{aptosConfig:t,creatorAddress:i,collectionName:r,options:n}=e,s={collection_name:{_eq:r},creator_address:{_eq:ef.from(i).toStringLong()}};return n?.tokenStandard&&(s.token_standard={_eq:n?.tokenStandard??"v2"}),sP({aptosConfig:t,options:{...n,where:s}})}async function sN(e){let{aptosConfig:t,creatorAddress:i,options:r}=e,n={creator_address:{_eq:ef.from(i).toStringLong()}};return r?.tokenStandard&&(n.token_standard={_eq:r?.tokenStandard??"v2"}),sP({aptosConfig:t,options:{...r,where:n}})}async function s$(e){let{aptosConfig:t,collectionId:i,options:r}=e,n={collection_id:{_eq:ef.from(i).toStringLong()}};return r?.tokenStandard&&(n.token_standard={_eq:r?.tokenStandard??"v2"}),sP({aptosConfig:t,options:{...r,where:n}})}async function sF(e){let{creatorAddress:t,collectionName:i,options:r,aptosConfig:n}=e,s={collection_name:{_eq:i},creator_address:{_eq:ef.from(t).toStringLong()}};return r?.tokenStandard&&(s.token_standard={_eq:r?.tokenStandard??"v2"}),(await sP({aptosConfig:n,options:{where:s}})).collection_id}var sB={typeParameters:[],parameters:[new rI(rK()),new rI(rK()),new rI(rK()),new rI(rK()),new rk(new rI(rK())),new rk(new rI(rK())),new rk(rk.u8())]};async function sR(e){let{aptosConfig:t,options:i,creator:r,collection:n,description:s,name:a,uri:o,propertyKeys:c,propertyTypes:u,propertyValues:l}=e,d=u?.map(e=>sz[e]);return nq({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::mint",functionArguments:[new ec(n),new ec(s),new ec(a),new ec(o),ea.MoveString(c??[]),ea.MoveString(d??[]),at(l??[],d??[])],abi:sB},options:i})}var sD={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rT]};async function sO(e){let{aptosConfig:t,sender:i,digitalAssetAddress:r,recipient:n,digitalAssetType:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::object::transfer",typeArguments:[s??sS],functionArguments:[ef.from(r),ef.from(n)],abi:sD},options:a})}var sL={typeParameters:[],parameters:[new rI(rK()),new rI(rK()),new rI(rK()),new rI(rK()),new rk(new rI(rK())),new rk(new rI(rK())),new rk(rk.u8()),new rT]};async function sV(e){let{aptosConfig:t,account:i,collection:r,description:n,name:s,uri:a,recipient:o,propertyKeys:c,propertyTypes:u,propertyValues:l,options:d}=e;if(c?.length!==l?.length)throw Error("Property keys and property values counts do not match");if(u?.length!==l?.length)throw Error("Property types and property values counts do not match");let f=u?.map(e=>sz[e]);return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::mint_soul_bound",functionArguments:[r,n,s,a,ea.MoveString(c??[]),ea.MoveString(f??[]),at(l??[],f??[]),o],abi:sL},options:d})}var sq={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0)))]};async function sH(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::burn",typeArguments:[n??sS],functionArguments:[ef.from(r)],abi:sq},options:s})}var sM={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0)))]};async function sG(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::freeze_transfer",typeArguments:[n??sS],functionArguments:[r],abi:sM},options:s})}var sj={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0)))]};async function sW(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::unfreeze_transfer",typeArguments:[n??sS],functionArguments:[r],abi:sj},options:s})}var sJ={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK())]};async function sY(e){let{aptosConfig:t,creator:i,description:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_description",typeArguments:[s??sS],functionArguments:[ef.from(n),new ec(r)],abi:sJ},options:a})}var sX={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK())]};async function sZ(e){let{aptosConfig:t,creator:i,name:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_name",typeArguments:[s??sS],functionArguments:[ef.from(n),new ec(r)],abi:sX},options:a})}var sQ={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK())]};async function s0(e){let{aptosConfig:t,creator:i,uri:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_uri",typeArguments:[s??sS],functionArguments:[ef.from(n),new ec(r)],abi:sQ},options:a})}var s2={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK()),new rI(rK()),rk.u8()]};async function s1(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::add_property",typeArguments:[o??sS],functionArguments:[ef.from(a),new ec(r),new ec(sz[n]),ea.U8(ai(s,sz[n]))],abi:s2},options:c})}var s8={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK())]};async function s3(e){let{aptosConfig:t,creator:i,propertyKey:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::remove_property",typeArguments:[s??sS],functionArguments:[ef.from(n),new ec(r)],abi:s8},options:a})}var s5={typeParameters:[{constraints:["key"]}],parameters:[new rI(rN(new rU(0))),new rI(rK()),new rI(rK()),rk.u8()]};async function s4(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::update_property",typeArguments:[o??sS],functionArguments:[ef.from(a),new ec(r),new ec(sz[n]),ai(s,sz[n])],abi:s5},options:c})}var s6={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new rI(rN(new rU(0))),new rI(rK()),new rU(1)]};async function s9(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::add_typed_property",typeArguments:[o??sS,sz[n]],functionArguments:[ef.from(a),new ec(r),s],abi:s6},options:c})}var s7={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new rI(rN(new rU(0))),new rI(rK()),new rU(1)]};async function ae(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::update_typed_property",typeArguments:[o??sS,sz[n]],functionArguments:[ef.from(a),new ec(r),s],abi:s7},options:c})}function at(e,t){let i=[];return t.forEach((t,r)=>{i.push(ai(e[r],t))}),i}function ai(e,t){return nF(e,nh(t),0,[]).bcsToBytes()}var ar=class{constructor(e){this.config=e}async getCollectionData(e){await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"});let{creatorAddress:t,collectionName:i,options:r}=e,n={collection_name:{_eq:i},creator_address:{_eq:ef.from(t).toStringLong()}};return r?.tokenStandard&&(n.token_standard={_eq:r?.tokenStandard??"v2"}),sP({aptosConfig:this.config,options:{where:n}})}async getCollectionDataByCreatorAddressAndCollectionName(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sK({aptosConfig:this.config,...e})}async getCollectionDataByCreatorAddress(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sN({aptosConfig:this.config,...e})}async getCollectionDataByCollectionId(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),s$({aptosConfig:this.config,...e})}async getCollectionId(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sF({aptosConfig:this.config,...e})}async getDigitalAssetData(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sT({aptosConfig:this.config,...e})}async getCurrentDigitalAssetOwnership(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sx({aptosConfig:this.config,...e})}async getOwnedDigitalAssets(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sC({aptosConfig:this.config,...e})}async getDigitalAssetActivity(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sU({aptosConfig:this.config,...e})}async createCollectionTransaction(e){return sI({aptosConfig:this.config,...e})}async mintDigitalAssetTransaction(e){return sR({aptosConfig:this.config,...e})}async transferDigitalAssetTransaction(e){return sO({aptosConfig:this.config,...e})}async mintSoulBoundTransaction(e){return sV({aptosConfig:this.config,...e})}async burnDigitalAssetTransaction(e){return sH({aptosConfig:this.config,...e})}async freezeDigitalAssetTransaferTransaction(e){return sG({aptosConfig:this.config,...e})}async unfreezeDigitalAssetTransaferTransaction(e){return sW({aptosConfig:this.config,...e})}async setDigitalAssetDescriptionTransaction(e){return sY({aptosConfig:this.config,...e})}async setDigitalAssetNameTransaction(e){return sZ({aptosConfig:this.config,...e})}async setDigitalAssetURITransaction(e){return s0({aptosConfig:this.config,...e})}async addDigitalAssetPropertyTransaction(e){return s1({aptosConfig:this.config,...e})}async removeDigitalAssetPropertyTransaction(e){return s3({aptosConfig:this.config,...e})}async updateDigitalAssetPropertyTransaction(e){return s4({aptosConfig:this.config,...e})}async addDigitalAssetTypedPropertyTransaction(e){return s9({aptosConfig:this.config,...e})}async updateDigitalAssetTypedPropertyTransaction(e){return ae({aptosConfig:this.config,...e})}},an=e=>{if(e&&e.length>300)throw Error("Event type length exceeds the maximum length of 300")};async function as(e){let{aptosConfig:t,eventType:i,options:r}=e,n={_or:[{account_address:{_eq:i.split("::")[0]}},{account_address:{_eq:"0x0000000000000000000000000000000000000000000000000000000000000000"},sequence_number:{_eq:0},creation_number:{_eq:0}}],indexed_type:{_eq:i}};return ac({aptosConfig:t,options:{...r,where:n}})}async function aa(e){let{accountAddress:t,aptosConfig:i,creationNumber:r,options:n}=e,s={account_address:{_eq:ef.from(t).toStringLong()},creation_number:{_eq:r}};return ac({aptosConfig:i,options:{...n,where:s}})}async function ao(e){let{accountAddress:t,aptosConfig:i,eventType:r,options:n}=e,s={account_address:{_eq:ef.from(t).toStringLong()},indexed_type:{_eq:r}};return ac({aptosConfig:i,options:{...n,where:s}})}async function ac(e){let{aptosConfig:t,options:i}=e;an(i?.where?.indexed_type?._eq);let r={query:tq,variables:{where_condition:i?.where,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:r,originMethod:"getEvents"})).events}var au=class{constructor(e){this.config=e}async getModuleEventsByEventType(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),as({aptosConfig:this.config,...e})}async getAccountEventsByCreationNumber(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),aa({aptosConfig:this.config,...e})}async getAccountEventsByEventType(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),ao({aptosConfig:this.config,...e})}async getEvents(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"events_processor"}),ac({aptosConfig:this.config,...e})}};async function al(e){let{aptosConfig:t,accountAddress:i,amount:r,options:n}=e,s=n?.timeoutSecs||20,{data:a}=await t3({aptosConfig:t,path:"fund",body:{address:ef.from(i).toString(),amount:r},originMethod:"fundAccount"}),o=a.txn_hashes[0],c=await iw({aptosConfig:t,transactionHash:o,options:{timeoutSecs:s,checkSuccess:n?.checkSuccess}});if("user_transaction"===c.type)return c;throw Error(`Unexpected transaction received for fund account: ${c.type}`)}var ad=class{constructor(e){this.config=e}async fundAccount(e){let t=await al({aptosConfig:this.config,...e});return(e.options?.waitForIndexer===void 0||e.options?.waitForIndexer)&&await iA({aptosConfig:this.config,minimumLedgerVersion:BigInt(t.version),processorType:"fungible_asset_processor"}),t}};async function af(e){let{aptosConfig:t,options:i}=e,r={query:tM,variables:{where_condition:i?.where,limit:i?.limit,offset:i?.offset}};return(await t7({aptosConfig:t,query:r,originMethod:"getFungibleAssetMetadata"})).fungible_asset_metadata}async function ap(e){let{aptosConfig:t,options:i}=e,r={query:tH,variables:{where_condition:i?.where,limit:i?.limit,offset:i?.offset}};return(await t7({aptosConfig:t,query:r,originMethod:"getFungibleAssetActivities"})).fungible_asset_activities}async function ah(e){let{aptosConfig:t,options:i}=e,r={query:tL,variables:{where_condition:i?.where,limit:i?.limit,offset:i?.offset}};return(await t7({aptosConfig:t,query:r,originMethod:"getCurrentFungibleAssetBalances"})).current_fungible_asset_balances}var ag={typeParameters:[{constraints:[]}],parameters:[nh("0x1::object::Object"),new rT,new rE]};async function ay(e){let{aptosConfig:t,sender:i,fungibleAssetMetadataAddress:r,recipient:n,amount:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[r,n,s],abi:ag},options:a})}async function am(e){let{aptosConfig:t,sender:i,fromStore:r,toStore:n,amount:s,options:a}=e;return nq({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::dispatchable_fungible_asset::transfer",typeArguments:["0x1::fungible_asset::FungibleStore"],functionArguments:[r,n,s],abi:ag},options:a})}var a_=class{constructor(e){this.config=e}async getFungibleAssetMetadata(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),af({aptosConfig:this.config,...e})}async getFungibleAssetMetadataByAssetType(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),(await af({aptosConfig:this.config,options:{where:{asset_type:{_eq:e.assetType}}}}))[0]}async getFungibleAssetMetadataByCreatorAddress(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),await af({aptosConfig:this.config,options:{where:{creator_address:{_eq:ef.from(e.creatorAddress).toStringLong()}}}})}async getFungibleAssetActivities(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),ap({aptosConfig:this.config,...e})}async getCurrentFungibleAssetBalances(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),ah({aptosConfig:this.config,...e})}async transferFungibleAsset(e){return ay({aptosConfig:this.config,...e})}async transferFungibleAssetBetweenStores(e){return am({aptosConfig:this.config,...e})}},aw=class{constructor(e){this.config=e}async getLedgerInfo(){return t6({aptosConfig:this.config})}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getBlockByVersion(e){return iE({aptosConfig:this.config,...e})}async getBlockByHeight(e){return iz({aptosConfig:this.config,...e})}async view(e){return sh({aptosConfig:this.config,...e})}async viewJson(e){return sg({aptosConfig:this.config,...e})}async getChainTopUserTransactions(e){return t9({aptosConfig:this.config,...e})}async queryIndexer(e){return t7({aptosConfig:this.config,...e})}async getIndexerLastSuccessVersion(){return it({aptosConfig:this.config})}async getProcessorStatus(e){return ii({aptosConfig:this.config,processorType:e})}},aA="A name must be between 3 and 63 characters long, and can only contain lowercase a-z, 0-9, and hyphens. A name may not start or end with a hyphen.";function ab(e){return!(!e||e.length<3||e.length>63||!/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/.test(e))}function av(e){let[t,i,...r]=e.replace(/\.apt$/,"").split(".");if(r.length>0)throw Error(`${e} is invalid. A name can only have two parts, a domain and a subdomain separated by a "."`);if(!ab(t))throw Error(`${t} is not valid. ${aA}`);if(i&&!ab(i))throw Error(`${i} is not valid. ${aA}`);return{domainName:i||t,subdomainName:i?t:void 0}}var aE=((N=aE||{})[N.Independent=0]="Independent",N[N.FollowsDomain=1]="FollowsDomain",N);function az(e){if(!e)return!1;let t=new Date(e.domain_expiration_timestamp).getTime()<Date.now(),i=new Date(e.expiration_timestamp).getTime()<Date.now();return(!e.subdomain||!t)&&(!!e.subdomain&&1===e.subdomain_expiration_policy||!i)}var aS={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c",local:"0x585fc9f0f0c54183b039ffc770ca282ebd87307916c215a3e692f2f8e4305e82",custom:null,devnet:null};function aT(e){let t=aS[e.network];if(!t)throw Error(`The ANS contract is not deployed to ${e.network}`);return t}var ax=e=>{if(e&&"object"==typeof e&&"vec"in e&&Array.isArray(e.vec))return e.vec[0]};async function aC(e){let{aptosConfig:t,name:i}=e,r=aT(t),{domainName:n,subdomainName:s}=av(i),a=ax((await sh({aptosConfig:t,payload:{function:`${r}::router::get_owner_addr`,functionArguments:[n,s]}}))[0]);return a?ef.from(a):void 0}async function aU(e){let{aptosConfig:t,expiration:i,name:r,sender:n,targetAddress:s,toAddress:a,options:o,transferable:c}=e,u=aT(t),{domainName:l,subdomainName:d}=av(r),f="subdomain:independent"===i.policy||"subdomain:follow-domain"===i.policy;if(d&&!f)throw Error("Subdomains must have an expiration policy of either 'subdomain:independent' or 'subdomain:follow-domain'");if(f&&!d)throw Error(`Policy is set to ${i.policy} but no subdomain was provided`);if("domain"===i.policy){let e=i.years??1;if(1!==e)throw Error("For now, names can only be registered for 1 year at a time");return await nq({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_domain`,functionArguments:[l,31536e3*e,s,a]},options:o})}if(!d)throw Error(`${i.policy} requires a subdomain to be provided.`);let p=await ak({aptosConfig:t,name:l});if(!p)throw Error("The domain does not exist");let h="subdomain:independent"===i.policy?i.expirationDate:p;if(h>p)throw Error("The subdomain expiration time cannot be greater than the domain expiration time");return await nq({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_subdomain`,functionArguments:[l,d,Math.round(h/1e3),"subdomain:follow-domain"===i.policy?1:0,!!c,s,a]},options:o})}async function ak(e){let{aptosConfig:t,name:i}=e,r=aT(t),{domainName:n,subdomainName:s}=av(i);try{let e=await sh({aptosConfig:t,payload:{function:`${r}::router::get_expiration`,functionArguments:[n,s]}});return 1e3*Number(e[0])}catch{return}}async function aI(e){let{aptosConfig:t,address:i}=e,r=aT(t),n=await sh({aptosConfig:t,payload:{function:`${r}::router::get_primary_name`,functionArguments:[ef.from(i).toString()]}}),s=ax(n[1]),a=ax(n[0]);if(s)return[a,s].filter(Boolean).join(".")}async function aP(e){let{aptosConfig:t,sender:i,name:r,options:n}=e,s=aT(t);if(!r)return await nq({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${s}::router::clear_primary_name`,functionArguments:[]},options:n});let{domainName:a,subdomainName:o}=av(r);return await nq({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${s}::router::set_primary_name`,functionArguments:[a,o]},options:n})}async function aK(e){let{aptosConfig:t,name:i}=e,r=aT(t),{domainName:n,subdomainName:s}=av(i),a=ax((await sh({aptosConfig:t,payload:{function:`${r}::router::get_target_addr`,functionArguments:[n,s]}}))[0]);return a?ef.from(a):void 0}async function aN(e){let{aptosConfig:t,sender:i,name:r,address:n,options:s}=e,a=aT(t),{domainName:o,subdomainName:c}=av(r);return await nq({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${a}::router::set_target_addr`,functionArguments:[o,c,n]},options:s})}async function a$(e){let{aptosConfig:t,name:i}=e,{domainName:r,subdomainName:n=""}=av(i),s=(await t7({aptosConfig:t,query:{query:tG,variables:{where_condition:{domain:{_eq:r},subdomain:{_eq:n}},limit:1}},originMethod:"getName"})).current_aptos_names[0];return s&&(s=aV(s)),az(s)?s:void 0}async function aF(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aO({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountNames",query:{query:tG,variables:{limit:i?.limit,offset:i?.offset,order_by:i?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n}}}}})).current_aptos_names.map(aV)}async function aB(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aO({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountDomains",query:{query:tG,variables:{limit:i?.limit,offset:i?.offset,order_by:i?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n},subdomain:{_eq:""}}}}})).current_aptos_names.map(aV)}async function aR(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aO({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountSubdomains",query:{query:tG,variables:{limit:i?.limit,offset:i?.offset,order_by:i?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n},subdomain:{_neq:""}}}}})).current_aptos_names.map(aV)}async function aD(e){let{aptosConfig:t,options:i,domain:r}=e;return(await t7({aptosConfig:t,originMethod:"getDomainSubdomains",query:{query:tG,variables:{limit:i?.limit,offset:i?.offset,order_by:i?.orderBy,where_condition:{...e.options?.where??{},domain:{_eq:r},subdomain:{_neq:""}}}}})).current_aptos_names.map(aV).filter(az)}async function aO(e){let{aptosConfig:t}=e,i=aT(t),[r]=await sh({aptosConfig:t,payload:{function:`${i}::config::reregistration_grace_sec`,functionArguments:[]}}),n=()=>new Date;return new Date(n().setDate(n().getDate()-r/60/60/24)).toISOString()}async function aL(e){let{aptosConfig:t,sender:i,name:r,years:n=1,options:s}=e,a=aT(t),{domainName:o,subdomainName:c}=av(r);if(c)throw Error("Subdomains cannot be renewed");if(1!==n)throw Error("Currently, only 1 year renewals are supported");return await nq({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${a}::router::renew_domain`,functionArguments:[o,31536e3*n]},options:s})}function aV(e){return{...e,expiration_timestamp:new Date(e.expiration_timestamp).getTime()}}var aq=class{constructor(e){this.config=e}async getOwnerAddress(e){return aC({aptosConfig:this.config,...e})}async getExpiration(e){return ak({aptosConfig:this.config,...e})}async getTargetAddress(e){return aK({aptosConfig:this.config,...e})}async setTargetAddress(e){return aN({aptosConfig:this.config,...e})}async getPrimaryName(e){return aI({aptosConfig:this.config,...e})}async setPrimaryName(e){return aP({aptosConfig:this.config,...e})}async registerName(e){return aU({aptosConfig:this.config,...e})}async renewDomain(e){return aL({aptosConfig:this.config,...e})}async getName(e){return a$({aptosConfig:this.config,...e})}async getAccountNames(e){return aF({aptosConfig:this.config,...e})}async getAccountDomains(e){return aB({aptosConfig:this.config,...e})}async getAccountSubdomains(e){return aR({aptosConfig:this.config,...e})}async getDomainSubdomains(e){return aD({aptosConfig:this.config,...e})}};async function aH(e){let{aptosConfig:t,poolAddress:i}=e,r=ef.from(i).toStringLong(),n=await t7({aptosConfig:t,query:{query:tj,variables:{where_condition:{pool_address:{_eq:r}}}}});return n.num_active_delegator_per_pool[0]?n.num_active_delegator_per_pool[0].num_active_delegator:0}async function aM(e){let{aptosConfig:t,options:i}=e,r={query:tj,variables:{order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:r})).num_active_delegator_per_pool}async function aG(e){let{aptosConfig:t,delegatorAddress:i,poolAddress:r}=e,n={query:tV,variables:{delegatorAddress:ef.from(i).toStringLong(),poolAddress:ef.from(r).toStringLong()}};return(await t7({aptosConfig:t,query:n})).delegated_staking_activities}var aj=class{constructor(e){this.config=e}async getNumberOfDelegators(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),aH({aptosConfig:this.config,...e})}async getNumberOfDelegatorsForAllPools(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),aM({aptosConfig:this.config,...e})}async getDelegatedStakingActivities(e){return await iT({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),aG({aptosConfig:this.config,...e})}},aW=class{constructor(e){this.config=e}async simple(e){return nq({aptosConfig:this.config,...e})}async multiAgent(e){return nq({aptosConfig:this.config,...e})}},aJ=class{constructor(e){this.config=e}async simple(e){return nW({aptosConfig:this.config,...e})}async multiAgent(e){return nW({aptosConfig:this.config,...e})}};M([tC],aJ.prototype,"simple",1),M([tC],aJ.prototype,"multiAgent",1);var aY=class{constructor(e){this.config=e}async simple(e){return nJ({aptosConfig:this.config,...e})}async multiAgent(e){return nJ({aptosConfig:this.config,...e})}};M([tx],aY.prototype,"simple",1),M([tx],aY.prototype,"multiAgent",1);var aX=class{constructor(e,t,i,r,n){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.aptosConfig=e,this.account=t,this.maxWaitTime=i,this.maximumInFlight=r,this.sleepTime=n}async nextSequenceNumber(){for(;this.lock;)await ej(this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((null===this.lastUncommintedNumber||null===this.currentNumber)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();let e=eJ();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await ej(this.sleepTime),eJ()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(e){console.error("error in getting next sequence number for this account",e)}finally{this.lock=!1}return e}async initialize(){let{sequence_number:e}=await n0({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){let{sequence_number:e}=await n0({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await ej(this.sleepTime);this.lock=!0;try{await this.update();let e=eJ();for(;this.lastUncommintedNumber!==this.currentNumber;)eJ()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):(await ej(this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}},aZ="fulfilled",aQ=(($=aQ||{}).TransactionSent="transactionSent",$.TransactionSendFailed="transactionSendFailed",$.TransactionExecuted="transactionExecuted",$.TransactionExecutionFailed="transactionExecutionFailed",$.ExecutionFinish="executionFinish",$),a0=class extends i7.Z{constructor(e,t,i=30,r=100,n=10){super(),this.taskQueue=new eh,this.transactionsQueue=new eh,this.outstandingTransactions=new eh,this.sentTransactions=[],this.executedTransactions=[],this.aptosConfig=e,this.account=t,this.started=!1,this.accountSequnceNumber=new aX(e,t,i,r,n)}async submitNextTransaction(){try{for(;;){let e=await this.accountSequnceNumber.nextSequenceNumber();if(null===e)return;let t=await this.generateNextTransaction(this.account,e);if(!t)return;let i=nY({aptosConfig:this.aptosConfig,transaction:t,signer:this.account});await this.outstandingTransactions.enqueue([i,e])}}catch(e){if(e instanceof eg)return;throw Error(`Submit transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async processTransactions(){try{for(;;){let e=[],t=[],[i,r]=await this.outstandingTransactions.dequeue();for(e.push(i),t.push(r);!this.outstandingTransactions.isEmpty();)[i,r]=await this.outstandingTransactions.dequeue(),e.push(i),t.push(r);let n=await Promise.allSettled(e);for(let e=0;e<n.length&&e<t.length;e+=1){let i=n[e];r=t[e],i.status===aZ?(this.sentTransactions.push([i.value.hash,r,null]),this.emit("transactionSent",{message:`transaction hash ${i.value.hash} has been committed to chain`,transactionHash:i.value.hash}),await this.checkTransaction(i,r)):(this.sentTransactions.push([i.status,r,i.reason]),this.emit("transactionSendFailed",{message:`failed to commit transaction ${this.sentTransactions.length} with error ${i.reason}`,error:i.reason}))}this.emit("executionFinish",{message:`execute ${n.length} transactions finished`})}}catch(e){if(e instanceof eg)return;throw Error(`Process execution failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async checkTransaction(e,t){try{let i=[];i.push(iw({aptosConfig:this.aptosConfig,transactionHash:e.value.hash}));let r=await Promise.allSettled(i);for(let i=0;i<r.length;i+=1){let n=r[i];n.status===aZ?(this.executedTransactions.push([n.value.hash,t,null]),this.emit("transactionExecuted",{message:`transaction hash ${n.value.hash} has been executed on chain`,transactionHash:e.value.hash})):(this.executedTransactions.push([n.status,t,n.reason]),this.emit("transactionExecutionFailed",{message:`failed to execute transaction ${this.executedTransactions.length} with error ${n.reason}`,error:n.reason}))}}catch(e){throw Error(`Check transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async push(e,t){this.transactionsQueue.enqueue([e,t])}async generateNextTransaction(e,t){if(this.transactionsQueue.isEmpty())return;let[i,r]=await this.transactionsQueue.dequeue();return nq({aptosConfig:this.aptosConfig,sender:e.accountAddress,data:i,options:{...r,accountSequenceNumber:t}})}async run(){try{for(;!this.taskQueue.isCancelled();)await (await this.taskQueue.dequeue())()}catch(e){throw Error(`Unable to start transaction batching: ${e}`)}}start(){if(this.started)throw Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},a2=class extends i7.Z{constructor(e){super(),this.config=e}start(e){let{sender:t}=e;this.account=t,this.transactionWorker=new a0(this.config,t),this.transactionWorker.start(),this.registerToEvents()}push(e){let{data:t,options:i}=e;for(let e of t)this.transactionWorker.push(e,i)}registerToEvents(){this.transactionWorker.on("transactionSent",async e=>{this.emit("transactionSent",e)}),this.transactionWorker.on("transactionSendFailed",async e=>{this.emit("transactionSendFailed",e)}),this.transactionWorker.on("transactionExecuted",async e=>{this.emit("transactionExecuted",e)}),this.transactionWorker.on("transactionExecutionFailed",async e=>{this.emit("transactionExecutionFailed",e)}),this.transactionWorker.on("executionFinish",async e=>{this.emit("executionFinish",e)})}forSingleAccount(e){try{let{sender:t,data:i,options:r}=e;this.start({sender:t}),this.push({data:i,options:r})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}},a1=class{constructor(e){this.config=e,this.build=new aW(this.config),this.simulate=new aJ(this.config),this.submit=new aY(this.config),this.batch=new a2(this.config)}async getTransactions(e){return ip({aptosConfig:this.config,...e})}async getTransactionByVersion(e){return ig({aptosConfig:this.config,...e})}async getTransactionByHash(e){return iy({aptosConfig:this.config,...e})}async isPendingTransaction(e){return im({aptosConfig:this.config,...e})}async waitForTransaction(e){return iw({aptosConfig:this.config,...e})}async getGasPriceEstimation(){return ih({aptosConfig:this.config})}getSigningMessage(e){return function(e){let{transaction:t}=e;return r3(t)}(e)}async publishPackageTransaction(e){return nQ({aptosConfig:this.config,...e})}async rotateAuthKey(e){return sl({aptosConfig:this.config,...e})}sign(e){return nG({...e})}signAsFeePayer(e){return nj({...e})}async batchTransactionsForSingleAccount(e){try{let{sender:t,data:i,options:r}=e;this.batch.forSingleAccount({sender:t,data:i,options:r})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}async signAndSubmitTransaction(e){return nY({aptosConfig:this.config,...e})}async signAndSubmitAsFeePayer(e){return nX({aptosConfig:this.config,...e})}};async function a8(e){let{aptosConfig:t,jwt:i,ephemeralKeyPair:r,uidKey:n="sub",derivationPath:s}=e,a={jwt_b64:i,epk:r.getPublicKey().bcsToHex().toStringWithoutPrefix(),exp_date_secs:r.expiryDateSecs,epk_blinder:L.fromHexInput(r.blinder).toStringWithoutPrefix(),uid_key:n,derivation_path:s},{data:o}=await t5({aptosConfig:t,path:"fetch",body:a,originMethod:"getPepper",overrides:{WITH_CREDENTIALS:!1}});return L.fromHexInput(o.pepper).toUint8Array()}async function a3(e){let{aptosConfig:t,jwt:i,ephemeralKeyPair:r,pepper:n=await a8(e),uidKey:s="sub",maxExpHorizonSecs:a=(await oA({aptosConfig:t})).maxExpHorizonSecs}=e;if(L.fromHexInput(n).toUint8Array().length!==nn.PEPPER_LENGTH)throw Error(`Pepper needs to be ${nn.PEPPER_LENGTH} bytes`);let o=(0,i4.o)(i);if("number"!=typeof o.iat)throw Error("iat was not found");if(a<r.expiryDateSecs-o.iat)throw Error(`The EphemeralKeyPair is too long lived.  It's lifespan must be less than ${a}`);let c={jwt_b64:i,epk:r.getPublicKey().bcsToHex().toStringWithoutPrefix(),epk_blinder:L.fromHexInput(r.blinder).toStringWithoutPrefix(),exp_date_secs:r.expiryDateSecs,exp_horizon_secs:a,pepper:L.fromHexInput(n).toStringWithoutPrefix(),uid_key:s},{data:u}=await t4({aptosConfig:t,path:"prove",body:c,originMethod:"getProof",overrides:{WITH_CREDENTIALS:!1}}),l=u.proof;return new om({proof:new oy(new oh({a:l.a,b:l.b,c:l.c}),0),trainingWheelsSignature:tT.fromHex(u.training_wheels_signature),expHorizonSecs:a})}async function a5(e){let{aptosConfig:t,jwt:i,jwkAddress:r,uidKey:n,proofFetchCallback:s,pepper:a=await a8(e)}=e,{verificationKey:o,maxExpHorizonSecs:c}=await oA({aptosConfig:t}),u=a3({...e,pepper:a,maxExpHorizonSecs:c}),l=s?u:await u;if(void 0!==r){let c=re.fromJwtAndPepper({jwt:i,pepper:a,jwkAddress:r,uidKey:n}),u=await n9({aptosConfig:t,authenticationKey:c.authKey().derivedAddress()});return ns.create({...e,address:u,proof:l,pepper:a,proofFetchCallback:s,jwkAddress:r,verificationKey:o})}let d=on.fromJwtAndPepper({jwt:i,pepper:a,uidKey:n}),f=await n9({aptosConfig:t,authenticationKey:d.authKey().derivedAddress()});return nn.create({...e,address:f,proof:l,pepper:a,proofFetchCallback:s,verificationKey:o})}async function a4(e){let t,{aptosConfig:i,sender:r,iss:n,options:s}=e,{jwksUrl:a}=e;void 0===a&&(a=id.test(n)?"https://www.googleapis.com/service_accounts/v1/jwk/securetoken@system.gserviceaccount.com":n.endsWith("/")?`${n}.well-known/jwks.json`:`${n}/.well-known/jwks.json`);try{if(!(t=await fetch(a)).ok)throw Error(`${t.status} ${t.statusText}`)}catch(t){let e;throw e=t instanceof Error?`${t.message}`:`error unknown - ${t}`,e5.fromErrorType({type:14,details:`Failed to fetch JWKS at ${a}: ${e}`})}let o=await t.json();return nq({aptosConfig:i,sender:r.accountAddress,data:{function:"0x1::jwks::update_federated_jwk_set",functionArguments:[n,ea.MoveString(o.keys.map(e=>e.kid)),ea.MoveString(o.keys.map(e=>e.alg)),ea.MoveString(o.keys.map(e=>e.e)),ea.MoveString(o.keys.map(e=>e.n))]},options:s})}var a6=class{constructor(e){this.config=e}async getPepper(e){return a8({aptosConfig:this.config,...e})}async getProof(e){return a3({aptosConfig:this.config,...e})}async deriveKeylessAccount(e){return a5({aptosConfig:this.config,...e})}async updateFederatedKeylessJwkSetTransaction(e){return a4({aptosConfig:this.config,...e})}};async function a9(e){let{aptosConfig:t,options:i}=e,r={query:tW,variables:{where_condition:i?.where,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:r,originMethod:"getObjectData"})).current_objects}async function a7(e){let{aptosConfig:t,objectAddress:i,options:r}=e,n={object_address:{_eq:ef.from(i).toStringLong()}};return(await a9({aptosConfig:t,options:{...r,where:n}}))[0]}var oe=class{constructor(e){this.config=e}async getObjectDataByObjectAddress(e){return await iT({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),a7({aptosConfig:this.config,...e})}},ot=class{constructor(e){this.config=new iF(e),this.account=new sA(this.config),this.abstraction=new sw(this.config),this.ans=new aq(this.config),this.coin=new sE(this.config),this.digitalAsset=new ar(this.config),this.event=new au(this.config),this.faucet=new ad(this.config),this.fungibleAsset=new a_(this.config),this.general=new aw(this.config),this.staking=new aj(this.config),this.transaction=new a1(this.config),this.table=new ix(this.config),this.keyless=new a6(this.config),this.object=new oe(this.config)}};function oi(e,t,i){Object.getOwnPropertyNames(t.prototype).forEach(r=>{let n=Object.getOwnPropertyDescriptor(t.prototype,r);n&&(n.value=function(...e){return this[i][r](...e)},Object.defineProperty(e.prototype,r,n))})}oi(ot,sA,"account"),oi(ot,sw,"abstraction"),oi(ot,aq,"ans"),oi(ot,sE,"coin"),oi(ot,ar,"digitalAsset"),oi(ot,au,"event"),oi(ot,ad,"faucet"),oi(ot,a_,"fungibleAsset"),oi(ot,aw,"general"),oi(ot,aj,"staking"),oi(ot,a1,"transaction"),oi(ot,ix,"table"),oi(ot,a6,"keyless"),oi(ot,oe,"object");var or=class e extends eP{constructor(t,i){super();let r=L.fromHexInput(i).toUint8Array();if(r.length!==e.ID_COMMITMENT_LENGTH)throw Error(`Id Commitment length in bytes should be ${e.ID_COMMITMENT_LENGTH}`);this.iss=t,this.idCommitment=r}authKey(){let e=new j;return e.serializeU32AsUleb128(3),e.serializeFixedBytes(this.bcsToBytes()),tg.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return oa({...e,publicKey:this}),!0}catch(e){if(e instanceof e5)return!1;throw e}}async verifySignatureAsync(e){return os({...e,publicKey:this})}serialize(e){e.serializeStr(this.iss),e.serializeBytes(this.idCommitment)}static deserialize(t){return new e(t.deserializeStr(),t.deserializeBytes())}static load(t){return new e(t.deserializeStr(),t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static create(t){return oc(t),new e(t.iss,oc(t))}static fromJwtAndPepper(t){let{jwt:i,pepper:r,uidKey:n="sub"}=t,s=(0,i4.o)(i);if("string"!=typeof s.iss)throw Error("iss was not found");if("string"!=typeof s.aud)throw Error("aud was not found or an array of values");let a=s[n];return e.create({iss:s.iss,uidKey:n,uidVal:a,aud:s.aud,pepper:r})}static isInstance(e){return"iss"in e&&"string"==typeof e.iss&&"idCommitment"in e&&e.idCommitment instanceof Uint8Array}};or.ID_COMMITMENT_LENGTH=32;var on=or;async function os(e){let{aptosConfig:t,publicKey:i,message:r,signature:n,jwk:s,keylessConfig:a=await oA({aptosConfig:t}),options:o}=e;try{if(!(n instanceof ou))throw e5.fromErrorType({type:26,details:"Not a keyless signature"});return oa({message:r,publicKey:i,signature:n,jwk:s||await oo({aptosConfig:t,publicKey:i,kid:n.getJwkKid()}),keylessConfig:a}),!0}catch(e){if(o?.throwErrorWithReason)throw e;return!1}}function oa(e){let{publicKey:t,message:i,signature:r,keylessConfig:n,jwk:s}=e,{verificationKey:a,maxExpHorizonSecs:o,trainingWheelsPubkey:c}=n;if(!(r instanceof ou))throw e5.fromErrorType({type:26,details:"Not a keyless signature"});if(!(r.ephemeralCertificate.signature instanceof om))throw e5.fromErrorType({type:26,details:"Unsupported ephemeral certificate variant"});let u=r.ephemeralCertificate.signature;if(!(u.proof.proof instanceof oh))throw e5.fromErrorType({type:26,details:"Unsupported proof variant for ZeroKnowledgeSig"});let l=u.proof.proof;if(r.expiryDateSecs<eJ())throw e5.fromErrorType({type:27,details:"The expiryDateSecs is in the past"});if(u.expHorizonSecs>o)throw e5.fromErrorType({type:28});if(!r.ephemeralPublicKey.verifySignature({message:i,signature:r.ephemeralSignature}))throw e5.fromErrorType({type:29});let d=function(e){let{publicKey:t,signature:i,jwk:r,keylessConfig:n}=e,s=t instanceof on?t:t.keylessPublicKey;if(!(i.ephemeralCertificate.signature instanceof om))throw Error("Signature is not a ZeroKnowledgeSig");let a=i.ephemeralCertificate.signature,o=[];return o.push(...tl(i.ephemeralPublicKey.toUint8Array(),n.maxCommitedEpkBytes)),o.push(td(s.idCommitment)),o.push(i.expiryDateSecs),o.push(a.expHorizonSecs),o.push(tu(s.iss,n.maxIssValBytes)),a.extraField?(o.push(1n),o.push(tu(a.extraField,n.maxExtraFieldBytes))):(o.push(0n),o.push(tu(" ",n.maxExtraFieldBytes))),o.push(tu((0,eM.cv)(i.jwtHeader,!0)+".",n.maxJwtHeaderB64Bytes)),o.push(r.toScalar()),a.overrideAudVal?(o.push(tu(a.overrideAudVal,120)),o.push(1n)):(o.push(tu("",120)),o.push(0n)),tp(o)}({publicKey:t,signature:r,jwk:s,keylessConfig:n});if(!a.verifyProof({publicInputsHash:d,groth16Proof:l}))throw e5.fromErrorType({type:32});if(c){if(!u.trainingWheelsSignature)throw e5.fromErrorType({type:30});let e=new og(l,d);if(!c.verifySignature({message:e.hash(),signature:u.trainingWheelsSignature}))throw e5.fromErrorType({type:31})}}async function oo(e){let{aptosConfig:t,publicKey:i,kid:r}=e,{iss:n}=i instanceof on?i:i.keylessPublicKey,s,a=i instanceof re?i.jwkAddress:void 0;try{s=await oz({aptosConfig:t,jwkAddr:a})}catch(e){throw e5.fromErrorType({type:24,error:e,details:`Failed to fetch ${a?"Federated":"Patched"}JWKs ${a?`for address ${a}`:"0x1"}`})}let o=s.get(n);if(void 0===o)throw e5.fromErrorType({type:7,details:`JWKs for issuer ${n} not found.`});let c=o.find(e=>e.kid===r);if(void 0===c)throw e5.fromErrorType({type:6,details:`JWK with kid '${r}' for issuer '${n}' not found.`});return c}function oc(e){let{uidKey:t,uidVal:i,aud:r,pepper:n}=e;return tf(tp([td(L.fromHexInput(n).toUint8Array()),tu(r,120),tu(i,330),tu(t,30)]),on.ID_COMMITMENT_LENGTH)}var ou=class e extends eK{constructor(e){super();let{jwtHeader:t,ephemeralCertificate:i,expiryDateSecs:r,ephemeralPublicKey:n,ephemeralSignature:s}=e;this.jwtHeader=t,this.ephemeralCertificate=i,this.expiryDateSecs=r,this.ephemeralPublicKey=n,this.ephemeralSignature=s}getJwkKid(){return function(e){try{let t=JSON.parse(e);if(void 0===t.kid)throw Error("JWT header missing kid");return t}catch{throw Error("Failed to parse JWT header.")}}(this.jwtHeader).kid}serialize(e){this.ephemeralCertificate.serialize(e),e.serializeStr(this.jwtHeader),e.serializeU64(this.expiryDateSecs),this.ephemeralPublicKey.serialize(e),this.ephemeralSignature.serialize(e)}static deserialize(t){let i=ol.deserialize(t),r=t.deserializeStr(),n=t.deserializeU64(),s=tS.deserialize(t),a=tT.deserialize(t);return new e({jwtHeader:r,expiryDateSecs:Number(n),ephemeralCertificate:i,ephemeralPublicKey:s,ephemeralSignature:a})}static getSimulationSignature(){return new e({jwtHeader:"{}",ephemeralCertificate:new ol(new om({proof:new oy(new oh({a:new Uint8Array(32),b:new Uint8Array(64),c:new Uint8Array(32)}),0),expHorizonSecs:0}),0),expiryDateSecs:0,ephemeralPublicKey:new tS(new tA(new Uint8Array(32))),ephemeralSignature:new tT(new tz(new Uint8Array(64)))})}static isSignature(t){return t instanceof e}},ol=class e extends eK{constructor(e,t){super(),this.signature=e,this.variant=t}toUint8Array(){return this.signature.toUint8Array()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(om.deserialize(t),i);throw Error(`Unknown variant index for EphemeralCertificate: ${i}`)}},od=class e extends G{constructor(e){if(super(),this.data=L.fromHexInput(e).toUint8Array(),32!==this.data.length)throw Error("Input needs to be 32 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(32))}toArray(){let e=this.toProjectivePoint();return[e.x.toString(),e.y.toString(),e.pz.toString()]}toProjectivePoint(){let t=new Uint8Array(this.data);t.reverse();let i=(128&t[0])>>7,{Fp:r}=i6.bn254.fields,n=r.create(of(t)),s=r.sqrt(r.add(r.pow(n,3n),e.B)),a=r.neg(s),o=s>a==(1===i)?s:a;return i6.bn254.G1.ProjectivePoint.fromAffine({x:n,y:o})}};function of(e){if(32!==e.length)throw Error("Input should be 32 bytes");let t=new Uint8Array(e);return t[0]=63&t[0],(0,i9.Hv)(t)}od.B=i6.bn254.fields.Fp.create(3n);var op=class e extends G{constructor(e){if(super(),this.data=L.fromHexInput(e).toUint8Array(),64!==this.data.length)throw Error("Input needs to be 64 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(64))}toArray(){let e=this.toProjectivePoint();return[[e.x.c0.toString(),e.x.c1.toString()],[e.y.c0.toString(),e.y.c1.toString()],[e.pz.c0.toString(),e.pz.c1.toString()]]}toProjectivePoint(){let t=new Uint8Array(this.data),i=t.slice(0,32).reverse(),r=t.slice(32,64).reverse(),n=(128&r[0])>>7,{Fp2:s}=i6.bn254.fields,a=s.fromBigTuple([of(i),of(r)]),o=s.sqrt(s.add(s.pow(a,3n),e.B)),c=s.neg(o),u=(o.c1>c.c1||o.c1===c.c1&&o.c0>c.c0)==(1===n)?o:c;return i6.bn254.G2.ProjectivePoint.fromAffine({x:a,y:u})}};op.B=i6.bn254.fields.Fp2.fromBigTuple([0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n,0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n]);var oh=class e extends th{constructor(e){super();let{a:t,b:i,c:r}=e;this.a=new od(t),this.b=new op(i),this.c=new od(r)}serialize(e){this.a.serialize(e),this.b.serialize(e),this.c.serialize(e)}static deserialize(t){return new e({a:od.deserialize(t).bcsToBytes(),b:op.deserialize(t).bcsToBytes(),c:od.deserialize(t).bcsToBytes()})}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",pi_a:this.a.toArray(),pi_b:this.b.toArray(),pi_c:this.c.toArray()}}},og=class e extends G{constructor(e,t){if(super(),this.domainSeparator="APTOS::Groth16ProofAndStatement",this.proof=e,this.publicInputsHash="bigint"==typeof t?tf(t,32):L.fromHexInput(t).toUint8Array(),32!==this.publicInputsHash.length)throw Error("Invalid public inputs hash")}serialize(e){this.proof.serialize(e),e.serializeFixedBytes(this.publicInputsHash)}static deserialize(t){return new e(oh.deserialize(t),t.deserializeFixedBytes(32))}hash(){return r8(this.bcsToBytes(),this.domainSeparator)}},oy=class e extends G{constructor(e,t){super(),this.proof=e,this.variant=t}serialize(e){e.serializeU32AsUleb128(this.variant),this.proof.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(oh.deserialize(t),i);throw Error(`Unknown variant index for ZkProof: ${i}`)}},om=class e extends eK{constructor(e){super();let{proof:t,expHorizonSecs:i,trainingWheelsSignature:r,extraField:n,overrideAudVal:s}=e;this.proof=t,this.expHorizonSecs=i,this.trainingWheelsSignature=r,this.extraField=n,this.overrideAudVal=s}static fromBytes(t){return e.deserialize(new es(t))}serialize(e){this.proof.serialize(e),e.serializeU64(this.expHorizonSecs),e.serializeOption(this.extraField),e.serializeOption(this.overrideAudVal),e.serializeOption(this.trainingWheelsSignature)}static deserialize(t){let i=oy.deserialize(t),r=Number(t.deserializeU64()),n=t.deserializeOption("string"),s=t.deserializeOption("string");return new e({proof:i,expHorizonSecs:r,trainingWheelsSignature:t.deserializeOption(tT),extraField:n,overrideAudVal:s})}},o_=class e{constructor(e){let{verificationKey:t,trainingWheelsPubkey:i,maxExpHorizonSecs:r=1e7,maxExtraFieldBytes:n=350,maxJwtHeaderB64Bytes:s=300,maxIssValBytes:a=120,maxCommitedEpkBytes:o=93}=e;this.verificationKey=t,this.maxExpHorizonSecs=r,i&&(this.trainingWheelsPubkey=new tS(new tA(i))),this.maxExtraFieldBytes=n,this.maxJwtHeaderB64Bytes=s,this.maxIssValBytes=a,this.maxCommitedEpkBytes=o}static create(t,i){return new e({verificationKey:new ow({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2}),maxExpHorizonSecs:Number(i.max_exp_horizon_secs),trainingWheelsPubkey:i.training_wheels_pubkey.vec[0],maxExtraFieldBytes:i.max_extra_field_bytes,maxJwtHeaderB64Bytes:i.max_jwt_header_b64_bytes,maxIssValBytes:i.max_iss_val_bytes,maxCommitedEpkBytes:i.max_commited_epk_bytes})}},ow=class e{constructor(e){let{alphaG1:t,betaG2:i,deltaG2:r,gammaAbcG1:n,gammaG2:s}=e;this.alphaG1=new od(t),this.betaG2=new op(i),this.deltaG2=new op(r),this.gammaAbcG1=[new od(n[0]),new od(n[1])],this.gammaG2=new op(s)}hash(){let e=new j;return this.serialize(e),eN.DZ.create().update(e.toUint8Array()).digest()}serialize(e){this.alphaG1.serialize(e),this.betaG2.serialize(e),this.deltaG2.serialize(e),this.gammaAbcG1[0].serialize(e),this.gammaAbcG1[1].serialize(e),this.gammaG2.serialize(e)}static fromGroth16VerificationKeyResponse(t){return new e({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2})}verifyProof(e){let{publicInputsHash:t,groth16Proof:i}=e;try{let e=i.a.toProjectivePoint(),r=i.b.toProjectivePoint(),n=i.c.toProjectivePoint(),s=this.alphaG1.toProjectivePoint(),a=this.betaG2.toProjectivePoint(),o=this.gammaG2.toProjectivePoint(),c=this.deltaG2.toProjectivePoint(),u=this.gammaAbcG1.map(e=>e.toProjectivePoint()),{Fp12:l}=i6.bn254.fields,d=u[0].add(u[1].multiply(t)),f=i6.bn254.pairing(d,o),p=i6.bn254.pairing(e,r),h=i6.bn254.pairing(s,a),g=i6.bn254.pairing(n,c),y=l.mul(h,l.mul(f,g));return l.eql(p,y)}catch(e){throw e5.fromErrorType({type:32,error:e,details:"Error encountered when checking zero knowledge relation"})}}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",nPublic:1,vk_alpha_1:this.alphaG1.toArray(),vk_beta_2:this.betaG2.toArray(),vk_gamma_2:this.gammaG2.toArray(),vk_delta_2:this.deltaG2.toArray(),IC:this.gammaAbcG1.map(e=>e.toArray())}}};async function oA(e){let{aptosConfig:t}=e;try{return await eV(async()=>{let[t,i]=await Promise.all([ov(e),oE(e)]);return o_.create(i,t)},`keyless-configuration-${t.network}`,3e5)()}catch(e){throw e instanceof e5?e:e5.fromErrorType({type:25,error:e})}}function ob(e){let{jwt:t,uidKey:i="sub"}=e,r;try{r=(0,i4.o)(t)}catch(e){throw e5.fromErrorType({type:12,details:`Failed to parse JWT - ${eW(e)}`})}if("string"!=typeof r.iss)throw e5.fromErrorType({type:12,details:"JWT is missing 'iss' in the payload. This should never happen."});if("string"!=typeof r.aud)throw e5.fromErrorType({type:12,details:"JWT is missing 'aud' in the payload or 'aud' is an array of values."});let n=r[i];return{iss:r.iss,aud:r.aud,uidVal:n}}async function ov(e){let{aptosConfig:t,options:i}=e;try{let{data:e}=await te({aptosConfig:t,originMethod:"getKeylessConfigurationResource",path:`accounts/${ef.from("0x1").toString()}/resource/0x1::keyless_account::Configuration`,params:{ledger_version:i?.ledgerVersion}});return e.data}catch(e){throw e5.fromErrorType({type:22,error:e})}}async function oE(e){let{aptosConfig:t,options:i}=e;try{let{data:e}=await te({aptosConfig:t,originMethod:"getGroth16VerificationKeyResource",path:`accounts/${ef.from("0x1").toString()}/resource/0x1::keyless_account::Groth16VerificationKey`,params:{ledger_version:i?.ledgerVersion}});return e.data}catch(e){throw e5.fromErrorType({type:23,error:e})}}async function oz(e){let{aptosConfig:t,jwkAddr:i,options:r}=e,n;if(i){let{data:e}=await te({aptosConfig:t,originMethod:"getKeylessJWKs",path:`accounts/${ef.from(i).toString()}/resource/0x1::jwks::FederatedJWKs`,params:{ledger_version:r?.ledgerVersion}});n=e}else{let{data:e}=await te({aptosConfig:t,originMethod:"getKeylessJWKs",path:"accounts/0x1/resource/0x1::jwks::PatchedJWKs",params:{ledger_version:r?.ledgerVersion}});n=e}let s=new Map;for(let e of n.data.jwks.entries){let t=[];for(let i of e.jwks){let{data:e}=i.variant,r=new es(L.fromHexInput(e).toUint8Array()),n=oS.deserialize(r);t.push(n)}s.set(V(e.issuer),t)}return s}var oS=class e extends G{constructor(e){super();let{kid:t,kty:i,alg:r,e:n,n:s}=e;this.kid=t,this.kty=i,this.alg=r,this.e=n,this.n=s}serialize(e){e.serializeStr(this.kid),e.serializeStr(this.kty),e.serializeStr(this.alg),e.serializeStr(this.e),e.serializeStr(this.n)}static fromMoveStruct(t){let{data:i}=t.variant,r=new es(L.fromHexInput(i).toUint8Array());return e.deserialize(r)}toScalar(){if("RS256"!==this.alg)throw e5.fromErrorType({type:32,details:"Failed to convert JWK to scalar when calculating the public inputs hash. Only RSA 256 is supported currently"});let e=(function(e){let t=[];for(let i=0;i<e.length;i+=24){let r=e.slice(i,Math.min(i+24,e.length));if(r.length<24){let e=new Uint8Array(24);e.set(r),t.push(e)}else t.push(r)}return t})((function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4!=0;)t+="=";return new Uint8Array(eG.from(t,"base64"))})(this.n).reverse()).map(e=>td(e));return e.push(256n),tp(e)}static deserialize(t){let i=t.deserializeStr(),r=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeStr();return new e({kid:i,kty:r,alg:n,n:t.deserializeStr(),e:s})}},oT=((F=oT||{})[F.V1=0]="V1",F[F.DerivableV1=1]="DerivableV1",F)},38580:function(e,t,i){i.d(t,{r:function(){return n}});var r=i(79456);class n extends r.py{}},80033:function(e,t,i){i.d(t,{O:function(){return p}});var r=i(79456),n=i(55682),s=i(87120),a=i(12671),o=i(37666),c=i(64303),u=i(10475),l=i(38580),d=i(57735),f=i(96307);class p extends r.X2{static _platform=d.c0;constructor(e,t){super(e,t??(0,n.X5)(e,p._platform))}getRpc(e){if(e in this.config){let t="Mainnet"===this.network?u.ZcK.MAINNET:u.ZcK.TESTNET,i=new u.ScN({fullnode:this.config[e].rpc,network:t});return new u.gZG(i)}throw Error("No configuration available for chain: "+e)}getChain(e,t){if(e in this.config)return new l.r(e,this);throw Error("No configuration available for chain: "+e)}static nativeTokenId(e,t){if(!this.isSupportedChain(t))throw Error(`invalid chain: ${t}`);return s.D.tokenId(t,f.E)}static isNativeTokenId(e,t,i){return!!this.isSupportedChain(t)&&i.chain===t&&this.nativeTokenId(e,t)==i}static isSupportedChain(e){return(0,a.fm)(e)===p._platform}static async getDecimals(e,t,i,n){if((0,r.tY)(n)||n===f.E)return o.K(p._platform);let s=n.toString();return(await i.getFungibleAssetMetadataByAssetType({assetType:s})).decimals}static async getBalance(e,t,i,n,s){let a=(0,r.tY)(s)?f.E:s.toString();try{let e=await i.getCurrentFungibleAssetBalances({options:{where:{owner_address:{_eq:n},asset_type:{_eq:a}}}});return e[0]?.amount??null}catch(e){if(404===e.status)return null;throw e}}static async getBalances(e,t,i,r){try{let e=await i.getCurrentFungibleAssetBalances({options:{where:{owner_address:{_eq:r}}}}),t={};for(let i of e)i.asset_type&&(t["0x1::aptos_coin::AptosCoin"===i.asset_type?"native":i.asset_type]=i.amount);return t}catch(e){if(404===e.status)return{};throw e}}static async sendWait(e,t,i){let r=[];for(let e of i){let i=await t.transaction.submit.simple(e.transaction),n=await t.waitForTransaction({transactionHash:i.hash});r.push(n.hash)}return r}static async getLatestBlock(e){return Number((await e.getLedgerInfo()).block_height)}static async getLatestFinalizedBlock(e){return Number((await e.getLedgerInfo()).block_height)}static chainFromChainId(e){let t=c.I(p._platform,BigInt(e));if(!t)throw Error(`No matching chainId to determine network and chain: ${e}`);let[i,r]=t;return[i,r]}static async chainFromRpc(e){let t=await e.getLedgerInfo();return this.chainFromChainId(t.chain_id.toString())}}},87082:function(e,t,i){i.r(t),i.d(t,{default:function(){return f}});var r=i(34750),n=i(80033),s=i(85570),a=i(10475);async function o(e,t){let[i,r]=await n.O.chainFromRpc(e);return new c(r,a.mRj.fromPrivateKey({privateKey:new a.qN7(s.$v.decode(t))}),e)}class c{_chain;_account;_rpc;_debug;constructor(e,t,i,r){this._chain=e,this._account=t,this._rpc=i,this._debug=r}chain(){return this._chain}address(){return this._account.accountAddress.toString()}async signAndSend(e){let t=[];for(let i of e){let{description:e,transaction:r}=i;this._debug&&console.log(`Signing: ${e} for ${this.address()}`);let n=await this._rpc.transaction.build.simple({sender:this._account.accountAddress,data:r}),{hash:s}=await this._simSignSend(n);t.push(s)}return t}async _simSignSend(e){return await this._rpc.transaction.simulate.simple({signerPublicKey:this._account.publicKey,transaction:e}).then(e=>e.forEach(e=>{if(!e.success)throw Error(`Transaction failed: ${e.vm_status}
${JSON.stringify(e,null,2)}`)})),this._rpc.signAndSubmitTransaction({signer:this._account,transaction:e}).then(e=>this._rpc.waitForTransaction({transactionHash:e.hash}))}}var u=i(38580),l=i(57735),d=i(55682),f={Address:r.fy,Platform:n.O,getSigner:o,protocols:{WormholeCore:()=>i.e(413).then(i.bind(i,64413)),TokenBridge:()=>i.e(929).then(i.bind(i,54869)),CircleBridge:()=>i.e(416).then(i.bind(i,20774))},getChain:(e,t,i)=>new u.r(t,new n.O(e,(0,d.C_)(e,l.c0,{[t]:i})))}}}]);