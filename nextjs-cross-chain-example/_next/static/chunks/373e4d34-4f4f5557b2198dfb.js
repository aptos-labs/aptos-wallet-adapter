"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{9429:function(e,t,i){let r,n,s,a,o,c,u,l,d;function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t){return null!=e?e:t()}function g(e){let t;let i=e[0],r=1;for(;r<e.length;){let n=e[r],s=e[r+1];if(r+=2,("optionalAccess"===n||"optionalCall"===n)&&null==i)return;"access"===n||"optionalAccess"===n?(t=i,i=s(i)):("call"===n||"optionalCall"===n)&&(i=s((...e)=>i.call(t,...e)),t=void 0)}return i}Object.defineProperty(t,"__esModule",{value:!0});var f,y=i(11238),m=class e{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}static fromHex(t){return new e(y.j.hexInputToUint8Array(t))}read(e){if(this.offset+e>this.buffer.byteLength)throw Error("Reached to the end of buffer");let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}remaining(){return this.buffer.byteLength-this.offset}assertFinished(){if(0!==this.remaining())throw Error("Buffer has remaining bytes")}deserializeStr(){let e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeOptionStr(){return this.deserializeOption("string")}deserializeOption(e,t){if(this.deserializeBool()){if("string"===e)return this.deserializeStr();if("bytes"===e)return this.deserializeBytes();if("fixedBytes"===e){if(void 0===t)throw Error("Fixed bytes length not provided");return this.deserializeFixedBytes(t)}return this.deserialize(e)}}deserializeBytes(){let e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){let e=new Uint8Array(this.read(1))[0];if(1!==e&&0!==e)throw Error("Invalid boolean value");return 1===e}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){let e=this.deserializeU32();return BigInt(BigInt(this.deserializeU32())<<BigInt(32)|BigInt(e))}deserializeU128(){let e=this.deserializeU64();return BigInt(this.deserializeU64()<<BigInt(64)|e)}deserializeU256(){let e=this.deserializeU128();return BigInt(this.deserializeU128()<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<y.d;){let i=this.deserializeU8();if(e|=BigInt(127&i)<<BigInt(t),(128&i)==0)break;t+=7}if(e>y.d)throw Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}deserialize(e){return e.deserialize(this)}deserializeVector(e){let t=this.deserializeUleb128AsU32(),i=[];for(let r=0;r<t;r+=1)i.push(this.deserialize(e));return i}},_=class e extends y.l{constructor(e){super(),this.value=y.j.fromHexInput(e).toUint8Array()}serialize(e){e.serializeFixedBytes(this.value)}serializeForEntryFunction(e){e.serialize(this)}serializeForScriptFunction(e){e.serialize(this)}static deserialize(t,i){return new e(t.deserializeFixedBytes(i))}},A=class e extends y.l{constructor(e){super(),this.value=new _(e)}serialize(e){e.serialize(this.value)}serializeForEntryFunction(e){e.serializeU32AsUleb128(this.value.value.length),e.serialize(this)}static deserialize(t,i){return new e(_.deserialize(t,i).value)}},w=class e extends y.l{constructor(e){super(),y.n.call(void 0,e),this.value=e}serialize(e){e.serializeBool(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(5),e.serialize(this)}deserialize(e){return new z(e.deserializeU256())}static deserialize(t){return new e(t.deserializeBool())}},b=t.U8=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,0,y.b),this.value=e}serialize(e){e.serializeU8(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(0),e.serialize(this)}static deserialize(t){return new e(t.deserializeU8())}},v=t.U16=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,0,y.c),this.value=e}serialize(e){e.serializeU16(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(6),e.serialize(this)}static deserialize(t){return new e(t.deserializeU16())}},T=t.U32=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,0,y.d),this.value=e}serialize(e){e.serializeU32(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(7),e.serialize(this)}static deserialize(t){return new e(t.deserializeU32())}},E=t.U64=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,BigInt(0),y.e),this.value=BigInt(e)}serialize(e){e.serializeU64(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(1),e.serialize(this)}static deserialize(t){return new e(t.deserializeU64())}},S=t.U128=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,BigInt(0),y.f),this.value=BigInt(e)}serialize(e){e.serializeU128(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(2),e.serialize(this)}static deserialize(t){return new e(t.deserializeU128())}},z=t.U256=class e extends y.l{constructor(e){super(),y.p.call(void 0,e,BigInt(0),y.g),this.value=BigInt(e)}serialize(e){e.serializeU256(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(8),e.serialize(this)}static deserialize(t){return new e(t.deserializeU256())}},C=class e extends y.l{constructor(e){super(),this.values=e}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){if(void 0!==this.values[0]&&!(this.values[0]instanceof b)){new U(this.bcsToBytes()).serializeForScriptFunction(e);return}e.serializeU32AsUleb128(4),e.serialize(this)}static U8(t){let i;if(Array.isArray(t)&&0===t.length)i=[];else if(Array.isArray(t)&&"number"==typeof t[0])i=t;else if("string"==typeof t)i=Array.from(y.j.fromHexInput(t).toUint8Array());else if(t instanceof Uint8Array)i=Array.from(t);else throw Error("Invalid input type, must be an number[], Uint8Array, or hex string");return new e(i.map(e=>new b(e)))}static U16(t){return new e(t.map(e=>new v(e)))}static U32(t){return new e(t.map(e=>new T(e)))}static U64(t){return new e(t.map(e=>new E(e)))}static U128(t){return new e(t.map(e=>new S(e)))}static U256(t){return new e(t.map(e=>new z(e)))}static Bool(t){return new e(t.map(e=>new w(e)))}static MoveString(t){return new e(t.map(e=>new x(e)))}serialize(e){e.serializeVector(this.values)}static deserialize(t,i){let r=t.deserializeUleb128AsU32(),n=[];for(let e=0;e<r;e+=1)n.push(i.deserialize(t));return new e(n)}},U=t.Serialized=class e extends y.l{constructor(e){super(),this.value=y.j.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}serializeForEntryFunction(e){this.serialize(e)}serializeForScriptFunction(e){e.serializeU32AsUleb128(9),this.serialize(e)}static deserialize(t){return new e(t.deserializeBytes())}toMoveVector(e){let t=new m(this.bcsToBytes());return t.deserializeUleb128AsU32(),new C(t.deserializeVector(e))}},x=t.MoveString=class e extends y.l{constructor(e){super(),this.value=e}serialize(e){e.serializeStr(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){let t=new TextEncoder().encode(this.value);C.U8(t).serializeForScriptFunction(e)}static deserialize(t){return new e(t.deserializeStr())}},k=t.MoveOption=class e extends y.l{constructor(e){super(),"u">typeof e&&null!==e?this.vec=new C([e]):this.vec=new C([]),[this.value]=this.vec.values}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}unwrap(){if(this.isSome())return this.vec.values[0];throw Error("Called unwrap on a MoveOption with no value")}isSome(){return 1===this.vec.values.length}serialize(e){this.vec.serialize(e)}static U8(t){return new e(null!=t?new b(t):void 0)}static U16(t){return new e(null!=t?new v(t):void 0)}static U32(t){return new e(null!=t?new T(t):void 0)}static U64(t){return new e(null!=t?new E(t):void 0)}static U128(t){return new e(null!=t?new S(t):void 0)}static U256(t){return new e(null!=t?new z(t):void 0)}static Bool(t){return new e(null!=t?new w(t):void 0)}static MoveString(t){return new e(null!=t?new x(t):void 0)}static deserialize(t,i){return new e(C.deserialize(t,i).values[0])}},P=i(70395),I=class e extends y.l{constructor(t){super();let{data:i}=t,r=y.j.fromHexInput(i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`Authentication Key length should be ${e.LENGTH}`);this.data=r}serialize(e){e.serializeFixedBytes(this.data.toUint8Array())}static deserialize(t){let i=t.deserializeFixedBytes(e.LENGTH);return new e({data:i})}toUint8Array(){return this.data.toUint8Array()}static fromSchemeAndBytes(t){let{scheme:i,input:r}=t,n=new Uint8Array([...y.j.fromHexInput(r).toUint8Array(),i]),s=P.sha3_256.create();return s.update(n),new e({data:s.digest()})}static fromPublicKeyAndScheme(e){let{publicKey:t}=e;return t.authKey()}static fromPublicKey(e){let{publicKey:t}=e;return t.authKey()}derivedAddress(){return new y.ba(this.data.toUint8Array())}};I.LENGTH=32;var K=class extends y.l{async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return y.j.fromHexInput(e).toString()}},N=t.AccountPublicKey=class extends K{},$=class extends y.l{toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return y.j.fromHexInput(e).toString()}},F=class e extends ${constructor(e){super(),this.value=y.j.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}static deserialize(t){return new e(t.deserializeBytes())}},R=t.AbstractPublicKey=class extends N{constructor(e){super(),this.accountAddress=e}authKey(){return new I({data:this.accountAddress.toUint8Array()})}verifySignature(e){throw Error("This function is not implemented for AbstractPublicKey.")}async verifySignatureAsync(e){throw Error("This function is not implemented for AbstractPublicKey.")}serialize(e){throw Error("This function is not implemented for AbstractPublicKey.")}},B=i(61804),D=i(35243),O=i(82865),L=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(i(70078)),M=/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'?$/,H=t.APTOS_BIP44_REGEX=/^m\/44'\/637'\/[0-9]+'\/[0-9]+\/[0-9]+$/,V=t.KeyType=((r=V||{}).ED25519="ed25519 seed",r),q=t.HARDENED_OFFSET=2147483648;function j(e){return H.test(e)}function G(e){return M.test(e)}var W=(e,t)=>{let i=D.hmac.create(O.sha512,e).update(t).digest();return{key:i.slice(0,32),chainCode:i.slice(32)}},J=t.CKDPriv=({key:e,chainCode:t},i)=>{let r=new ArrayBuffer(4);new DataView(r).setUint32(0,i);let n=new Uint8Array(r),s=new Uint8Array([0]);return W(t,new Uint8Array([...s,...e,...n]))},Y=e=>e.replace(/'/g,""),X=t.splitPath=e=>e.split("/").slice(1).map(Y),Z=t.mnemonicToSeed=e=>{let t=e.trim().split(/\s+/).map(e=>e.toLowerCase()).join(" ");return L.mnemonicToSeedSync(t)},Q=class e{static formatPrivateKey(t,i){let r=e.AIP80_PREFIXES[i],n=t;return"string"==typeof n&&n.startsWith(r)&&(n=n.split("-")[2]),`${r}${y.j.fromHexInput(n).toString()}`}static parseHexInput(t,i,r){let n,s=e.AIP80_PREFIXES[i];if("string"==typeof t){if(r||t.startsWith(s)){if(t.startsWith(s))n=y.j.fromHexString(t.split("-")[2]);else throw r?Error("Invalid HexString input while parsing private key. Must AIP-80 compliant string."):Error("Invalid HexString input while parsing private key.")}else n=y.j.fromHexInput(t),!1!==r&&console.warn("[Aptos SDK] It is recommended that private keys are AIP-80 compliant (https://github.com/aptos-foundation/AIPs/blob/main/aips/aip-80.md). You can fix the private key by formatting it with `PrivateKey.formatPrivateKey(privateKey: string, type: 'ed25519' | 'secp256k1'): string`.")}else n=y.j.fromHexInput(t);return n}};Q.AIP80_PREFIXES={ed25519:"ed25519-priv-",secp256k1:"secp256k1-priv-",secp256r1:"secp256r1-priv-"};var ee=Q,et=i(62595),ei=class e extends K{constructor(e){super();let t=e.constructor.name;if(t===tX.name)this.publicKey=e,this.variant=0;else throw Error(`Unsupported key for EphemeralPublicKey - ${t}`)}verifySignature(e){let{message:t,signature:i}=e;return this.publicKey.verifySignature({message:t,signature:i.signature})}async verifySignatureAsync(e){return this.verifySignature(e)}serialize(e){if(this.publicKey instanceof tX)e.serializeU32AsUleb128(0),this.publicKey.serialize(e);else throw Error("Unknown public key type")}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(tX.deserialize(t));throw Error(`Unknown variant index for EphemeralPublicKey: ${i}`)}static isPublicKey(t){return t instanceof e}},er=t.EphemeralSignature=class e extends ${constructor(e){super();let t=e.constructor.name;if(t===t0.name)this.signature=e;else throw Error(`Unsupported signature for EphemeralSignature - ${t}`)}static fromHex(t){let i=new m(y.j.fromHexInput(t).toUint8Array());return e.deserialize(i)}serialize(e){if(this.signature instanceof t0)e.serializeU32AsUleb128(0),this.signature.serialize(e);else throw Error("Unknown signature type")}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(t0.deserialize(t));throw Error(`Unknown variant index for EphemeralSignature: ${i}`)}},en=i(32092),es=[en.poseidon1,en.poseidon2,en.poseidon3,en.poseidon4,en.poseidon5,en.poseidon6,en.poseidon7,en.poseidon8,en.poseidon9,en.poseidon10,en.poseidon11,en.poseidon12,en.poseidon13,en.poseidon14,en.poseidon15,en.poseidon16];function ea(e,t){return function(e,t){if(e.length>t)throw Error(`Inputted bytes of length ${e} is longer than ${t}`);return el(eo(e,t))}(new TextEncoder().encode(e),t)}function eo(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return(function(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return function(e){if(e.length>465)throw Error(`Can't pack more than 465.  Was given ${e.length} bytes`);return(function(e,t){let i=[];for(let t=0;t<e.length;t+=31)i.push(e.subarray(t,t+31));return i})(e,31).map(e=>ec(e))}(function(e,t){if(t<e.length)throw Error("Padded size must be greater than or equal to the input array size.");let i=new Uint8Array(t);i.set(e);for(let r=e.length;r<t;r+=1)i[r]=0;return i}(e,t))})(e,t).concat([BigInt(e.length)])}function ec(e){let t=BigInt(0);for(let i=e.length-1;i>=0;i-=1)t=t<<BigInt(8)|BigInt(e[i]);return t}function eu(e,t){let i=BigInt(e),r=new Uint8Array(t);for(let e=0;e<t;e+=1)r[e]=Number(i&BigInt(255)),i>>=BigInt(8);return r}function el(e){if(e.length>es.length)throw Error(`Unable to hash input of length ${e.length}.  Max input length is ${es.length}`);return es[e.length-1](e)}var ed=class extends y.l{},ep={mainnet:"https://api.mainnet.aptoslabs.com/v1/graphql",testnet:"https://api.testnet.aptoslabs.com/v1/graphql",devnet:"https://api.devnet.aptoslabs.com/v1/graphql",shelbynet:"https://api.shelbynet.shelby.xyz/v1/graphql",local:"http://127.0.0.1:8090/v1/graphql"},eh=t.NetworkToNodeAPI={mainnet:"https://api.mainnet.aptoslabs.com/v1",testnet:"https://api.testnet.aptoslabs.com/v1",devnet:"https://api.devnet.aptoslabs.com/v1",shelbynet:"https://api.shelbynet.shelby.xyz/v1",local:"http://127.0.0.1:8080/v1"},eg=t.NetworkToFaucetAPI={devnet:"https://faucet.devnet.aptoslabs.com",shelbynet:"https://faucet.shelbynet.shelby.xyz",local:"http://127.0.0.1:8081"},ef=t.NetworkToPepperAPI={mainnet:"https://api.mainnet.aptoslabs.com/keyless/pepper/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/pepper/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/pepper/v0",shelbynet:"https://api.devnet.aptoslabs.com/keyless/pepper/v0",local:"https://api.devnet.aptoslabs.com/keyless/pepper/v0"},ey=t.NetworkToProverAPI={mainnet:"https://api.mainnet.aptoslabs.com/keyless/prover/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/prover/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/prover/v0",shelbynet:"https://api.devnet.aptoslabs.com/keyless/prover/v0",local:"https://api.devnet.aptoslabs.com/keyless/prover/v0"},em=t.Network=((n=em||{}).MAINNET="mainnet",n.TESTNET="testnet",n.DEVNET="devnet",n.SHELBYNET="shelbynet",n.LOCAL="local",n.CUSTOM="custom",n),e_=t.NetworkToChainId={mainnet:1,testnet:2,local:4},eA=t.NetworkToNetworkName={mainnet:"mainnet",testnet:"testnet",devnet:"devnet",shelbynet:"shelbynet",local:"local",custom:"custom"},ew=((s=ew||{}).FULLNODE="Fullnode",s.INDEXER="Indexer",s.FAUCET="Faucet",s.PEPPER="Pepper",s.PROVER="Prover",s),eb=t.DEFAULT_MAX_GAS_AMOUNT=2e5,ev=t.DEFAULT_TXN_EXP_SEC_FROM_NOW=20,eT=t.DEFAULT_TXN_TIMEOUT_SEC=20,eE=t.APTOS_COIN="0x1::aptos_coin::AptosCoin",eS=t.APTOS_FA="0x000000000000000000000000000000000000000000000000000000000000000a",ez=t.RAW_TRANSACTION_SALT="APTOS::RawTransaction",eC=t.RAW_TRANSACTION_WITH_DATA_SALT="APTOS::RawTransactionWithData",eU=t.ACCOUNT_ABSTRACTION_SIGNING_DATA_SALT="APTOS::AASigningData",ex=t.ProcessorType=((a=ex||{}).ACCOUNT_RESTORATION_PROCESSOR="account_restoration_processor",a.ACCOUNT_TRANSACTION_PROCESSOR="account_transactions_processor",a.DEFAULT="default_processor",a.EVENTS_PROCESSOR="events_processor",a.FUNGIBLE_ASSET_PROCESSOR="fungible_asset_processor",a.STAKE_PROCESSOR="stake_processor",a.TOKEN_V2_PROCESSOR="token_v2_processor",a.USER_TRANSACTION_PROCESSOR="user_transaction_processor",a.OBJECT_PROCESSOR="objects_processor",a),ek=t.FIREBASE_AUTH_ISS_PATTERN=/^https:\/\/securetoken\.google\.com\/[a-zA-Z0-9-_]+$/;function eP(e,t){let i=new m(t.bcsToBytes());return e.deserialize(i)}var eI=((o=eI||{})[o.API_ERROR=0]="API_ERROR",o[o.EXTERNAL_API_ERROR=1]="EXTERNAL_API_ERROR",o[o.SESSION_EXPIRED=2]="SESSION_EXPIRED",o[o.INVALID_STATE=3]="INVALID_STATE",o[o.INVALID_SIGNATURE=4]="INVALID_SIGNATURE",o[o.UNKNOWN=5]="UNKNOWN",o),eK=t.KeylessErrorResolutionTip=((c=eK||{}).REAUTHENTICATE="Re-authentiate to continue using your keyless account",c.REAUTHENTICATE_UNSURE="Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support",c.UPDATE_REQUEST_PARAMS="Update the invalid request parameters and reauthenticate.",c.RATE_LIMIT_EXCEEDED="Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest.",c.SERVER_ERROR="Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",c.CALL_PRECHECK="Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing.",c.REINSTANTIATE="Try instantiating the account again.  Avoid manipulating the account object directly",c.JOIN_SUPPORT_GROUP="For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",c.UNKNOWN="Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",c),eN=t.KeylessErrorType=((u=eN||{})[u.EPHEMERAL_KEY_PAIR_EXPIRED=0]="EPHEMERAL_KEY_PAIR_EXPIRED",u[u.PROOF_NOT_FOUND=1]="PROOF_NOT_FOUND",u[u.ASYNC_PROOF_FETCH_FAILED=2]="ASYNC_PROOF_FETCH_FAILED",u[u.INVALID_PROOF_VERIFICATION_FAILED=3]="INVALID_PROOF_VERIFICATION_FAILED",u[u.INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND=4]="INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND",u[u.INVALID_JWT_SIG=5]="INVALID_JWT_SIG",u[u.INVALID_JWT_JWK_NOT_FOUND=6]="INVALID_JWT_JWK_NOT_FOUND",u[u.INVALID_JWT_ISS_NOT_RECOGNIZED=7]="INVALID_JWT_ISS_NOT_RECOGNIZED",u[u.INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED=8]="INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED",u[u.INVALID_TW_SIG_VERIFICATION_FAILED=9]="INVALID_TW_SIG_VERIFICATION_FAILED",u[u.INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND=10]="INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND",u[u.INVALID_EXPIRY_HORIZON=11]="INVALID_EXPIRY_HORIZON",u[u.JWT_PARSING_ERROR=12]="JWT_PARSING_ERROR",u[u.JWK_FETCH_FAILED=13]="JWK_FETCH_FAILED",u[u.JWK_FETCH_FAILED_FEDERATED=14]="JWK_FETCH_FAILED_FEDERATED",u[u.RATE_LIMIT_EXCEEDED=15]="RATE_LIMIT_EXCEEDED",u[u.PEPPER_SERVICE_INTERNAL_ERROR=16]="PEPPER_SERVICE_INTERNAL_ERROR",u[u.PEPPER_SERVICE_BAD_REQUEST=17]="PEPPER_SERVICE_BAD_REQUEST",u[u.PEPPER_SERVICE_OTHER=18]="PEPPER_SERVICE_OTHER",u[u.PROVER_SERVICE_INTERNAL_ERROR=19]="PROVER_SERVICE_INTERNAL_ERROR",u[u.PROVER_SERVICE_BAD_REQUEST=20]="PROVER_SERVICE_BAD_REQUEST",u[u.PROVER_SERVICE_OTHER=21]="PROVER_SERVICE_OTHER",u[u.FULL_NODE_CONFIG_LOOKUP_ERROR=22]="FULL_NODE_CONFIG_LOOKUP_ERROR",u[u.FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR=23]="FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR",u[u.FULL_NODE_JWKS_LOOKUP_ERROR=24]="FULL_NODE_JWKS_LOOKUP_ERROR",u[u.FULL_NODE_OTHER=25]="FULL_NODE_OTHER",u[u.SIGNATURE_TYPE_INVALID=26]="SIGNATURE_TYPE_INVALID",u[u.SIGNATURE_EXPIRED=27]="SIGNATURE_EXPIRED",u[u.MAX_EXPIRY_HORIZON_EXCEEDED=28]="MAX_EXPIRY_HORIZON_EXCEEDED",u[u.EPHEMERAL_SIGNATURE_VERIFICATION_FAILED=29]="EPHEMERAL_SIGNATURE_VERIFICATION_FAILED",u[u.TRAINING_WHEELS_SIGNATURE_MISSING=30]="TRAINING_WHEELS_SIGNATURE_MISSING",u[u.TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED=31]="TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED",u[u.PROOF_VERIFICATION_FAILED=32]="PROOF_VERIFICATION_FAILED",u[u.UNKNOWN=33]="UNKNOWN",u),e$={0:["The ephemeral keypair has expired.",2,"Re-authentiate to continue using your keyless account"],1:["The required proof could not be found.",3,"Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing."],2:["The required proof failed to fetch.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],3:["The provided proof is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],4:["The verification key used to authenticate was updated.",2,"Re-authentiate to continue using your keyless account"],5:["The JWK was found, but JWT failed verification",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],6:["The JWK required to verify the JWT could not be found. The JWK may have been rotated out.",2,"Re-authentiate to continue using your keyless account"],7:["The JWT issuer is not recognized.",3,"Update the invalid request parameters and reauthenticate."],8:["The JWT issuer is not supported by the Federated Keyless ",0,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],9:["The training wheels signature is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],10:["The public key used to verify the training wheels signature was not found.",2,"Re-authentiate to continue using your keyless account"],11:["The expiry horizon is invalid.",2,"Re-authentiate to continue using your keyless account"],13:["Failed to fetch JWKS.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],14:["Failed to fetch JWKS for Federated Keyless provider.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],15:["Rate limit exceeded. Too many requests in a short period.",0,"Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest."],16:["Internal error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],17:["Bad request sent to Pepper service.",0,"Update the invalid request parameters and reauthenticate."],18:["Unknown error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],19:["Internal error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],20:["Bad request sent to Prover service.",0,"Update the invalid request parameters and reauthenticate."],21:["Unknown error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],12:["Error when parsing JWT. This should never happen. Join https://t.me/+h5CN-W35yUFiYzkx for support",3,"Try instantiating the account again.  Avoid manipulating the account object directly"],22:["Error when looking up on-chain keyless configuration.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],23:["Error when looking up on-chain verification key.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],24:["Error when looking up on-chain JWKS.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],25:["Unknown error from full node.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],26:["The signature is not a valid Keyless signature.",4,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],27:["The ephemeral key pair used to sign the message has expired.",4,"Re-authentiate to continue using your keyless account"],28:["The expiry horizon on the signature exceeds the maximum allowed value.",4,"Re-authentiate to continue using your keyless account"],29:["Failed to verify the ephemeral signature with the ephemeral public key.",4,"Re-authentiate to continue using your keyless account"],30:["The training wheels signature is missing but is required by the Keyless configuration.",4,"Re-authentiate to continue using your keyless account"],31:["Failed to verify the training wheels signature with the training wheels public key.",4,"Re-authentiate to continue using your keyless account"],32:["The proof verification failed.",4,"Re-authentiate to continue using your keyless account"],33:["An unknown error has occurred.",5,"Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"]},eF=t.KeylessError=class e extends Error{constructor(t){let{innerError:i,category:r,resolutionTip:n,type:s,message:a=e$[s][0],details:o}=t;super(a),this.name="KeylessError",this.innerError=i,this.category=r,this.resolutionTip=n,this.type=s,this.details=o,this.message=e.constructMessage(a,n,i,o)}static constructMessage(e,t,i,r){let n=`
Message: ${e}`;return r&&(n+=`
Details: ${r}`),i instanceof eR?n+=`
AptosApiError: ${i.message}`:void 0!==i&&(n+=`
Error: ${y.ga.call(void 0,i)}`),n+=`
KeylessErrorResolutionTip: ${t}`}static fromErrorType(t){let{error:i,type:r,details:n}=t,[s,a,o]=e$[r];return new e({message:s,details:n,innerError:i,category:a,resolutionTip:o,type:r})}},eR=t.AptosApiError=class extends Error{constructor({apiType:e,aptosRequest:t,aptosResponse:i}){super(function({apiType:e,aptosRequest:t,aptosResponse:i}){let r,n=g([i,"access",e=>e.headers,"optionalAccess",e=>e.traceparent,"optionalAccess",e=>e.split,"call",e=>e("-"),"access",e=>e[1]]),s=n?`(trace_id:${n}) `:"",a=`Request to [${e}]: ${t.method} ${h(i.url,()=>t.url)} ${s}failed with`;return"Indexer"===e&&null!=g([i,"access",e=>e.data,"optionalAccess",e=>e.errors,"optionalAccess",e=>e[0],"optionalAccess",e=>e.message])?`${a}: ${i.data.errors[0].message}`:null!=g([i,"access",e=>e.data,"optionalAccess",e=>e.message])&&null!=g([i,"access",e=>e.data,"optionalAccess",e=>e.error_code])?`${a}: ${JSON.stringify(i.data)}`:`${a} status: ${i.statusText}(code:${i.status}) and response body: ${(r=JSON.stringify(i.data)).length<=400?r:`truncated(original_size:${r.length}): ${r.slice(0,200)}...${r.slice(-200)}`}`}({apiType:e,aptosRequest:t,aptosResponse:i})),this.name="AptosApiError",this.url=i.url,this.status=i.status,this.statusText=i.statusText,this.data=i.data,this.request=t}};async function eB(e,t){let{url:i,method:r,body:n,contentType:s,params:a,overrides:o,originMethod:c}=e,u={...g([o,"optionalAccess",e=>e.HEADERS]),"x-aptos-client":"aptos-typescript-sdk/5.1.1","content-type":h(s,()=>"application/json"),"x-aptos-typescript-sdk-origin-method":c};return g([o,"optionalAccess",e=>e.AUTH_TOKEN])&&(u.Authorization=`Bearer ${g([o,"optionalAccess",e=>e.AUTH_TOKEN])}`),g([o,"optionalAccess",e=>e.API_KEY])&&(u.Authorization=`Bearer ${g([o,"optionalAccess",e=>e.API_KEY])}`),t.provider({url:i,method:r,body:n,params:a,headers:u,overrides:o})}async function eD(e,t,i){let{url:r,path:n}=e,s=n?`${r}/${n}`:r,a=await eB({...e,url:s},t.client),o={status:a.status,statusText:h(a.statusText,()=>"No status text provided"),data:a.data,headers:a.headers,config:a.config,request:a.request,url:s};if(401===o.status)throw new eR({apiType:i,aptosRequest:e,aptosResponse:o});if("Indexer"===i){let t=o.data;if(t.errors)throw new eR({apiType:i,aptosRequest:e,aptosResponse:o});o.data=t.data}else if(("Pepper"===i||"Prover"===i)&&o.status>=400)throw new eR({apiType:i,aptosRequest:e,aptosResponse:o});if(o.status>=200&&o.status<300)return o;throw new eR({apiType:i,aptosRequest:e,aptosResponse:o})}async function eO(e){let{aptosConfig:t,overrides:i,params:r,contentType:n,acceptType:s,path:a,originMethod:o,type:c}=e;return eD({url:t.getRequestUrl(c),method:"GET",originMethod:o,path:a,contentType:n,acceptType:s,params:r,overrides:{...t.clientConfig,...i}},t,e.type)}async function eL(e){let{aptosConfig:t}=e;return eO({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...g([t,"access",e=>e.clientConfig,"optionalAccess",e=>e.HEADERS]),...g([t,"access",e=>e.fullnodeConfig,"optionalAccess",e=>e.HEADERS])}}})}async function eM(e){return eO({...e,type:"Pepper"})}async function eH(e){let t=[],i,r=e.params;do{let n=await eO({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:r,overrides:e.overrides});i=n.headers["x-aptos-cursor"],delete n.headers,t.push(...n.data),r.start=i}while(null!=i);return t}async function eV(e){let t=[],i,r=e.params,n=r.limit;do{let{response:s,cursor:a}=await eq({...e});if(i=a,t.push(...s.data),g([e,"optionalAccess",e=>e.params])&&(e.params.start=i),void 0!==n){let e=n-t.length;if(e<=0)break;r.limit=e}}while(null!=i);return t}async function eq(e){let t,i={};"string"==typeof g([e,"access",e=>e.params,"optionalAccess",e=>e.cursor])&&(i.start=e.params.cursor),"number"==typeof g([e,"access",e=>e.params,"optionalAccess",e=>e.limit])&&(i.limit=e.params.limit);let r=await eO({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:i,overrides:e.overrides});return t=r.headers["x-aptos-cursor"],{response:r,cursor:t}}async function ej(e){let{type:t,originMethod:i,path:r,body:n,acceptType:s,contentType:a,params:o,aptosConfig:c,overrides:u}=e;return eD({url:c.getRequestUrl(t),method:"POST",originMethod:i,path:r,body:n,contentType:a,acceptType:s,params:o,overrides:u},c,e.type)}async function eG(e){let{aptosConfig:t}=e;return ej({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...g([t,"access",e=>e.clientConfig,"optionalAccess",e=>e.HEADERS]),...g([t,"access",e=>e.fullnodeConfig,"optionalAccess",e=>e.HEADERS])}}})}async function eW(e){let{aptosConfig:t}=e;return ej({...e,type:"Indexer",overrides:{...t.clientConfig,...t.indexerConfig,...e.overrides,HEADERS:{...g([t,"access",e=>e.clientConfig,"optionalAccess",e=>e.HEADERS]),...g([t,"access",e=>e.indexerConfig,"optionalAccess",e=>e.HEADERS])}}})}async function eJ(e){let{aptosConfig:t}=e,i={...t,clientConfig:{...t.clientConfig}};return g([i,"optionalAccess",e=>e.clientConfig,"optionalAccess",e=>delete e.API_KEY]),ej({...e,type:"Faucet",overrides:{...i.clientConfig,...i.faucetConfig,...e.overrides,HEADERS:{...g([i,"access",e=>e.clientConfig,"optionalAccess",e=>e.HEADERS]),...g([i,"access",e=>e.faucetConfig,"optionalAccess",e=>e.HEADERS])}}})}async function eY(e){return ej({...e,type:"Pepper"})}async function eX(e){return ej({...e,type:"Prover"})}var eZ=new Map;function eQ(e,t,i){return async(...r)=>{if(eZ.has(t)){let{value:e,timestamp:r}=eZ.get(t);if(void 0===i||Date.now()-r<=i)return e}let n=await e(...r);return eZ.set(t,{value:n,timestamp:Date.now()}),n}}var e0=i(19845),e2=i(3536),e1=i(70468),e8=t.MAX_AUD_VAL_BYTES=120,e3=t.MAX_UID_KEY_BYTES=30,e5=t.MAX_UID_VAL_BYTES=330,e6=t.MAX_ISS_VAL_BYTES=120,e4=t.MAX_EXTRA_FIELD_BYTES=350,e9=t.MAX_JWT_HEADER_B64_BYTES=300,e7=t.MAX_COMMITED_EPK_BYTES=93,te=class e extends N{constructor(t,i){super();let r=y.j.fromHexInput(i).toUint8Array();if(r.length!==e.ID_COMMITMENT_LENGTH)throw Error(`Id Commitment length in bytes should be ${e.ID_COMMITMENT_LENGTH}`);this.iss=t,this.idCommitment=r}authKey(){let e=new y.m;return e.serializeU32AsUleb128(3),e.serializeFixedBytes(this.bcsToBytes()),I.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return ti({...e,publicKey:this}),!0}catch(e){if(e instanceof eF)return!1;throw e}}async verifySignatureAsync(e){return tt({...e,publicKey:this})}serialize(e){e.serializeStr(this.iss),e.serializeBytes(this.idCommitment)}static deserialize(t){return new e(t.deserializeStr(),t.deserializeBytes())}static load(t){return new e(t.deserializeStr(),t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static create(t){return tn(t),new e(t.iss,tn(t))}static fromJwtAndPepper(t){let{jwt:i,pepper:r,uidKey:n="sub"}=t,s=et.jwtDecode.call(void 0,i);if("string"!=typeof s.iss)throw Error("iss was not found");if("string"!=typeof s.aud)throw Error("aud was not found or an array of values");let a=s[n];return e.create({iss:s.iss,uidKey:n,uidVal:a,aud:s.aud,pepper:r})}static isInstance(e){return"iss"in e&&"string"==typeof e.iss&&"idCommitment"in e&&e.idCommitment instanceof Uint8Array}};async function tt(e){let{aptosConfig:t,publicKey:i,message:r,signature:n,jwk:s,keylessConfig:a=await ty({aptosConfig:t}),options:o}=e;try{if(!(n instanceof ts))throw eF.fromErrorType({type:26,details:"Not a keyless signature"});return ti({message:r,publicKey:i,signature:n,jwk:s||await tr({aptosConfig:t,publicKey:i,kid:n.getJwkKid()}),keylessConfig:a}),!0}catch(e){if(g([o,"optionalAccess",e=>e.throwErrorWithReason]))throw e;return!1}}function ti(e){let{publicKey:t,message:i,signature:r,keylessConfig:n,jwk:s}=e,{verificationKey:a,maxExpHorizonSecs:o,trainingWheelsPubkey:c}=n;if(!(r instanceof ts))throw eF.fromErrorType({type:26,details:"Not a keyless signature"});if(!(r.ephemeralCertificate.signature instanceof th))throw eF.fromErrorType({type:26,details:"Unsupported ephemeral certificate variant"});let u=r.ephemeralCertificate.signature;if(!(u.proof.proof instanceof tl))throw eF.fromErrorType({type:26,details:"Unsupported proof variant for ZeroKnowledgeSig"});let l=u.proof.proof;if(r.expiryDateSecs<y.ha.call(void 0))throw eF.fromErrorType({type:27,details:"The expiryDateSecs is in the past"});if(u.expHorizonSecs>o)throw eF.fromErrorType({type:28});if(!r.ephemeralPublicKey.verifySignature({message:i,signature:r.ephemeralSignature}))throw eF.fromErrorType({type:29});let d=function(e){let{publicKey:t,signature:i,jwk:r,keylessConfig:n}=e,s=t instanceof te?t:t.keylessPublicKey;if(!(i.ephemeralCertificate.signature instanceof th))throw Error("Signature is not a ZeroKnowledgeSig");let a=i.ephemeralCertificate.signature,o=[];return o.push(...eo(i.ephemeralPublicKey.toUint8Array(),n.maxCommitedEpkBytes)),o.push(ec(s.idCommitment)),o.push(i.expiryDateSecs),o.push(a.expHorizonSecs),o.push(ea(s.iss,n.maxIssValBytes)),a.extraField?(o.push(1n),o.push(ea(a.extraField,n.maxExtraFieldBytes))):(o.push(0n),o.push(ea(" ",n.maxExtraFieldBytes))),o.push(ea(e1.encode.call(void 0,i.jwtHeader,!0)+".",n.maxJwtHeaderB64Bytes)),o.push(r.toScalar()),a.overrideAudVal?(o.push(ea(a.overrideAudVal,e8)),o.push(1n)):(o.push(ea("",e8)),o.push(0n)),el(o)}({publicKey:t,signature:r,jwk:s,keylessConfig:n});if(!a.verifyProof({publicInputsHash:d,groth16Proof:l}))throw eF.fromErrorType({type:32});if(c){if(!u.trainingWheelsSignature)throw eF.fromErrorType({type:30});let e=new td(l,d);if(!c.verifySignature({message:e.hash(),signature:u.trainingWheelsSignature}))throw eF.fromErrorType({type:31})}}async function tr(e){let{aptosConfig:t,publicKey:i,kid:r}=e,{iss:n}=i instanceof te?i:i.keylessPublicKey,s,a=i instanceof tT?i.jwkAddress:void 0;try{s=await tw({aptosConfig:t,jwkAddr:a})}catch(e){throw eF.fromErrorType({type:24,error:e,details:`Failed to fetch ${a?"Federated":"Patched"}JWKs ${a?`for address ${a}`:"0x1"}`})}let o=s.get(n);if(void 0===o)throw eF.fromErrorType({type:7,details:`JWKs for issuer ${n} not found.`});let c=o.find(e=>e.kid===r);if(void 0===c)throw eF.fromErrorType({type:6,details:`JWK with kid '${r}' for issuer '${n}' not found.`});return c}function tn(e){let{uidKey:t,uidVal:i,aud:r,pepper:n}=e;return eu(el([ec(y.j.fromHexInput(n).toUint8Array()),ea(r,e8),ea(i,e5),ea(t,e3)]),te.ID_COMMITMENT_LENGTH)}te.ID_COMMITMENT_LENGTH=32;var ts=class e extends ${constructor(e){super();let{jwtHeader:t,ephemeralCertificate:i,expiryDateSecs:r,ephemeralPublicKey:n,ephemeralSignature:s}=e;this.jwtHeader=t,this.ephemeralCertificate=i,this.expiryDateSecs=r,this.ephemeralPublicKey=n,this.ephemeralSignature=s}getJwkKid(){return tv(this.jwtHeader).kid}serialize(e){this.ephemeralCertificate.serialize(e),e.serializeStr(this.jwtHeader),e.serializeU64(this.expiryDateSecs),this.ephemeralPublicKey.serialize(e),this.ephemeralSignature.serialize(e)}static deserialize(t){let i=ta.deserialize(t),r=t.deserializeStr(),n=t.deserializeU64(),s=ei.deserialize(t),a=er.deserialize(t);return new e({jwtHeader:r,expiryDateSecs:Number(n),ephemeralCertificate:i,ephemeralPublicKey:s,ephemeralSignature:a})}static getSimulationSignature(){return new e({jwtHeader:"{}",ephemeralCertificate:new ta(new th({proof:new tp(new tl({a:new Uint8Array(32),b:new Uint8Array(64),c:new Uint8Array(32)}),0),expHorizonSecs:0}),0),expiryDateSecs:0,ephemeralPublicKey:new ei(new tX(new Uint8Array(32))),ephemeralSignature:new er(new t0(new Uint8Array(64)))})}static isSignature(t){return t instanceof e}},ta=t.EphemeralCertificate=class e extends ${constructor(e,t){super(),this.signature=e,this.variant=t}toUint8Array(){return this.signature.toUint8Array()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(th.deserialize(t),i);throw Error(`Unknown variant index for EphemeralCertificate: ${i}`)}},to=class e extends y.l{constructor(e){if(super(),this.data=y.j.fromHexInput(e).toUint8Array(),32!==this.data.length)throw Error("Input needs to be 32 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(32))}toArray(){let e=this.toProjectivePoint();return[e.x.toString(),e.y.toString(),e.pz.toString()]}toProjectivePoint(){let t=new Uint8Array(this.data);t.reverse();let i=(128&t[0])>>7,{Fp:r}=e0.bn254.fields,n=r.create(tc(t)),s=r.sqrt(r.add(r.pow(n,3n),e.B)),a=r.neg(s),o=s>a==(1===i)?s:a;return e0.bn254.G1.ProjectivePoint.fromAffine({x:n,y:o})}};function tc(e){if(32!==e.length)throw Error("Input should be 32 bytes");let t=new Uint8Array(e);return t[0]=63&t[0],e2.bytesToNumberBE.call(void 0,t)}to.B=e0.bn254.fields.Fp.create(3n);var tu=class e extends y.l{constructor(e){if(super(),this.data=y.j.fromHexInput(e).toUint8Array(),64!==this.data.length)throw Error("Input needs to be 64 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(64))}toArray(){let e=this.toProjectivePoint();return[[e.x.c0.toString(),e.x.c1.toString()],[e.y.c0.toString(),e.y.c1.toString()],[e.pz.c0.toString(),e.pz.c1.toString()]]}toProjectivePoint(){let t=new Uint8Array(this.data),i=t.slice(0,32).reverse(),r=t.slice(32,64).reverse(),n=(128&r[0])>>7,{Fp2:s}=e0.bn254.fields,a=s.fromBigTuple([tc(i),tc(r)]),o=s.sqrt(s.add(s.pow(a,3n),e.B)),c=s.neg(o),u=(o.c1>c.c1||o.c1===c.c1&&o.c0>c.c0)==(1===n)?o:c;return e0.bn254.G2.ProjectivePoint.fromAffine({x:a,y:u})}};tu.B=e0.bn254.fields.Fp2.fromBigTuple([0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n,0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n]);var tl=t.Groth16Zkp=class e extends ed{constructor(e){super();let{a:t,b:i,c:r}=e;this.a=new to(t),this.b=new tu(i),this.c=new to(r)}serialize(e){this.a.serialize(e),this.b.serialize(e),this.c.serialize(e)}static deserialize(t){return new e({a:to.deserialize(t).bcsToBytes(),b:tu.deserialize(t).bcsToBytes(),c:to.deserialize(t).bcsToBytes()})}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",pi_a:this.a.toArray(),pi_b:this.b.toArray(),pi_c:this.c.toArray()}}},td=t.Groth16ProofAndStatement=class e extends y.l{constructor(e,t){if(super(),this.domainSeparator="APTOS::Groth16ProofAndStatement",this.proof=e,this.publicInputsHash="bigint"==typeof t?eu(t,32):y.j.fromHexInput(t).toUint8Array(),32!==this.publicInputsHash.length)throw Error("Invalid public inputs hash")}serialize(e){this.proof.serialize(e),e.serializeFixedBytes(this.publicInputsHash)}static deserialize(t){return new e(tl.deserialize(t),t.deserializeFixedBytes(32))}hash(){return i0(this.bcsToBytes(),this.domainSeparator)}},tp=t.ZkProof=class e extends y.l{constructor(e,t){super(),this.proof=e,this.variant=t}serialize(e){e.serializeU32AsUleb128(this.variant),this.proof.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0===i)return new e(tl.deserialize(t),i);throw Error(`Unknown variant index for ZkProof: ${i}`)}},th=t.ZeroKnowledgeSig=class e extends ${constructor(e){super();let{proof:t,expHorizonSecs:i,trainingWheelsSignature:r,extraField:n,overrideAudVal:s}=e;this.proof=t,this.expHorizonSecs=i,this.trainingWheelsSignature=r,this.extraField=n,this.overrideAudVal=s}static fromBytes(t){return e.deserialize(new m(t))}serialize(e){this.proof.serialize(e),e.serializeU64(this.expHorizonSecs),e.serializeOption(this.extraField),e.serializeOption(this.overrideAudVal),e.serializeOption(this.trainingWheelsSignature)}static deserialize(t){let i=tp.deserialize(t),r=Number(t.deserializeU64()),n=t.deserializeOption("string"),s=t.deserializeOption("string");return new e({proof:i,expHorizonSecs:r,trainingWheelsSignature:t.deserializeOption(er),extraField:n,overrideAudVal:s})}},tg=t.KeylessConfiguration=class e{constructor(e){let{verificationKey:t,trainingWheelsPubkey:i,maxExpHorizonSecs:r=1e7,maxExtraFieldBytes:n=e4,maxJwtHeaderB64Bytes:s=e9,maxIssValBytes:a=e6,maxCommitedEpkBytes:o=e7}=e;this.verificationKey=t,this.maxExpHorizonSecs=r,i&&(this.trainingWheelsPubkey=new ei(new tX(i))),this.maxExtraFieldBytes=n,this.maxJwtHeaderB64Bytes=s,this.maxIssValBytes=a,this.maxCommitedEpkBytes=o}static create(t,i){return new e({verificationKey:new tf({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2}),maxExpHorizonSecs:Number(i.max_exp_horizon_secs),trainingWheelsPubkey:i.training_wheels_pubkey.vec[0],maxExtraFieldBytes:i.max_extra_field_bytes,maxJwtHeaderB64Bytes:i.max_jwt_header_b64_bytes,maxIssValBytes:i.max_iss_val_bytes,maxCommitedEpkBytes:i.max_commited_epk_bytes})}},tf=t.Groth16VerificationKey=class e{constructor(e){let{alphaG1:t,betaG2:i,deltaG2:r,gammaAbcG1:n,gammaG2:s}=e;this.alphaG1=new to(t),this.betaG2=new tu(i),this.deltaG2=new tu(r),this.gammaAbcG1=[new to(n[0]),new to(n[1])],this.gammaG2=new tu(s)}hash(){let e=new y.m;return this.serialize(e),P.sha3_256.create().update(e.toUint8Array()).digest()}serialize(e){this.alphaG1.serialize(e),this.betaG2.serialize(e),this.deltaG2.serialize(e),this.gammaAbcG1[0].serialize(e),this.gammaAbcG1[1].serialize(e),this.gammaG2.serialize(e)}static fromGroth16VerificationKeyResponse(t){return new e({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2})}verifyProof(e){let{publicInputsHash:t,groth16Proof:i}=e;try{let e=i.a.toProjectivePoint(),r=i.b.toProjectivePoint(),n=i.c.toProjectivePoint(),s=this.alphaG1.toProjectivePoint(),a=this.betaG2.toProjectivePoint(),o=this.gammaG2.toProjectivePoint(),c=this.deltaG2.toProjectivePoint(),u=this.gammaAbcG1.map(e=>e.toProjectivePoint()),{Fp12:l}=e0.bn254.fields,d=u[0].add(u[1].multiply(t)),p=e0.bn254.pairing(d,o),h=e0.bn254.pairing(e,r),g=e0.bn254.pairing(s,a),f=e0.bn254.pairing(n,c),y=l.mul(g,l.mul(p,f));return l.eql(h,y)}catch(e){throw eF.fromErrorType({type:32,error:e,details:"Error encountered when checking zero knowledge relation"})}}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",nPublic:1,vk_alpha_1:this.alphaG1.toArray(),vk_beta_2:this.betaG2.toArray(),vk_gamma_2:this.gammaG2.toArray(),vk_delta_2:this.deltaG2.toArray(),IC:this.gammaAbcG1.map(e=>e.toArray())}}};async function ty(e){let{aptosConfig:t}=e;try{return await eQ(async()=>{let[t,i]=await Promise.all([t_(e),tA(e)]);return tg.create(i,t)},`keyless-configuration-${t.network}`,3e5)()}catch(e){throw e instanceof eF?e:eF.fromErrorType({type:25,error:e})}}function tm(e){let{jwt:t,uidKey:i="sub"}=e,r;try{r=et.jwtDecode.call(void 0,t)}catch(e){throw eF.fromErrorType({type:12,details:`Failed to parse JWT - ${y.ga.call(void 0,e)}`})}if("string"!=typeof r.iss)throw eF.fromErrorType({type:12,details:"JWT is missing 'iss' in the payload. This should never happen."});if("string"!=typeof r.aud)throw eF.fromErrorType({type:12,details:"JWT is missing 'aud' in the payload or 'aud' is an array of values."});let n=r[i];return{iss:r.iss,aud:r.aud,uidVal:n}}async function t_(e){let{aptosConfig:t,options:i}=e;try{let{data:e}=await eL({aptosConfig:t,originMethod:"getKeylessConfigurationResource",path:`accounts/${y.ba.from("0x1").toString()}/resource/0x1::keyless_account::Configuration`,params:{ledger_version:g([i,"optionalAccess",e=>e.ledgerVersion])}});return e.data}catch(e){throw eF.fromErrorType({type:22,error:e})}}async function tA(e){let{aptosConfig:t,options:i}=e;try{let{data:e}=await eL({aptosConfig:t,originMethod:"getGroth16VerificationKeyResource",path:`accounts/${y.ba.from("0x1").toString()}/resource/0x1::keyless_account::Groth16VerificationKey`,params:{ledger_version:g([i,"optionalAccess",e=>e.ledgerVersion])}});return e.data}catch(e){throw eF.fromErrorType({type:23,error:e})}}async function tw(e){let{aptosConfig:t,jwkAddr:i,options:r}=e,n;if(i){let{data:e}=await eL({aptosConfig:t,originMethod:"getKeylessJWKs",path:`accounts/${y.ba.from(i).toString()}/resource/0x1::jwks::FederatedJWKs`,params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion])}});n=e}else{let{data:e}=await eL({aptosConfig:t,originMethod:"getKeylessJWKs",path:"accounts/0x1/resource/0x1::jwks::PatchedJWKs",params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion])}});n=e}let s=new Map;for(let e of n.data.jwks.entries){let t=[];for(let i of e.jwks){let{data:e}=i.variant,r=new m(y.j.fromHexInput(e).toUint8Array()),n=tb.deserialize(r);t.push(n)}s.set(y.k.call(void 0,e.issuer),t)}return s}var tb=class e extends y.l{constructor(e){super();let{kid:t,kty:i,alg:r,e:n,n:s}=e;this.kid=t,this.kty=i,this.alg=r,this.e=n,this.n=s}serialize(e){e.serializeStr(this.kid),e.serializeStr(this.kty),e.serializeStr(this.alg),e.serializeStr(this.e),e.serializeStr(this.n)}static fromMoveStruct(t){let{data:i}=t.variant,r=new m(y.j.fromHexInput(i).toUint8Array());return e.deserialize(r)}toScalar(){if("RS256"!==this.alg)throw eF.fromErrorType({type:32,details:"Failed to convert JWK to scalar when calculating the public inputs hash. Only RSA 256 is supported currently"});let e=(function(e){let t=[];for(let i=0;i<e.length;i+=24){let r=e.slice(i,Math.min(i+24,e.length));if(r.length<24){let e=new Uint8Array(24);e.set(r),t.push(e)}else t.push(r)}return t})(y.ka.call(void 0,this.n).reverse()).map(e=>ec(e));return e.push(256n),el(e)}static deserialize(t){let i=t.deserializeStr(),r=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeStr();return new e({kid:i,kty:r,alg:n,n:t.deserializeStr(),e:s})}};function tv(e){try{let t=JSON.parse(e);if(void 0===t.kid)throw Error("JWT header missing kid");return t}catch(e){throw Error("Failed to parse JWT header.")}}var tT=class e extends N{constructor(e,t){super(),this.jwkAddress=y.ba.from(e),this.keylessPublicKey=t}authKey(){let e=new y.m;return e.serializeU32AsUleb128(4),e.serializeFixedBytes(this.bcsToBytes()),I.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return ti({...e,publicKey:this}),!0}catch(e){return!1}}serialize(e){this.jwkAddress.serialize(e),this.keylessPublicKey.serialize(e)}static deserialize(t){return new e(y.ba.deserialize(t),te.deserialize(t))}static isPublicKey(t){return t instanceof e}async verifySignatureAsync(e){return tt({...e,publicKey:this})}static create(t){return new e(t.jwkAddress,te.create(t))}static fromJwtAndPepper(t){return new e(t.jwkAddress,te.fromJwtAndPepper(t))}static isInstance(e){return"jwkAddress"in e&&e.jwkAddress instanceof y.ba&&"keylessPublicKey"in e&&e.keylessPublicKey instanceof te}},tE=i(72293),tS=i(88397),tz=class e extends K{constructor(t){super(),this.keyType="secp256k1";let i=y.j.fromHexInput(t),{length:r}=i.toUint8Array();if(r===e.LENGTH)this.key=i;else if(r===e.COMPRESSED_LENGTH){let e=tE.secp256k1.ProjectivePoint.fromHex(i.toUint8Array());this.key=y.j.fromHexInput(e.toRawBytes(!1))}else throw Error(`PublicKey length should be ${e.LENGTH} or ${e.COMPRESSED_LENGTH}, received ${r}`)}verifySignature(e){let{message:t,signature:i}=e,r=tq(t),n=y.j.fromHexInput(r).toUint8Array(),s=P.sha3_256.call(void 0,n),a=i.toUint8Array();return tE.secp256k1.verify(a,s,this.key.toUint8Array(),{lowS:!0})}async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}deserialize(e){return new tx(e.deserializeBytes())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&g([t,"access",e=>e.key,"optionalAccess",e=>e.data,"optionalAccess",e=>e.length])===e.LENGTH&&"keyType"in t&&"secp256k1"===t.keyType}};tz.LENGTH=65,tz.COMPRESSED_LENGTH=33;var tC=class e extends y.l{constructor(t,i){super();let r=ee.parseHexInput(t,"secp256k1",i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.key=r}static generate(){return new e(tE.secp256k1.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,i){if(!j(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,Z(i))}static fromDerivationPathInner(t,i){let{privateKey:r}=tS.HDKey.fromMasterSeed(i).derive(t);if(null===r)throw Error("Invalid key");return new e(r,!1)}sign(e){let t=tq(e),i=y.j.fromHexInput(t),r=P.sha3_256.call(void 0,i.toUint8Array());return new tx(tE.secp256k1.sign(r,this.key.toUint8Array(),{lowS:!0}).toCompactRawBytes())}publicKey(){return new tz(tE.secp256k1.getPublicKey(this.key.toUint8Array(),!1))}toUint8Array(){return this.key.toUint8Array()}toString(){return this.toAIP80String()}toHexString(){return this.key.toString()}toAIP80String(){return ee.formatPrivateKey(this.key.toString(),"secp256k1")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};tC.LENGTH=32;var tU=class e extends ${constructor(t){super();let i=y.j.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}, received ${i.toUint8Array().length}`);this.data=i}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tU.LENGTH=64;var tx=tU,tk=i(31044),tP=class e extends K{constructor(t){super(),this.keyType="secp256r1";let i=y.j.fromHexInput(t),r=i.toUint8Array().length;if(r!==e.LENGTH&&r!==e.COMPRESSED_LENGTH)throw Error(`PublicKey length should be ${e.LENGTH} or ${e.COMPRESSED_LENGTH}, received ${r}`);if(r===e.COMPRESSED_LENGTH){let e=tk.p256.ProjectivePoint.fromHex(i.toUint8Array());this.key=y.j.fromHexInput(e.toRawBytes(!1))}else this.key=i}toUint8Array(){return this.key.toUint8Array()}toString(){return this.key.toString()}bcsToBytes(){let e=new y.m;return this.serialize(e),e.toUint8Array()}verifySignature(e){let{message:t,signature:i}=e,r=y.j.fromHexInput(t).toUint8Array(),n=P.sha3_256.call(void 0,r),s=i.toUint8Array();return tk.p256.verify(s,n,this.toUint8Array())}async verifySignatureAsync(e){return this.verifySignature({message:e.message,signature:e.signature})}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}static load(t){return new e(t.deserializeBytes())}static isInstance(t){return"key"in t&&g([t,"access",e=>e.key,"optionalAccess",e=>e.data,"optionalAccess",e=>e.length])===e.LENGTH&&"keyType"in t&&"secp256r1"===t.keyType}authKey(){let e=new y.m;return e.serializeU32AsUleb128(2),e.serializeFixedBytes(this.bcsToBytes()),I.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}};tP.LENGTH=65,tP.COMPRESSED_LENGTH=33;var tI=class e extends ee{constructor(t,i){super();let r=ee.parseHexInput(t,"secp256r1",i),n=r.toUint8Array().length;if(n!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}, received ${n}`);this.key=r}toUint8Array(){return this.key.toUint8Array()}toString(){return ee.formatPrivateKey(this.key.toString(),"secp256r1")}toHexString(){return this.key.toString()}sign(e){let t=y.j.fromHexInput(e),i=P.sha3_256.call(void 0,t.toUint8Array());return new t$(tk.p256.sign(i,this.key.toUint8Array()).toCompactRawBytes())}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}static generate(){return new e(tk.p256.utils.randomPrivateKey())}publicKey(){return new tP(tk.p256.getPublicKey(this.key.toUint8Array(),!1))}};tI.LENGTH=32;var tK=t.WebAuthnSignature=class e extends ${constructor(e,t,i){super(),this.signature=y.j.fromHexInput(e),this.authenticatorData=y.j.fromHexInput(t),this.clientDataJSON=y.j.fromHexInput(i)}toUint8Array(){return this.signature.toUint8Array()}serialize(e){e.serializeU32AsUleb128(0),e.serializeBytes(this.signature.toUint8Array()),e.serializeBytes(this.authenticatorData.toUint8Array()),e.serializeBytes(this.clientDataJSON.toUint8Array())}bcsToBytes(){let e=new y.m;return this.serialize(e),e.toUint8Array()}bcsToHex(){return y.j.fromHexInput(this.bcsToBytes())}toStringWithoutPrefix(){return y.j.fromHexInput(this.bcsToBytes()).toString()}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0!==i)throw Error(`Invalid id for WebAuthnSignature: ${i}`);return new e(t.deserializeBytes(),t.deserializeBytes(),t.deserializeBytes())}},tN=class e extends ${constructor(t){super();let i=y.j.fromHexInput(t),r=i.toUint8Array().length;if(r!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}, received ${r}`);let n=tk.p256.Signature.fromCompact(i.toUint8Array()).normalizeS().toCompactRawBytes();this.data=y.j.fromHexInput(n)}toUint8Array(){return this.data.toUint8Array()}toString(){return this.data.toString()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tN.LENGTH=64;var t$=tN,tF=class e extends N{constructor(e){if(super(),this.publicKey=e,e instanceof tX)this.variant=0;else if(e instanceof tz)this.variant=1;else if(e instanceof tP)this.variant=2;else if(e instanceof te)this.variant=3;else if(e instanceof tT)this.variant=4;else throw Error("Unsupported public key type")}verifySignature(e){let{message:t,signature:i}=e;if(this.publicKey instanceof te)throw Error("Use verifySignatureAsync to verify Keyless signatures");return this.publicKey.verifySignature({message:t,signature:i.signature})}async verifySignatureAsync(e){if(!(e.signature instanceof tR)){if(g([e,"access",e=>e.options,"optionalAccess",e=>e.throwErrorWithReason]))throw Error("Signature must be an instance of AnySignature");return!1}return await this.publicKey.verifySignatureAsync({...e,signature:e.signature.signature})}authKey(){return I.fromSchemeAndBytes({scheme:2,input:this.toUint8Array()})}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.publicKey.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;switch(i){case 0:r=tX.deserialize(t);break;case 1:r=tz.deserialize(t);break;case 2:r=tP.deserialize(t);break;case 3:r=te.deserialize(t);break;case 4:r=tT.deserialize(t);break;default:throw Error(`Unknown variant index for AnyPublicKey: ${i}`)}return new e(r)}static isPublicKey(t){return t instanceof e}isEd25519(){return this.publicKey instanceof tX}isSecp256k1PublicKey(){return this.publicKey instanceof tz}static isInstance(e){return"publicKey"in e&&"variant"in e}},tR=t.AnySignature=class e extends ${constructor(e){if(super(),this.signature=e,e instanceof t0)this.variant=0;else if(e instanceof tx)this.variant=1;else if(e instanceof tK)this.variant=2;else if(e instanceof ts)this.variant=3;else throw Error("Unsupported signature type")}toUint8Array(){return console.warn("[Aptos SDK] Calls to AnySignature.toUint8Array() will soon return the underlying signature bytes. Use AnySignature.bcsToBytes() instead."),this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;switch(i){case 0:r=t0.deserialize(t);break;case 1:r=tx.deserialize(t);break;case 2:r=tK.deserialize(t);break;case 3:r=ts.deserialize(t);break;default:throw Error(`Unknown variant index for AnySignature: ${i}`)}return new e(r)}static isInstance(e){return"signature"in e&&"object"==typeof e.signature&&null!==e.signature&&"toUint8Array"in e.signature}},tB=t.AbstractMultiKey=class extends N{constructor(e){super(),this.publicKeys=e.publicKeys}createBitmap(e){let{bits:t}=e,i=new Uint8Array([0,0,0,0]),r=new Set;return t.forEach((e,t)=>{if(t+1>this.publicKeys.length)throw Error(`Signature index ${t+1} is out of public keys range, ${this.publicKeys.length}.`);if(r.has(e))throw Error(`Duplicate bit ${e} detected.`);r.add(e);let n=Math.floor(e/8),s=i[n];s|=128>>e%8,i[n]=s}),i}getIndex(e){let t=this.publicKeys.findIndex(t=>t.toString()===e.toString());if(-1!==t)return t;throw Error(`Public key ${e} not found in multi key set ${this.publicKeys}`)}},tD=t.MultiKey=class e extends tB{constructor(e){let{publicKeys:t,signaturesRequired:i}=e;if(super({publicKeys:t}),i<1)throw Error("The number of required signatures needs to be greater than 0");if(t.length<i)throw Error(`Provided ${t.length} public keys is smaller than the ${i} required signatures`);if(this.publicKeys=t.map(e=>e instanceof tF?e:new tF(e)),i>3&&this.publicKeys.filter(e=>3===e.variant||4===e.variant).length>3)throw Error(`Construction of MultiKey with more than 3 keyless public keys is not allowed when signaturesRequired 
          is greater than 3. This is because a maximum of 3 keyless signatures are supported for a 
          K-of-N MultiKey transaction.`);this.signaturesRequired=i}getSignaturesRequired(){return this.signaturesRequired}verifySignature(e){let{message:t,signature:i}=e;if(i.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let r=i.bitMapToSignerIndices();for(let e=0;e<i.signatures.length;e+=1){let n=i.signatures[e];if(!this.publicKeys[r[e]].verifySignature({message:t,signature:n}))return!1}return!0}async verifySignatureAsync(e){let{signature:t}=e;try{if(!(t instanceof tL))throw Error("Signature is not a MultiKeySignature");if(t.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let i=t.bitMapToSignerIndices();for(let r=0;r<t.signatures.length;r+=1){let n=t.signatures[r];if(!await this.publicKeys[i[r]].verifySignatureAsync({...e,signature:n}))return!1}return!0}catch(t){if(g([e,"access",e=>e.options,"optionalAccess",e=>e.throwErrorWithReason]))throw t;return!1}}authKey(){return I.fromSchemeAndBytes({scheme:3,input:this.toUint8Array()})}serialize(e){e.serializeVector(this.publicKeys),e.serializeU8(this.signaturesRequired)}static deserialize(t){return new e({publicKeys:t.deserializeVector(tF),signaturesRequired:t.deserializeU8()})}getIndex(e){let t=e instanceof tF?e:new tF(e);return super.getIndex(t)}static isInstance(e){return"publicKeys"in e&&"signaturesRequired"in e}},tO=class e extends ${constructor(t){super();let{signatures:i,bitmap:r}=t;if(i.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=i.map(e=>e instanceof tR?e:new tR(e)),r instanceof Uint8Array){if(r.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=r}else this.bitmap=e.createBitmap({bits:r});let n=this.bitmap.reduce((e,t)=>{let i;return e+(i=t,i-=i>>1&1431655765,((i=(858993459&i)+(i>>2&858993459))+(i>>4)&252645135)*16843009>>24)},0);if(n!==this.signatures.length)throw Error(`Expecting ${n} signatures from the bitmap, but got ${this.signatures.length}`)}static createBitmap(t){let{bits:i}=t,r=new Uint8Array([0,0,0,0]),n=new Set;return i.forEach(t=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");n.add(t);let i=Math.floor(t/8),s=r[i];s|=128>>t%8,r[i]=s}),r}bitMapToSignerIndices(){let e=[];for(let t=0;t<this.bitmap.length;t+=1){let i=this.bitmap[t];for(let r=0;r<8;r+=1)(i&128>>r)!=0&&e.push(8*t+r)}return e}serialize(e){e.serializeVector(this.signatures),e.serializeBytes(this.bitmap)}static deserialize(t){return new e({signatures:t.deserializeVector(tR),bitmap:t.deserializeBytes()})}};tO.BITMAP_LEN=4,tO.MAX_SIGNATURES_SUPPORTED=8*tO.BITMAP_LEN;var tL=tO,tM=class e extends tB{constructor(t){let{publicKeys:i,threshold:r}=t;if(super({publicKeys:i}),i.length>e.MAX_KEYS||i.length<e.MIN_KEYS)throw Error(`Must have between ${e.MIN_KEYS} and ${e.MAX_KEYS} public keys, inclusive`);if(r<e.MIN_THRESHOLD||r>i.length)throw Error(`Threshold must be between ${e.MIN_THRESHOLD} and ${i.length}, inclusive`);this.publicKeys=i,this.threshold=r}getSignaturesRequired(){return this.threshold}verifySignature(e){let{message:t,signature:i}=e;if(!(i instanceof tV))return!1;let r=[];for(let e=0;e<4;e+=1)for(let t=0;t<8;t+=1)if((i.bitmap[e]&1<<7-t)!=0){let i=8*e+t;r.push(i)}if(r.length!==i.signatures.length)throw Error("Bitmap and signatures length mismatch");if(r.length<this.threshold)throw Error("Not enough signatures");for(let e=0;e<r.length;e+=1)if(!this.publicKeys[r[e]].verifySignature({message:t,signature:i.signatures[e]}))return!1;return!0}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return I.fromSchemeAndBytes({scheme:1,input:this.toUint8Array()})}toUint8Array(){let e=new Uint8Array(this.publicKeys.length*tX.LENGTH+1);return this.publicKeys.forEach((t,i)=>{e.set(t.toUint8Array(),i*tX.LENGTH)}),e[this.publicKeys.length*tX.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let i=t.deserializeBytes(),r=i[i.length-1],n=[];for(let e=0;e<i.length-1;e+=tX.LENGTH){let t=e;n.push(new tX(i.subarray(t,t+tX.LENGTH)))}return new e({publicKeys:n,threshold:r})}static deserializeWithoutLength(t){let i=t.remaining(),r=t.deserializeFixedBytes(i),n=r[r.length-1],s=[];for(let e=0;e<r.length-1;e+=tX.LENGTH){let t=e;s.push(new tX(r.subarray(t,t+tX.LENGTH)))}return new e({publicKeys:s,threshold:n})}getIndex(e){return super.getIndex(e)}};tM.MAX_KEYS=32,tM.MIN_KEYS=2,tM.MIN_THRESHOLD=1;var tH=class e extends ${constructor(t){super();let{signatures:i,bitmap:r}=t;if(i.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=i,r instanceof Uint8Array){if(r.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=r}else this.bitmap=e.createBitmap({bits:r})}toUint8Array(){let t=new Uint8Array(this.signatures.length*t0.LENGTH+e.BITMAP_LEN);return this.signatures.forEach((e,i)=>{t.set(e.toUint8Array(),i*t0.LENGTH)}),t.set(this.bitmap,this.signatures.length*t0.LENGTH),t}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let i=t.deserializeBytes(),r=i.subarray(i.length-4),n=[];for(let e=0;e<i.length-r.length;e+=t0.LENGTH){let t=e;n.push(new t0(i.subarray(t,t+t0.LENGTH)))}return new e({signatures:n,bitmap:r})}static createBitmap(t){let{bits:i}=t,r=new Uint8Array([0,0,0,0]),n=new Set;return i.forEach((t,s)=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");if(s>0&&t<=i[s-1])throw Error("The bits need to be sorted in ascending order.");n.add(t);let a=Math.floor(t/8),o=r[a];o|=128>>t%8,r[a]=o}),r}};tH.MAX_SIGNATURES_SUPPORTED=32,tH.BITMAP_LEN=4;var tV=tH,tq=e=>"string"==typeof e?y.j.isValid(e).valid?e:new TextEncoder().encode(e):e,tj=e=>{if(e instanceof tX||e instanceof tF||e instanceof tM||e instanceof tD)return e;if(e instanceof te||e instanceof tT)return new tF(e);throw Error(`Unknown account public key: ${e}`)},tG=e=>{let t=tj(e);if(t instanceof tX)return 0;if(t instanceof tF)return 2;if(t instanceof tM)return 1;if(t instanceof tD)return 3;throw Error(`Unknown signing scheme: ${t}`)},tW=[237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16];function tJ(e){let t=e.toUint8Array().slice(32);for(let e=tW.length-1;e>=0;e-=1){if(t[e]<tW[e])return!0;if(t[e]>tW[e])break}return!1}var tY=class e extends N{constructor(t){super();let i=y.j.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`PublicKey length should be ${e.LENGTH}`);this.key=i}verifySignature(e){let{message:t,signature:i}=e;if(!tJ(i))return!1;let r=tq(t),n=y.j.fromHexInput(r).toUint8Array(),s=i.toUint8Array(),a=this.key.toUint8Array();return B.ed25519.verify(s,n,a)}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return I.fromSchemeAndBytes({scheme:0,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&g([t,"access",e=>e.key,"optionalAccess",e=>e.data,"optionalAccess",e=>e.length])===e.LENGTH}};tY.LENGTH=32;var tX=tY,tZ=class e extends y.l{constructor(t,i){super();let r=ee.parseHexInput(t,"ed25519",i);if(r.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.signingKey=r}static generate(){return new e(B.ed25519.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,i){if(!G(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,Z(i))}static fromDerivationPathInner(t,i,r=q){let{key:n,chainCode:s}=W(e.SLIP_0010_SEED,i),{key:a}=X(t).map(e=>parseInt(e,10)).reduce((e,t)=>J(e,t+r),{key:n,chainCode:s});return new e(a,!1)}publicKey(){return new tX(B.ed25519.getPublicKey(this.signingKey.toUint8Array()))}sign(e){let t=tq(e),i=y.j.fromHexInput(t).toUint8Array();return new t0(B.ed25519.sign(i,this.signingKey.toUint8Array()))}toUint8Array(){return this.signingKey.toUint8Array()}toString(){return this.toAIP80String()}toHexString(){return this.signingKey.toString()}toAIP80String(){return ee.formatPrivateKey(this.signingKey.toString(),"ed25519")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};tZ.LENGTH=32,tZ.SLIP_0010_SEED="ed25519 seed";var tQ=class e extends ${constructor(t){super();let i=y.j.fromHexInput(t);if(i.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}`);this.data=i}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tQ.LENGTH=64;var t0=tQ,t2="Multiple possible deserializations found",t1=class extends y.l{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return t8.load(e);case 1:return t3.load(e);case 2:return t5.load(e);case 3:return t6.load(e);case 4:return t4.load(e);case 5:return t9.load(e);default:throw Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}isEd25519(){return this instanceof t8}isMultiEd25519(){return this instanceof t3}isSingleKey(){return this instanceof t5}isMultiKey(){return this instanceof t6}},t8=t.AccountAuthenticatorEd25519=class e extends t1{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tX.deserialize(t),t0.deserialize(t))}},t3=t.AccountAuthenticatorMultiEd25519=class e extends t1{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tM.deserialize(t),tV.deserialize(t))}},t5=t.AccountAuthenticatorSingleKey=class e extends t1{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(2),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tF.deserialize(t),tR.deserialize(t))}},t6=t.AccountAuthenticatorMultiKey=class e extends t1{constructor(e,t){super(),this.public_keys=e,this.signatures=t}serialize(e){e.serializeU32AsUleb128(3),this.public_keys.serialize(e),this.signatures.serialize(e)}static load(t){return new e(tD.deserialize(t),tL.deserialize(t))}},t4=t.AccountAuthenticatorNoAccountAuthenticator=class e extends t1{serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},t9=t.AccountAuthenticatorAbstraction=class e extends t1{constructor(e,t,i,r){if(super(),!y.qa.call(void 0,e))throw Error(`Invalid function info ${e} passed into AccountAuthenticatorAbstraction`);this.functionInfo=e,this.abstractionSignature=i,this.signingMessageDigest=y.j.fromHexInput(y.j.fromHexInput(t).toUint8Array()),this.accountIdentity=r}serialize(e){e.serializeU32AsUleb128(5);let{moduleAddress:t,moduleName:i,functionName:r}=y.pa.call(void 0,this.functionInfo);y.ba.fromString(t).serialize(e),e.serializeStr(i),e.serializeStr(r),this.accountIdentity?e.serializeU32AsUleb128(1):e.serializeU32AsUleb128(0),e.serializeBytes(this.signingMessageDigest.toUint8Array()),this.accountIdentity?e.serializeBytes(this.abstractionSignature):e.serializeFixedBytes(this.abstractionSignature),this.accountIdentity&&e.serializeBytes(this.accountIdentity)}static load(t){let i=y.ba.deserialize(t),r=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeUleb128AsU32(),a=t.deserializeBytes();if(0===s)return new e(`${i}::${r}::${n}`,a,t.deserializeFixedBytes(t.remaining()));if(1===s)return new e(`${i}::${r}::${n}`,a,t.deserializeBytes(),t.deserializeBytes());throw Error(`Unknown variant index for AccountAuthenticatorAbstraction: ${s}`)}},t7=t.AccountAbstractionMessage=class e extends y.l{constructor(e,t){super(),this.originalSigningMessage=y.j.fromHexInput(y.j.fromHexInput(e).toUint8Array()),this.functionInfo=t}serialize(e){e.serializeU32AsUleb128(0),e.serializeBytes(this.originalSigningMessage.toUint8Array());let{moduleAddress:t,moduleName:i,functionName:r}=y.pa.call(void 0,this.functionInfo);y.ba.fromString(t).serialize(e),e.serializeStr(i),e.serializeStr(r)}static deserialize(t){let i=t.deserializeUleb128AsU32();if(0!==i)throw Error(`Unknown variant index for AccountAbstractionMessage: ${i}`);let r=t.deserializeBytes(),n=y.ba.deserialize(t),s=t.deserializeStr(),a=t.deserializeStr();return new e(r,`${n}::${s}::${a}`)}},ie=class e extends y.l{constructor(e){super(),this.chainId=e}serialize(e){e.serializeU8(this.chainId)}static deserialize(t){return new e(t.deserializeU8())}},it=class e extends y.l{constructor(e){super(),this.identifier=e}serialize(e){e.serializeStr(this.identifier)}static deserialize(t){return new e(t.deserializeStr())}},ii=class e extends y.l{constructor(e,t){super(),this.address=e,this.name=t}static fromStr(t){let i=t.split("::");if(2!==i.length)throw Error("Invalid module id.");return new e(y.ba.fromString(i[0]),new it(i[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(t){return new e(y.ba.deserialize(t),it.deserialize(t))}},ir=class e extends y.l{deserialize(t){return new iA(y.ba.deserialize(t),it.deserialize(t),it.deserialize(t),t.deserializeVector(e))}static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return is.load(e);case 1:return ia.load(e);case 2:return iu.load(e);case 3:return il.load(e);case 4:return ip.load(e);case 5:return ih.load(e);case 6:return im.load(e);case 7:return i_.load(e);case 8:return io.load(e);case 9:return ic.load(e);case 10:return id.load(e);case 255:return iy.load(e);default:throw Error(`Unknown variant index for TypeTag: ${t}`)}}isBool(){return this instanceof is}isAddress(){return this instanceof ip}isGeneric(){return this instanceof iy}isSigner(){return this instanceof ih}isVector(){return this instanceof im}isStruct(){return this instanceof i_}isU8(){return this instanceof ia}isU16(){return this instanceof io}isU32(){return this instanceof ic}isU64(){return this instanceof iu}isU128(){return this instanceof il}isU256(){return this instanceof id}isPrimitive(){return this instanceof ih||this instanceof ip||this instanceof is||this instanceof ia||this instanceof io||this instanceof ic||this instanceof iu||this instanceof il||this instanceof id}},is=t.TypeTagBool=class e extends ir{toString(){return"bool"}serialize(e){e.serializeU32AsUleb128(0)}static load(t){return new e}},ia=t.TypeTagU8=class e extends ir{toString(){return"u8"}serialize(e){e.serializeU32AsUleb128(1)}static load(t){return new e}},io=t.TypeTagU16=class e extends ir{toString(){return"u16"}serialize(e){e.serializeU32AsUleb128(8)}static load(t){return new e}},ic=t.TypeTagU32=class e extends ir{toString(){return"u32"}serialize(e){e.serializeU32AsUleb128(9)}static load(t){return new e}},iu=t.TypeTagU64=class e extends ir{toString(){return"u64"}serialize(e){e.serializeU32AsUleb128(2)}static load(t){return new e}},il=t.TypeTagU128=class e extends ir{toString(){return"u128"}serialize(e){e.serializeU32AsUleb128(3)}static load(t){return new e}},id=t.TypeTagU256=class e extends ir{toString(){return"u256"}serialize(e){e.serializeU32AsUleb128(10)}static load(t){return new e}},ip=t.TypeTagAddress=class e extends ir{toString(){return"address"}serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},ih=t.TypeTagSigner=class e extends ir{toString(){return"signer"}serialize(e){e.serializeU32AsUleb128(5)}static load(t){return new e}},ig=t.TypeTagReference=class e extends ir{constructor(e){super(),this.value=e}toString(){return`&${this.value.toString()}`}serialize(e){e.serializeU32AsUleb128(254)}static load(t){return new e(ir.deserialize(t))}},iy=t.TypeTagGeneric=class e extends ir{constructor(e){if(super(),this.value=e,e<0)throw Error("Generic type parameter index cannot be negative")}toString(){return`T${this.value}`}serialize(e){e.serializeU32AsUleb128(255),e.serializeU32(this.value)}static load(t){return new e(t.deserializeU32())}},im=t.TypeTagVector=class e extends ir{constructor(e){super(),this.value=e}toString(){return`vector<${this.value.toString()}>`}static u8(){return new e(new ia)}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(t){return new e(ir.deserialize(t))}},i_=t.TypeTagStruct=class e extends ir{constructor(e){super(),this.value=e}toString(){let e="";return this.value.typeArgs.length>0&&(e=`<${this.value.typeArgs.map(e=>e.toString()).join(", ")}>`),`${this.value.address.toString()}::${this.value.moduleName.identifier}::${this.value.name.identifier}${e}`}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(t){return new e(iA.deserialize(t))}isTypeTag(e,t,i){return this.value.moduleName.identifier===t&&this.value.name.identifier===i&&this.value.address.equals(e)}isString(){return this.isTypeTag(y.ba.ONE,"string","String")}isOption(){return this.isTypeTag(y.ba.ONE,"option","Option")}isObject(){return this.isTypeTag(y.ba.ONE,"object","Object")}isDelegationKey(){return this.isTypeTag(y.ba.ONE,"permissioned_delegation","DelegationKey")}isRateLimiter(){return this.isTypeTag(y.ba.ONE,"rate_limiter","RateLimiter")}},iA=t.StructTag=class e extends y.l{constructor(e,t,i,r){super(),this.address=e,this.moduleName=t,this.name=i,this.typeArgs=r}serialize(e){e.serialize(this.address),e.serialize(this.moduleName),e.serialize(this.name),e.serializeVector(this.typeArgs)}static deserialize(t){return new e(y.ba.deserialize(t),it.deserialize(t),it.deserialize(t),t.deserializeVector(ir))}};function iw(){return new iA(y.ba.ONE,new it("string"),new it("String"),[])}function ib(e){return new iA(y.ba.ONE,new it("object"),new it("Object"),[e])}function iv(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return b.deserialize(e);case 1:return E.deserialize(e);case 2:return S.deserialize(e);case 3:return y.ba.deserialize(e);case 4:return C.deserialize(e,b);case 5:return w.deserialize(e);case 6:return v.deserialize(e);case 7:return T.deserialize(e);case 8:return z.deserialize(e);case 9:return U.deserialize(e);default:throw Error(`Unknown variant index for ScriptTransactionArgument: ${t}`)}}var iT=class extends y.l{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return iE.load(e);case 2:return iS.load(e);case 3:return iz.load(e);case 4:return iP.deserialize(e);default:throw Error(`Unknown variant index for TransactionPayload: ${t}`)}}},iE=t.TransactionPayloadScript=class e extends iT{constructor(e){super(),this.script=e}serialize(e){e.serializeU32AsUleb128(0),this.script.serialize(e)}static load(t){return new e(iU.deserialize(t))}},iS=t.TransactionPayloadEntryFunction=class e extends iT{constructor(e){super(),this.entryFunction=e}serialize(e){e.serializeU32AsUleb128(2),this.entryFunction.serialize(e)}static load(t){return new e(iC.deserialize(t))}},iz=t.TransactionPayloadMultiSig=class e extends iT{constructor(e){super(),this.multiSig=e}serialize(e){e.serializeU32AsUleb128(3),this.multiSig.serialize(e)}static load(t){return new e(ix.deserialize(t))}},iC=t.EntryFunction=class e{constructor(e,t,i,r){this.module_name=e,this.function_name=t,this.type_args=i,this.args=r}static build(t,i,r,n){return new e(ii.fromStr(t),new it(i),r,n)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForEntryFunction(e)})}static deserialize(t){let i=ii.deserialize(t),r=it.deserialize(t),n=t.deserializeVector(ir),s=t.deserializeUleb128AsU32(),a=[];for(let e=0;e<s;e+=1){let e=t.deserializeUleb128AsU32(),i=A.deserialize(t,e);a.push(i)}return new e(i,r,n,a)}},iU=t.Script=class e{constructor(e,t,i){this.bytecode=e,this.type_args=t,this.args=i}serialize(e){e.serializeBytes(this.bytecode),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForScriptFunction(e)})}static deserialize(t){let i=t.deserializeBytes(),r=t.deserializeVector(ir),n=t.deserializeUleb128AsU32(),s=[];for(let e=0;e<n;e+=1){let e=iv(t);s.push(e)}return new e(i,r,s)}},ix=t.MultiSig=class e{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),void 0===this.transaction_payload?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(t){let i=y.ba.deserialize(t),r;return t.deserializeBool()&&(r=ik.deserialize(t)),new e(i,r)}},ik=t.MultiSigTransactionPayload=class e extends y.l{constructor(e){super(),this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(t){return t.deserializeUleb128AsU32(),new e(iC.deserialize(t))}},iP=t.TransactionInnerPayload=class extends iT{static deserialize(e){let t=e.deserializeUleb128AsU32();if(0===t)return iI.load(e);throw Error(`Unknown variant index for TransactionInnerPayload: ${t}`)}},iI=t.TransactionInnerPayloadV1=class e extends iP{constructor(e,t){super(),this.executable=e,this.extra_config=t}serialize(e){e.serializeU32AsUleb128(4),e.serializeU32AsUleb128(0),this.executable.serialize(e),this.extra_config.serialize(e)}static load(t){return new e(iK.deserialize(t),iR.deserialize(t))}},iK=t.TransactionExecutable=class{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return iN.load(e);case 1:return i$.load(e);case 2:return iF.load(e);default:throw Error(`Unknown variant index for TransactionExecutable: ${t}`)}}},iN=t.TransactionExecutableScript=class e extends iK{constructor(e){super(),this.script=e}serialize(e){e.serializeU32AsUleb128(0),this.script.serialize(e)}static load(t){return new e(iU.deserialize(t))}},i$=t.TransactionExecutableEntryFunction=class e extends iK{constructor(e){super(),this.entryFunction=e}serialize(e){e.serializeU32AsUleb128(1),this.entryFunction.serialize(e)}static load(t){return new e(iC.deserialize(t))}},iF=t.TransactionExecutableEmpty=class e extends iK{serialize(e){e.serializeU32AsUleb128(2)}static load(t){return new e}},iR=t.TransactionExtraConfig=class{static deserialize(e){let t=e.deserializeUleb128AsU32();if(0===t)return iB.load(e);throw Error(`Unknown variant index for TransactionExtraConfig: ${t}`)}},iB=t.TransactionExtraConfigV1=class e extends iR{constructor(e,t){super(),this.multisigAddress=e,this.replayProtectionNonce=void 0!==t?BigInt(t):void 0}serialize(e){e.serializeU32AsUleb128(0),e.serializeOption(this.multisigAddress),e.serializeOption(void 0!==this.replayProtectionNonce?new E(this.replayProtectionNonce):void 0)}static load(t){return new e(t.deserializeOption(y.ba),g([t.deserializeOption(E),"optionalAccess",e=>e.value]))}},iD=class e extends y.l{constructor(e,t,i,r,n,s,a){super(),this.sender=e,this.sequence_number=t,this.payload=i,this.max_gas_amount=r,this.gas_unit_price=n,this.expiration_timestamp_secs=s,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(t){return new e(y.ba.deserialize(t),t.deserializeU64(),iT.deserialize(t),t.deserializeU64(),t.deserializeU64(),t.deserializeU64(),ie.deserialize(t))}},iO=t.RawTransactionWithData=class extends y.l{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return iL.load(e);case 1:return iM.load(e);default:throw Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},iL=t.MultiAgentRawTransaction=class e extends iO{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses)}static load(t){return new e(iD.deserialize(t),t.deserializeVector(y.ba))}},iM=t.FeePayerRawTransaction=class e extends iO{constructor(e,t,i){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=i}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses),this.fee_payer_address.serialize(e)}static load(t){return new e(iD.deserialize(t),t.deserializeVector(y.ba),y.ba.deserialize(t))}},iH=class extends y.l{constructor(e){super(),this.accountAddress=y.ba.ONE,this.moduleName=new x("account"),this.structName=new x("RotationProofChallenge"),this.sequenceNumber=new E(e.sequenceNumber),this.originator=e.originator,this.currentAuthKey=e.currentAuthKey,this.newPublicKey=C.U8(e.newPublicKey.toUint8Array())}serialize(e){e.serialize(this.accountAddress),e.serialize(this.moduleName),e.serialize(this.structName),e.serialize(this.sequenceNumber),e.serialize(this.originator),e.serialize(this.currentAuthKey),e.serialize(this.newPublicKey)}},iV=class extends y.l{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return iq.load(e);case 1:return ij.load(e);case 2:return iG.load(e);case 3:return iW.load(e);case 4:return iJ.load(e);default:throw Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}isEd25519(){return this instanceof iq}isMultiEd25519(){return this instanceof ij}isMultiAgent(){return this instanceof iG}isFeePayer(){return this instanceof iW}isSingleSender(){return this instanceof iJ}},iq=t.TransactionAuthenticatorEd25519=class e extends iV{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tX.deserialize(t),t0.deserialize(t))}},ij=t.TransactionAuthenticatorMultiEd25519=class e extends iV{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(tM.deserialize(t),tV.deserialize(t))}},iG=t.TransactionAuthenticatorMultiAgent=class e extends iV{constructor(e,t,i){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=i}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers)}static load(t){return new e(t1.deserialize(t),t.deserializeVector(y.ba),t.deserializeVector(t1))}},iW=t.TransactionAuthenticatorFeePayer=class e extends iV{constructor(e,t,i,r){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=i,this.fee_payer=r}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(t){return new e(t1.deserialize(t),t.deserializeVector(y.ba),t.deserializeVector(t1),{address:y.ba.deserialize(t),authenticator:t1.deserialize(t)})}},iJ=t.TransactionAuthenticatorSingleSender=class e extends iV{constructor(e){super(),this.sender=e}serialize(e){e.serializeU32AsUleb128(4),this.sender.serialize(e)}static load(t){return new e(t1.deserialize(t))}},iY=class e extends y.l{constructor(e,t){super(),this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(t){return new e(iD.deserialize(t),iV.deserialize(t))}},iX=class e extends y.l{constructor(e,t){super(),this.rawTransaction=e,this.feePayerAddress=t}serialize(e){this.rawTransaction.serialize(e),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let i=iD.deserialize(t),r;return t.deserializeBool()&&(r=y.ba.deserialize(t)),new e(i,r)}},iZ=class e extends y.l{constructor(e,t,i){super(),this.rawTransaction=e,this.feePayerAddress=i,this.secondarySignerAddresses=t}serialize(e){this.rawTransaction.serialize(e),e.serializeVector(this.secondarySignerAddresses),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let i=iD.deserialize(t),r=t.deserializeVector(y.ba),n;return t.deserializeBool()&&(n=y.ba.deserialize(t)),new e(i,r,n)}};function iQ(e){return e.feePayerAddress?new iM(e.rawTransaction,h(e.secondarySignerAddresses,()=>[]),e.feePayerAddress):e.secondarySignerAddresses?new iL(e.rawTransaction,e.secondarySignerAddresses):e.rawTransaction}function i0(e,t){let i=P.sha3_256.create();if(!t.startsWith("APTOS::"))throw Error(`Domain separator needs to start with 'APTOS::'.  Provided - ${t}`);i.update(t);let r=i.digest(),n=new Uint8Array(r.length+e.length);return n.set(r),n.set(e,r.length),n}function i2(e){let t=iQ(e);return e.feePayerAddress?i0(t.bcsToBytes(),eC):e.secondarySignerAddresses?i0(t.bcsToBytes(),eC):i0(t.bcsToBytes(),ez)}var i1=class e{constructor(e){this.signingScheme=0;let{privateKey:t,address:i}=e;this.privateKey=t,this.publicKey=t.publicKey(),this.accountAddress=i?y.ba.from(i):this.publicKey.authKey().derivedAddress()}static generate(){return new e({privateKey:tZ.generate()})}static fromDerivationPath(t){let{path:i,mnemonic:r}=t;return new e({privateKey:tZ.fromDerivationPath(i,r)})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new t8(this.publicKey,this.privateKey.sign(e))}signTransactionWithAuthenticator(e){return new t8(this.publicKey,this.signTransaction(e))}sign(e){return this.privateKey.sign(e)}signTransaction(e){return this.sign(i2(e))}};function i8(e){return"object"==typeof e&&null!==e&&"getAnyPublicKey"in e&&"function"==typeof e.getAnyPublicKey}var i3=class e{constructor(e){this.signingScheme=2;let{privateKey:t,address:i}=e;this.privateKey=t,this.publicKey=new tF(t.publicKey()),this.accountAddress=i?y.ba.from(i):this.publicKey.authKey().derivedAddress()}getAnyPublicKey(){return this.publicKey}static generate(t={}){let{scheme:i=0}=t,r;switch(i){case 0:r=tZ.generate();break;case 2:r=tC.generate();break;default:throw Error(`Unsupported signature scheme ${i}`)}return new e({privateKey:r})}static fromDerivationPath(t){let{scheme:i=0,path:r,mnemonic:n}=t,s;switch(i){case 0:s=tZ.fromDerivationPath(r,n);break;case 2:s=tC.fromDerivationPath(r,n);break;default:throw Error(`Unsupported signature scheme ${i}`)}return new e({privateKey:s})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new t5(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new t5(this.publicKey,this.signTransaction(e))}sign(e){return new tR(this.privateKey.sign(e))}signTransaction(e){return this.sign(i2(e))}static fromEd25519Account(t){return new e({privateKey:t.privateKey,address:t.accountAddress})}},i5=class{static generate(e={}){let{scheme:t=0,legacy:i=!0}=e;return 0===t&&i?i1.generate():i3.generate({scheme:t})}static fromPrivateKey(e){let{privateKey:t,address:i,legacy:r=!0}=e;return t instanceof tZ&&r?new i1({privateKey:t,address:i}):new i3({privateKey:t,address:i})}static fromPrivateKeyAndAddress(e){return this.fromPrivateKey(e)}static fromDerivationPath(e){let{scheme:t=0,mnemonic:i,path:r,legacy:n=!0}=e;return 0===t&&n?i1.fromDerivationPath({mnemonic:i,path:r}):i3.fromDerivationPath({scheme:t,mnemonic:i,path:r})}static authKey(e){let{publicKey:t}=e;return t.authKey()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync(e)}},i6=i(27738),i4=class e extends y.l{constructor(e){super();let{privateKey:t,expiryDateSecs:i,blinder:r}=e;this.privateKey=t,this.publicKey=new ei(t.publicKey()),this.expiryDateSecs=i||y.ia.call(void 0,y.ha.call(void 0)+1209600),this.blinder=void 0!==r?y.j.fromHexInput(r).toUint8Array():i6.randomBytes.call(void 0,i4.BLINDER_LENGTH);let n=eo(this.publicKey.bcsToBytes(),93);n.push(BigInt(this.expiryDateSecs)),n.push(ec(this.blinder));let s=el(n);this.nonce=s.toString()}getPublicKey(){return this.publicKey}isExpired(){return Math.floor(Date.now()/1e3)>this.expiryDateSecs}serialize(e){e.serializeU32AsUleb128(this.publicKey.variant),e.serializeBytes(this.privateKey.toUint8Array()),e.serializeU64(this.expiryDateSecs),e.serializeFixedBytes(this.blinder)}static deserialize(t){let i=t.deserializeUleb128AsU32(),r;if(0===i)r=tZ.deserialize(t);else throw Error(`Unknown variant index for EphemeralPublicKey: ${i}`);let n=t.deserializeU64(),s=t.deserializeFixedBytes(31);return new e({privateKey:r,expiryDateSecs:Number(n),blinder:s})}static fromBytes(t){return e.deserialize(new m(t))}static generate(t){return g([t,"optionalAccess",e=>e.scheme]),new e({privateKey:tZ.generate(),expiryDateSecs:g([t,"optionalAccess",e=>e.expiryDateSecs])})}sign(e){if(this.isExpired())throw Error("EphemeralKeyPair has expired");return new er(this.privateKey.sign(e))}};i4.BLINDER_LENGTH=31;var i9=p(i(6078));function i7(e){return null!=e&&"function"==typeof e.checkKeylessAccountValidity}var re=class e extends y.l{constructor(t){super(),this.signingScheme=2;let{address:i,ephemeralKeyPair:r,publicKey:n,uidKey:s,uidVal:a,aud:o,pepper:c,proof:u,proofFetchCallback:l,jwt:d,verificationKeyHash:p}=t;if(this.ephemeralKeyPair=r,this.publicKey=n,this.accountAddress=i?y.ba.from(i):this.publicKey.authKey().derivedAddress(),this.uidKey=s,this.uidVal=a,this.aud=o,this.jwt=d,this.emitter=new i9.default,this.proofOrPromise=u,u instanceof th)this.proof=u;else{if(void 0===l)throw Error("Must provide callback for async proof fetch");this.emitter.on("proofFetchFinish",async e=>{await l(e),this.emitter.removeAllListeners()}),this.init(u)}let h=y.j.fromHexInput(c).toUint8Array();if(h.length!==e.PEPPER_LENGTH)throw Error(`Pepper length in bytes should be ${e.PEPPER_LENGTH}`);if(this.pepper=h,void 0!==p){if(32!==y.j.hexInputToUint8Array(p).length)throw Error("verificationKeyHash must be 32 bytes");this.verificationKeyHash=y.j.hexInputToUint8Array(p)}}getAnyPublicKey(){return new tF(this.publicKey)}async init(e){try{this.proof=await e,this.emitter.emit("proofFetchFinish",{status:"Success"})}catch(e){e instanceof Error?this.emitter.emit("proofFetchFinish",{status:"Failed",error:e.toString()}):this.emitter.emit("proofFetchFinish",{status:"Failed",error:"Unknown"})}}serialize(e){if(this.accountAddress.serialize(e),e.serializeStr(this.jwt),e.serializeStr(this.uidKey),e.serializeFixedBytes(this.pepper),this.ephemeralKeyPair.serialize(e),void 0===this.proof)throw Error("Cannot serialize - proof undefined");this.proof.serialize(e),e.serializeOption(this.verificationKeyHash,32)}static partialDeserialize(e){return{address:y.ba.deserialize(e),jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:i4.deserialize(e),proof:th.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}isExpired(){return this.ephemeralKeyPair.isExpired()}signWithAuthenticator(e){let t=new tR(this.sign(e));return new t5(new tF(this.publicKey),t)}signTransactionWithAuthenticator(e){let t=new tR(this.signTransaction(e));return new t5(new tF(this.publicKey),t)}async waitForProofFetch(){this.proofOrPromise instanceof Promise&&await this.proofOrPromise}async checkKeylessAccountValidity(t){if(this.isExpired())throw eF.fromErrorType({type:0});if(await this.waitForProofFetch(),void 0===this.proof)throw eF.fromErrorType({type:2});let i=et.jwtDecode.call(void 0,this.jwt,{header:!0});if(void 0===i.kid)throw eF.fromErrorType({type:12,details:"checkKeylessAccountValidity failed. JWT is missing 'kid' in header. This should never happen."});if(void 0!==this.verificationKeyHash){let{verificationKey:e}=await ty({aptosConfig:t});if(y.j.hexInputToString(e.hash())!==y.j.hexInputToString(this.verificationKeyHash))throw eF.fromErrorType({type:4})}else console.warn("[Aptos SDK] The verification key hash was not set. Proof may be invalid if the verification key has rotated.");await e.fetchJWK({aptosConfig:t,publicKey:this.publicKey,kid:i.kid})}sign(e){let{expiryDateSecs:t}=this.ephemeralKeyPair;if(this.isExpired())throw eF.fromErrorType({type:0});if(void 0===this.proof)throw eF.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let i=this.ephemeralKeyPair.getPublicKey(),r=this.ephemeralKeyPair.sign(e);return new ts({jwtHeader:y.ja.call(void 0,this.jwt.split(".")[0]),ephemeralCertificate:new ta(this.proof,0),expiryDateSecs:t,ephemeralPublicKey:i,ephemeralSignature:r})}signTransaction(e){if(void 0===this.proof)throw eF.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let t=new ri(iQ(e),this.proof.proof).hash();return this.sign(t)}getSigningMessage(e){if(void 0===this.proof)throw eF.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});return new ri(iQ(e),this.proof.proof).hash()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e})}static async fetchJWK(e){return tr(e)}};re.PEPPER_LENGTH=31;var rt=re,ri=t.TransactionAndProof=class extends y.l{constructor(e,t){super(),this.domainSeparator="APTOS::TransactionAndProof",this.transaction=e,this.proof=t}serialize(e){e.serializeFixedBytes(this.transaction.bcsToBytes()),e.serializeOption(this.proof)}hash(){return i0(this.bcsToBytes(),this.domainSeparator)}},rr=class e extends rt{constructor(e){let t=te.create(e);super({publicKey:t,...e}),this.publicKey=t}serialize(e){super.serialize(e)}static deserialize(t){let{address:i,proof:r,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=rt.partialDeserialize(t),{iss:u,aud:l,uidVal:d}=tm({jwt:s,uidKey:a});return new e({address:i,proof:r,ephemeralKeyPair:n,iss:u,uidKey:a,uidVal:d,aud:l,pepper:o,jwt:s,verificationKeyHash:c})}static fromBytes(t){return e.deserialize(new m(y.j.hexInputToUint8Array(t)))}static create(t){let{address:i,proof:r,jwt:n,ephemeralKeyPair:s,pepper:a,uidKey:o="sub",proofFetchCallback:c,verificationKey:u,verificationKeyHash:l}=t;if(l&&u)throw Error("Cannot provide both verificationKey and verificationKeyHash");let{iss:d,aud:p,uidVal:g}=tm({jwt:n,uidKey:o});return new e({address:i,proof:r,ephemeralKeyPair:s,iss:d,uidKey:o,uidVal:g,aud:p,pepper:a,jwt:n,proofFetchCallback:c,verificationKeyHash:h(l,()=>u?u.hash():void 0)})}},rn=class e extends rt{constructor(e){let t=tT.create(e);super({publicKey:t,...e}),this.publicKey=t,this.audless=h(e.audless,()=>!1)}serialize(e){super.serialize(e),this.publicKey.jwkAddress.serialize(e)}static deserialize(t){let{address:i,proof:r,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=rt.partialDeserialize(t),u=y.ba.deserialize(t),{iss:l,aud:d,uidVal:p}=tm({jwt:s,uidKey:a});return new e({address:i,proof:r,ephemeralKeyPair:n,iss:l,uidKey:a,uidVal:p,aud:d,pepper:o,jwt:s,verificationKeyHash:c,jwkAddress:u})}static fromBytes(t){return e.deserialize(m.fromHex(t))}static create(t){let{address:i,proof:r,jwt:n,ephemeralKeyPair:s,pepper:a,jwkAddress:o,uidKey:c="sub",proofFetchCallback:u,verificationKey:l,verificationKeyHash:d}=t;if(d&&l)throw Error("Cannot provide both verificationKey and verificationKeyHash");let{iss:p,aud:g,uidVal:f}=tm({jwt:n,uidKey:c});return new e({address:i,proof:r,ephemeralKeyPair:s,iss:p,uidKey:c,uidVal:f,aud:g,pepper:a,jwkAddress:y.ba.from(o),jwt:n,proofFetchCallback:u,verificationKeyHash:h(d,()=>l?l.hash():void 0)})}},rs=class e{constructor(e){this.signingScheme=3;let{multiKey:t,address:i}=e,r=e.signers.map(e=>e instanceof i1?i3.fromEd25519Account(e):e);if(t.signaturesRequired>r.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${t.signaturesRequired} signers, but only ${r.length} provided`);if(t.signaturesRequired<r.length)throw Error(`More signers provided than required. Need ${t.signaturesRequired} signers, but ${r.length} provided`);this.publicKey=t,this.accountAddress=i?y.ba.from(i):this.publicKey.authKey().derivedAddress();let n=[];for(let e of r)n.push(this.publicKey.getIndex(e.getAnyPublicKey()));let s=r.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndicies=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}static fromPublicKeysAndSigners(t){let{address:i,publicKeys:r,signaturesRequired:n,signers:s}=t;return new e({multiKey:new tD({publicKeys:r,signaturesRequired:n}),signers:s,address:i})}static isMultiKeySigner(t){return t instanceof e}signWithAuthenticator(e){return new t6(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new t6(this.publicKey,this.signTransaction(e))}async waitForProofFetch(){let e=this.signers.filter(e=>e instanceof rt).map(async e=>e.waitForProofFetch());await Promise.all(e)}async checkKeylessAccountValidity(e){let t=this.signers.filter(e=>e instanceof rt).map(t=>t.checkKeylessAccountValidity(e));await Promise.all(t)}sign(e){let t=[];for(let i of this.signers)t.push(i.sign(e));return new tL({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){let t=[];for(let i of this.signers)t.push(i.signTransaction(e));return new tL({signatures:t,bitmap:this.signaturesBitmap})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return await this.publicKey.verifySignatureAsync(e)}},ra=class{constructor(e){this.signingScheme=1;let{signers:t,publicKey:i,address:r}=e;if(this.publicKey=i,this.accountAddress=r?y.ba.from(r):this.publicKey.authKey().derivedAddress(),i.threshold>t.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${i.threshold} signers, but only ${t.length} provided`);if(i.threshold<t.length)throw Error(`More signers provided than required. Need ${i.threshold} signers, but ${t.length} provided`);let n=[];for(let e of t)n.push(this.publicKey.getIndex(e.publicKey()));let s=t.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndices=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new t3(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new t3(this.publicKey,this.signTransaction(e))}sign(e){let t=[];for(let i of this.signers)t.push(i.sign(e));return new tV({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){return this.sign(i2(e))}};function ro(e,t){if(t.serializeStr(e.jwt),t.serializeStr(e.uidKey),t.serializeFixedBytes(e.pepper),e.ephemeralKeyPair.serialize(t),void 0===e.proof)throw Error("Cannot serialize - proof undefined");e.proof.serialize(t),t.serializeOption(e.verificationKeyHash,32)}function rc(e){return{jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:i4.deserialize(e),proof:th.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}(e=>{function t(e){let i=new y.m;switch(i.serializeU32AsUleb128(e.signingScheme),e.accountAddress.serialize(i),e.signingScheme){case 0:return e.privateKey.serialize(i),i.toUint8Array();case 2:{if(!i8(e))throw Error("Account is not a SingleKeySigner");let t=e.getAnyPublicKey();switch(i.serializeU32AsUleb128(t.variant),t.variant){case 3:return ro(e,i),i.toUint8Array();case 4:return ro(e,i),e.publicKey.jwkAddress.serialize(i),i.serializeBool(e.audless),i.toUint8Array();case 1:case 0:return e.privateKey.serialize(i),i.toUint8Array();default:throw Error(`Invalid public key variant: ${t.variant}`)}}case 3:return e.publicKey.serialize(i),i.serializeU32AsUleb128(e.signers.length),e.signers.forEach(e=>{i.serializeFixedBytes(t(e))}),i.toUint8Array();default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${e.signingScheme}`)}}function i(e){let{address:t,signingScheme:r}=function(e){let t=e.deserializeUleb128AsU32();if(!Object.values(y.Z).includes(t))throw Error(`Deserialization of Account failed: SigningScheme variant ${t} is invalid`);return{address:y.ba.deserialize(e),signingScheme:t}}(e);switch(r){case 0:return new i1({privateKey:tZ.deserialize(e),address:t});case 2:{let i=e.deserializeUleb128AsU32();switch(i){case 0:return new i3({privateKey:tZ.deserialize(e),address:t});case 1:return new i3({privateKey:tC.deserialize(e),address:t});case 3:{let t=rc(e),i=tm(t);return new rr({...t,...i})}case 4:{let t=rc(e),i=y.ba.deserialize(e),r=e.deserializeBool(),n=tm(t);return new rn({...t,...n,jwkAddress:i,audless:r})}default:throw Error(`Unsupported public key variant ${i}`)}}case 3:{let r=tD.deserialize(e),n=e.deserializeUleb128AsU32(),s=[];for(let t=0;t<n;t+=1){let t=i(e);if(!i8(t)&&!(t instanceof i1))throw Error("Deserialization of MultiKeyAccount failed. Signer is not a SingleKeySigner or Ed25519Account");s.push(t)}return new rs({multiKey:r,signers:s,address:t})}default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${r}`)}}function r(e){return i(m.fromHex(e))}e.toBytes=t,e.toHexStringWithoutPrefix=function(e){return y.j.hexInputToStringWithoutPrefix(t(e))},e.toHexString=function(e){return y.j.hexInputToString(t(e))},e.deserialize=i,e.keylessAccountFromHex=function(e){let t=r(e);if(!(t instanceof rr))throw Error("Deserialization of KeylessAccount failed");return t},e.federatedKeylessAccountFromHex=function(e){let t=r(e);if(!(t instanceof rn))throw Error("Deserialization of FederatedKeylessAccount failed");return t},e.multiKeyAccountFromHex=function(e){let t=r(e);if(!(t instanceof rs))throw Error("Deserialization of MultiKeyAccount failed");return t},e.singleKeyAccountFromHex=function(e){let t=r(e);if(!(t instanceof i3))throw Error("Deserialization of SingleKeyAccount failed");return t},e.ed25519AccountFromHex=function(e){let t=r(e);if(!(t instanceof i1))throw Error("Deserialization of Ed25519Account failed");return t},e.fromHex=r,e.fromBytes=function(e){return r(e)}})(f||(f=t.AccountUtils={}));var ru=class e extends i5{constructor({signer:e,accountAddress:t,authenticationFunction:i}){if(super(),this.signingScheme=2,!y.qa.call(void 0,i))throw Error(`Invalid authentication function ${i} passed into AbstractedAccount`);this.authenticationFunction=i,this.accountAddress=t,this.publicKey=new R(this.accountAddress),this.sign=t=>new F(e(t))}static fromPermissionedSigner({signer:t,accountAddress:i}){return new e({signer:e=>{let i=new y.m;return t.publicKey.serialize(i),t.sign(e).serialize(i),i.toUint8Array()},accountAddress:h(i,()=>t.accountAddress),authenticationFunction:"0x1::permissioned_delegation::authenticate"})}static generateAccountAbstractionMessage(e,t){return i0(new t7(e,t).bcsToBytes(),eU)}signWithAuthenticator(e){return new t9(this.authenticationFunction,P.sha3_256.call(void 0,e),this.sign(P.sha3_256.call(void 0,e)).toUint8Array())}signTransactionWithAuthenticator(t){let i=e.generateAccountAbstractionMessage(i2(t),this.authenticationFunction);return this.signWithAuthenticator(i)}signTransaction(e){return this.sign(i2(e))}setSigner(e){this.sign=t=>new F(e(t))}},rl=class e extends ru{constructor({signer:t,authenticationFunction:i,abstractPublicKey:r}){super({accountAddress:new y.ba(e.computeAccountAddress(i,r)),signer:t,authenticationFunction:i}),this.abstractPublicKey=r}static computeAccountAddress(t,i){if(!y.qa.call(void 0,t))throw Error(`Invalid authentication function ${t} passed into DerivableAbstractedAccount`);let[r,n,s]=t.split("::"),a=P.sha3_256.create(),o=new y.m;y.ba.fromString(r).serialize(o),o.serializeStr(n),o.serializeStr(s),a.update(o.toUint8Array());let c=new y.m;return c.serializeBytes(i),a.update(c.toUint8Array()),a.update(new Uint8Array([e.ADDRESS_DOMAIN_SEPERATOR])),a.digest()}signWithAuthenticator(e){return new t9(this.authenticationFunction,P.sha3_256.call(void 0,e),this.sign(P.sha3_256.call(void 0,e)).value,this.abstractPublicKey)}};rl.ADDRESS_DOMAIN_SEPERATOR=5;var rd=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,rp=`
    fragment AnsTokenFragment on current_aptos_names {
  domain
  expiration_timestamp
  registered_address
  subdomain
  token_standard
  is_primary
  owner_address
  subdomain_expiration_policy
  domain_expiration_timestamp
}
    `,rh=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,rg=`
    query getAccountAddressesForAuthKey($where_condition: auth_key_account_addresses_bool_exp, $order_by: [auth_key_account_addresses_order_by!]) {
  auth_key_account_addresses(where: $where_condition, order_by: $order_by) {
    auth_key
    account_address
    last_transaction_version
    is_auth_key_used
  }
}
    `,rf=`
    query getAccountCoinsCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,ry=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,rm=`
    query getAccountCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,r_=`
    query getAccountOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${rh}`,rA=`
    query getAccountOwnedTokensFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${rh}`,rw=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,rb=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,rv=`
    query getAuthKeysForPublicKey($where_condition: public_key_auth_keys_bool_exp, $order_by: [public_key_auth_keys_order_by!]) {
  public_key_auth_keys(where: $where_condition, order_by: $order_by) {
    public_key
    public_key_type
    auth_key
    account_public_key
    last_transaction_version
    is_public_key_used
    signature_type
  }
}
    `,rT=`
    query getChainTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,rE=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!) {
  current_collections_v2(where: $where_condition) {
    uri
    total_minted_v2
    token_standard
    table_handle_v1
    mutable_uri
    mutable_description
    max_supply
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    cdn_asset_uris {
      cdn_image_uri
      asset_uri
      animation_optimizer_retry_count
      cdn_animation_uri
      cdn_json_uri
      image_optimizer_retry_count
      json_parser_retry_count
      raw_animation_uri
      raw_image_uri
    }
  }
}
    `,rS=`
    query getCurrentFungibleAssetBalances($where_condition: current_fungible_asset_balances_bool_exp, $offset: Int, $limit: Int) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
  }
}
    `,rz=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,rC=`
    query getFungibleAssetActivities($where_condition: fungible_asset_activities_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_activities(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    block_height
    entry_function_id_str
    event_index
    gas_fee_payer_address
    is_frozen
    is_gas_fee
    is_transaction_success
    owner_address
    storage_id
    storage_refund_amount
    token_standard
    transaction_timestamp
    transaction_version
    type
  }
}
    `,rU=`
    query getFungibleAssetMetadata($where_condition: fungible_asset_metadata_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_metadata(where: $where_condition, offset: $offset, limit: $limit) {
    icon_uri
    project_uri
    supply_aggregator_table_handle_v1
    supply_aggregator_table_key_v1
    creator_address
    asset_type
    decimals
    last_transaction_timestamp
    last_transaction_version
    name
    symbol
    token_standard
    supply_v2
    maximum_v2
  }
}
    `,rx=`
    query getNames($offset: Int, $limit: Int, $where_condition: current_aptos_names_bool_exp, $order_by: [current_aptos_names_order_by!]) {
  current_aptos_names(
    limit: $limit
    where: $where_condition
    order_by: $order_by
    offset: $offset
  ) {
    ...AnsTokenFragment
  }
}
    ${rp}`,rk=`
    query getNumberOfDelegators($where_condition: num_active_delegator_per_pool_bool_exp, $order_by: [num_active_delegator_per_pool_order_by!]) {
  num_active_delegator_per_pool(where: $where_condition, order_by: $order_by) {
    num_active_delegator
    pool_address
  }
}
    `,rP=`
    query getObjectData($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,rI=`
    query getProcessorStatus($where_condition: processor_status_bool_exp) {
  processor_status(where: $where_condition) {
    last_success_version
    processor
    last_updated
  }
}
    `,rK=`
    query getTableItemsData($where_condition: table_items_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_items_order_by!]) {
  table_items(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    decoded_key
    decoded_value
    key
    table_handle
    transaction_version
    write_set_change_index
  }
}
    `,rN=`
    query getTableItemsMetadata($where_condition: table_metadatas_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_metadatas_order_by!]) {
  table_metadatas(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    handle
    key_type
    value_type
  }
}
    `,r$=`
    query getTokenActivity($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${rd}`,rF=`
    query getCurrentTokenOwnership($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${rh}`,rR=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `;async function rB(e){let{aptosConfig:t}=e,{data:i}=await eL({aptosConfig:t,originMethod:"getLedgerInfo",path:""});return i}async function rD(e){let{aptosConfig:t,limit:i}=e;return(await rO({aptosConfig:t,query:{query:rT,variables:{limit:i}},originMethod:"getChainTopUserTransactions"})).user_transactions}async function rO(e){let{aptosConfig:t,query:i,originMethod:r}=e,{data:n}=await eW({aptosConfig:t,originMethod:h(r,()=>"queryIndexer"),path:"",body:i,overrides:{WITH_CREDENTIALS:!1}});return n}async function rL(e){let{aptosConfig:t}=e;return(await rO({aptosConfig:t,query:{query:rI},originMethod:"getProcessorStatuses"})).processor_status}async function rM(e){return BigInt((await rL({aptosConfig:e.aptosConfig}))[0].last_success_version)}async function rH(e){let{aptosConfig:t,processorType:i}=e;return(await rO({aptosConfig:t,query:{query:rI,variables:{where_condition:{processor:{_eq:i}}}},originMethod:"getProcessorStatus"})).processor_status[0]}async function rV(e){let{aptosConfig:t,accountAddress:i}=e,{data:r}=await eL({aptosConfig:t,originMethod:"getInfo",path:`accounts/${y.ba.from(i).toString()}`});return r}async function rq(e){return void 0!==g([e,"access",e=>e.options,"optionalAccess",e=>e.ledgerVersion])?rj(e):eQ(async()=>rj(e),`module-${e.accountAddress}-${e.moduleName}`,3e5)()}async function rj(e){let{aptosConfig:t,accountAddress:i,moduleName:r,options:n}=e,{data:s}=await eL({aptosConfig:t,originMethod:"getModule",path:`accounts/${y.ba.from(i).toString()}/module/${r}`,params:{ledger_version:g([n,"optionalAccess",e=>e.ledgerVersion])}});return s}async function rG(e){let{aptosConfig:t,handle:i,data:r,options:n}=e;return(await eG({aptosConfig:t,originMethod:"getTableItem",path:`tables/${i}/item`,params:{ledger_version:g([n,"optionalAccess",e=>e.ledgerVersion])},body:r})).data}async function rW(e){let{aptosConfig:t,options:i}=e,r={query:rK,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),offset:g([i,"optionalAccess",e=>e.offset]),limit:g([i,"optionalAccess",e=>e.limit]),order_by:g([i,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:r,originMethod:"getTableItemsData"})).table_items}async function rJ(e){let{aptosConfig:t,options:i}=e,r={query:rN,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),offset:g([i,"optionalAccess",e=>e.offset]),limit:g([i,"optionalAccess",e=>e.limit]),order_by:g([i,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:r,originMethod:"getTableItemsMetadata"})).table_metadatas}async function rY(e){let{aptosConfig:t,options:i}=e;return eH({aptosConfig:t,originMethod:"getTransactions",path:"transactions",params:{start:g([i,"optionalAccess",e=>e.offset]),limit:g([i,"optionalAccess",e=>e.limit])}})}async function rX(e){let{aptosConfig:t}=e;return eQ(async()=>{let{data:e}=await eL({aptosConfig:t,originMethod:"getGasPriceEstimation",path:"estimate_gas_price"});return e},`gas-price-${t.network}`,3e5)()}async function rZ(e){let{aptosConfig:t,ledgerVersion:i}=e,{data:r}=await eL({aptosConfig:t,originMethod:"getTransactionByVersion",path:`transactions/by_version/${i}`});return r}async function rQ(e){let{aptosConfig:t,transactionHash:i}=e,{data:r}=await eL({aptosConfig:t,path:`transactions/by_hash/${i}`,originMethod:"getTransactionByHash"});return r}async function r0(e){let{aptosConfig:t,transactionHash:i}=e;try{return"pending_transaction"===(await rQ({aptosConfig:t,transactionHash:i})).type}catch(e){if(404===g([e,"optionalAccess",e=>e.status]))return!0;throw e}}async function r2(e){let{aptosConfig:t,transactionHash:i}=e,{data:r}=await eL({aptosConfig:t,path:`transactions/wait_by_hash/${i}`,originMethod:"longWaitForTransaction"});return r}async function r1(e){let{aptosConfig:t,transactionHash:i,options:r}=e,n=h(g([r,"optionalAccess",e=>e.timeoutSecs]),()=>20),s=h(g([r,"optionalAccess",e=>e.checkSuccess]),()=>!0),a=!0,o=0,c,u,l=200;function d(e){if(!(e instanceof eR)||(u=e,404!==e.status&&e.status>=400&&e.status<500))throw e}try{c=await rQ({aptosConfig:t,transactionHash:i}),a="pending_transaction"===c.type}catch(e){d(e)}if(a){let e=Date.now();try{c=await r2({aptosConfig:t,transactionHash:i}),a="pending_transaction"===c.type}catch(e){d(e)}o=(Date.now()-e)/1e3}for(;a&&!(o>=n);){try{if(c=await rQ({aptosConfig:t,transactionHash:i}),!(a="pending_transaction"===c.type))break}catch(e){d(e)}await y.fa.call(void 0,l),o+=l/1e3,l*=1.5}if(void 0===c)throw u||new r3(`Fetching transaction ${i} failed and timed out after ${n} seconds`,c);if("pending_transaction"===c.type)throw new r3(`Transaction ${i} timed out in pending state after ${n} seconds`,c);if(!s)return c;if(!c.success)throw new r5(`Transaction ${i} failed with an error: ${c.vm_status}`,c);return c}async function r8(e){let{aptosConfig:t,processorType:i}=e,r=BigInt(e.minimumLedgerVersion),n=new Date().getTime(),s=BigInt(-1);for(;s<r;){if(new Date().getTime()-n>3e3)throw Error("waitForLastSuccessIndexerVersionSync timeout");if((s=void 0===i?await rM({aptosConfig:t}):(await rH({aptosConfig:t,processorType:i})).last_success_version)>=r)break;await y.fa.call(void 0,200)}}var r3=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},r5=class extends Error{constructor(e,t){super(e),this.transaction=t}};async function r6(e){let{aptosConfig:t,ledgerVersion:i,options:r}=e,{data:n}=await eL({aptosConfig:t,originMethod:"getBlockByVersion",path:`blocks/by_version/${i}`,params:{with_transactions:g([r,"optionalAccess",e=>e.withTransactions])}});return r9({block:n,...e})}async function r4(e){let{aptosConfig:t,blockHeight:i,options:r}=e,{data:n}=await eL({aptosConfig:t,originMethod:"getBlockByHeight",path:`blocks/by_height/${i}`,params:{with_transactions:g([r,"optionalAccess",e=>e.withTransactions])}});return r9({block:n,...e})}async function r9(e){let{aptosConfig:t,block:i,options:r}=e;if(g([r,"optionalAccess",e=>e.withTransactions])){i.transactions=h(i.transactions,()=>[]);let e=i.transactions[i.transactions.length-1],r=BigInt(i.first_version),n=BigInt(i.last_version),s=g([e,"optionalAccess",e=>e.version]),a;if((a=void 0===s?r-1n:BigInt(s))===n)return i;let o=[];for(let e=a+1n;e<n;e+=BigInt(100))o.push(rY({aptosConfig:t,options:{offset:e,limit:Math.min(Number(100n),Number(n-e+1n))}}));for(let e of(await Promise.all(o)))i.transactions.push(...e)}return i}function r7(e){return!!e.match(/^[_a-zA-Z0-9]+$/)}function ne(e){return!!e.match(/\s/)}var nt=((l=nt||{}).InvalidTypeTag="unknown type",l.UnexpectedGenericType="unexpected generic type",l.UnexpectedTypeArgumentClose="unexpected '>'",l.UnexpectedWhitespaceCharacter="unexpected whitespace character",l.UnexpectedComma="unexpected ','",l.TypeArgumentCountMismatch="type argument count doesn't match expected amount",l.MissingTypeArgumentClose="no matching '>' for '<'",l.MissingTypeArgument="no type argument before ','",l.UnexpectedPrimitiveTypeArguments="primitive types not expected to have type arguments",l.UnexpectedVectorTypeArgumentCount="vector type expected to have exactly one type argument",l.UnexpectedStructFormat="unexpected struct format, must be of the form 0xaddress::module_name::struct_name",l.InvalidModuleNameCharacter="module name must only contain alphanumeric or '_' characters",l.InvalidStructNameCharacter="struct name must only contain alphanumeric or '_' characters",l.InvalidAddress="struct address must be valid",l),ni=t.TypeTagParserError=class extends Error{constructor(e,t){super(`Failed to parse typeTag '${e}', ${t}`)}};function nr(e,t){let i=h(g([t,"optionalAccess",e=>e.allowGenerics]),()=>!1),r=[],n=[],s=[],a=0,o="",c=1;for(;a<e.length;){let t=e[a];if("<"===t)r.push({savedExpectedTypes:c,savedStr:o,savedTypes:s}),o="",s=[],c=1;else if(">"===t){if(""!==o){let e=nn(o,n,i);s.push(e)}let t=r.pop();if(void 0===t)throw new ni(e,"unexpected '>'");if(c!==s.length)throw new ni(e,"type argument count doesn't match expected amount");let{savedStr:a,savedTypes:u,savedExpectedTypes:l}=t;n=s,s=u,o=a,c=l}else if(","===t){if(0===r.length)throw new ni(e,"unexpected ','");if(0===o.length)throw new ni(e,"no type argument before ','");let t=nn(o,n,i);n=[],s.push(t),o="",c+=1}else if(ne(t)){let t=!1;if(0!==o.length){let e=nn(o,n,i);n=[],s.push(e),o="",t=!0}a=function(e,t){let i=t;for(;i<e.length&&ne(e[i]);i+=1);return i}(e,a);let r=e[a];if(a<e.length&&t&&","!==r&&">"!==r)throw new ni(e,"unexpected whitespace character");continue}else o+=t;a+=1}if(r.length>0)throw new ni(e,"no matching '>' for '<'");switch(s.length){case 0:return nn(o,n,i);case 1:if(""===o)return s[0];throw new ni(e,"unexpected ','");default:throw new ni(e,"unexpected whitespace character")}}function nn(e,t,i){let r=e.trim();if(function(e){switch(e){case"signer":case"address":case"bool":case"u8":case"u16":case"u32":case"u64":case"u128":case"u256":return!0;default:return!1}}(r.toLowerCase())&&t.length>0)throw new ni(e,"primitive types not expected to have type arguments");switch(r.toLowerCase()){case"signer":return new ih;case"bool":return new is;case"address":return new ip;case"u8":return new ia;case"u16":return new io;case"u32":return new ic;case"u64":return new iu;case"u128":return new il;case"u256":return new id;case"vector":if(1!==t.length)throw new ni(e,"vector type expected to have exactly one type argument");return new im(t[0]);default:let n;if(r.match(/^&.+$/))return new ig(nn(r.substring(1),t,i));if(r.match(/^T[0-9]+$/)){if(i)return new iy(Number(r.split("T")[1]));throw new ni(e,"unexpected generic type")}if(!r.match(/:/))throw new ni(e,"unknown type");let s=r.split("::");if(3!==s.length)throw new ni(e,"unexpected struct format, must be of the form 0xaddress::module_name::struct_name");try{n=y.ba.fromString(s[0])}catch(t){throw new ni(e,"struct address must be valid")}if(!r7(s[1]))throw new ni(e,"module name must only contain alphanumeric or '_' characters");if(!r7(s[2]))throw new ni(e,"struct name must only contain alphanumeric or '_' characters");return new i_(new iA(n,new it(s[1]),new it(s[2]),t))}}function ns(e){return"boolean"==typeof e}function na(e){return"string"==typeof e}function no(e){return"number"==typeof e}function nc(e){return no(e)?e:na(e)&&""!==e?Number.parseInt(e,10):void 0}function nu(e){return"number"==typeof e||"bigint"==typeof e||"string"==typeof e}function nl(e){return null==e}function nd(e){return np(e)||ny(e)||nm(e)||n_(e)||nA(e)||nw(e)||nb(e)||nh(e)||ng(e)||nf(e)||e instanceof C||e instanceof k}function np(e){return e instanceof w}function nh(e){return e instanceof y.ba}function ng(e){return e instanceof x}function nf(e){return e instanceof _}function ny(e){return e instanceof b}function nm(e){return e instanceof v}function n_(e){return e instanceof T}function nA(e){return e instanceof E}function nw(e){return e instanceof S}function nb(e){return e instanceof z}function nv(e){return"bytecode"in e}function nT(e,t){throw Error(`Type mismatch for argument ${t}, expected '${e}'`)}function nE(e){let t=e.params.findIndex(e=>"signer"!==e&&"&signer"!==e);return t<0?e.params.length:t}var nS=new TextEncoder;function nz(e){return h(g([e,"optionalAccess",e=>e.map,"call",e=>e(e=>na(e)?nr(e):e)]),()=>[])}async function nC(e,t,i){return(await n4({aptosConfig:i,accountAddress:e,moduleName:t})).abi}async function nU(e,t,i,r){let n=await nC(e,t,r);if(!n)throw Error(`Could not find module ABI for '${e}::${t}'`);return n.exposed_functions.find(e=>e.name===i)}async function nx(e,t,i,r){let n=await nU(e,t,i,r);if(!n)throw Error(`Could not find function ABI for '${e}::${t}::${i}'`);let s=[];for(let e=0;e<n.params.length;e+=1)s.push(nr(n.params[e],{allowGenerics:!0}));return{typeParameters:n.generic_type_params,parameters:s}}async function nk(e,t,i,r){let n=await nU(e,t,i,r);if(!n)throw Error(`Could not find entry function ABI for '${e}::${t}::${i}'`);if(!n.is_entry)throw Error(`'${e}::${t}::${i}' is not an entry function`);let s=nE(n),a=[];for(let e=s;e<n.params.length;e+=1)a.push(nr(n.params[e],{allowGenerics:!0}));return{signers:s,typeParameters:n.generic_type_params,parameters:a}}async function nP(e,t,i,r){let n=await nU(e,t,i,r);if(!n)throw Error(`Could not find view function ABI for '${e}::${t}::${i}'`);if(!n.is_view)throw Error(`'${e}::${t}::${i}' is not an view function`);let s=[];for(let e=0;e<n.params.length;e+=1)s.push(nr(n.params[e],{allowGenerics:!0}));let a=[];for(let e=0;e<n.return.length;e+=1)a.push(nr(n.return[e],{allowGenerics:!0}));return{typeParameters:n.generic_type_params,parameters:s,returnTypes:a}}function nI(e,t,i,r,n,s){let a;if("exposed_functions"in t){let i=t.exposed_functions.find(t=>t.name===e);if(!i)throw Error(`Could not find function ABI for '${t.address}::${t.name}::${e}'`);if(r>=i.params.length)throw Error(`Too many arguments for '${e}', expected ${i.params.length}`);a=nr(i.params[r],{allowGenerics:!0})}else{if(r>=t.parameters.length)throw Error(`Too many arguments for '${e}', expected ${t.parameters.length}`);a=t.parameters[r]}return nK(i,a,r,n,"exposed_functions"in t?t:void 0,s)}function nK(e,t,i,r,n,s){return nd(e)?(function e(t,i,r){if(t.isBool()){if(np(i))return;nT("Bool",r)}if(t.isAddress()){if(nh(i))return;nT("AccountAddress",r)}if(t.isU8()){if(ny(i))return;nT("U8",r)}if(t.isU16()){if(nm(i))return;nT("U16",r)}if(t.isU32()){if(n_(i))return;nT("U32",r)}if(t.isU64()){if(nA(i))return;nT("U64",r)}if(t.isU128()){if(nw(i))return;nT("U128",r)}if(t.isU256()){if(nb(i))return;nT("U256",r)}if(t.isVector()){if(i instanceof C){i.values.length>0&&e(t.value,i.values[0],r);return}nT("MoveVector",r)}if(t instanceof i_){if(t.isString()){if(ng(i))return;nT("MoveString",r)}if(t.isObject()){if(nh(i))return;nT("AccountAddress",r)}if(t.isOption()){if(i instanceof k){void 0!==i.value&&e(t.value.typeArgs[0],i.value,r);return}nT("MoveOption",r)}}throw Error(`Type mismatch for argument ${r}, expected '${t.toString()}'`)}(t,e,i),e):function(e,t,i,r,n,s){if(t.isBool()){if(ns(e))return new w(e);if(na(e)){if("true"===e)return new w(!0);if("false"===e)return new w(!1)}nT("boolean",i)}if(t.isAddress()){if(na(e))return y.ba.fromString(e);if(e&&"object"==typeof e&&"data"in e&&e.data instanceof Uint8Array)return new y.ba(e.data);nT("string | AccountAddress",i)}if(t.isU8()){let t=nc(e);if(void 0!==t)return new b(t);nT("number | string",i)}if(t.isU16()){let t=nc(e);if(void 0!==t)return new v(t);nT("number | string",i)}if(t.isU32()){let t=nc(e);if(void 0!==t)return new T(t);nT("number | string",i)}if(t.isU64()){if(nu(e))return new E(BigInt(e));nT("bigint | number | string",i)}if(t.isU128()){if(nu(e))return new S(BigInt(e));nT("bigint | number | string",i)}if(t.isU256()){if(nu(e))return new z(BigInt(e));nT("bigint | number | string",i)}if(t.isGeneric()){let s=t.value;if(s<0||s>=r.length)throw Error(`Generic argument ${t.toString()} is invalid for argument ${i}`);return nK(e,r[s],i,r,n)}if(t.isVector()){if(t.value.isU8()){if(na(e))return C.U8(nS.encode(e));if(e instanceof Uint8Array)return C.U8(e);if(e instanceof ArrayBuffer)return C.U8(new Uint8Array(e))}if(na(e)&&e.startsWith("["))return nK(JSON.parse(e),t,i,r);if(Array.isArray(e))return new C(e.map(e=>nK(e,t.value,i,r,n)));throw Error(`Type mismatch for argument ${i}, type '${t.toString()}'`)}if(t.isStruct()){if(t.isString()){if(na(e))return new x(e);nT("string",i)}if(t.isObject()){if(na(e))return y.ba.fromString(e);if(e&&"object"==typeof e&&"data"in e&&e.data instanceof Uint8Array)return new y.ba(e.data);nT("string | AccountAddress",i)}if(t.isDelegationKey()||t.isRateLimiter()){if(e instanceof Uint8Array)return new _(e);nT("Uint8Array",i)}if(t.isOption())return nl(e)?(t.value.typeArgs[0],new k(null)):new k(nK(e,t.value.typeArgs[0],i,r,n));if(0===g([n,"optionalAccess",e=>e.structs,"access",e=>e.find,"call",e=>e(e=>e.name===t.value.name.identifier),"optionalAccess",e=>e.fields,"access",e=>e.length])&&e instanceof Uint8Array)return new _(e);if(e instanceof Uint8Array&&g([s,"optionalAccess",e=>e.allowUnknownStructs]))return console.warn(`Unsupported struct input type for argument ${i}. Continuing since 'allowUnknownStructs' is enabled.`),new _(e);throw Error(`Unsupported struct input type for argument ${i}, type '${t.toString()}'`)}throw Error(`Type mismatch for argument ${i}, type '${t.toString()}'`)}(e,t,i,r,n,s)}async function nN(e){if(nv(e))return new iE(new iU(y.j.fromHexInput(e.bytecode).toUint8Array(),nz(e.typeArguments),e.functionArguments));let{moduleAddress:t,moduleName:i,functionName:r}=y.pa.call(void 0,e.function),n=await nj({key:"entry-function",moduleAddress:t,moduleName:i,functionName:r,aptosConfig:e.aptosConfig,abi:e.abi,fetch:nk});return n$({...e,abi:n})}function n$(e){let t=e.abi,{moduleAddress:i,moduleName:r,functionName:n}=y.pa.call(void 0,e.function),s=nz(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=e.functionArguments.map((i,r)=>nI(e.function,t,i,r,s));if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${i}::${r}::${n}', expected ${t.parameters.length} but got ${a.length}`);let o=iC.build(`${i}::${r}`,n,s,a);return"multisigAddress"in e?new iz(new ix(y.ba.from(e.multisigAddress),new ik(o))):new iS(o)}async function nF(e){let{moduleAddress:t,moduleName:i,functionName:r}=y.pa.call(void 0,e.function);return nR({abi:await nj({key:"view-function",moduleAddress:t,moduleName:i,functionName:r,aptosConfig:e.aptosConfig,abi:e.abi,fetch:nP}),...e})}function nR(e){let t=e.abi,{moduleAddress:i,moduleName:r,functionName:n}=y.pa.call(void 0,e.function),s=nz(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=h(g([e,"optionalAccess",e=>e.functionArguments,"optionalAccess",e=>e.map,"call",i=>i((i,r)=>nI(e.function,t,i,r,s))]),()=>[]);if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${i}::${r}::${n}', expected ${t.parameters.length} but got ${a.length}`);return iC.build(`${i}::${r}`,n,s,a)}async function nB(e){let{aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s}=e;if(void 0!==g([n,"optionalAccess",e=>e.replayProtectionNonce])&&void 0!==g([n,"optionalAccess",e=>e.accountSequenceNumber]))throw Error("Cannot specify both replayProtectionNonce and accountSequenceNumber in options.");let a=async()=>e_[t.network]?{chainId:e_[t.network]}:{chainId:(await rB({aptosConfig:t})).chain_id},o=async()=>g([n,"optionalAccess",e=>e.gasUnitPrice])?{gasEstimate:n.gasUnitPrice}:{gasEstimate:(await rX({aptosConfig:t})).gas_estimate},c=async()=>{let e=async()=>void 0!==g([n,"optionalAccess",e=>e.accountSequenceNumber])?n.accountSequenceNumber:void 0!==g([n,"optionalAccess",e=>e.replayProtectionNonce])?3735928559n:(await rV({aptosConfig:t,accountAddress:i})).sequence_number;if(!(s&&y.ba.from(s).equals(y.ba.ZERO)))return e();try{return await e()}catch(e){return 0}},[{chainId:u},{gasEstimate:l},d]=await Promise.all([a(),o(),c()]),{maxGasAmount:p,gasUnitPrice:f,expireTimestamp:m,replayProtectionNonce:_}={maxGasAmount:g([n,"optionalAccess",e=>e.maxGasAmount])?BigInt(n.maxGasAmount):BigInt(t.getDefaultMaxGasAmount()),gasUnitPrice:h(g([n,"optionalAccess",e=>e.gasUnitPrice]),()=>BigInt(l)),expireTimestamp:h(g([n,"optionalAccess",e=>e.expireTimestamp]),()=>BigInt(Math.floor(Date.now()/1e3)+t.getDefaultTxnExpirySecFromNow())),replayProtectionNonce:g([n,"optionalAccess",e=>e.replayProtectionNonce])?BigInt(n.replayProtectionNonce):void 0},A=r;return void 0!==_&&(A=nD(r,_)),new iD(y.ba.from(i),BigInt(d),A,BigInt(p),BigInt(f),BigInt(m),new ie(u))}function nD(e,t){if(e instanceof iE)return new iI(new iN(e.script),new iB(void 0,t));if(e instanceof iS)return new iI(new i$(e.entryFunction),new iB(void 0,t));if(e instanceof iz){let i=e.multiSig.transaction_payload,r;if(void 0===i||void 0===g([i,"optionalAccess",e=>e.transaction_payload]))r=new iF;else if(i.transaction_payload instanceof iC)r=new i$(i.transaction_payload);else throw Error("Scripts are not supported in multi-sig transactions.");return new iI(r,new iB(e.multiSig.multisig_address,t))}throw Error(`Unsupported payload type: ${e}`)}async function nO(e){let{aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s}=e,a=await nB({aptosConfig:t,sender:i,payload:r,options:n,feePayerAddress:s});return"secondarySignerAddresses"in e?new iZ(a,h(g([e,"access",e=>e.secondarySignerAddresses,"optionalAccess",e=>e.map,"call",e=>e(e=>y.ba.from(e))]),()=>[]),e.feePayerAddress?y.ba.from(e.feePayerAddress):void 0):new iX(a,e.feePayerAddress?y.ba.from(e.feePayerAddress):void 0)}function nL(e){let t,{signerPublicKey:i,transaction:r,secondarySignersPublicKeys:n,feePayerPublicKey:s}=e,a=nM(i);if(r.feePayerAddress){let e=new iM(r.rawTransaction,h(r.secondarySignerAddresses,()=>[]),r.feePayerAddress),t=[];r.secondarySignerAddresses&&(t=n?n.map(e=>nM(e)):Array.from({length:r.secondarySignerAddresses.length},()=>nM(void 0)));let i=nM(s),o=new iW(a,h(r.secondarySignerAddresses,()=>[]),t,{address:r.feePayerAddress,authenticator:i});return new iY(e.raw_txn,o).bcsToBytes()}if(r.secondarySignerAddresses){let e=new iL(r.rawTransaction,r.secondarySignerAddresses),t=[];t=n?n.map(e=>nM(e)):Array.from({length:r.secondarySignerAddresses.length},()=>nM(void 0));let i=new iG(a,r.secondarySignerAddresses,t);return new iY(e.raw_txn,i).bcsToBytes()}if(a instanceof t8)t=new iq(a.public_key,a.signature);else if(a instanceof t5||a instanceof t6)t=new iJ(a);else if(a instanceof t4)t=new iJ(a);else throw Error("Invalid public key");return new iY(r.rawTransaction,t).bcsToBytes()}function nM(e){if(!e)return new t4;let t=te.isInstance(e)||tT.isInstance(e)||tz.isInstance(e)?new tF(e):e,i=new t0(new Uint8Array(64));if(tX.isInstance(t))return new t8(t,i);if(tF.isInstance(t))return te.isInstance(t.publicKey)?new t5(t,new tR(ts.getSimulationSignature())):new t5(t,new tR(i));if(tD.isInstance(t))return new t6(t,new tL({signatures:t.publicKeys.map(e=>new tR(te.isInstance(e.publicKey)||tT.isInstance(e.publicKey)?ts.getSimulationSignature():i)),bitmap:t.createBitmap({bits:Array(t.publicKeys.length).fill(0).map((e,t)=>t)})}));throw Error("Unsupported PublicKey used for simulations")}function nH(e){let{transaction:t,feePayerAuthenticator:i,additionalSignersAuthenticators:r}=e,n=eP(t1,e.senderAuthenticator),s;if(t.feePayerAddress){if(!i)throw Error("Must provide a feePayerAuthenticator argument to generate a signed fee payer transaction");s=new iW(n,h(t.secondarySignerAddresses,()=>[]),h(r,()=>[]),{address:t.feePayerAddress,authenticator:i})}else if(t.secondarySignerAddresses){if(!r)throw Error("Must provide a additionalSignersAuthenticators argument to generate a signed multi agent transaction");s=new iG(n,t.secondarySignerAddresses,r)}else s=n instanceof t8?new iq(n.public_key,n.signature):n instanceof t3?new ij(n.public_key,n.signature):new iJ(n);return new iY(t.rawTransaction,s).bcsToBytes()}function nV(e){let t=P.sha3_256.create();for(let i of e)t.update(i);return t.digest()}var nq=nV(["APTOS::Transaction"]);async function nj({key:e,moduleAddress:t,moduleName:i,functionName:r,aptosConfig:n,abi:s,fetch:a}){return void 0!==s?s:eQ(async()=>a(t,i,r,n),`${e}-${n.network}-${t}-${i}-${r}`,3e5)()}async function nG(e){let t=await nW(e);return nJ(e,t)}async function nW(e){let{aptosConfig:t,data:i}=e,r,n;return"bytecode"in i?n=await nN(i):(r="multisigAddress"in i?{aptosConfig:t,multisigAddress:i.multisigAddress,function:i.function,functionArguments:i.functionArguments,typeArguments:i.typeArguments,abi:i.abi}:{aptosConfig:t,function:i.function,functionArguments:i.functionArguments,typeArguments:i.typeArguments,abi:i.abi},n=await nN(r)),n}async function nJ(e,t){let{aptosConfig:i,sender:r,options:n}=e,s;if(!0===e.withFeePayer&&(s=y.ba.ZERO.toString()),"secondarySignerAddresses"in e){let{secondarySignerAddresses:a}=e;return nO({aptosConfig:i,sender:r,payload:t,options:n,secondarySignerAddresses:a,feePayerAddress:s})}return nO({aptosConfig:i,sender:r,payload:t,options:n,feePayerAddress:s})}function nY(e){let{signer:t,transaction:i}=e;return t.signTransactionWithAuthenticator(i)}function nX(e){let{signer:t,transaction:i}=e;if(!i.feePayerAddress)throw Error(`Transaction ${i} is not a Fee Payer transaction`);return i.feePayerAddress=t.accountAddress,nY({signer:t,transaction:i})}async function nZ(e){let{aptosConfig:t,transaction:i,signerPublicKey:r,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}=e,o=nL({transaction:i,signerPublicKey:r,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}),{data:c}=await eG({aptosConfig:t,body:o,path:"transactions/simulate",params:{estimate_gas_unit_price:h(g([e,"access",e=>e.options,"optionalAccess",e=>e.estimateGasUnitPrice]),()=>!1),estimate_max_gas_amount:h(g([e,"access",e=>e.options,"optionalAccess",e=>e.estimateMaxGasAmount]),()=>!1),estimate_prioritized_gas_unit_price:h(g([e,"access",e=>e.options,"optionalAccess",e=>e.estimatePrioritizedGasUnitPrice]),()=>!1)},originMethod:"simulateTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return c}async function nQ(e){let{aptosConfig:t,transactionSubmitter:i}=e,r=void 0===i?t.getTransactionSubmitter():i;if(r)return r.submitTransaction(e);let n=nH({...e});try{let{data:e}=await eG({aptosConfig:t,body:n,path:"transactions",originMethod:"submitTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return e}catch(i){let e=iY.deserialize(new m(n));throw e.authenticator.isSingleSender()&&e.authenticator.sender.isSingleKey()&&(e.authenticator.sender.public_key.publicKey instanceof te||e.authenticator.sender.public_key.publicKey instanceof tT)&&await rt.fetchJWK({aptosConfig:t,publicKey:e.authenticator.sender.public_key.publicKey,kid:e.authenticator.sender.signature.signature.getJwkKid()}),i}}async function n0(e){let{aptosConfig:t,signer:i,feePayer:r,transaction:n,...s}=e;i7(i)&&await i.checkKeylessAccountValidity(t),i7(r)&&await r.checkKeylessAccountValidity(t);let a=e.feePayerAuthenticator||r&&nX({signer:r,transaction:n}),o=nY({signer:i,transaction:n});return nQ({aptosConfig:t,transaction:n,senderAuthenticator:o,feePayerAuthenticator:a,...s})}async function n2(e){let{aptosConfig:t,senderAuthenticator:i,feePayer:r,transaction:n,...s}=e;i7(r)&&await r.checkKeylessAccountValidity(t);let a=nX({signer:r,transaction:n});return nQ({aptosConfig:t,transaction:n,senderAuthenticator:i,feePayerAuthenticator:a,...s})}var n1={typeParameters:[],parameters:[im.u8(),new im(im.u8())]};async function n8(e){let{aptosConfig:t,account:i,metadataBytes:r,moduleBytecode:n,options:s}=e,a=n.map(e=>C.U8(e));return nG({aptosConfig:t,sender:y.ba.from(i),data:{function:"0x1::code::publish_package_txn",functionArguments:[C.U8(r),new C(a)],abi:n1},options:s})}async function n3(e){return rV(e)}async function n5(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return eV({aptosConfig:t,originMethod:"getModules",path:`accounts/${y.ba.from(i).toString()}/modules`,params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion]),limit:h(g([r,"optionalAccess",e=>e.limit]),()=>1e3)}})}async function n6(e){let{aptosConfig:t,accountAddress:i,options:r}=e,{response:n,cursor:s}=await eq({aptosConfig:t,originMethod:"getModulesPage",path:`accounts/${y.ba.from(i).toString()}/modules`,params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion]),cursor:g([r,"optionalAccess",e=>e.cursor]),limit:h(g([r,"optionalAccess",e=>e.limit]),()=>100)}});return{modules:n.data,cursor:s}}async function n4(e){return rq(e)}async function n9(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return eH({aptosConfig:t,originMethod:"getTransactions",path:`accounts/${y.ba.from(i).toString()}/transactions`,params:{start:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit])}})}async function n7(e){let{aptosConfig:t,accountAddress:i,options:r}=e;return eV({aptosConfig:t,originMethod:"getResources",path:`accounts/${y.ba.from(i).toString()}/resources`,params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion]),limit:h(g([r,"optionalAccess",e=>e.limit]),()=>999)}})}async function se(e){let{aptosConfig:t,accountAddress:i,options:r}=e,{response:n,cursor:s}=await eq({aptosConfig:t,originMethod:"getResourcesPage",path:`accounts/${y.ba.from(i).toString()}/resources`,params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion]),cursor:g([r,"optionalAccess",e=>e.cursor]),limit:h(g([r,"optionalAccess",e=>e.limit]),()=>100)}});return{resources:n.data,cursor:s}}async function st(e){let{aptosConfig:t,accountAddress:i,resourceType:r,options:n}=e,{data:s}=await eL({aptosConfig:t,originMethod:"getResource",path:`accounts/${y.ba.from(i).toString()}/resource/${r}`,params:{ledger_version:g([n,"optionalAccess",e=>e.ledgerVersion])}});return s.data}async function si(e){let{aptosConfig:t,authenticationKey:i,options:r}=e,{address_map:{handle:n}}=await st({aptosConfig:t,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:r}),s=y.ba.from(i);try{let e=await rG({aptosConfig:t,handle:n,data:{key:s.toString(),key_type:"address",value_type:"address"},options:r});return y.ba.from(e)}catch(e){if(e instanceof eR&&"table_item_not_found"===e.data.error_code)return s;throw e}}async function sr(e){let{aptosConfig:t,accountAddress:i}=e,r={owner_address:{_eq:y.ba.from(i).toStringLong()},amount:{_gt:0}},n=await rO({aptosConfig:t,query:{query:rw,variables:{where_condition:r}},originMethod:"getAccountTokensCount"});return n.current_token_ownerships_v2_aggregate.aggregate?n.current_token_ownerships_v2_aggregate.aggregate.count:0}async function sn(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={owner_address:{_eq:y.ba.from(i).toStringLong()},amount:{_gt:0}};g([r,"optionalAccess",e=>e.tokenStandard])&&(n.token_standard={_eq:g([r,"optionalAccess",e=>e.tokenStandard])});let s={query:r_,variables:{where_condition:n,offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:s,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function ss(e){let{aptosConfig:t,accountAddress:i,collectionAddress:r,options:n}=e,s={owner_address:{_eq:y.ba.from(i).toStringLong()},current_token_data:{collection_id:{_eq:y.ba.from(r).toStringLong()}},amount:{_gt:0}};g([n,"optionalAccess",e=>e.tokenStandard])&&(s.token_standard={_eq:g([n,"optionalAccess",e=>e.tokenStandard])});let a={query:rA,variables:{where_condition:s,offset:g([n,"optionalAccess",e=>e.offset]),limit:g([n,"optionalAccess",e=>e.limit]),order_by:g([n,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:a,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function sa(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={owner_address:{_eq:y.ba.from(i).toStringLong()}};g([r,"optionalAccess",e=>e.tokenStandard])&&(n.current_collection={token_standard:{_eq:g([r,"optionalAccess",e=>e.tokenStandard])}});let s={query:rm,variables:{where_condition:n,offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:s,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function so(e){let{aptosConfig:t,accountAddress:i}=e,r=y.ba.from(i).toStringLong(),n=await rO({aptosConfig:t,query:{query:rb,variables:{address:r}},originMethod:"getAccountTransactionsCount"});return n.account_transactions_aggregate.aggregate?n.account_transactions_aggregate.aggregate.count:0}async function sc(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n=y.ba.from(i).toStringLong(),s={query:ry,variables:{where_condition:{...g([r,"optionalAccess",e=>e.where]),owner_address:{_eq:n}},offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:s,originMethod:"getAccountCoinsData"})).current_fungible_asset_balances}async function su(e){let{aptosConfig:t,accountAddress:i}=e,r=y.ba.from(i).toStringLong(),n=await rO({aptosConfig:t,query:{query:rf,variables:{address:r}},originMethod:"getAccountCoinsCount"});if(!n.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return n.current_fungible_asset_balances_aggregate.aggregate.count}async function sl(e){let{aptosConfig:t,accountAddress:i,asset:r}=e;return parseInt((await eL({aptosConfig:t,originMethod:"getBalance",path:`accounts/${i}/balance/${r}`,params:{accountAddress:i.toString(),asset:r instanceof Uint8Array?y.ba.from(r).toString():r.toString()}})).data.toString(),10)}async function sd(e){let{aptosConfig:t,accountAddress:i,options:r}=e,n={query:rP,variables:{where_condition:{owner_address:{_eq:y.ba.from(i).toStringLong()}},offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:n,originMethod:"getAccountOwnedObjects"})).current_objects}async function sp(e){let{aptosConfig:t,privateKey:i,options:r}=e,n=h(g([r,"optionalAccess",e=>e.throwIfNoAccountFound]),()=>!1),s=await sv({aptosConfig:t,privateKey:i});if(0===s.length){if(n)throw Error("No existing account found for private key.");return i5.fromPrivateKey({privateKey:i})}return s[0]}async function sh(e){let{aptosConfig:t,accountAddress:i,options:r}=e;try{let[e,n]=await Promise.all([n7({aptosConfig:t,accountAddress:i}),sd({aptosConfig:t,accountAddress:i,options:{limit:1}})]),s=e.find(e=>"0x1::account::Account"===e.type);if(!s&&0===n.length)return!1;if(!g([r,"optionalAccess",e=>e.withAuthKey]))return!0;return(s?s.data.authentication_key:i.toStringLong())===r.withAuthKey.toString()}catch(e){throw Error(`Error while checking if account exists at ${i.toString()}: ${e}`)}}var sg={typeParameters:[],parameters:[new ia,im.u8(),new ia,im.u8(),im.u8(),im.u8()]};async function sf(e){let{aptosConfig:t,fromAccount:i,options:r}=e;if("toNewPrivateKey"in e)return sy({aptosConfig:t,fromAccount:i,toNewPrivateKey:e.toNewPrivateKey,options:r});if("toAccount"in e)return e.toAccount instanceof i1?sy({aptosConfig:t,fromAccount:i,toNewPrivateKey:e.toAccount.privateKey,options:r}):sy({aptosConfig:t,fromAccount:i,toAccount:e.toAccount,options:r});throw Error("Invalid arguments")}async function sy(e){let{aptosConfig:t,fromAccount:i,options:r}=e,n=await n3({aptosConfig:t,accountAddress:i.accountAddress}),s;s="toNewPrivateKey"in e?i5.fromPrivateKey({privateKey:e.toNewPrivateKey,legacy:!0}):e.toAccount;let a=new iH({sequenceNumber:BigInt(n.sequence_number),originator:i.accountAddress,currentAuthKey:y.ba.from(n.authentication_key),newPublicKey:s.publicKey}).bcsToBytes(),o=i.sign(a),c=s.sign(a);return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::account::rotate_authentication_key",functionArguments:[new b(i.signingScheme),C.U8(i.publicKey.toUint8Array()),new b(s.signingScheme),C.U8(s.publicKey.toUint8Array()),C.U8(o.toUint8Array()),C.U8(c.toUint8Array())],abi:sg},options:r})}var sm={typeParameters:[],parameters:[new ia,im.u8()]};async function s_(e){let{aptosConfig:t,fromAccount:i,toNewPublicKey:r,options:n}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::account::rotate_authentication_key_from_public_key",functionArguments:[new b(tG(r)),C.U8(tj(r).toUint8Array())],abi:sm},options:n})}async function sA(e){let{aptosConfig:t,publicKey:i,options:r}=e,n=h(g([r,"optionalAccess",e=>e.noMultiKey]),()=>!1);if(n&&i instanceof tB)throw Error("Multi-key accounts are not supported when noMultiKey is true.");let s=[i];i instanceof tF&&i.publicKey instanceof tX?s.push(i.publicKey):i instanceof tX&&s.push(new tF(i));let[a,o]=await Promise.all([Promise.all(s.map(async e=>{let i=await sz({aptosConfig:t,publicKey:e});if(i)return{...i,publicKey:e}})),i instanceof tB||n?Promise.resolve([]):sT({aptosConfig:t,publicKey:i,options:r})]),c=[];for(let e of a)e&&c.push(e);s.push(...o);let u=new Map(s.map(e=>[e.authKey().toString(),e]));for(let e of(await sE({aptosConfig:t,authKeys:s.map(e=>e.authKey()),options:r}))){if(c.find(t=>t.accountAddress===e.accountAddress))continue;let t=u.get(e.authKey.toString());if(!t)throw Error(`No publicKey found for authentication key ${e.authKey}. This should never happen.`);c.push({accountAddress:e.accountAddress,publicKey:t,lastTransactionVersion:e.lastTransactionVersion})}return c.sort((e,t)=>t.lastTransactionVersion-e.lastTransactionVersion)}async function sw(e){let{aptosConfig:t,signer:i,options:r}=e;if(i instanceof tZ||i instanceof tC)return sv({aptosConfig:t,privateKey:i,options:r});if(i instanceof i1||i instanceof i3)return sv({aptosConfig:t,privateKey:i.privateKey,options:r});if(i instanceof rr||i instanceof rn)return sb({aptosConfig:t,keylessAccount:i,options:r});if(i instanceof rs&&1===i.signers.length)return sw({aptosConfig:t,signer:i.signers[0],options:r});if(i instanceof ra&&1===i.signers.length)return sv({aptosConfig:t,privateKey:i.signers[0],options:r});throw Error("Unknown signer type")}async function sb(e){let{aptosConfig:t,keylessAccount:i,options:r}=e,n=await sA({aptosConfig:t,publicKey:i.getAnyPublicKey(),options:r}),s={proof:i.proofOrPromise,jwt:i.jwt,ephemeralKeyPair:i.ephemeralKeyPair,pepper:i.pepper,verificationKeyHash:i.verificationKeyHash},a=[];for(let{accountAddress:e,publicKey:t}of n)if(t instanceof tB){if(t.getSignaturesRequired()>1)continue;if(t instanceof tM)throw Error("Keyless authentication cannot be used for multi-ed25519 accounts. This should never happen.");t instanceof tD&&a.push(new rs({multiKey:t,signers:[i],address:e}))}else i instanceof rn?a.push(rn.create({...s,address:e,jwkAddress:i.publicKey.jwkAddress})):a.push(rr.create({...s,address:e}));return a}async function sv(e){let{aptosConfig:t,privateKey:i,options:r}=e,n=i5.fromPrivateKey({privateKey:i,legacy:!1}),s=await sA({aptosConfig:t,publicKey:new tF(i.publicKey()),options:r}),a=[];for(let{accountAddress:e,publicKey:t}of s)if(t instanceof tB){if(t.getSignaturesRequired()>1)continue;t instanceof tM?a.push(new ra({publicKey:t,signers:[i],address:e})):t instanceof tD&&a.push(new rs({multiKey:t,signers:[n],address:e}))}else{let r=t instanceof tX;a.push(i5.fromPrivateKey({privateKey:i,address:e,legacy:r}))}return a}async function sT(e){let{aptosConfig:t,publicKey:i,options:r}=e;if(i instanceof tB)throw Error("Public key is a multi-key.");let n=h(g([r,"optionalAccess",e=>e.includeUnverified]),()=>!1),s=i instanceof tF?i:new tF(i),a=s.publicKey,o=y.C.call(void 0,s.variant),c={public_key:{_eq:a.toString()},public_key_type:{_eq:o},...n?{}:{is_public_key_used:{_eq:!0}}},{public_key_auth_keys:u}=await rO({aptosConfig:t,query:{query:rv,variables:{where_condition:c}},originMethod:"getMultiKeysForPublicKey"});return u.map(e=>{switch(e.signature_type){case"multi_ed25519_signature":return tM.deserializeWithoutLength(m.fromHex(e.account_public_key));case"multi_key_signature":return tD.deserialize(m.fromHex(e.account_public_key));default:throw Error(`Unknown multi-signature type: ${e.signature_type}`)}})}async function sE(e){let{aptosConfig:t,authKeys:i,options:r}=e,n=h(g([r,"optionalAccess",e=>e.includeUnverified]),()=>!1);if(0===i.length)throw Error("No authentication keys provided");let s={auth_key:{_in:i.map(e=>e.toString())},...n?{}:{is_auth_key_used:{_eq:!0}}},{auth_key_account_addresses:a}=await rO({aptosConfig:t,query:{query:rg,variables:{where_condition:s,order_by:[{last_transaction_version:"desc"}]}},originMethod:"getAccountAddressesForAuthKeys"});return a.map(e=>({authKey:new I({data:e.auth_key}),accountAddress:new y.ba(y.j.hexInputToUint8Array(e.account_address)),lastTransactionVersion:Number(e.last_transaction_version)}))}async function sS(e){let{aptosConfig:t,accountAddress:i}=e,r=await n9({aptosConfig:t,accountAddress:i,options:{limit:1}});return 0===r.length?0:Number(r[0].version)}async function sz(e){let{aptosConfig:t,publicKey:i}=e,r=i.authKey().derivedAddress(),[n,s]=await Promise.all([sS({aptosConfig:t,accountAddress:r}),sh({aptosConfig:t,accountAddress:r,options:{withAuthKey:i.authKey()}})]);if(s)return{accountAddress:r,lastTransactionVersion:n}}async function sC(e){void 0!==e.minimumLedgerVersion&&await r8({aptosConfig:e.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:e.processorType})}async function sU(e){let{aptosConfig:t,payload:i,options:r}=e,n=await nF({...i,aptosConfig:t}),s=new y.m;n.serialize(s);let a=s.toUint8Array(),{data:o}=await eG({aptosConfig:t,path:"view",originMethod:"view",contentType:"application/x.aptos.view_function+bcs",params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion])},body:a});return o}async function sx(e){let{aptosConfig:t,payload:i,options:r}=e,{data:n}=await eG({aptosConfig:t,originMethod:"viewJson",path:"view",params:{ledger_version:g([r,"optionalAccess",e=>e.ledgerVersion])},body:{function:i.function,type_arguments:h(i.typeArguments,()=>[]),arguments:h(i.functionArguments,()=>[])}});return n}async function sk(e){let{aptosConfig:t,sender:i,authenticationFunction:r,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=y.pa.call(void 0,r);return nG({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::add_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new ip,new i_(iw()),new i_(iw())]}},options:n})}async function sP(e){let{aptosConfig:t,sender:i,authenticationFunction:r,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=y.pa.call(void 0,r);return nG({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::remove_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new ip,new i_(iw()),new i_(iw())]}},options:n})}async function sI(e){let{aptosConfig:t,sender:i,options:r}=e;return nG({aptosConfig:t,sender:i,data:{function:"0x1::account_abstraction::remove_authenticator",typeArguments:[],functionArguments:[],abi:{typeParameters:[],parameters:[]}},options:r})}var sK=class{constructor(e){this.config=e,this.isAccountAbstractionEnabled=async e=>{let t=await this.getAuthenticationFunction(e),{moduleAddress:i,moduleName:r,functionName:n}=y.pa.call(void 0,e.authenticationFunction);return h(g([t,"optionalAccess",e=>e.some,"call",e=>e(e=>y.ba.fromString(i).equals(e.moduleAddress)&&r===e.moduleName&&n===e.functionName)]),()=>!1)},this.enableAccountAbstractionTransaction=this.addAuthenticationFunctionTransaction,this.disableAccountAbstractionTransaction=async e=>{let{accountAddress:t,authenticationFunction:i,options:r}=e;return i?this.removeAuthenticationFunctionTransaction({accountAddress:t,authenticationFunction:i,options:r}):this.removeDispatchableAuthenticatorTransaction({accountAddress:t,options:r})}}async addAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:i,options:r}=e;return sk({aptosConfig:this.config,authenticationFunction:i,sender:t,options:r})}async removeAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:i,options:r}=e;return sP({aptosConfig:this.config,sender:t,authenticationFunction:i,options:r})}async removeDispatchableAuthenticatorTransaction(e){let{accountAddress:t,options:i}=e;return sI({aptosConfig:this.config,sender:t,options:i})}async getAuthenticationFunction(e){let{accountAddress:t}=e,[{vec:i}]=await sU({aptosConfig:this.config,payload:{function:"0x1::account_abstraction::dispatchable_authenticator",functionArguments:[y.ba.from(t)],abi:{typeParameters:[],parameters:[new ip],returnTypes:[]}}});if(0!==i.length)return i[0].map(e=>({moduleAddress:y.ba.fromString(e.module_address),moduleName:e.module_name,functionName:e.function_name}))}},sN=class{constructor(e){this.config=e,this.abstraction=new sK(e)}async getAccountInfo(e){return n3({aptosConfig:this.config,...e})}async getAccountModules(e){return n5({aptosConfig:this.config,...e})}async getAccountModulesPage(e){return n6({aptosConfig:this.config,...e})}async getAccountModule(e){return n4({aptosConfig:this.config,...e})}async getAccountTransactions(e){return n9({aptosConfig:this.config,...e})}async getAccountResources(e){return n7({aptosConfig:this.config,...e})}async getAccountResourcesPage(e){return se({aptosConfig:this.config,...e})}async getAccountResource(e){return st({aptosConfig:this.config,...e})}async lookupOriginalAccountAddress(e){return si({aptosConfig:this.config,...e})}async getAccountTokensCount(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),sr({aptosConfig:this.config,...e})}async getAccountOwnedTokens(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sn({aptosConfig:this.config,...e})}async getAccountOwnedTokensFromCollectionAddress(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ss({aptosConfig:this.config,...e})}async getAccountCollectionsWithOwnedTokens(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sa({aptosConfig:this.config,...e})}async getAccountTransactionsCount(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),so({aptosConfig:this.config,...e})}async getAccountCoinsData(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),sc({aptosConfig:this.config,...e})}async getAccountCoinsCount(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),su({aptosConfig:this.config,...e})}async getAccountAPTAmount(e){return this.getAccountCoinAmount({coinType:eE,faMetadataAddress:eS,...e})}async getAccountCoinAmount(e){let t,{accountAddress:i,coinType:r,faMetadataAddress:n}=e,s=r;if(void 0===r&&void 0!==n&&(s=await eQ(async()=>{try{let e=(await sU({aptosConfig:this.config,payload:{function:"0x1::coin::paired_coin",functionArguments:[n]}}))[0];if(e.vec.length>0&&y.oa.call(void 0,e.vec[0]))return y.na.call(void 0,e.vec[0])}catch(e){}},`coin-mapping-${n.toString()}`,3e5)()),void 0!==r&&void 0!==n)t=y.ba.from(n).toStringLong();else if(void 0!==r&&void 0===n)t=r===eE?y.ba.A.toStringLong():y.ca.call(void 0,y.ba.A,r).toStringLong();else if(void 0===r&&void 0!==n){let e=y.ba.from(n);t=e.toStringLong(),e===y.ba.A&&(s=eE)}else throw Error("Either coinType, faMetadataAddress, or both must be provided");if(void 0!==s){let[e]=await sU({aptosConfig:this.config,payload:{function:"0x1::coin::balance",typeArguments:[s],functionArguments:[i]}});return parseInt(e,10)}let[a]=await sU({aptosConfig:this.config,payload:{function:"0x1::primary_fungible_store::balance",typeArguments:["0x1::object::ObjectCore"],functionArguments:[i,t]}});return parseInt(a,10)}async getBalance(e){return sl({aptosConfig:this.config,...e})}async getAccountOwnedObjects(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),sd({aptosConfig:this.config,...e})}async deriveAccountFromPrivateKey(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_restoration_processor"}),await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),sp({aptosConfig:this.config,...e})}async deriveOwnedAccountsFromSigner(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_restoration_processor"}),await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),sw({aptosConfig:this.config,...e})}async getAccountsForPublicKey(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_restoration_processor"}),await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),sA({aptosConfig:this.config,...e})}},s$=p(i(13418)),sF=class{constructor(e){if(g([e,"optionalAccess",e=>e.fullnode])||g([e,"optionalAccess",e=>e.indexer])||g([e,"optionalAccess",e=>e.faucet])||g([e,"optionalAccess",e=>e.pepper])||g([e,"optionalAccess",e=>e.prover])){if("custom"===g([e,"optionalAccess",e=>e.network]))console.info("Note: using CUSTOM network will require queries to lookup ChainId");else if(!g([e,"optionalAccess",e=>e.network]))throw Error("Custom endpoints require a network to be specified")}this.network=h(g([e,"optionalAccess",e=>e.network]),()=>"devnet"),this.fullnode=g([e,"optionalAccess",e=>e.fullnode]),this.faucet=g([e,"optionalAccess",e=>e.faucet]),this.pepper=g([e,"optionalAccess",e=>e.pepper]),this.prover=g([e,"optionalAccess",e=>e.prover]),this.indexer=g([e,"optionalAccess",e=>e.indexer]),this.client=h(g([e,"optionalAccess",e=>e.client]),()=>({provider:s$.default})),this.clientConfig=h(g([e,"optionalAccess",e=>e.clientConfig]),()=>({})),this.fullnodeConfig=h(g([e,"optionalAccess",e=>e.fullnodeConfig]),()=>({})),this.indexerConfig=h(g([e,"optionalAccess",e=>e.indexerConfig]),()=>({})),this.faucetConfig=h(g([e,"optionalAccess",e=>e.faucetConfig]),()=>({})),this.transactionGenerationConfig=h(g([e,"optionalAccess",e=>e.transactionGenerationConfig]),()=>({})),this.pluginConfig=g([e,"optionalAccess",e=>e.pluginSettings])?{...e.pluginSettings,IGNORE_TRANSACTION_SUBMITTER:!1}:void 0}getRequestUrl(e){switch(e){case"Fullnode":if(void 0!==this.fullnode)return this.fullnode;if("custom"===this.network)throw Error("Please provide a custom full node url");return eh[this.network];case"Faucet":if(void 0!==this.faucet)return this.faucet;if("testnet"===this.network)throw Error("There is no way to programmatically mint testnet APT, you must use the minting site at https://aptos.dev/network/faucet");if("mainnet"===this.network)throw Error("There is no mainnet faucet");if("custom"===this.network)throw Error("Please provide a custom faucet url");return eg[this.network];case"Indexer":if(void 0!==this.indexer)return this.indexer;if("custom"===this.network)throw Error("Please provide a custom indexer url");return ep[this.network];case"Pepper":if(void 0!==this.pepper)return this.pepper;if("custom"===this.network)throw Error("Please provide a custom pepper service url");return ef[this.network];case"Prover":if(void 0!==this.prover)return this.prover;if("custom"===this.network)throw Error("Please provide a custom prover service url");return ey[this.network];default:throw Error(`apiType ${e} is not supported`)}}isPepperServiceRequest(e){return ef[this.network]===e}isProverServiceRequest(e){return ey[this.network]===e}getDefaultMaxGasAmount(){return h(g([this,"access",e=>e.transactionGenerationConfig,"optionalAccess",e=>e.defaultMaxGasAmount]),()=>2e5)}getDefaultTxnExpirySecFromNow(){return h(g([this,"access",e=>e.transactionGenerationConfig,"optionalAccess",e=>e.defaultTxnExpirySecFromNow]),()=>20)}setIgnoreTransactionSubmitter(e){this.pluginConfig&&(this.pluginConfig.IGNORE_TRANSACTION_SUBMITTER=e)}getTransactionSubmitter(){if(void 0!==this.pluginConfig&&!0!==this.pluginConfig.IGNORE_TRANSACTION_SUBMITTER)return this.pluginConfig.TRANSACTION_SUBMITTER}},sR={typeParameters:[{constraints:[]}],parameters:[new ip,new iu]};async function sB(e){let{aptosConfig:t,sender:i,recipient:r,amount:n,coinType:s,options:a}=e;return nG({aptosConfig:t,sender:i,data:{function:"0x1::aptos_account::transfer_coins",typeArguments:[h(s,()=>eE)],functionArguments:[r,n],abi:sR},options:a})}var sD=class{constructor(e){this.config=e}async transferCoinTransaction(e){return sB({aptosConfig:this.config,...e})}},sO={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",STRING:"0x1::string::String",ARRAY:"vector<u8>"},sL="0x4::token::Token";async function sM(e){let{aptosConfig:t,digitalAssetAddress:i}=e,r={token_data_id:{_eq:y.ba.from(i).toStringLong()}};return(await rO({aptosConfig:t,query:{query:rR,variables:{where_condition:r}},originMethod:"getDigitalAssetData"})).current_token_datas_v2[0]}async function sH(e){let{aptosConfig:t,digitalAssetAddress:i}=e,r={token_data_id:{_eq:y.ba.from(i).toStringLong()},amount:{_gt:0}};return(await rO({aptosConfig:t,query:{query:rF,variables:{where_condition:r}},originMethod:"getCurrentDigitalAssetOwnership"})).current_token_ownerships_v2[0]}async function sV(e){let{aptosConfig:t,ownerAddress:i,options:r}=e,n={query:rF,variables:{where_condition:{owner_address:{_eq:y.ba.from(i).toStringLong()},amount:{_gt:0}},offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:n,originMethod:"getOwnedDigitalAssets"})).current_token_ownerships_v2}async function sq(e){let{aptosConfig:t,digitalAssetAddress:i,options:r}=e,n={query:r$,variables:{where_condition:{token_data_id:{_eq:y.ba.from(i).toStringLong()}},offset:g([r,"optionalAccess",e=>e.offset]),limit:g([r,"optionalAccess",e=>e.limit]),order_by:g([r,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:n,originMethod:"getDigitalAssetActivity"})).token_activities_v2}var sj={typeParameters:[],parameters:[new i_(iw()),new iu,new i_(iw()),new i_(iw()),new is,new is,new is,new is,new is,new is,new is,new is,new is,new iu,new iu]};async function sG(e){let{aptosConfig:t,options:i,creator:r}=e;return nG({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::create_collection",functionArguments:[new x(e.description),new E(h(e.maxSupply,()=>y.e)),new x(e.name),new x(e.uri),new w(h(e.mutableDescription,()=>!0)),new w(h(e.mutableRoyalty,()=>!0)),new w(h(e.mutableURI,()=>!0)),new w(h(e.mutableTokenDescription,()=>!0)),new w(h(e.mutableTokenName,()=>!0)),new w(h(e.mutableTokenProperties,()=>!0)),new w(h(e.mutableTokenURI,()=>!0)),new w(h(e.tokensBurnableByCreator,()=>!0)),new w(h(e.tokensFreezableByCreator,()=>!0)),new E(h(e.royaltyNumerator,()=>0)),new E(h(e.royaltyDenominator,()=>1))],abi:sj},options:i})}async function sW(e){let{aptosConfig:t,options:i}=e,r=g([i,"optionalAccess",e=>e.where]);g([i,"optionalAccess",e=>e.tokenStandard])&&(r.token_standard={_eq:h(g([i,"optionalAccess",e=>e.tokenStandard]),()=>"v2")});let n={query:rE,variables:{where_condition:r,offset:g([i,"optionalAccess",e=>e.offset]),limit:g([i,"optionalAccess",e=>e.limit])}};return(await rO({aptosConfig:t,query:n,originMethod:"getCollectionData"})).current_collections_v2[0]}async function sJ(e){let{aptosConfig:t,creatorAddress:i,collectionName:r,options:n}=e,s={collection_name:{_eq:r},creator_address:{_eq:y.ba.from(i).toStringLong()}};return g([n,"optionalAccess",e=>e.tokenStandard])&&(s.token_standard={_eq:h(g([n,"optionalAccess",e=>e.tokenStandard]),()=>"v2")}),sW({aptosConfig:t,options:{...n,where:s}})}async function sY(e){let{aptosConfig:t,creatorAddress:i,options:r}=e,n={creator_address:{_eq:y.ba.from(i).toStringLong()}};return g([r,"optionalAccess",e=>e.tokenStandard])&&(n.token_standard={_eq:h(g([r,"optionalAccess",e=>e.tokenStandard]),()=>"v2")}),sW({aptosConfig:t,options:{...r,where:n}})}async function sX(e){let{aptosConfig:t,collectionId:i,options:r}=e,n={collection_id:{_eq:y.ba.from(i).toStringLong()}};return g([r,"optionalAccess",e=>e.tokenStandard])&&(n.token_standard={_eq:h(g([r,"optionalAccess",e=>e.tokenStandard]),()=>"v2")}),sW({aptosConfig:t,options:{...r,where:n}})}async function sZ(e){let{creatorAddress:t,collectionName:i,options:r,aptosConfig:n}=e,s={collection_name:{_eq:i},creator_address:{_eq:y.ba.from(t).toStringLong()}};return g([r,"optionalAccess",e=>e.tokenStandard])&&(s.token_standard={_eq:h(g([r,"optionalAccess",e=>e.tokenStandard]),()=>"v2")}),(await sW({aptosConfig:n,options:{where:s}})).collection_id}var sQ={typeParameters:[],parameters:[new i_(iw()),new i_(iw()),new i_(iw()),new i_(iw()),new im(new i_(iw())),new im(new i_(iw())),new im(im.u8())]};async function s0(e){let{aptosConfig:t,options:i,creator:r,collection:n,description:s,name:a,uri:o,propertyKeys:c,propertyTypes:u,propertyValues:l}=e,d=g([u,"optionalAccess",e=>e.map,"call",e=>e(e=>sO[e])]);return nG({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::mint",functionArguments:[new x(n),new x(s),new x(a),new x(o),C.MoveString(h(c,()=>[])),C.MoveString(h(d,()=>[])),am(h(l,()=>[]),h(d,()=>[]))],abi:sQ},options:i})}var s2={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new ip]};async function s1(e){let{aptosConfig:t,sender:i,digitalAssetAddress:r,recipient:n,digitalAssetType:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::object::transfer",typeArguments:[h(s,()=>sL)],functionArguments:[y.ba.from(r),y.ba.from(n)],abi:s2},options:a})}var s8={typeParameters:[],parameters:[new i_(iw()),new i_(iw()),new i_(iw()),new i_(iw()),new im(new i_(iw())),new im(new i_(iw())),new im(im.u8()),new ip]};async function s3(e){let{aptosConfig:t,account:i,collection:r,description:n,name:s,uri:a,recipient:o,propertyKeys:c,propertyTypes:u,propertyValues:l,options:d}=e;if(g([c,"optionalAccess",e=>e.length])!==g([l,"optionalAccess",e=>e.length]))throw Error("Property keys and property values counts do not match");if(g([u,"optionalAccess",e=>e.length])!==g([l,"optionalAccess",e=>e.length]))throw Error("Property types and property values counts do not match");let p=g([u,"optionalAccess",e=>e.map,"call",e=>e(e=>sO[e])]);return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::mint_soul_bound",functionArguments:[r,n,s,a,C.MoveString(h(c,()=>[])),C.MoveString(h(p,()=>[])),am(h(l,()=>[]),h(p,()=>[])),o],abi:s8},options:d})}var s5={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0)))]};async function s6(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::burn",typeArguments:[h(n,()=>sL)],functionArguments:[y.ba.from(r)],abi:s5},options:s})}var s4={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0)))]};async function s9(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::freeze_transfer",typeArguments:[h(n,()=>sL)],functionArguments:[r],abi:s4},options:s})}var s7={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0)))]};async function ae(e){let{aptosConfig:t,creator:i,digitalAssetAddress:r,digitalAssetType:n,options:s}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::unfreeze_transfer",typeArguments:[h(n,()=>sL)],functionArguments:[r],abi:s7},options:s})}var at={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw())]};async function ai(e){let{aptosConfig:t,creator:i,description:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_description",typeArguments:[h(s,()=>sL)],functionArguments:[y.ba.from(n),new x(r)],abi:at},options:a})}var ar={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw())]};async function an(e){let{aptosConfig:t,creator:i,name:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_name",typeArguments:[h(s,()=>sL)],functionArguments:[y.ba.from(n),new x(r)],abi:ar},options:a})}var as={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw())]};async function aa(e){let{aptosConfig:t,creator:i,uri:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::set_uri",typeArguments:[h(s,()=>sL)],functionArguments:[y.ba.from(n),new x(r)],abi:as},options:a})}var ao={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw()),new i_(iw()),im.u8()]};async function ac(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::add_property",typeArguments:[h(o,()=>sL)],functionArguments:[y.ba.from(a),new x(r),new x(sO[n]),C.U8(a_(s,sO[n]))],abi:ao},options:c})}var au={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw())]};async function al(e){let{aptosConfig:t,creator:i,propertyKey:r,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::remove_property",typeArguments:[h(s,()=>sL)],functionArguments:[y.ba.from(n),new x(r)],abi:au},options:a})}var ad={typeParameters:[{constraints:["key"]}],parameters:[new i_(ib(new iy(0))),new i_(iw()),new i_(iw()),im.u8()]};async function ap(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::update_property",typeArguments:[h(o,()=>sL)],functionArguments:[y.ba.from(a),new x(r),new x(sO[n]),a_(s,sO[n])],abi:ad},options:c})}var ah={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new i_(ib(new iy(0))),new i_(iw()),new iy(1)]};async function ag(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::add_typed_property",typeArguments:[h(o,()=>sL),sO[n]],functionArguments:[y.ba.from(a),new x(r),s],abi:ah},options:c})}var af={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new i_(ib(new iy(0))),new i_(iw()),new iy(1)]};async function ay(e){let{aptosConfig:t,creator:i,propertyKey:r,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::update_typed_property",typeArguments:[h(o,()=>sL),sO[n]],functionArguments:[y.ba.from(a),new x(r),s],abi:af},options:c})}function am(e,t){let i=[];return t.forEach((t,r)=>{i.push(a_(e[r],t))}),i}function a_(e,t){return nK(e,nr(t),0,[]).bcsToBytes()}var aA=class{constructor(e){this.config=e}async getCollectionData(e){await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"});let{creatorAddress:t,collectionName:i,options:r}=e,n={collection_name:{_eq:i},creator_address:{_eq:y.ba.from(t).toStringLong()}};return g([r,"optionalAccess",e=>e.tokenStandard])&&(n.token_standard={_eq:h(g([r,"optionalAccess",e=>e.tokenStandard]),()=>"v2")}),sW({aptosConfig:this.config,options:{where:n}})}async getCollectionDataByCreatorAddressAndCollectionName(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sJ({aptosConfig:this.config,...e})}async getCollectionDataByCreatorAddress(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sY({aptosConfig:this.config,...e})}async getCollectionDataByCollectionId(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sX({aptosConfig:this.config,...e})}async getCollectionId(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sZ({aptosConfig:this.config,...e})}async getDigitalAssetData(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sM({aptosConfig:this.config,...e})}async getCurrentDigitalAssetOwnership(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sH({aptosConfig:this.config,...e})}async getOwnedDigitalAssets(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sV({aptosConfig:this.config,...e})}async getDigitalAssetActivity(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sq({aptosConfig:this.config,...e})}async createCollectionTransaction(e){return sG({aptosConfig:this.config,...e})}async mintDigitalAssetTransaction(e){return s0({aptosConfig:this.config,...e})}async transferDigitalAssetTransaction(e){return s1({aptosConfig:this.config,...e})}async mintSoulBoundTransaction(e){return s3({aptosConfig:this.config,...e})}async burnDigitalAssetTransaction(e){return s6({aptosConfig:this.config,...e})}async freezeDigitalAssetTransaferTransaction(e){return s9({aptosConfig:this.config,...e})}async unfreezeDigitalAssetTransaferTransaction(e){return ae({aptosConfig:this.config,...e})}async setDigitalAssetDescriptionTransaction(e){return ai({aptosConfig:this.config,...e})}async setDigitalAssetNameTransaction(e){return an({aptosConfig:this.config,...e})}async setDigitalAssetURITransaction(e){return aa({aptosConfig:this.config,...e})}async addDigitalAssetPropertyTransaction(e){return ac({aptosConfig:this.config,...e})}async removeDigitalAssetPropertyTransaction(e){return al({aptosConfig:this.config,...e})}async updateDigitalAssetPropertyTransaction(e){return ap({aptosConfig:this.config,...e})}async addDigitalAssetTypedPropertyTransaction(e){return ag({aptosConfig:this.config,...e})}async updateDigitalAssetTypedPropertyTransaction(e){return ay({aptosConfig:this.config,...e})}};async function aw(e){let{aptosConfig:t,accountAddress:i,amount:r,options:n}=e,s=g([n,"optionalAccess",e=>e.timeoutSecs])||20,{data:a}=await eJ({aptosConfig:t,path:"fund",body:{address:y.ba.from(i).toString(),amount:r},originMethod:"fundAccount"}),o=a.txn_hashes[0],c=await r1({aptosConfig:t,transactionHash:o,options:{timeoutSecs:s,checkSuccess:g([n,"optionalAccess",e=>e.checkSuccess])}});if("user_transaction"===c.type)return c;throw Error(`Unexpected transaction received for fund account: ${c.type}`)}var ab=class{constructor(e){this.config=e}async fundAccount(e){let t=await aw({aptosConfig:this.config,...e});return(void 0===g([e,"access",e=>e.options,"optionalAccess",e=>e.waitForIndexer])||g([e,"access",e=>e.options,"optionalAccess",e=>e.waitForIndexer]))&&await r8({aptosConfig:this.config,minimumLedgerVersion:BigInt(t.version),processorType:"fungible_asset_processor"}),t}};async function av(e){let{aptosConfig:t,options:i}=e,r={query:rU,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset])}};return(await rO({aptosConfig:t,query:r,originMethod:"getFungibleAssetMetadata"})).fungible_asset_metadata}async function aT(e){let{aptosConfig:t,options:i}=e,r={query:rC,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset])}};return(await rO({aptosConfig:t,query:r,originMethod:"getFungibleAssetActivities"})).fungible_asset_activities}async function aE(e){let{aptosConfig:t,options:i}=e,r={query:rS,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset])}};return(await rO({aptosConfig:t,query:r,originMethod:"getCurrentFungibleAssetBalances"})).current_fungible_asset_balances}var aS={typeParameters:[{constraints:[]}],parameters:[nr("0x1::object::Object"),new ip,new iu]};async function az(e){let{aptosConfig:t,sender:i,fungibleAssetMetadataAddress:r,recipient:n,amount:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[r,n,s],abi:aS},options:a})}async function aC(e){let{aptosConfig:t,sender:i,fromStore:r,toStore:n,amount:s,options:a}=e;return nG({aptosConfig:t,sender:i.accountAddress,data:{function:"0x1::dispatchable_fungible_asset::transfer",typeArguments:["0x1::fungible_asset::FungibleStore"],functionArguments:[r,n,s],abi:aS},options:a})}var aU=class{constructor(e){this.config=e}async getFungibleAssetMetadata(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),av({aptosConfig:this.config,...e})}async getFungibleAssetMetadataByAssetType(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),(await av({aptosConfig:this.config,options:{where:{asset_type:{_eq:e.assetType}}}}))[0]}async getFungibleAssetMetadataByCreatorAddress(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),await av({aptosConfig:this.config,options:{where:{creator_address:{_eq:y.ba.from(e.creatorAddress).toStringLong()}}}})}async getFungibleAssetActivities(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),aT({aptosConfig:this.config,...e})}async getCurrentFungibleAssetBalances(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"fungible_asset_processor"}),aE({aptosConfig:this.config,...e})}async transferFungibleAsset(e){return az({aptosConfig:this.config,...e})}async transferFungibleAssetBetweenStores(e){return aC({aptosConfig:this.config,...e})}},ax=class{constructor(e){this.config=e}async getLedgerInfo(){return rB({aptosConfig:this.config})}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getBlockByVersion(e){return r6({aptosConfig:this.config,...e})}async getBlockByHeight(e){return r4({aptosConfig:this.config,...e})}async view(e){return sU({aptosConfig:this.config,...e})}async viewJson(e){return sx({aptosConfig:this.config,...e})}async getChainTopUserTransactions(e){return rD({aptosConfig:this.config,...e})}async queryIndexer(e){return rO({aptosConfig:this.config,...e})}async getIndexerLastSuccessVersion(){return rM({aptosConfig:this.config})}async getProcessorStatus(e){return rH({aptosConfig:this.config,processorType:e})}},ak="A name must be between 3 and 63 characters long, and can only contain lowercase a-z, 0-9, and hyphens. A name may not start or end with a hyphen.";function aP(e){return!(!e||e.length<3||e.length>63||!/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/.test(e))}function aI(e){let[t,i,...r]=e.replace(/\.apt$/,"").split(".");if(r.length>0)throw Error(`${e} is invalid. A name can only have two parts, a domain and a subdomain separated by a "."`);if(!aP(t))throw Error(`${t} is not valid. ${ak}`);if(i&&!aP(i))throw Error(`${i} is not valid. ${ak}`);return{domainName:i||t,subdomainName:i?t:void 0}}function aK(e){if(!e)return!1;let t=new Date(e.domain_expiration_timestamp).getTime()<Date.now(),i=new Date(e.expiration_timestamp).getTime()<Date.now();return(!e.subdomain||!t)&&(!!e.subdomain&&1===e.subdomain_expiration_policy||!i)}var aN={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c",local:"0x585fc9f0f0c54183b039ffc770ca282ebd87307916c215a3e692f2f8e4305e82",custom:null,devnet:null,shelbynet:null};function a$(e){let t=aN[e.network];if(!t)throw Error(`The ANS contract is not deployed to ${e.network}`);return t}var aF=e=>{if(e&&"object"==typeof e&&"vec"in e&&Array.isArray(e.vec))return e.vec[0]};async function aR(e){let{aptosConfig:t,name:i}=e,r=a$(t),{domainName:n,subdomainName:s}=aI(i),a=aF((await sU({aptosConfig:t,payload:{function:`${r}::router::get_owner_addr`,functionArguments:[n,s]}}))[0]);return a?y.ba.from(a):void 0}async function aB(e){let{aptosConfig:t,expiration:i,name:r,sender:n,targetAddress:s,toAddress:a,options:o,transferable:c}=e,u=a$(t),{domainName:l,subdomainName:d}=aI(r),p="subdomain:independent"===i.policy||"subdomain:follow-domain"===i.policy;if(d&&!p)throw Error("Subdomains must have an expiration policy of either 'subdomain:independent' or 'subdomain:follow-domain'");if(p&&!d)throw Error(`Policy is set to ${i.policy} but no subdomain was provided`);if("domain"===i.policy){let e=h(i.years,()=>1);if(1!==e)throw Error("For now, names can only be registered for 1 year at a time");return await nG({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_domain`,functionArguments:[l,31536e3*e,s,a]},options:o})}if(!d)throw Error(`${i.policy} requires a subdomain to be provided.`);let g=await aD({aptosConfig:t,name:l});if(!g)throw Error("The domain does not exist");let f="subdomain:independent"===i.policy?i.expirationDate:g;if(f>g)throw Error("The subdomain expiration time cannot be greater than the domain expiration time");return await nG({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_subdomain`,functionArguments:[l,d,Math.round(f/1e3),"subdomain:follow-domain"===i.policy?1:0,!!c,s,a]},options:o})}async function aD(e){let{aptosConfig:t,name:i}=e,r=a$(t),{domainName:n,subdomainName:s}=aI(i);try{let e=await sU({aptosConfig:t,payload:{function:`${r}::router::get_expiration`,functionArguments:[n,s]}});return 1e3*Number(e[0])}catch(e){return}}async function aO(e){let{aptosConfig:t,address:i}=e,r=a$(t),n=await sU({aptosConfig:t,payload:{function:`${r}::router::get_primary_name`,functionArguments:[y.ba.from(i).toString()]}}),s=aF(n[1]),a=aF(n[0]);if(s)return[a,s].filter(Boolean).join(".")}async function aL(e){let{aptosConfig:t,sender:i,name:r,options:n}=e,s=a$(t);if(!r)return await nG({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${s}::router::clear_primary_name`,functionArguments:[]},options:n});let{domainName:a,subdomainName:o}=aI(r);return await nG({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${s}::router::set_primary_name`,functionArguments:[a,o]},options:n})}async function aM(e){let{aptosConfig:t,name:i}=e,r=a$(t),{domainName:n,subdomainName:s}=aI(i),a=aF((await sU({aptosConfig:t,payload:{function:`${r}::router::get_target_addr`,functionArguments:[n,s]}}))[0]);return a?y.ba.from(a):void 0}async function aH(e){let{aptosConfig:t,sender:i,name:r,address:n,options:s}=e,a=a$(t),{domainName:o,subdomainName:c}=aI(r);return await nG({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${a}::router::set_target_addr`,functionArguments:[o,c,n]},options:s})}async function aV(e){let{aptosConfig:t,name:i}=e,{domainName:r,subdomainName:n=""}=aI(i),s=(await rO({aptosConfig:t,query:{query:rx,variables:{where_condition:{domain:{_eq:r},subdomain:{_eq:n}},limit:1}},originMethod:"getName"})).current_aptos_names[0];return s&&(s=aX(s)),aK(s)?s:void 0}async function aq(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aJ({aptosConfig:t});return(await rO({aptosConfig:t,originMethod:"getAccountNames",query:{query:rx,variables:{limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset]),order_by:g([i,"optionalAccess",e=>e.orderBy]),where_condition:{...h(g([e,"access",e=>e.options,"optionalAccess",e=>e.where]),()=>({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n}}}}})).current_aptos_names.map(aX)}async function aj(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aJ({aptosConfig:t});return(await rO({aptosConfig:t,originMethod:"getAccountDomains",query:{query:rx,variables:{limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset]),order_by:g([i,"optionalAccess",e=>e.orderBy]),where_condition:{...h(g([e,"access",e=>e.options,"optionalAccess",e=>e.where]),()=>({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n},subdomain:{_eq:""}}}}})).current_aptos_names.map(aX)}async function aG(e){let{aptosConfig:t,options:i,accountAddress:r}=e,n=await aJ({aptosConfig:t});return(await rO({aptosConfig:t,originMethod:"getAccountSubdomains",query:{query:rx,variables:{limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset]),order_by:g([i,"optionalAccess",e=>e.orderBy]),where_condition:{...h(g([e,"access",e=>e.options,"optionalAccess",e=>e.where]),()=>({})),owner_address:{_eq:r.toString()},expiration_timestamp:{_gte:n},subdomain:{_neq:""}}}}})).current_aptos_names.map(aX)}async function aW(e){let{aptosConfig:t,options:i,domain:r}=e;return(await rO({aptosConfig:t,originMethod:"getDomainSubdomains",query:{query:rx,variables:{limit:g([i,"optionalAccess",e=>e.limit]),offset:g([i,"optionalAccess",e=>e.offset]),order_by:g([i,"optionalAccess",e=>e.orderBy]),where_condition:{...h(g([e,"access",e=>e.options,"optionalAccess",e=>e.where]),()=>({})),domain:{_eq:r},subdomain:{_neq:""}}}}})).current_aptos_names.map(aX).filter(aK)}async function aJ(e){let{aptosConfig:t}=e,i=a$(t),[r]=await sU({aptosConfig:t,payload:{function:`${i}::config::reregistration_grace_sec`,functionArguments:[]}}),n=()=>new Date;return new Date(n().setDate(n().getDate()-r/60/60/24)).toISOString()}async function aY(e){let{aptosConfig:t,sender:i,name:r,years:n=1,options:s}=e,a=a$(t),{domainName:o,subdomainName:c}=aI(r);if(c)throw Error("Subdomains cannot be renewed");if(1!==n)throw Error("Currently, only 1 year renewals are supported");return await nG({aptosConfig:t,sender:i.accountAddress.toString(),data:{function:`${a}::router::renew_domain`,functionArguments:[o,31536e3*n]},options:s})}function aX(e){return{...e,expiration_timestamp:new Date(e.expiration_timestamp).getTime()}}var aZ=class{constructor(e){this.config=e}async getOwnerAddress(e){return aR({aptosConfig:this.config,...e})}async getExpiration(e){return aD({aptosConfig:this.config,...e})}async getTargetAddress(e){return aM({aptosConfig:this.config,...e})}async setTargetAddress(e){return aH({aptosConfig:this.config,...e})}async getPrimaryName(e){return aO({aptosConfig:this.config,...e})}async setPrimaryName(e){return aL({aptosConfig:this.config,...e})}async registerName(e){return aB({aptosConfig:this.config,...e})}async renewDomain(e){return aY({aptosConfig:this.config,...e})}async getName(e){return aV({aptosConfig:this.config,...e})}async getAccountNames(e){return aq({aptosConfig:this.config,...e})}async getAccountDomains(e){return aj({aptosConfig:this.config,...e})}async getAccountSubdomains(e){return aG({aptosConfig:this.config,...e})}async getDomainSubdomains(e){return aW({aptosConfig:this.config,...e})}};async function aQ(e){let{aptosConfig:t,poolAddress:i}=e,r=y.ba.from(i).toStringLong(),n=await rO({aptosConfig:t,query:{query:rk,variables:{where_condition:{pool_address:{_eq:r}}}}});return n.num_active_delegator_per_pool[0]?n.num_active_delegator_per_pool[0].num_active_delegator:0}async function a0(e){let{aptosConfig:t,options:i}=e,r={query:rk,variables:{order_by:g([i,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:r})).num_active_delegator_per_pool}async function a2(e){let{aptosConfig:t,delegatorAddress:i,poolAddress:r}=e,n={query:rz,variables:{delegatorAddress:y.ba.from(i).toStringLong(),poolAddress:y.ba.from(r).toStringLong()}};return(await rO({aptosConfig:t,query:n})).delegated_staking_activities}var a1=class{constructor(e){this.config=e}async getNumberOfDelegators(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"stake_processor"}),aQ({aptosConfig:this.config,...e})}async getNumberOfDelegatorsForAllPools(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"stake_processor"}),a0({aptosConfig:this.config,...e})}async getDelegatedStakingActivities(e){return await sC({config:this.config,minimumLedgerVersion:g([e,"optionalAccess",e=>e.minimumLedgerVersion]),processorType:"stake_processor"}),a2({aptosConfig:this.config,...e})}},a8=class{constructor(e){this.config=e}async simple(e){return nG({aptosConfig:this.config,...e})}async multiAgent(e){return nG({aptosConfig:this.config,...e})}};function a3(e,t){if(!(void 0!==e.getTransactionSubmitter()||void 0!==t.transactionSubmitter)&&t.transaction.feePayerAddress&&!t.feePayerAuthenticator)throw Error("You are submitting a Fee Payer transaction but missing the feePayerAuthenticator")}function a5(e,t,i){let r=i.value;return i.value=async function(...e){return r.apply(this,e)},i}var a6=class{constructor(e){this.config=e}async simple(e){return nZ({aptosConfig:this.config,...e})}async multiAgent(e){return nZ({aptosConfig:this.config,...e})}};y.a.call(void 0,[a5],a6.prototype,"simple",1),y.a.call(void 0,[a5],a6.prototype,"multiAgent",1);var a4=class{constructor(e){this.config=e}async simple(e){return a3(this.config,e),nQ({aptosConfig:this.config,...e})}async multiAgent(e){return a3(this.config,e),nQ({aptosConfig:this.config,...e})}},a9=class{constructor(e,t,i,r,n){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.aptosConfig=e,this.account=t,this.maxWaitTime=i,this.maximumInFlight=r,this.sleepTime=n}async nextSequenceNumber(){for(;this.lock;)await y.fa.call(void 0,this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((null===this.lastUncommintedNumber||null===this.currentNumber)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();let e=y.ha.call(void 0);for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await y.fa.call(void 0,this.sleepTime),y.ha.call(void 0)-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(e){console.error("error in getting next sequence number for this account",e)}finally{this.lock=!1}return e}async initialize(){let{sequence_number:e}=await n3({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){let{sequence_number:e}=await n3({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await y.fa.call(void 0,this.sleepTime);this.lock=!0;try{await this.update();let e=y.ha.call(void 0);for(;this.lastUncommintedNumber!==this.currentNumber;)y.ha.call(void 0)-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):(await y.fa.call(void 0,this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}},a7=class{constructor(){this.queue=[],this.pendingDequeue=[],this.cancelled=!1}enqueue(e){if(this.cancelled=!1,this.pendingDequeue.length>0){g([this,"access",e=>e.pendingDequeue,"access",e=>e.shift,"call",e=>e(),"optionalAccess",e=>e.resolve,"call",t=>t(e)]);return}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise((e,t)=>{this.pendingDequeue.push({resolve:e,reject:t})})}isEmpty(){return 0===this.queue.length}cancel(){this.cancelled=!0,this.pendingDequeue.forEach(async({reject:e})=>{e(new oe("Task cancelled"))}),this.pendingDequeue=[],this.queue.length=0}isCancelled(){return this.cancelled}pendingDequeueLength(){return this.pendingDequeue.length}},oe=class extends Error{},ot="fulfilled",oi=t.TransactionWorkerEventsEnum=((d=oi||{}).TransactionSent="transactionSent",d.TransactionSendFailed="transactionSendFailed",d.TransactionExecuted="transactionExecuted",d.TransactionExecutionFailed="transactionExecutionFailed",d.ExecutionFinish="executionFinish",d),or=t.TransactionWorker=class extends i9.default{constructor(e,t,i=30,r=100,n=10){super(),this.taskQueue=new a7,this.transactionsQueue=new a7,this.outstandingTransactions=new a7,this.sentTransactions=[],this.executedTransactions=[],this.aptosConfig=e,this.account=t,this.started=!1,this.accountSequnceNumber=new a9(e,t,i,r,n)}async submitNextTransaction(){try{for(;;){let e=await this.accountSequnceNumber.nextSequenceNumber();if(null===e)return;let t=await this.generateNextTransaction(this.account,e);if(!t)return;let i=n0({aptosConfig:this.aptosConfig,transaction:t,signer:this.account});await this.outstandingTransactions.enqueue([i,e])}}catch(e){if(e instanceof oe)return;throw Error(`Submit transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async processTransactions(){try{for(;;){let e=[],t=[],[i,r]=await this.outstandingTransactions.dequeue();for(e.push(i),t.push(r);!this.outstandingTransactions.isEmpty();)[i,r]=await this.outstandingTransactions.dequeue(),e.push(i),t.push(r);let n=await Promise.allSettled(e);for(let e=0;e<n.length&&e<t.length;e+=1){let i=n[e];r=t[e],i.status===ot?(this.sentTransactions.push([i.value.hash,r,null]),this.emit("transactionSent",{message:`transaction hash ${i.value.hash} has been committed to chain`,transactionHash:i.value.hash}),await this.checkTransaction(i,r)):(this.sentTransactions.push([i.status,r,i.reason]),this.emit("transactionSendFailed",{message:`failed to commit transaction ${this.sentTransactions.length} with error ${i.reason}`,error:i.reason}))}this.emit("executionFinish",{message:`execute ${n.length} transactions finished`})}}catch(e){if(e instanceof oe)return;throw Error(`Process execution failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async checkTransaction(e,t){try{let i=[];i.push(r1({aptosConfig:this.aptosConfig,transactionHash:e.value.hash}));let r=await Promise.allSettled(i);for(let i=0;i<r.length;i+=1){let n=r[i];n.status===ot?(this.executedTransactions.push([n.value.hash,t,null]),this.emit("transactionExecuted",{message:`transaction hash ${n.value.hash} has been executed on chain`,transactionHash:e.value.hash})):(this.executedTransactions.push([n.status,t,n.reason]),this.emit("transactionExecutionFailed",{message:`failed to execute transaction ${this.executedTransactions.length} with error ${n.reason}`,error:n.reason}))}}catch(e){throw Error(`Check transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async push(e,t){this.transactionsQueue.enqueue([e,t])}async generateNextTransaction(e,t){if(this.transactionsQueue.isEmpty())return;let[i,r]=await this.transactionsQueue.dequeue();return nG({aptosConfig:this.aptosConfig,sender:e.accountAddress,data:i,options:{...r,accountSequenceNumber:t,replayProtectionNonce:void 0}})}async run(){try{for(;!this.taskQueue.isCancelled();)await (await this.taskQueue.dequeue())()}catch(e){throw Error(`Unable to start transaction batching: ${e}`)}}start(){if(this.started)throw Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},on=class extends i9.default{constructor(e){super(),this.config=e}start(e){let{sender:t}=e;this.account=t,this.transactionWorker=new or(this.config,t),this.transactionWorker.start(),this.registerToEvents()}push(e){let{data:t,options:i}=e;for(let e of t)this.transactionWorker.push(e,i)}registerToEvents(){this.transactionWorker.on("transactionSent",async e=>{this.emit("transactionSent",e)}),this.transactionWorker.on("transactionSendFailed",async e=>{this.emit("transactionSendFailed",e)}),this.transactionWorker.on("transactionExecuted",async e=>{this.emit("transactionExecuted",e)}),this.transactionWorker.on("transactionExecutionFailed",async e=>{this.emit("transactionExecutionFailed",e)}),this.transactionWorker.on("executionFinish",async e=>{this.emit("executionFinish",e)})}forSingleAccount(e){try{let{sender:t,data:i,options:r}=e;this.start({sender:t}),this.push({data:i,options:r})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}},os=class{constructor(e){this.config=e,this.build=new a8(this.config),this.simulate=new a6(this.config),this.submit=new a4(this.config),this.batch=new on(this.config)}async getTransactions(e){return rY({aptosConfig:this.config,...e})}async getTransactionByVersion(e){return rZ({aptosConfig:this.config,...e})}async getTransactionByHash(e){return rQ({aptosConfig:this.config,...e})}async isPendingTransaction(e){return r0({aptosConfig:this.config,...e})}async waitForTransaction(e){return r1({aptosConfig:this.config,...e})}async getGasPriceEstimation(){return rX({aptosConfig:this.config})}getSigningMessage(e){return function(e){let{transaction:t}=e;return i2(t)}(e)}async publishPackageTransaction(e){return n8({aptosConfig:this.config,...e})}async rotateAuthKey(e){return sf({aptosConfig:this.config,...e})}async rotateAuthKeyUnverified(e){return s_({aptosConfig:this.config,...e})}sign(e){return nY({...e})}signAsFeePayer(e){return nX({...e})}async batchTransactionsForSingleAccount(e){try{let{sender:t,data:i,options:r}=e;this.batch.forSingleAccount({sender:t,data:i,options:r})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}async signAndSubmitTransaction(e){return n0({aptosConfig:this.config,...e})}async signAndSubmitAsFeePayer(e){return n2({aptosConfig:this.config,...e})}},oa=class{constructor(e){this.config=e}async getTableItem(e){return rG({aptosConfig:this.config,...e})}async getTableItemsData(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),rW({aptosConfig:this.config,...e})}async getTableItemsMetadata(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),rJ({aptosConfig:this.config,...e})}};async function oo(e){let{aptosConfig:t,jwt:i,ephemeralKeyPair:r,uidKey:n="sub",derivationPath:s}=e,a={jwt_b64:i,epk:r.getPublicKey().bcsToHex().toStringWithoutPrefix(),exp_date_secs:r.expiryDateSecs,epk_blinder:y.j.fromHexInput(r.blinder).toStringWithoutPrefix(),uid_key:n,derivation_path:s},{data:o}=await eY({aptosConfig:t,path:"fetch",body:a,originMethod:"getPepper",overrides:{WITH_CREDENTIALS:!1}});return y.j.fromHexInput(o.pepper).toUint8Array()}async function oc(e){let{aptosConfig:t,jwt:i,ephemeralKeyPair:r,pepper:n=await oo(e),uidKey:s="sub",maxExpHorizonSecs:a=(await ty({aptosConfig:t})).maxExpHorizonSecs}=e;if(y.j.fromHexInput(n).toUint8Array().length!==rr.PEPPER_LENGTH)throw Error(`Pepper needs to be ${rr.PEPPER_LENGTH} bytes`);let o=et.jwtDecode.call(void 0,i);if("number"!=typeof o.iat)throw Error("iat was not found");if(a<r.expiryDateSecs-o.iat)throw Error(`The EphemeralKeyPair is too long lived.  It's lifespan must be less than ${a}`);let c={jwt_b64:i,epk:r.getPublicKey().bcsToHex().toStringWithoutPrefix(),epk_blinder:y.j.fromHexInput(r.blinder).toStringWithoutPrefix(),exp_date_secs:r.expiryDateSecs,exp_horizon_secs:a,pepper:y.j.fromHexInput(n).toStringWithoutPrefix(),uid_key:s},{data:u}=await eX({aptosConfig:t,path:"prove",body:c,originMethod:"getProof",overrides:{WITH_CREDENTIALS:!1}}),l=u.proof;return new th({proof:new tp(new tl({a:l.a,b:l.b,c:l.c}),0),trainingWheelsSignature:er.fromHex(u.training_wheels_signature),expHorizonSecs:a})}async function ou(e){let{aptosConfig:t,jwt:i,jwkAddress:r,uidKey:n,proofFetchCallback:s,pepper:a=await oo(e)}=e,{verificationKey:o,maxExpHorizonSecs:c}=await ty({aptosConfig:t}),u=oc({...e,pepper:a,maxExpHorizonSecs:c}),l=s?u:await u;if(void 0!==r){let c=tT.fromJwtAndPepper({jwt:i,pepper:a,jwkAddress:r,uidKey:n}),u=await si({aptosConfig:t,authenticationKey:c.authKey().derivedAddress()});return rn.create({...e,address:u,proof:l,pepper:a,proofFetchCallback:s,jwkAddress:r,verificationKey:o})}let d=te.fromJwtAndPepper({jwt:i,pepper:a,uidKey:n}),p=await si({aptosConfig:t,authenticationKey:d.authKey().derivedAddress()});return rr.create({...e,address:p,proof:l,pepper:a,proofFetchCallback:s,verificationKey:o})}async function ol(e){let t,{aptosConfig:i,sender:r,iss:n,options:s}=e,{jwksUrl:a}=e;void 0===a&&(a=ek.test(n)?"https://www.googleapis.com/service_accounts/v1/jwk/securetoken@system.gserviceaccount.com":n.endsWith("/")?`${n}.well-known/jwks.json`:`${n}/.well-known/jwks.json`);try{if(!(t=await fetch(a)).ok)throw Error(`${t.status} ${t.statusText}`)}catch(t){let e;throw e=t instanceof Error?`${t.message}`:`error unknown - ${t}`,eF.fromErrorType({type:14,details:`Failed to fetch JWKS at ${a}: ${e}`})}let o=await t.json();return nG({aptosConfig:i,sender:r.accountAddress,data:{function:"0x1::jwks::update_federated_jwk_set",functionArguments:[n,C.MoveString(o.keys.map(e=>e.kid)),C.MoveString(o.keys.map(e=>e.alg)),C.MoveString(o.keys.map(e=>e.e)),C.MoveString(o.keys.map(e=>e.n))]},options:s})}var od=class{constructor(e){this.config=e}async getPepper(e){return oo({aptosConfig:this.config,...e})}async getProof(e){return oc({aptosConfig:this.config,...e})}async deriveKeylessAccount(e){return ou({aptosConfig:this.config,...e})}async updateFederatedKeylessJwkSetTransaction(e){return ol({aptosConfig:this.config,...e})}};async function op(e){let{aptosConfig:t,options:i}=e,r={query:rP,variables:{where_condition:g([i,"optionalAccess",e=>e.where]),offset:g([i,"optionalAccess",e=>e.offset]),limit:g([i,"optionalAccess",e=>e.limit]),order_by:g([i,"optionalAccess",e=>e.orderBy])}};return(await rO({aptosConfig:t,query:r,originMethod:"getObjectData"})).current_objects}async function oh(e){let{aptosConfig:t,objectAddress:i,options:r}=e,n={object_address:{_eq:y.ba.from(i).toStringLong()}};return(await op({aptosConfig:t,options:{...r,where:n}}))[0]}var og=class{constructor(e){this.config=e}async getObjectDataByObjectAddress(e){return await sC({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),oh({aptosConfig:this.config,...e})}},of=class{constructor(e){this.config=h(e,()=>new sF),this.account=new sN(this.config),this.abstraction=new sK(this.config),this.ans=new aZ(this.config),this.coin=new sD(this.config),this.digitalAsset=new aA(this.config),this.faucet=new ab(this.config),this.fungibleAsset=new aU(this.config),this.general=new ax(this.config),this.staking=new a1(this.config),this.transaction=new os(this.config),this.table=new oa(this.config),this.keyless=new od(this.config),this.object=new og(this.config)}setIgnoreTransactionSubmitter(e){this.config.setIgnoreTransactionSubmitter(e)}};function oy(e,t,i){Object.getOwnPropertyNames(t.prototype).forEach(r=>{let n=Object.getOwnPropertyDescriptor(t.prototype,r);n&&Object.defineProperty(e.prototype,r,{value:function(...e){return this[i][r](...e)},writable:n.writable,configurable:n.configurable,enumerable:n.enumerable})})}oy(of,sN,"account"),oy(of,sK,"abstraction"),oy(of,aZ,"ans"),oy(of,sD,"coin"),oy(of,aA,"digitalAsset"),oy(of,Event,"event"),oy(of,ab,"faucet"),oy(of,aU,"fungibleAsset"),oy(of,ax,"general"),oy(of,a1,"staking"),oy(of,os,"transaction"),oy(of,oa,"table"),oy(of,od,"keyless"),oy(of,og,"object"),t.ACCOUNT_ABSTRACTION_SIGNING_DATA_SALT=eU,t.APTOS_BIP44_REGEX=H,t.APTOS_COIN=eE,t.APTOS_FA=eS,t.APTOS_HARDENED_REGEX=M,t.AbstractKeylessAccount=rt,t.AbstractMultiKey=tB,t.AbstractPublicKey=R,t.AbstractSignature=F,t.AbstractedAccount=ru,t.Account=i5,t.AccountAbstractionMessage=t7,t.AccountAddress=y.ba,t.AccountAuthenticator=t1,t.AccountAuthenticatorAbstraction=t9,t.AccountAuthenticatorEd25519=t8,t.AccountAuthenticatorMultiEd25519=t3,t.AccountAuthenticatorMultiKey=t6,t.AccountAuthenticatorNoAccountAuthenticator=t4,t.AccountAuthenticatorSingleKey=t5,t.AccountAuthenticatorVariant=y.z,t.AccountPublicKey=N,t.AccountSequenceNumber=a9,t.AccountUtils=f,t.AddressInvalidReason=y.aa,t.AnyPublicKey=tF,t.AnyPublicKeyVariant=y.B,t.AnySignature=tR,t.AnySignatureVariant=y.D,t.Aptos=of,t.AptosApiError=eR,t.AptosApiType=ew,t.AptosConfig=sF,t.AuthenticationKey=I,t.Bool=w,t.CKDPriv=J,t.ChainId=ie,t.DEFAULT_MAX_GAS_AMOUNT=eb,t.DEFAULT_TXN_EXP_SEC_FROM_NOW=ev,t.DEFAULT_TXN_TIMEOUT_SEC=eT,t.DerivableAbstractedAccount=rl,t.DeriveScheme=y.$,t.Deserializer=m,t.EPK_HORIZON_SECS=1e7,t.Ed25519Account=i1,t.Ed25519PrivateKey=tZ,t.Ed25519PublicKey=tX,t.Ed25519Signature=t0,t.EntryFunction=iC,t.EntryFunctionBytes=A,t.EphemeralCertificate=ta,t.EphemeralCertificateVariant=y.G,t.EphemeralKeyPair=i4,t.EphemeralPublicKey=ei,t.EphemeralPublicKeyVariant=y.E,t.EphemeralSignature=er,t.EphemeralSignatureVariant=y.F,t.FIREBASE_AUTH_ISS_PATTERN=ek,t.FederatedKeylessAccount=rn,t.FederatedKeylessPublicKey=tT,t.FeePayerRawTransaction=iM,t.FixedBytes=_,t.Groth16ProofAndStatement=td,t.Groth16VerificationKey=tf,t.Groth16Zkp=tl,t.HARDENED_OFFSET=q,t.Hex=y.j,t.HexInvalidReason=y.i,t.Identifier=it,t.KeyType=V,t.KeylessAccount=rr,t.KeylessConfiguration=tg,t.KeylessError=eF,t.KeylessErrorCategory=eI,t.KeylessErrorResolutionTip=eK,t.KeylessErrorType=eN,t.KeylessPublicKey=te,t.KeylessSignature=ts,t.MAX_AUD_VAL_BYTES=e8,t.MAX_COMMITED_EPK_BYTES=e7,t.MAX_EXTRA_FIELD_BYTES=e4,t.MAX_ISS_VAL_BYTES=e6,t.MAX_JWT_HEADER_B64_BYTES=e9,t.MAX_UID_KEY_BYTES=e3,t.MAX_UID_VAL_BYTES=e5,t.MimeType=y.q,t.ModuleId=ii,t.MoveAbility=y.X,t.MoveFunctionVisibility=y.W,t.MoveJWK=tb,t.MoveOption=k,t.MoveString=x,t.MoveVector=C,t.MultiAgentRawTransaction=iL,t.MultiAgentTransaction=iZ,t.MultiEd25519Account=ra,t.MultiEd25519PublicKey=tM,t.MultiEd25519Signature=tV,t.MultiKey=tD,t.MultiKeyAccount=rs,t.MultiKeySignature=tL,t.MultiSig=ix,t.MultiSigTransactionPayload=ik,t.Network=em,t.NetworkToChainId=e_,t.NetworkToFaucetAPI=eg,t.NetworkToIndexerAPI=ep,t.NetworkToNetworkName=eA,t.NetworkToNodeAPI=eh,t.NetworkToPepperAPI=ef,t.NetworkToProverAPI=ey,t.ParsingError=y.h,t.PrivateKey=ee,t.PrivateKeyVariants=y.A,t.ProcessorType=ex,t.PublicKey=K,t.RAW_TRANSACTION_SALT=ez,t.RAW_TRANSACTION_WITH_DATA_SALT=eC,t.RawTransaction=iD,t.RawTransactionWithData=iO,t.RoleType=y.Y,t.RotationProofChallenge=iH,t.Script=iU,t.ScriptTransactionArgumentVariants=y.s,t.Secp256k1PrivateKey=tC,t.Secp256k1PublicKey=tz,t.Secp256k1Signature=tx,t.Secp256r1PrivateKey=tI,t.Secp256r1PublicKey=tP,t.Secp256r1Signature=t$,t.Serializable=y.l,t.Serialized=U,t.Serializer=y.m,t.Signature=$,t.SignedTransaction=iY,t.SigningScheme=y.Z,t.SigningSchemeInput=y._,t.SimpleTransaction=iX,t.SingleKeyAccount=i3,t.StructTag=iA,t.TransactionAndProof=ri,t.TransactionAuthenticator=iV,t.TransactionAuthenticatorEd25519=iq,t.TransactionAuthenticatorFeePayer=iW,t.TransactionAuthenticatorMultiAgent=iG,t.TransactionAuthenticatorMultiEd25519=ij,t.TransactionAuthenticatorSingleSender=iJ,t.TransactionAuthenticatorVariant=y.y,t.TransactionExecutable=iK,t.TransactionExecutableEmpty=iF,t.TransactionExecutableEntryFunction=i$,t.TransactionExecutableScript=iN,t.TransactionExecutableVariants=y.v,t.TransactionExtraConfig=iR,t.TransactionExtraConfigV1=iB,t.TransactionExtraConfigVariants=y.w,t.TransactionInnerPayload=iP,t.TransactionInnerPayloadV1=iI,t.TransactionInnerPayloadVariants=y.u,t.TransactionPayload=iT,t.TransactionPayloadEntryFunction=iS,t.TransactionPayloadMultiSig=iz,t.TransactionPayloadScript=iE,t.TransactionPayloadVariants=y.t,t.TransactionResponseType=y.I,t.TransactionVariants=y.x,t.TransactionWorker=or,t.TransactionWorkerEventsEnum=oi,t.TypeTag=ir,t.TypeTagAddress=ip,t.TypeTagBool=is,t.TypeTagGeneric=iy,t.TypeTagParserError=ni,t.TypeTagParserErrorType=nt,t.TypeTagReference=ig,t.TypeTagSigner=ih,t.TypeTagStruct=i_,t.TypeTagU128=il,t.TypeTagU16=io,t.TypeTagU256=id,t.TypeTagU32=ic,t.TypeTagU64=iu,t.TypeTagU8=ia,t.TypeTagVariants=y.r,t.TypeTagVector=im,t.U128=S,t.U16=v,t.U256=z,t.U32=T,t.U64=E,t.U8=b,t.WebAuthnSignature=tK,t.ZeroKnowledgeSig=th,t.ZkProof=tp,t.ZkpVariant=y.H,t.anyPublicKeyVariantToString=y.C,t.aptosCoinStructTag=function(){return new iA(y.ba.ONE,new it("aptos_coin"),new it("AptosCoin"),[])},t.aptosRequest=eD,t.base64UrlDecode=y.ja,t.base64UrlToBytes=y.ka,t.bigIntToBytesLE=eu,t.buildTransaction=nO,t.bytesToBigIntLE=ec,t.checkOrConvertArgument=nK,t.convertAmountFromHumanReadableToOnChain=y.la,t.convertAmountFromOnChainToHumanReadable=y.ma,t.convertArgument=nI,t.convertNumber=nc,t.convertPayloadToInnerPayload=nD,t.createObjectAddress=y.ca,t.createResourceAddress=y.da,t.createTokenAddress=y.ea,t.deriveKey=W,t.deriveTransactionType=iQ,t.deserializeFromScriptArgument=iv,t.deserializePublicKey=function(e){let t;for(let i of[tX,tF,tM,tD,te,tT,tz])try{let r=m.fromHex(e),n=i.deserialize(r);if(r.assertFinished(),t)throw Error(`${t2}: ${e}`);t=n}catch(e){if(e instanceof Error&&e.message.includes(t2))throw e}if(!t)throw Error(`Failed to deserialize public key: ${e}`);return t},t.deserializeSignature=function(e){let t;for(let i of[t0,tR,tV,tL,ts,tx])try{let r=m.fromHex(e),n=i.deserialize(r);if(r.assertFinished(),t)throw Error(`${t2}: ${e}`);t=n}catch(e){if(e instanceof Error&&e.message.includes(t2))throw e}if(!t)throw Error(`Failed to deserialize signature: ${e}`);return t},t.ensureBoolean=y.n,t.fetchEntryFunctionAbi=nk,t.fetchFunctionAbi=nU,t.fetchJWK=tr,t.fetchModuleAbi=nC,t.fetchMoveFunctionAbi=nx,t.fetchViewFunctionAbi=nP,t.findFirstNonSignerArg=nE,t.floorToWholeHour=y.ia,t.generateRawTransaction=nB,t.generateSignedTransaction=nH,t.generateSignedTransactionForSimulation=nL,t.generateSigningMessage=i0,t.generateSigningMessageForSerializable=function(e){return i0(e.bcsToBytes(),`APTOS::${e.constructor.name}`)},t.generateSigningMessageForTransaction=i2,t.generateTransactionPayload=nN,t.generateTransactionPayloadWithABI=n$,t.generateUserTransactionHash=function(e){let t=nH(e);return new(0,y.j)(nV([nq,new Uint8Array([0]),t])).toString()},t.generateViewFunctionPayload=nF,t.generateViewFunctionPayloadWithABI=nR,t.get=eO,t.getAptosFullNode=eL,t.getAptosPepperService=eM,t.getAuthenticatorForSimulation=nM,t.getErrorMessage=y.ga,t.getFunctionParts=y.pa,t.getIssAudAndUidVal=tm,t.getKeylessConfig=ty,t.getKeylessJWKs=tw,t.getPageWithObfuscatedCursor=eq,t.hashStrToField=ea,t.hashValues=nV,t.hexToAsciiString=y.k,t.isBcsAddress=nh,t.isBcsBool=np,t.isBcsFixedBytes=nf,t.isBcsString=ng,t.isBcsU128=nw,t.isBcsU16=nm,t.isBcsU256=nb,t.isBcsU32=n_,t.isBcsU64=nA,t.isBcsU8=ny,t.isBlockEpilogueTransactionResponse=y.P,t.isBlockMetadataTransactionResponse=y.M,t.isBool=ns,t.isCanonicalEd25519Signature=tJ,t.isEd25519Signature=y.Q,t.isEmptyOption=nl,t.isEncodedEntryFunctionArgument=nd,t.isEncodedStruct=y.oa,t.isFeePayerSignature=y.T,t.isGenesisTransactionResponse=y.L,t.isKeylessSigner=i7,t.isLargeNumber=nu,t.isMultiAgentSignature=y.S,t.isMultiEd25519Signature=y.U,t.isNumber=no,t.isPendingTransactionResponse=y.J,t.isScriptDataInput=nv,t.isSecp256k1Signature=y.R,t.isSingleKeySigner=i8,t.isSingleSenderSignature=y.V,t.isStateCheckpointTransactionResponse=y.N,t.isString=na,t.isUserTransactionResponse=y.K,t.isValidBIP44Path=j,t.isValidFunctionInfo=y.qa,t.isValidHardenedPath=G,t.isValidatorTransactionResponse=y.O,t.mnemonicToSeed=Z,t.normalizeBundle=eP,t.nowInSeconds=y.ha,t.objectStructTag=ib,t.optionStructTag=function(e){return new iA(y.ba.ONE,new it("option"),new it("Option"),[e])},t.outOfRangeErrorMessage=y.o,t.padAndPackBytesWithLen=eo,t.paginateWithCursor=eH,t.paginateWithObfuscatedCursor=eV,t.pairedFaMetadataAddress=y.sa,t.parseEncodedStruct=y.na,t.parseJwtHeader=tv,t.parseTypeTag=nr,t.poseidonHash=el,t.post=ej,t.postAptosFaucet=eJ,t.postAptosFullNode=eG,t.postAptosIndexer=eW,t.postAptosPepperService=eY,t.postAptosProvingService=eX,t.promiseFulfilledStatus=ot,t.request=eB,t.sleep=y.fa,t.splitPath=X,t.standardizeTypeTags=nz,t.stringStructTag=iw,t.throwTypeMismatch=nT,t.truncateAddress=y.ra,t.validateNumberInRange=y.p,t.verifyKeylessSignature=tt,t.verifyKeylessSignatureWithJwkAndConfig=ti}}]);