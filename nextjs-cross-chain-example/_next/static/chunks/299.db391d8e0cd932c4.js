"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{15272:function(e,t,r){let i,n,s,a,o,c,u,l,d,f,p,h,g,y,m,_,w,b,A,v,E,S,z,T,x,C,U,I,k,P,N,B,K,R;r.d(t,{mRj:function(){return nB},kxK:function(){return eh},gZG:function(){return o$},ScN:function(){return r3},qN7:function(){return tb},sFe:function(){return ec},ZcK:function(){return r1},PMf:function(){return ei},G90:function(){return en}});var $,F=class{constructor(){this.queue=[],this.pendingDequeue=[],this.cancelled=!1}enqueue(e){if(this.cancelled=!1,this.pendingDequeue.length>0){this.pendingDequeue.shift()?.resolve(e);return}this.queue.push(e)}async dequeue(){return this.queue.length>0?Promise.resolve(this.queue.shift()):new Promise((e,t)=>{this.pendingDequeue.push({resolve:e,reject:t})})}isEmpty(){return 0===this.queue.length}cancel(){this.cancelled=!0,this.pendingDequeue.forEach(async({reject:e})=>{e(new O("Task cancelled"))}),this.pendingDequeue=[],this.queue.length=0}isCancelled(){return this.cancelled}pendingDequeueLength(){return this.pendingDequeue.length}},O=class extends Error{},D=class extends Error{constructor(e,t){super(e),this.invalidReason=t}},q=r(16846),L=((i=L||{}).TOO_SHORT="too_short",i.INVALID_LENGTH="invalid_length",i.INVALID_HEX_CHARS="invalid_hex_chars",i),V=class e{constructor(e){this.data=e}toUint8Array(){return this.data}toStringWithoutPrefix(){return(0,q.ci)(this.data)}toString(){return`0x${this.toStringWithoutPrefix()}`}static fromHexString(t){let r=t;if(r.startsWith("0x")&&(r=r.slice(2)),0===r.length)throw new D("Hex string is too short, must be at least 1 char long, excluding the optional leading 0x.","too_short");if(r.length%2!=0)throw new D("Hex string must be an even number of hex characters.","invalid_length");try{return new e((0,q.nr)(r))}catch(e){throw new D(`Hex string contains invalid hex characters: ${e?.message}`,"invalid_hex_chars")}}static fromHexInput(t){return t instanceof Uint8Array?new e(t):e.fromHexString(t)}static hexInputToUint8Array(t){return t instanceof Uint8Array?t:e.fromHexString(t).toUint8Array()}static hexInputToString(t){return e.fromHexInput(t).toString()}static hexInputToStringWithoutPrefix(t){return e.fromHexInput(t).toStringWithoutPrefix()}static isValid(t){try{return e.fromHexString(t),{valid:!0}}catch(e){return{valid:!1,invalidReason:e?.invalidReason,invalidReasonMessage:e?.message}}}equals(e){return this.data.length===e.data.length&&this.data.every((t,r)=>t===e.data[r])}},H=e=>new TextDecoder().decode(V.fromHexInput(e).toUint8Array()),M=Object.defineProperty,j=Object.getOwnPropertyDescriptor,G=(e,t,r,i)=>{for(var n,s=i>1?void 0:i?j(t,r):t,a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i?n(t,r,s):n(s))||s);return i&&s&&M(t,r,s),s},W=class{bcsToBytes(){let e=new J;return this.serialize(e),e.toUint8Array()}bcsToHex(){let e=this.bcsToBytes();return V.fromHexInput(e)}toStringWithoutPrefix(){return this.bcsToHex().toStringWithoutPrefix()}toString(){return`0x${this.toStringWithoutPrefix()}`}},J=class{constructor(e=64){if(e<=0)throw Error("Length needs to be greater than 0");this.buffer=new ArrayBuffer(e),this.offset=0}ensureBufferWillHandleSize(e){for(;this.buffer.byteLength<this.offset+e;){let e=new ArrayBuffer(2*this.buffer.byteLength);new Uint8Array(e).set(new Uint8Array(this.buffer)),this.buffer=e}}appendToBuffer(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length}serializeWithFunction(e,t,r){this.ensureBufferWillHandleSize(t);let i=new DataView(this.buffer,this.offset);e.apply(i,[0,r,!0]),this.offset+=t}serializeStr(e){let t=new TextEncoder;this.serializeBytes(t.encode(e))}serializeBytes(e){this.serializeU32AsUleb128(e.length),this.appendToBuffer(e)}serializeFixedBytes(e){this.appendToBuffer(e)}serializeBool(e){Y(e),this.appendToBuffer(new Uint8Array([e?1:0]))}serializeU8(e){this.appendToBuffer(new Uint8Array([e]))}serializeU16(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)}serializeU32(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)}serializeU64(e){let t=BigInt(e)&BigInt(4294967295),r=BigInt(e)>>BigInt(32);this.serializeU32(Number(t)),this.serializeU32(Number(r))}serializeU128(e){let t=0xffffffffffffffffn&BigInt(e),r=BigInt(e)>>BigInt(64);this.serializeU64(t),this.serializeU64(r)}serializeU256(e){let t=0xffffffffffffffffffffffffffffffffn&BigInt(e),r=BigInt(e)>>BigInt(128);this.serializeU128(t),this.serializeU128(r)}serializeU32AsUleb128(e){let t=e,r=[];for(;t>>>7;)r.push(127&t|128),t>>>=7;r.push(t),this.appendToBuffer(new Uint8Array(r))}toUint8Array(){return new Uint8Array(this.buffer).slice(0,this.offset)}serialize(e){e.serialize(this)}serializeVector(e){this.serializeU32AsUleb128(e.length),e.forEach(e=>{e.serialize(this)})}serializeOption(e,t){let r=void 0!==e;this.serializeBool(r),r&&("string"==typeof e?this.serializeStr(e):e instanceof Uint8Array?void 0!==t?this.serializeFixedBytes(e):this.serializeBytes(e):e.serialize(this))}serializeOptionStr(e){void 0===e?this.serializeU32AsUleb128(0):(this.serializeU32AsUleb128(1),this.serializeStr(e))}};function Y(e){if("boolean"!=typeof e)throw Error(`${e} is not a boolean value`)}G([Q(0,255)],J.prototype,"serializeU8",1),G([Q(0,65535)],J.prototype,"serializeU16",1),G([Q(0,4294967295)],J.prototype,"serializeU32",1),G([Q(BigInt(0),0xffffffffffffffffn)],J.prototype,"serializeU64",1),G([Q(BigInt(0),0xffffffffffffffffffffffffffffffffn)],J.prototype,"serializeU128",1),G([Q(BigInt(0),0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn)],J.prototype,"serializeU256",1),G([Q(0,4294967295)],J.prototype,"serializeU32AsUleb128",1);var Z=(e,t,r)=>`${e} is out of range: [${t}, ${r}]`;function X(e,t,r){let i=BigInt(e);if(i>BigInt(r)||i<BigInt(t))throw Error(Z(e,t,r))}function Q(e,t){return(r,i,n)=>{let s=n.value;return n.value=function(r){return X(r,e,t),s.apply(this,[r])},n}}var ee=class e extends W{constructor(e){super(),Y(e),this.value=e}serialize(e){e.serializeBool(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(5),e.serialize(this)}deserialize(e){return new ea(e.deserializeU256())}static deserialize(t){return new e(t.deserializeBool())}},et=class e extends W{constructor(e){super(),X(e,0,255),this.value=e}serialize(e){e.serializeU8(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(0),e.serialize(this)}static deserialize(t){return new e(t.deserializeU8())}},er=class e extends W{constructor(e){super(),X(e,0,65535),this.value=e}serialize(e){e.serializeU16(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(6),e.serialize(this)}static deserialize(t){return new e(t.deserializeU16())}},ei=class e extends W{constructor(e){super(),X(e,0,4294967295),this.value=e}serialize(e){e.serializeU32(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(7),e.serialize(this)}static deserialize(t){return new e(t.deserializeU32())}},en=class e extends W{constructor(e){super(),X(e,BigInt(0),0xffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU64(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(1),e.serialize(this)}static deserialize(t){return new e(t.deserializeU64())}},es=class e extends W{constructor(e){super(),X(e,BigInt(0),0xffffffffffffffffffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU128(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(2),e.serialize(this)}static deserialize(t){return new e(t.deserializeU128())}},ea=class e extends W{constructor(e){super(),X(e,BigInt(0),0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn),this.value=BigInt(e)}serialize(e){e.serializeU256(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(8),e.serialize(this)}static deserialize(t){return new e(t.deserializeU256())}},eo=class e{constructor(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}static fromHex(t){return new e(V.hexInputToUint8Array(t))}read(e){if(this.offset+e>this.buffer.byteLength)throw Error("Reached to the end of buffer");let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}remaining(){return this.buffer.byteLength-this.offset}deserializeStr(){let e=this.deserializeBytes();return new TextDecoder().decode(e)}deserializeOptionStr(){return this.deserializeOption("string")}deserializeOption(e,t){if(this.deserializeBool()){if("string"===e)return this.deserializeStr();if("bytes"===e)return this.deserializeBytes();if("fixedBytes"===e){if(void 0===t)throw Error("Fixed bytes length not provided");return this.deserializeFixedBytes(t)}return this.deserialize(e)}}deserializeBytes(){let e=this.deserializeUleb128AsU32();return new Uint8Array(this.read(e))}deserializeFixedBytes(e){return new Uint8Array(this.read(e))}deserializeBool(){let e=new Uint8Array(this.read(1))[0];if(1!==e&&0!==e)throw Error("Invalid boolean value");return 1===e}deserializeU8(){return new DataView(this.read(1)).getUint8(0)}deserializeU16(){return new DataView(this.read(2)).getUint16(0,!0)}deserializeU32(){return new DataView(this.read(4)).getUint32(0,!0)}deserializeU64(){let e=this.deserializeU32();return BigInt(BigInt(this.deserializeU32())<<BigInt(32)|BigInt(e))}deserializeU128(){let e=this.deserializeU64();return BigInt(this.deserializeU64()<<BigInt(64)|e)}deserializeU256(){let e=this.deserializeU128();return BigInt(this.deserializeU128()<<BigInt(128)|e)}deserializeUleb128AsU32(){let e=BigInt(0),t=0;for(;e<4294967295;){let r=this.deserializeU8();if(e|=BigInt(127&r)<<BigInt(t),!(128&r))break;t+=7}if(e>4294967295)throw Error("Overflow while parsing uleb128-encoded uint32 value");return Number(e)}deserialize(e){return e.deserialize(this)}deserializeVector(e){let t=this.deserializeUleb128AsU32(),r=[];for(let i=0;i<t;i+=1)r.push(this.deserialize(e));return r}},ec=class e extends W{constructor(e){super(),this.values=e}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){if(void 0!==this.values[0]&&!(this.values[0]instanceof et)){new eu(this.bcsToBytes()).serializeForScriptFunction(e);return}e.serializeU32AsUleb128(4),e.serialize(this)}static U8(t){let r;if(Array.isArray(t)&&0===t.length)r=[];else if(Array.isArray(t)&&"number"==typeof t[0])r=t;else if("string"==typeof t)r=Array.from(V.fromHexInput(t).toUint8Array());else if(t instanceof Uint8Array)r=Array.from(t);else throw Error("Invalid input type, must be an number[], Uint8Array, or hex string");return new e(r.map(e=>new et(e)))}static U16(t){return new e(t.map(e=>new er(e)))}static U32(t){return new e(t.map(e=>new ei(e)))}static U64(t){return new e(t.map(e=>new en(e)))}static U128(t){return new e(t.map(e=>new es(e)))}static U256(t){return new e(t.map(e=>new ea(e)))}static Bool(t){return new e(t.map(e=>new ee(e)))}static MoveString(t){return new e(t.map(e=>new el(e)))}serialize(e){e.serializeVector(this.values)}static deserialize(t,r){let i=t.deserializeUleb128AsU32(),n=[];for(let e=0;e<i;e+=1)n.push(r.deserialize(t));return new e(n)}},eu=class e extends W{constructor(e){super(),this.value=V.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}serializeForEntryFunction(e){this.serialize(e)}serializeForScriptFunction(e){e.serializeU32AsUleb128(9),this.serialize(e)}static deserialize(t){return new e(t.deserializeBytes())}toMoveVector(e){let t=new eo(this.bcsToBytes());return t.deserializeUleb128AsU32(),new ec(t.deserializeVector(e))}},el=class e extends W{constructor(e){super(),this.value=e}serialize(e){e.serializeStr(this.value)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){let t=new TextEncoder().encode(this.value);ec.U8(t).serializeForScriptFunction(e)}static deserialize(t){return new e(t.deserializeStr())}},ed=class e extends W{constructor(e){super(),"u">typeof e&&null!==e?this.vec=new ec([e]):this.vec=new ec([]),[this.value]=this.vec.values}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}unwrap(){if(this.isSome())return this.vec.values[0];throw Error("Called unwrap on a MoveOption with no value")}isSome(){return 1===this.vec.values.length}serialize(e){this.vec.serialize(e)}static U8(t){return new e(null!=t?new et(t):void 0)}static U16(t){return new e(null!=t?new er(t):void 0)}static U32(t){return new e(null!=t?new ei(t):void 0)}static U64(t){return new e(null!=t?new en(t):void 0)}static U128(t){return new e(null!=t?new es(t):void 0)}static U256(t){return new e(null!=t?new ea(t):void 0)}static Bool(t){return new e(null!=t?new ee(t):void 0)}static MoveString(t){return new e(null!=t?new el(t):void 0)}static deserialize(t,r){return new e(ec.deserialize(t,r).values[0])}},ef=((n=ef||{}).INCORRECT_NUMBER_OF_BYTES="incorrect_number_of_bytes",n.INVALID_HEX_CHARS="invalid_hex_chars",n.TOO_SHORT="too_short",n.TOO_LONG="too_long",n.LEADING_ZERO_X_REQUIRED="leading_zero_x_required",n.LONG_FORM_REQUIRED_UNLESS_SPECIAL="long_form_required_unless_special",n.INVALID_PADDING_ZEROES="INVALID_PADDING_ZEROES",n.INVALID_PADDING_STRICTNESS="INVALID_PADDING_STRICTNESS",n),ep=class e extends W{constructor(t){if(super(),t.length!==e.LENGTH)throw new D("AccountAddress data should be exactly 32 bytes long","incorrect_number_of_bytes");this.data=t}isSpecial(){return this.data.slice(0,this.data.length-1).every(e=>0===e)&&this.data[this.data.length-1]<16}toString(){return`0x${this.toStringWithoutPrefix()}`}toStringWithoutPrefix(){let e=(0,q.ci)(this.data);return this.isSpecial()&&(e=e[e.length-1]),e}toStringLong(){return`0x${this.toStringLongWithoutPrefix()}`}toStringLongWithoutPrefix(){return(0,q.ci)(this.data)}toStringShort(){return`0x${this.toStringShortWithoutPrefix()}`}toStringShortWithoutPrefix(){let e=(0,q.ci)(this.data).replace(/^0+/,"");return""===e?"0":e}toUint8Array(){return this.data}serialize(e){e.serializeFixedBytes(this.data)}serializeForEntryFunction(e){let t=this.bcsToBytes();e.serializeBytes(t)}serializeForScriptFunction(e){e.serializeU32AsUleb128(3),e.serialize(this)}static deserialize(t){let r=t.deserializeFixedBytes(e.LENGTH);return new e(r)}static fromStringStrict(t){if(!t.startsWith("0x"))throw new D("Hex string must start with a leading 0x.","leading_zero_x_required");let r=e.fromString(t);if(t.length!==e.LONG_STRING_LENGTH+2){if(r.isSpecial()){if(3!==t.length)throw new D(`The given hex string ${t} is a special address not in LONG form, it must be 0x0 to 0xf without padding zeroes.`,"INVALID_PADDING_ZEROES")}else throw new D(`The given hex string ${t} is not a special address, it must be represented as 0x + 64 chars.`,"long_form_required_unless_special")}return r}static fromString(t,{maxMissingChars:r=4}={}){let i,n=t;if(t.startsWith("0x")&&(n=t.slice(2)),0===n.length)throw new D("Hex string is too short, must be 1 to 64 chars long, excluding the leading 0x.","too_short");if(n.length>64)throw new D("Hex string is too long, must be 1 to 64 chars long, excluding the leading 0x.","too_long");if(r>63||r<0)throw new D(`maxMissingChars must be between or equal to 0 and 63. Received ${r}`,"INVALID_PADDING_STRICTNESS");try{i=(0,q.nr)(n.padStart(64,"0"))}catch(e){throw new D(`Hex characters are invalid: ${e?.message}`,"invalid_hex_chars")}let s=new e(i);if(n.length<64-r&&!s.isSpecial())throw new D(`Hex string is too short, must be ${64-r} to 64 chars long, excluding the leading 0x. You may need to fix 
the addresss by padding it with 0s before passing it to \`fromString\` (e.g. <addressString>.padStart(64, '0')). 
Received ${t}`,"too_short");return s}static from(t,{maxMissingChars:r=4}={}){return"string"==typeof t?e.fromString(t,{maxMissingChars:r}):t instanceof Uint8Array?new e(t):t}static fromStrict(t){return"string"==typeof t?e.fromStringStrict(t):t instanceof Uint8Array?new e(t):t}static isValid(t){try{return t.strict?e.fromStrict(t.input):e.from(t.input),{valid:!0}}catch(e){return{valid:!1,invalidReason:e?.invalidReason,invalidReasonMessage:e?.message}}}equals(e){return this.data.length===e.data.length&&this.data.every((t,r)=>t===e.data[r])}};ep.LENGTH=32,ep.LONG_STRING_LENGTH=64,ep.ZERO=ep.from("0x0"),ep.ONE=ep.from("0x1"),ep.TWO=ep.from("0x2"),ep.THREE=ep.from("0x3"),ep.FOUR=ep.from("0x4"),ep.A=ep.from("0xA");var eh=ep,eg=class extends W{constructor(e){super(),this.accountAddress=eh.ONE,this.moduleName=new el("account"),this.structName=new el("RotationProofChallenge"),this.sequenceNumber=new en(e.sequenceNumber),this.originator=e.originator,this.currentAuthKey=e.currentAuthKey,this.newPublicKey=ec.U8(e.newPublicKey.toUint8Array())}serialize(e){e.serialize(this.accountAddress),e.serialize(this.moduleName),e.serialize(this.structName),e.serialize(this.sequenceNumber),e.serialize(this.originator),e.serialize(this.currentAuthKey),e.serialize(this.newPublicKey)}},ey=new Map;function em(e,t,r){return async(...i)=>{if(ey.has(t)){let{value:e,timestamp:i}=ey.get(t);if(void 0===r||Date.now()-i<=r)return e}let n=await e(...i);return ey.set(t,{value:n,timestamp:Date.now()}),n}}var e_=r(36950),ew=r(67094).Buffer,eb=(e,t)=>{let r=new Uint8Array([...e.bcsToBytes(),..."string"==typeof t?ew.from(t,"utf8"):t,254]);return new eh((0,e_.DZ)(r))},eA=r(68712),ev=r(67094).Buffer;async function eE(e){return new Promise(t=>{setTimeout(t,e)})}function eS(e){return e instanceof Error?e.message:String(e)}var ez=()=>Math.floor(Date.now()/1e3),eT=e=>{let t="";for(let r=2;r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substring(r,r+2),16));return t},ex=e=>{let{account_address:t,module_name:r,struct_name:i}=e,n=eT(r),s=eT(i);return`${t}::${n}::${s}`},eC=e=>"object"==typeof e&&!Array.isArray(e)&&null!==e&&"account_address"in e&&"module_name"in e&&"struct_name"in e&&"string"==typeof e.account_address&&"string"==typeof e.module_name&&"string"==typeof e.struct_name;function eU(e){let t=e.split("::");if(3!==t.length)throw Error(`Invalid function ${e}`);return{moduleAddress:t[0],moduleName:t[1],functionName:t[2]}}function eI(e){let t=e.split("::");return 3===t.length&&eh.isValid({input:t[0]}).valid}eh.A.toStringLong();var ek=((s=ek||{})[s.API_ERROR=0]="API_ERROR",s[s.EXTERNAL_API_ERROR=1]="EXTERNAL_API_ERROR",s[s.SESSION_EXPIRED=2]="SESSION_EXPIRED",s[s.INVALID_STATE=3]="INVALID_STATE",s[s.INVALID_SIGNATURE=4]="INVALID_SIGNATURE",s[s.UNKNOWN=5]="UNKNOWN",s),eP=((a=eP||{}).REAUTHENTICATE="Re-authentiate to continue using your keyless account",a.REAUTHENTICATE_UNSURE="Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support",a.UPDATE_REQUEST_PARAMS="Update the invalid request parameters and reauthenticate.",a.RATE_LIMIT_EXCEEDED="Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest.",a.SERVER_ERROR="Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",a.CALL_PRECHECK="Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing.",a.REINSTANTIATE="Try instantiating the account again.  Avoid manipulating the account object directly",a.JOIN_SUPPORT_GROUP="For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",a.UNKNOWN="Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx",a),eN=((o=eN||{})[o.EPHEMERAL_KEY_PAIR_EXPIRED=0]="EPHEMERAL_KEY_PAIR_EXPIRED",o[o.PROOF_NOT_FOUND=1]="PROOF_NOT_FOUND",o[o.ASYNC_PROOF_FETCH_FAILED=2]="ASYNC_PROOF_FETCH_FAILED",o[o.INVALID_PROOF_VERIFICATION_FAILED=3]="INVALID_PROOF_VERIFICATION_FAILED",o[o.INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND=4]="INVALID_PROOF_VERIFICATION_KEY_NOT_FOUND",o[o.INVALID_JWT_SIG=5]="INVALID_JWT_SIG",o[o.INVALID_JWT_JWK_NOT_FOUND=6]="INVALID_JWT_JWK_NOT_FOUND",o[o.INVALID_JWT_ISS_NOT_RECOGNIZED=7]="INVALID_JWT_ISS_NOT_RECOGNIZED",o[o.INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED=8]="INVALID_JWT_FEDERATED_ISS_NOT_SUPPORTED",o[o.INVALID_TW_SIG_VERIFICATION_FAILED=9]="INVALID_TW_SIG_VERIFICATION_FAILED",o[o.INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND=10]="INVALID_TW_SIG_PUBLIC_KEY_NOT_FOUND",o[o.INVALID_EXPIRY_HORIZON=11]="INVALID_EXPIRY_HORIZON",o[o.JWT_PARSING_ERROR=12]="JWT_PARSING_ERROR",o[o.JWK_FETCH_FAILED=13]="JWK_FETCH_FAILED",o[o.JWK_FETCH_FAILED_FEDERATED=14]="JWK_FETCH_FAILED_FEDERATED",o[o.RATE_LIMIT_EXCEEDED=15]="RATE_LIMIT_EXCEEDED",o[o.PEPPER_SERVICE_INTERNAL_ERROR=16]="PEPPER_SERVICE_INTERNAL_ERROR",o[o.PEPPER_SERVICE_BAD_REQUEST=17]="PEPPER_SERVICE_BAD_REQUEST",o[o.PEPPER_SERVICE_OTHER=18]="PEPPER_SERVICE_OTHER",o[o.PROVER_SERVICE_INTERNAL_ERROR=19]="PROVER_SERVICE_INTERNAL_ERROR",o[o.PROVER_SERVICE_BAD_REQUEST=20]="PROVER_SERVICE_BAD_REQUEST",o[o.PROVER_SERVICE_OTHER=21]="PROVER_SERVICE_OTHER",o[o.FULL_NODE_CONFIG_LOOKUP_ERROR=22]="FULL_NODE_CONFIG_LOOKUP_ERROR",o[o.FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR=23]="FULL_NODE_VERIFICATION_KEY_LOOKUP_ERROR",o[o.FULL_NODE_JWKS_LOOKUP_ERROR=24]="FULL_NODE_JWKS_LOOKUP_ERROR",o[o.FULL_NODE_OTHER=25]="FULL_NODE_OTHER",o[o.SIGNATURE_TYPE_INVALID=26]="SIGNATURE_TYPE_INVALID",o[o.SIGNATURE_EXPIRED=27]="SIGNATURE_EXPIRED",o[o.MAX_EXPIRY_HORIZON_EXCEEDED=28]="MAX_EXPIRY_HORIZON_EXCEEDED",o[o.EPHEMERAL_SIGNATURE_VERIFICATION_FAILED=29]="EPHEMERAL_SIGNATURE_VERIFICATION_FAILED",o[o.TRAINING_WHEELS_SIGNATURE_MISSING=30]="TRAINING_WHEELS_SIGNATURE_MISSING",o[o.TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED=31]="TRAINING_WHEELS_SIGNATURE_VERIFICATION_FAILED",o[o.PROOF_VERIFICATION_FAILED=32]="PROOF_VERIFICATION_FAILED",o[o.UNKNOWN=33]="UNKNOWN",o),eB={0:["The ephemeral keypair has expired.",2,"Re-authentiate to continue using your keyless account"],1:["The required proof could not be found.",3,"Call `await account.checkKeylessAccountValidity()` to wait for asyncronous changes and check for account validity before signing or serializing."],2:["The required proof failed to fetch.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],3:["The provided proof is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],4:["The verification key used to authenticate was updated.",2,"Re-authentiate to continue using your keyless account"],5:["The JWK was found, but JWT failed verification",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],6:["The JWK required to verify the JWT could not be found. The JWK may have been rotated out.",2,"Re-authentiate to continue using your keyless account"],7:["The JWT issuer is not recognized.",3,"Update the invalid request parameters and reauthenticate."],8:["The JWT issuer is not supported by the Federated Keyless ",0,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],9:["The training wheels signature is invalid.",3,"Try re-authentiating. If the error persists join the telegram group at https://t.me/+h5CN-W35yUFiYzkx for further support"],10:["The public key used to verify the training wheels signature was not found.",2,"Re-authentiate to continue using your keyless account"],11:["The expiry horizon is invalid.",2,"Re-authentiate to continue using your keyless account"],13:["Failed to fetch JWKS.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],14:["Failed to fetch JWKS for Federated Keyless provider.",1,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],15:["Rate limit exceeded. Too many requests in a short period.",0,"Cache the keyless account and reuse it to avoid making too many requests.  Keyless accounts are valid until either the EphemeralKeyPair expires, when the JWK is rotated, or when the proof verifying key is changed, whichever comes soonest."],16:["Internal error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],17:["Bad request sent to Pepper service.",0,"Update the invalid request parameters and reauthenticate."],18:["Unknown error from Pepper service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],19:["Internal error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],20:["Bad request sent to Prover service.",0,"Update the invalid request parameters and reauthenticate."],21:["Unknown error from Prover service.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],12:["Error when parsing JWT. This should never happen. Join https://t.me/+h5CN-W35yUFiYzkx for support",3,"Try instantiating the account again.  Avoid manipulating the account object directly"],22:["Error when looking up on-chain keyless configuration.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],23:["Error when looking up on-chain verification key.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],24:["Error when looking up on-chain JWKS.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],25:["Unknown error from full node.",0,"Try again later.  See aptosApiError error for more context. For additional support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],26:["The signature is not a valid Keyless signature.",4,"For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"],27:["The ephemeral key pair used to sign the message has expired.",4,"Re-authentiate to continue using your keyless account"],28:["The expiry horizon on the signature exceeds the maximum allowed value.",4,"Re-authentiate to continue using your keyless account"],29:["Failed to verify the ephemeral signature with the ephemeral public key.",4,"Re-authentiate to continue using your keyless account"],30:["The training wheels signature is missing but is required by the Keyless configuration.",4,"Re-authentiate to continue using your keyless account"],31:["Failed to verify the training wheels signature with the training wheels public key.",4,"Re-authentiate to continue using your keyless account"],32:["The proof verification failed.",4,"Re-authentiate to continue using your keyless account"],33:["An unknown error has occurred.",5,"Error unknown. For support join the telegram group at https://t.me/+h5CN-W35yUFiYzkx"]},eK=class e extends Error{constructor(t){let{innerError:r,category:i,resolutionTip:n,type:s,message:a=eB[s][0],details:o}=t;super(a),this.name="KeylessError",this.innerError=r,this.category=i,this.resolutionTip=n,this.type=s,this.details=o,this.message=e.constructMessage(a,n,r,o)}static constructMessage(e,t,r,i){let n=`
Message: ${e}`;return i&&(n+=`
Details: ${i}`),r instanceof eR?n+=`
AptosApiError: ${r.message}`:void 0!==r&&(n+=`
Error: ${eS(r)}`),n+=`
KeylessErrorResolutionTip: ${t}`}static fromErrorType(t){let{error:r,type:i,details:n}=t,[s,a,o]=eB[i];return new e({message:s,details:n,innerError:r,category:a,resolutionTip:o,type:i})}},eR=class extends Error{constructor({apiType:e,aptosRequest:t,aptosResponse:r}){super(function({apiType:e,aptosRequest:t,aptosResponse:r}){let i,n=r.headers?.traceparent?.split("-")[1],s=n?`(trace_id:${n}) `:"",a=`Request to [${e}]: ${t.method} ${r.url??t.url} ${s}failed with`;return"Indexer"===e&&r.data?.errors?.[0]?.message!=null?`${a}: ${r.data.errors[0].message}`:r.data?.message!=null&&r.data?.error_code!=null?`${a}: ${JSON.stringify(r.data)}`:`${a} status: ${r.statusText}(code:${r.status}) and response body: ${(i=JSON.stringify(r.data)).length<=400?i:`truncated(original_size:${i.length}): ${i.slice(0,200)}...${i.slice(-200)}`}`}({apiType:e,aptosRequest:t,aptosResponse:r})),this.name="AptosApiError",this.url=r.url,this.status=r.status,this.statusText=r.statusText,this.data=r.data,this.request=t}};async function e$(e,t){let{url:r,method:i,body:n,contentType:s,params:a,overrides:o,originMethod:c}=e,u={...o?.HEADERS,"x-aptos-client":"aptos-typescript-sdk/1.38.0","content-type":s??"application/json","x-aptos-typescript-sdk-origin-method":c};return o?.AUTH_TOKEN&&(u.Authorization=`Bearer ${o?.AUTH_TOKEN}`),o?.API_KEY&&(u.Authorization=`Bearer ${o?.API_KEY}`),t.provider({url:r,method:i,body:n,params:a,headers:u,overrides:o})}async function eF(e,t,r){let{url:i,path:n}=e,s=n?`${i}/${n}`:i,a=await e$({...e,url:s},t.client),o={status:a.status,statusText:a.statusText??"No status text provided",data:a.data,headers:a.headers,config:a.config,request:a.request,url:s};if(401===o.status)throw new eR({apiType:r,aptosRequest:e,aptosResponse:o});if("Indexer"===r){let t=o.data;if(t.errors)throw new eR({apiType:r,aptosRequest:e,aptosResponse:o});o.data=t.data}else if(("Pepper"===r||"Prover"===r)&&o.status>=400)throw new eR({apiType:r,aptosRequest:e,aptosResponse:o});if(o.status>=200&&o.status<300)return o;throw new eR({apiType:r,aptosRequest:e,aptosResponse:o})}async function eO(e){let{aptosConfig:t,overrides:r,params:i,contentType:n,acceptType:s,path:a,originMethod:o,type:c}=e;return eF({url:t.getRequestUrl(c),method:"GET",originMethod:o,path:a,contentType:n,acceptType:s,params:i,overrides:{...t.clientConfig,...r}},t,e.type)}async function eD(e){let{aptosConfig:t}=e;return eO({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.fullnodeConfig?.HEADERS}}})}async function eq(e){let t=[],r,i=e.params;do{let n=await eO({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:i,overrides:e.overrides});r=n.headers["x-aptos-cursor"],delete n.headers,t.push(...n.data),i.start=r}while(null!=r);return t}async function eL(e){let t=[],r,i=e.params,n=i.limit;do{let{response:s,cursor:a}=await eV({...e});if(r=a,t.push(...s.data),e?.params&&(e.params.start=r),void 0!==n){let e=n-t.length;if(e<=0)break;i.limit=e}}while(null!=r);return t}async function eV(e){let t,r={};"string"==typeof e.params?.cursor&&(r.start=e.params.cursor),"number"==typeof e.params?.limit&&(r.limit=e.params.limit);let i=await eO({type:"Fullnode",aptosConfig:e.aptosConfig,originMethod:e.originMethod,path:e.path,params:r,overrides:e.overrides});return t=i.headers["x-aptos-cursor"],{response:i,cursor:t}}async function eH(e){let{aptosConfig:t,accountAddress:r}=e,{data:i}=await eD({aptosConfig:t,originMethod:"getInfo",path:`accounts/${eh.from(r).toString()}`});return i}async function eM(e){return e.options?.ledgerVersion!==void 0?ej(e):em(async()=>ej(e),`module-${e.accountAddress}-${e.moduleName}`,3e5)()}async function ej(e){let{aptosConfig:t,accountAddress:r,moduleName:i,options:n}=e,{data:s}=await eD({aptosConfig:t,originMethod:"getModule",path:`accounts/${eh.from(r).toString()}/module/${i}`,params:{ledger_version:n?.ledgerVersion}});return s}var eG=class e extends W{constructor(e){super(),this.chainId=e}serialize(e){e.serializeU8(this.chainId)}static deserialize(t){return new e(t.deserializeU8())}},eW=class e extends W{constructor(e){super(),this.identifier=e}serialize(e){e.serializeStr(this.identifier)}static deserialize(t){return new e(t.deserializeStr())}},eJ=r(32092),eY=[eJ.poseidon1,eJ.poseidon2,eJ.poseidon3,eJ.poseidon4,eJ.poseidon5,eJ.poseidon6,eJ.poseidon7,eJ.poseidon8,eJ.poseidon9,eJ.poseidon10,eJ.poseidon11,eJ.poseidon12,eJ.poseidon13,eJ.poseidon14,eJ.poseidon15,eJ.poseidon16];function eZ(e,t){return function(e,t){if(e.length>t)throw Error(`Inputted bytes of length ${e} is longer than ${t}`);return e1(eX(e,t))}(new TextEncoder().encode(e),t)}function eX(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return(function(e,t){if(e.length>t)throw Error(`Input bytes of length ${e} is longer than ${t}`);return function(e){if(e.length>465)throw Error(`Can't pack more than 465.  Was given ${e.length} bytes`);return(function(e,t){let r=[];for(let t=0;t<e.length;t+=31)r.push(e.subarray(t,t+31));return r})(e,31).map(e=>eQ(e))}(function(e,t){if(t<e.length)throw Error("Padded size must be greater than or equal to the input array size.");let r=new Uint8Array(t);r.set(e);for(let i=e.length;i<t;i+=1)r[i]=0;return r}(e,t))})(e,t).concat([BigInt(e.length)])}function eQ(e){let t=BigInt(0);for(let r=e.length-1;r>=0;r-=1)t=t<<BigInt(8)|BigInt(e[r]);return t}function e0(e,t){let r=BigInt(e),i=new Uint8Array(t);for(let e=0;e<t;e+=1)i[e]=Number(r&BigInt(255)),r>>=BigInt(8);return i}function e1(e){if(e.length>eY.length)throw Error(`Unable to hash input of length ${e.length}.  Max input length is ${eY.length}`);return eY[e.length-1](e)}var e2=class extends W{},e8=class e{static formatPrivateKey(t,r){let i=e.AIP80_PREFIXES[r],n=t;return"string"==typeof n&&n.startsWith(i)&&(n=n.split("-")[2]),`${i}${V.fromHexInput(n).toString()}`}static parseHexInput(t,r,i){let n,s=e.AIP80_PREFIXES[r];if("string"==typeof t){if(i||t.startsWith(s)){if(t.startsWith(s))n=V.fromHexString(t.split("-")[2]);else throw i?Error("Invalid HexString input while parsing private key. Must AIP-80 compliant string."):Error("Invalid HexString input while parsing private key.")}else n=V.fromHexInput(t),!1!==i&&console.warn("[Aptos SDK] It is recommended that private keys are AIP-80 compliant (https://github.com/aptos-foundation/AIPs/blob/main/aips/aip-80.md). You can fix the private key by formatting it with `PrivateKey.formatPrivateKey(privateKey: string, type: 'ed25519' | 'secp256k1'): string`.")}else n=V.fromHexInput(t);return n}};e8.AIP80_PREFIXES={ed25519:"ed25519-priv-",secp256k1:"secp256k1-priv-"};var e3=e=>"string"==typeof e?V.isValid(e).valid?e:new TextEncoder().encode(e):e,e5=r(78473),e4=r(37990),e6=r(98628),e9=/^m\/44'\/637'\/[0-9]+'\/[0-9]+'\/[0-9]+'?$/,e7=/^m\/44'\/637'\/[0-9]+'\/[0-9]+\/[0-9]+$/,te=((c=te||{}).ED25519="ed25519 seed",c),tt=(e,t)=>{let r=e5.b.create(e4.o,e).update(t).digest();return{key:r.slice(0,32),chainCode:r.slice(32)}},tr=({key:e,chainCode:t},r)=>{let i=new ArrayBuffer(4);new DataView(i).setUint32(0,r);let n=new Uint8Array(i),s=new Uint8Array([0]);return tt(t,new Uint8Array([...s,...e,...n]))},ti=e=>e.replace(/'/g,""),tn=e=>e.split("/").slice(1).map(ti),ts=e=>{let t=e.trim().split(/\s+/).map(e=>e.toLowerCase()).join(" ");return e6.Z1(t)},ta=class extends W{async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return V.fromHexInput(e).toString()}},to=class extends ta{},tc=class extends W{toUint8Array(){return this.bcsToBytes()}toString(){let e=this.toUint8Array();return V.fromHexInput(e).toString()}},tu=r(54191),tl=r(81748),td=class e extends ta{constructor(t){super();let r=V.fromHexInput(t),{length:i}=r.toUint8Array();if(i===e.LENGTH)this.key=r;else if(i===e.COMPRESSED_LENGTH){let e=tu.kA.ProjectivePoint.fromHex(r.toUint8Array());this.key=V.fromHexInput(e.toRawBytes(!1))}else throw Error(`PublicKey length should be ${e.LENGTH} or ${e.COMPRESSED_LENGTH}, received ${i}`)}verifySignature(e){let{message:t,signature:r}=e,i=e3(t),n=V.fromHexInput(i).toUint8Array(),s=(0,e_.DZ)(n),a=r.toUint8Array();return tu.kA.verify(a,s,this.key.toUint8Array(),{lowS:!0})}async verifySignatureAsync(e){return this.verifySignature(e)}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}deserialize(e){return new th(e.deserializeBytes())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&t.key?.data?.length===e.LENGTH}};td.LENGTH=65,td.COMPRESSED_LENGTH=33;var tf=class e extends W{constructor(t,r){super();let i=e8.parseHexInput(t,"secp256k1",r);if(i.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.key=i}static generate(){return new e(tu.kA.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,r){if(!e7.test(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,ts(r))}static fromDerivationPathInner(t,r){let{privateKey:i}=tl.B.fromMasterSeed(r).derive(t);if(null===i)throw Error("Invalid key");return new e(i,!1)}sign(e){let t=e3(e),r=V.fromHexInput(t),i=(0,e_.DZ)(r.toUint8Array());return new th(tu.kA.sign(i,this.key.toUint8Array(),{lowS:!0}).toCompactRawBytes())}publicKey(){return new td(tu.kA.getPublicKey(this.key.toUint8Array(),!1))}toUint8Array(){return this.key.toUint8Array()}toString(){return this.toHexString()}toHexString(){return this.key.toString()}toAIP80String(){return e8.formatPrivateKey(this.key.toString(),"secp256k1")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};tf.LENGTH=32;var tp=class e extends tc{constructor(t){super();let r=V.fromHexInput(t);if(r.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}, received ${r.toUint8Array().length}`);this.data=r}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tp.LENGTH=64;var th=tp,tg=class e extends W{constructor(t){super();let{data:r}=t,i=V.fromHexInput(r);if(i.toUint8Array().length!==e.LENGTH)throw Error(`Authentication Key length should be ${e.LENGTH}`);this.data=i}serialize(e){e.serializeFixedBytes(this.data.toUint8Array())}static deserialize(t){let r=t.deserializeFixedBytes(e.LENGTH);return new e({data:r})}toUint8Array(){return this.data.toUint8Array()}static fromSchemeAndBytes(t){let{scheme:r,input:i}=t,n=new Uint8Array([...V.fromHexInput(i).toUint8Array(),r]),s=e_.DZ.create();return s.update(n),new e({data:s.digest()})}static fromPublicKeyAndScheme(e){let{publicKey:t}=e;return t.authKey()}static fromPublicKey(e){let{publicKey:t}=e;return t.authKey()}derivedAddress(){return new eh(this.data.toUint8Array())}};tg.LENGTH=32;var ty=r(97633),tm=[237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16],t_=class e extends to{constructor(t){super();let r=V.fromHexInput(t);if(r.toUint8Array().length!==e.LENGTH)throw Error(`PublicKey length should be ${e.LENGTH}`);this.key=r}verifySignature(e){let{message:t,signature:r}=e;if(!function(e){let t=e.toUint8Array().slice(32);for(let e=tm.length-1;e>=0;e-=1){if(t[e]<tm[e])return!0;if(t[e]>tm[e])break}return!1}(r))return!1;let i=e3(t),n=V.fromHexInput(i).toUint8Array(),s=r.toUint8Array(),a=this.key.toUint8Array();return ty.UN.verify(s,n,a)}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return tg.fromSchemeAndBytes({scheme:0,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static isInstance(t){return"key"in t&&t.key?.data?.length===e.LENGTH}};t_.LENGTH=32;var tw=class e extends W{constructor(t,r){super();let i=e8.parseHexInput(t,"ed25519",r);if(i.toUint8Array().length!==e.LENGTH)throw Error(`PrivateKey length should be ${e.LENGTH}`);this.signingKey=i}static generate(){return new e(ty.UN.utils.randomPrivateKey(),!1)}static fromDerivationPath(t,r){if(!e9.test(t))throw Error(`Invalid derivation path ${t}`);return e.fromDerivationPathInner(t,ts(r))}static fromDerivationPathInner(t,r,i=2147483648){let{key:n,chainCode:s}=tt(e.SLIP_0010_SEED,r),{key:a}=tn(t).map(e=>parseInt(e,10)).reduce((e,t)=>tr(e,t+i),{key:n,chainCode:s});return new e(a,!1)}publicKey(){return new t_(ty.UN.getPublicKey(this.signingKey.toUint8Array()))}sign(e){let t=e3(e),r=V.fromHexInput(t).toUint8Array();return new tv(ty.UN.sign(r,this.signingKey.toUint8Array()))}toUint8Array(){return this.signingKey.toUint8Array()}toString(){return this.toHexString()}toHexString(){return this.signingKey.toString()}toAIP80String(){return e8.formatPrivateKey(this.signingKey.toString(),"ed25519")}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes(),!1)}static isPrivateKey(t){return t instanceof e}};tw.LENGTH=32,tw.SLIP_0010_SEED="ed25519 seed";var tb=tw,tA=class e extends tc{constructor(t){super();let r=V.fromHexInput(t);if(r.toUint8Array().length!==e.LENGTH)throw Error(`Signature length should be ${e.LENGTH}`);this.data=r}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(t){return new e(t.deserializeBytes())}};tA.LENGTH=64;var tv=tA,tE=class e extends ta{constructor(e){super();let t=e.constructor.name;if(t===t_.name)this.publicKey=e,this.variant=0;else throw Error(`Unsupported key for EphemeralPublicKey - ${t}`)}verifySignature(e){let{message:t,signature:r}=e;return this.publicKey.verifySignature({message:t,signature:r.signature})}async verifySignatureAsync(e){return this.verifySignature(e)}serialize(e){if(this.publicKey instanceof t_)e.serializeU32AsUleb128(0),this.publicKey.serialize(e);else throw Error("Unknown public key type")}static deserialize(t){let r=t.deserializeUleb128AsU32();if(0===r)return new e(t_.deserialize(t));throw Error(`Unknown variant index for EphemeralPublicKey: ${r}`)}static isPublicKey(t){return t instanceof e}},tS=class e extends tc{constructor(e){super();let t=e.constructor.name;if(t===tv.name)this.signature=e;else throw Error(`Unsupported signature for EphemeralSignature - ${t}`)}static fromHex(t){let r=new eo(V.fromHexInput(t).toUint8Array());return e.deserialize(r)}serialize(e){if(this.signature instanceof tv)e.serializeU32AsUleb128(0),this.signature.serialize(e);else throw Error("Unknown signature type")}static deserialize(t){let r=t.deserializeUleb128AsU32();if(0===r)return new e(tv.deserialize(t));throw Error(`Unknown variant index for EphemeralSignature: ${r}`)}};function tz(e,t,r){let i=r.value;return r.value=async function(...e){let[t]=e;if(t.transaction.feePayerAddress&&!t.feePayerAuthenticator)throw Error("You are submitting a Fee Payer transaction but missing the feePayerAuthenticator");return i.apply(this,e)},r}function tT(e,t,r){let i=r.value;return r.value=async function(...e){return i.apply(this,e)},r}var tx=class e extends tc{constructor(e){super(),this.value=V.fromHexInput(e).toUint8Array()}serialize(e){e.serializeBytes(this.value)}static deserialize(t){return new e(t.deserializeBytes())}},tC=class extends to{constructor(e){super(),this.accountAddress=e}authKey(){return new tg({data:this.accountAddress.toUint8Array()})}verifySignature(e){throw Error("This function is not implemented for AbstractPublicKey.")}async verifySignatureAsync(e){throw Error("This function is not implemented for AbstractPublicKey.")}serialize(e){throw Error("This function is not implemented for AbstractPublicKey.")}},tU=`
    fragment TokenActivitiesFields on token_activities_v2 {
  after_value
  before_value
  entry_function_id_str
  event_account_address
  event_index
  from_address
  is_fungible_v2
  property_version_v1
  to_address
  token_amount
  token_data_id
  token_standard
  transaction_timestamp
  transaction_version
  type
}
    `,tI=`
    fragment AnsTokenFragment on current_aptos_names {
  domain
  expiration_timestamp
  registered_address
  subdomain
  token_standard
  is_primary
  owner_address
  subdomain_expiration_policy
  domain_expiration_timestamp
}
    `,tk=`
    fragment CurrentTokenOwnershipFields on current_token_ownerships_v2 {
  token_standard
  token_properties_mutated_v1
  token_data_id
  table_type_v1
  storage_id
  property_version_v1
  owner_address
  last_transaction_version
  last_transaction_timestamp
  is_soulbound_v2
  is_fungible_v2
  amount
  current_token_data {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `,tP=`
    query getAccountCoinsCount($address: String) {
  current_fungible_asset_balances_aggregate(
    where: {owner_address: {_eq: $address}}
  ) {
    aggregate {
      count
    }
  }
}
    `,tN=`
    query getAccountCoinsData($where_condition: current_fungible_asset_balances_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_fungible_asset_balances_order_by!]) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
    metadata {
      token_standard
      symbol
      supply_aggregator_table_key_v1
      supply_aggregator_table_handle_v1
      project_uri
      name
      last_transaction_version
      last_transaction_timestamp
      icon_uri
      decimals
      creator_address
      asset_type
    }
  }
}
    `,tB=`
    query getAccountCollectionsWithOwnedTokens($where_condition: current_collection_ownership_v2_view_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_collection_ownership_v2_view_order_by!]) {
  current_collection_ownership_v2_view(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      mutable_description
      max_supply
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
    collection_id
    collection_name
    collection_uri
    creator_address
    distinct_tokens
    last_transaction_version
    owner_address
    single_token_uri
  }
}
    `,tK=`
    query getAccountOwnedTokens($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tk}`,tR=`
    query getAccountOwnedTokensFromCollection($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tk}`,t$=`
    query getAccountTokensCount($where_condition: current_token_ownerships_v2_bool_exp, $offset: Int, $limit: Int) {
  current_token_ownerships_v2_aggregate(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    aggregate {
      count
    }
  }
}
    `,tF=`
    query getAccountTransactionsCount($address: String) {
  account_transactions_aggregate(where: {account_address: {_eq: $address}}) {
    aggregate {
      count
    }
  }
}
    `,tO=`
    query getChainTopUserTransactions($limit: Int) {
  user_transactions(limit: $limit, order_by: {version: desc}) {
    version
  }
}
    `,tD=`
    query getCollectionData($where_condition: current_collections_v2_bool_exp!) {
  current_collections_v2(where: $where_condition) {
    uri
    total_minted_v2
    token_standard
    table_handle_v1
    mutable_uri
    mutable_description
    max_supply
    collection_id
    collection_name
    creator_address
    current_supply
    description
    last_transaction_timestamp
    last_transaction_version
    cdn_asset_uris {
      cdn_image_uri
      asset_uri
      animation_optimizer_retry_count
      cdn_animation_uri
      cdn_json_uri
      image_optimizer_retry_count
      json_parser_retry_count
      raw_animation_uri
      raw_image_uri
    }
  }
}
    `,tq=`
    query getCurrentFungibleAssetBalances($where_condition: current_fungible_asset_balances_bool_exp, $offset: Int, $limit: Int) {
  current_fungible_asset_balances(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    is_frozen
    is_primary
    last_transaction_timestamp
    last_transaction_version
    owner_address
    storage_id
    token_standard
  }
}
    `,tL=`
    query getDelegatedStakingActivities($delegatorAddress: String, $poolAddress: String) {
  delegated_staking_activities(
    where: {delegator_address: {_eq: $delegatorAddress}, pool_address: {_eq: $poolAddress}}
  ) {
    amount
    delegator_address
    event_index
    event_type
    pool_address
    transaction_version
  }
}
    `,tV=`
    query getEvents($where_condition: events_bool_exp, $offset: Int, $limit: Int, $order_by: [events_order_by!]) {
  events(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    account_address
    creation_number
    data
    event_index
    sequence_number
    transaction_block_height
    transaction_version
    type
    indexed_type
  }
}
    `,tH=`
    query getFungibleAssetActivities($where_condition: fungible_asset_activities_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_activities(
    where: $where_condition
    offset: $offset
    limit: $limit
  ) {
    amount
    asset_type
    block_height
    entry_function_id_str
    event_index
    gas_fee_payer_address
    is_frozen
    is_gas_fee
    is_transaction_success
    owner_address
    storage_id
    storage_refund_amount
    token_standard
    transaction_timestamp
    transaction_version
    type
  }
}
    `,tM=`
    query getFungibleAssetMetadata($where_condition: fungible_asset_metadata_bool_exp, $offset: Int, $limit: Int) {
  fungible_asset_metadata(where: $where_condition, offset: $offset, limit: $limit) {
    icon_uri
    project_uri
    supply_aggregator_table_handle_v1
    supply_aggregator_table_key_v1
    creator_address
    asset_type
    decimals
    last_transaction_timestamp
    last_transaction_version
    name
    symbol
    token_standard
    supply_v2
    maximum_v2
  }
}
    `,tj=`
    query getNames($offset: Int, $limit: Int, $where_condition: current_aptos_names_bool_exp, $order_by: [current_aptos_names_order_by!]) {
  current_aptos_names(
    limit: $limit
    where: $where_condition
    order_by: $order_by
    offset: $offset
  ) {
    ...AnsTokenFragment
  }
}
    ${tI}`,tG=`
    query getNumberOfDelegators($where_condition: num_active_delegator_per_pool_bool_exp, $order_by: [num_active_delegator_per_pool_order_by!]) {
  num_active_delegator_per_pool(where: $where_condition, order_by: $order_by) {
    num_active_delegator
    pool_address
  }
}
    `,tW=`
    query getObjectData($where_condition: current_objects_bool_exp, $offset: Int, $limit: Int, $order_by: [current_objects_order_by!]) {
  current_objects(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    allow_ungated_transfer
    state_key_hash
    owner_address
    object_address
    last_transaction_version
    last_guid_creation_num
    is_deleted
  }
}
    `,tJ=`
    query getProcessorStatus($where_condition: processor_status_bool_exp) {
  processor_status(where: $where_condition) {
    last_success_version
    processor
    last_updated
  }
}
    `,tY=`
    query getTableItemsData($where_condition: table_items_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_items_order_by!]) {
  table_items(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    decoded_key
    decoded_value
    key
    table_handle
    transaction_version
    write_set_change_index
  }
}
    `,tZ=`
    query getTableItemsMetadata($where_condition: table_metadatas_bool_exp!, $offset: Int, $limit: Int, $order_by: [table_metadatas_order_by!]) {
  table_metadatas(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    handle
    key_type
    value_type
  }
}
    `,tX=`
    query getTokenActivity($where_condition: token_activities_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [token_activities_v2_order_by!]) {
  token_activities_v2(
    where: $where_condition
    order_by: $order_by
    offset: $offset
    limit: $limit
  ) {
    ...TokenActivitiesFields
  }
}
    ${tU}`,tQ=`
    query getCurrentTokenOwnership($where_condition: current_token_ownerships_v2_bool_exp!, $offset: Int, $limit: Int, $order_by: [current_token_ownerships_v2_order_by!]) {
  current_token_ownerships_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    ...CurrentTokenOwnershipFields
  }
}
    ${tk}`,t0=`
    query getTokenData($where_condition: current_token_datas_v2_bool_exp, $offset: Int, $limit: Int, $order_by: [current_token_datas_v2_order_by!]) {
  current_token_datas_v2(
    where: $where_condition
    offset: $offset
    limit: $limit
    order_by: $order_by
  ) {
    collection_id
    description
    is_fungible_v2
    largest_property_version_v1
    last_transaction_timestamp
    last_transaction_version
    maximum
    supply
    token_data_id
    token_name
    token_properties
    token_standard
    token_uri
    decimals
    current_collection {
      collection_id
      collection_name
      creator_address
      current_supply
      description
      last_transaction_timestamp
      last_transaction_version
      max_supply
      mutable_description
      mutable_uri
      table_handle_v1
      token_standard
      total_minted_v2
      uri
    }
  }
}
    `;async function t1(e){let{type:t,originMethod:r,path:i,body:n,acceptType:s,contentType:a,params:o,aptosConfig:c,overrides:u}=e;return eF({url:c.getRequestUrl(t),method:"POST",originMethod:r,path:i,body:n,contentType:a,acceptType:s,params:o,overrides:u},c,e.type)}async function t2(e){let{aptosConfig:t}=e;return t1({...e,type:"Fullnode",overrides:{...t.clientConfig,...t.fullnodeConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.fullnodeConfig?.HEADERS}}})}async function t8(e){let{aptosConfig:t}=e;return t1({...e,type:"Indexer",overrides:{...t.clientConfig,...t.indexerConfig,...e.overrides,HEADERS:{...t.clientConfig?.HEADERS,...t.indexerConfig?.HEADERS}}})}async function t3(e){let{aptosConfig:t}=e,r={...t,clientConfig:{...t.clientConfig}};return delete r?.clientConfig?.API_KEY,t1({...e,type:"Faucet",overrides:{...r.clientConfig,...r.faucetConfig,...e.overrides,HEADERS:{...r.clientConfig?.HEADERS,...r.faucetConfig?.HEADERS}}})}async function t5(e){return t1({...e,type:"Pepper"})}async function t4(e){return t1({...e,type:"Prover"})}async function t6(e){let{aptosConfig:t}=e,{data:r}=await eD({aptosConfig:t,originMethod:"getLedgerInfo",path:""});return r}async function t9(e){let{aptosConfig:t,limit:r}=e;return(await t7({aptosConfig:t,query:{query:tO,variables:{limit:r}},originMethod:"getChainTopUserTransactions"})).user_transactions}async function t7(e){let{aptosConfig:t,query:r,originMethod:i}=e,{data:n}=await t8({aptosConfig:t,originMethod:i??"queryIndexer",path:"",body:r,overrides:{WITH_CREDENTIALS:!1}});return n}async function re(e){let{aptosConfig:t}=e;return(await t7({aptosConfig:t,query:{query:tJ},originMethod:"getProcessorStatuses"})).processor_status}async function rt(e){return BigInt((await re({aptosConfig:e.aptosConfig}))[0].last_success_version)}async function rr(e){let{aptosConfig:t,processorType:r}=e;return(await t7({aptosConfig:t,query:{query:tJ,variables:{where_condition:{processor:{_eq:r}}}},originMethod:"getProcessorStatus"})).processor_status[0]}async function ri(e){let{aptosConfig:t,handle:r,data:i,options:n}=e;return(await t2({aptosConfig:t,originMethod:"getTableItem",path:`tables/${r}/item`,params:{ledger_version:n?.ledgerVersion},body:i})).data}async function rn(e){let{aptosConfig:t,options:r}=e,i={query:tY,variables:{where_condition:r?.where,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:i,originMethod:"getTableItemsData"})).table_items}async function rs(e){let{aptosConfig:t,options:r}=e,i={query:tZ,variables:{where_condition:r?.where,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:i,originMethod:"getTableItemsMetadata"})).table_metadatas}var ra=((u=ra||{}).FULLNODE="Fullnode",u.INDEXER="Indexer",u.FAUCET="Faucet",u.PEPPER="Pepper",u.PROVER="Prover",u),ro="0x1::aptos_coin::AptosCoin",rc="APTOS::RawTransactionWithData",ru=((l=ru||{}).ACCOUNT_TRANSACTION_PROCESSOR="account_transactions_processor",l.DEFAULT="default_processor",l.EVENTS_PROCESSOR="events_processor",l.FUNGIBLE_ASSET_PROCESSOR="fungible_asset_processor",l.STAKE_PROCESSOR="stake_processor",l.TOKEN_V2_PROCESSOR="token_v2_processor",l.USER_TRANSACTION_PROCESSOR="user_transaction_processor",l.OBJECT_PROCESSOR="objects_processor",l),rl=/^https:\/\/securetoken\.google\.com\/[a-zA-Z0-9-_]+$/;async function rd(e){let{aptosConfig:t,options:r}=e;return eq({aptosConfig:t,originMethod:"getTransactions",path:"transactions",params:{start:r?.offset,limit:r?.limit}})}async function rf(e){let{aptosConfig:t}=e;return em(async()=>{let{data:e}=await eD({aptosConfig:t,originMethod:"getGasPriceEstimation",path:"estimate_gas_price"});return e},`gas-price-${t.network}`,3e5)()}async function rp(e){let{aptosConfig:t,ledgerVersion:r}=e,{data:i}=await eD({aptosConfig:t,originMethod:"getTransactionByVersion",path:`transactions/by_version/${r}`});return i}async function rh(e){let{aptosConfig:t,transactionHash:r}=e,{data:i}=await eD({aptosConfig:t,path:`transactions/by_hash/${r}`,originMethod:"getTransactionByHash"});return i}async function rg(e){let{aptosConfig:t,transactionHash:r}=e;try{return"pending_transaction"===(await rh({aptosConfig:t,transactionHash:r})).type}catch(e){if(e?.status===404)return!0;throw e}}async function ry(e){let{aptosConfig:t,transactionHash:r}=e,{data:i}=await eD({aptosConfig:t,path:`transactions/wait_by_hash/${r}`,originMethod:"longWaitForTransaction"});return i}async function rm(e){let{aptosConfig:t,transactionHash:r,options:i}=e,n=i?.timeoutSecs??20,s=i?.checkSuccess??!0,a=!0,o=0,c,u,l=200;function d(e){if(!(e instanceof eR)||(u=e,404!==e.status&&e.status>=400&&e.status<500))throw e}try{c=await rh({aptosConfig:t,transactionHash:r}),a="pending_transaction"===c.type}catch(e){d(e)}if(a){let e=Date.now();try{c=await ry({aptosConfig:t,transactionHash:r}),a="pending_transaction"===c.type}catch(e){d(e)}o=(Date.now()-e)/1e3}for(;a&&!(o>=n);){try{if(c=await rh({aptosConfig:t,transactionHash:r}),!(a="pending_transaction"===c.type))break}catch(e){d(e)}await eE(l),o+=l/1e3,l*=1.5}if(void 0===c)throw u||new rw(`Fetching transaction ${r} failed and timed out after ${n} seconds`,c);if("pending_transaction"===c.type)throw new rw(`Transaction ${r} timed out in pending state after ${n} seconds`,c);if(!s)return c;if(!c.success)throw new rb(`Transaction ${r} failed with an error: ${c.vm_status}`,c);return c}async function r_(e){let{aptosConfig:t,processorType:r}=e,i=BigInt(e.minimumLedgerVersion),n=new Date().getTime(),s=BigInt(-1);for(;s<i;){if(new Date().getTime()-n>3e3)throw Error("waitForLastSuccessIndexerVersionSync timeout");if((s=void 0===r?await rt({aptosConfig:t}):(await rr({aptosConfig:t,processorType:r})).last_success_version)>=i)break;await eE(200)}}var rw=class extends Error{constructor(e,t){super(e),this.lastSubmittedTransaction=t}},rb=class extends Error{constructor(e,t){super(e),this.transaction=t}};async function rA(e){let{aptosConfig:t,ledgerVersion:r,options:i}=e,{data:n}=await eD({aptosConfig:t,originMethod:"getBlockByVersion",path:`blocks/by_version/${r}`,params:{with_transactions:i?.withTransactions}});return rE({block:n,...e})}async function rv(e){let{aptosConfig:t,blockHeight:r,options:i}=e,{data:n}=await eD({aptosConfig:t,originMethod:"getBlockByHeight",path:`blocks/by_height/${r}`,params:{with_transactions:i?.withTransactions}});return rE({block:n,...e})}async function rE(e){let{aptosConfig:t,block:r,options:i}=e;if(i?.withTransactions){r.transactions=r.transactions??[];let e=r.transactions[r.transactions.length-1],i=BigInt(r.first_version),n=BigInt(r.last_version),s=e?.version,a;if((a=void 0===s?i-1n:BigInt(s))===n)return r;let o=[];for(let e=a+1n;e<n;e+=BigInt(100))o.push(rd({aptosConfig:t,options:{offset:e,limit:Math.min(Number(100n),Number(n-e+1n))}}));for(let e of(await Promise.all(o)))r.transactions.push(...e)}return r}async function rS(e){void 0!==e.minimumLedgerVersion&&await r_({aptosConfig:e.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:e.processorType})}var rz=class{constructor(e){this.config=e}async getTableItem(e){return ri({aptosConfig:this.config,...e})}async getTableItemsData(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),rn({aptosConfig:this.config,...e})}async getTableItemsMetadata(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),rs({aptosConfig:this.config,...e})}},rT=class e extends W{constructor(e){super(),this.value=V.fromHexInput(e).toUint8Array()}serialize(e){e.serializeFixedBytes(this.value)}serializeForEntryFunction(e){e.serialize(this)}serializeForScriptFunction(e){e.serialize(this)}static deserialize(t,r){return new e(t.deserializeFixedBytes(r))}},rx=class e extends W{constructor(e){super(),this.value=new rT(e)}serialize(e){e.serialize(this.value)}serializeForEntryFunction(e){e.serializeU32AsUleb128(this.value.value.length),e.serialize(this)}static deserialize(t,r){return new e(rT.deserialize(t,r).value)}},rC=r(46669),rU=((d=rU||{}).JSON="application/json",d.BCS="application/x-bcs",d.BCS_SIGNED_TRANSACTION="application/x.aptos.signed_transaction+bcs",d.BCS_VIEW_FUNCTION="application/x.aptos.view_function+bcs",d),rI=((f=rI||{})[f.Bool=0]="Bool",f[f.U8=1]="U8",f[f.U64=2]="U64",f[f.U128=3]="U128",f[f.Address=4]="Address",f[f.Signer=5]="Signer",f[f.Vector=6]="Vector",f[f.Struct=7]="Struct",f[f.U16=8]="U16",f[f.U32=9]="U32",f[f.U256=10]="U256",f[f.Reference=254]="Reference",f[f.Generic=255]="Generic",f),rk=((p=rk||{})[p.U8=0]="U8",p[p.U64=1]="U64",p[p.U128=2]="U128",p[p.Address=3]="Address",p[p.U8Vector=4]="U8Vector",p[p.Bool=5]="Bool",p[p.U16=6]="U16",p[p.U32=7]="U32",p[p.U256=8]="U256",p[p.Serialized=9]="Serialized",p),rP=((h=rP||{})[h.Script=0]="Script",h[h.EntryFunction=2]="EntryFunction",h[h.Multisig=3]="Multisig",h),rN=((g=rN||{})[g.MultiAgentTransaction=0]="MultiAgentTransaction",g[g.FeePayerTransaction=1]="FeePayerTransaction",g),rB=((y=rB||{})[y.Ed25519=0]="Ed25519",y[y.MultiEd25519=1]="MultiEd25519",y[y.MultiAgent=2]="MultiAgent",y[y.FeePayer=3]="FeePayer",y[y.SingleSender=4]="SingleSender",y),rK=((m=rK||{})[m.Ed25519=0]="Ed25519",m[m.MultiEd25519=1]="MultiEd25519",m[m.SingleKey=2]="SingleKey",m[m.MultiKey=3]="MultiKey",m[m.NoAccountAuthenticator=4]="NoAccountAuthenticator",m[m.Abstraction=5]="Abstraction",m),rR=((_=rR||{}).Ed25519="ed25519",_.Secp256k1="secp256k1",_),r$=((w=r$||{})[w.Ed25519=0]="Ed25519",w[w.Secp256k1=1]="Secp256k1",w[w.Keyless=3]="Keyless",w[w.FederatedKeyless=4]="FederatedKeyless",w),rF=((b=rF||{})[b.Ed25519=0]="Ed25519",b[b.Secp256k1=1]="Secp256k1",b[b.Keyless=3]="Keyless",b),rO=((A=rO||{})[A.Ed25519=0]="Ed25519",A),rD=((v=rD||{})[v.Ed25519=0]="Ed25519",v),rq=((E=rq||{})[E.ZkProof=0]="ZkProof",E),rL=((S=rL||{})[S.Groth16=0]="Groth16",S),rV=((z=rV||{}).Pending="pending_transaction",z.User="user_transaction",z.Genesis="genesis_transaction",z.BlockMetadata="block_metadata_transaction",z.StateCheckpoint="state_checkpoint_transaction",z.Validator="validator_transaction",z.BlockEpilogue="block_epilogue_transaction",z),rH=((T=rH||{}).PRIVATE="private",T.PUBLIC="public",T.FRIEND="friend",T),rM=((x=rM||{}).STORE="store",x.DROP="drop",x.KEY="key",x.COPY="copy",x),rj=((C=rj||{}).VALIDATOR="validator",C.FULL_NODE="full_node",C),rG=((U=rG||{})[U.Ed25519=0]="Ed25519",U[U.MultiEd25519=1]="MultiEd25519",U[U.SingleKey=2]="SingleKey",U[U.MultiKey=3]="MultiKey",U),rW=((I=rW||{})[I.Ed25519=0]="Ed25519",I[I.Secp256k1Ecdsa=2]="Secp256k1Ecdsa",I),rJ=((k=rJ||{})[k.DeriveAuid=251]="DeriveAuid",k[k.DeriveObjectAddressFromObject=252]="DeriveObjectAddressFromObject",k[k.DeriveObjectAddressFromGuid=253]="DeriveObjectAddressFromGuid",k[k.DeriveObjectAddressFromSeed=254]="DeriveObjectAddressFromSeed",k[k.DeriveResourceAccountAddress=255]="DeriveResourceAccountAddress",k),rY={mainnet:"https://api.mainnet.aptoslabs.com/v1/graphql",testnet:"https://api.testnet.aptoslabs.com/v1/graphql",devnet:"https://api.devnet.aptoslabs.com/v1/graphql",local:"http://127.0.0.1:8090/v1/graphql"},rZ={mainnet:"https://api.mainnet.aptoslabs.com/v1",testnet:"https://api.testnet.aptoslabs.com/v1",devnet:"https://api.devnet.aptoslabs.com/v1",local:"http://127.0.0.1:8080/v1"},rX={devnet:"https://faucet.devnet.aptoslabs.com",local:"http://127.0.0.1:8081"},rQ={mainnet:"https://api.mainnet.aptoslabs.com/keyless/pepper/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/pepper/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/pepper/v0",local:"https://api.devnet.aptoslabs.com/keyless/pepper/v0"},r0={mainnet:"https://api.mainnet.aptoslabs.com/keyless/prover/v0",testnet:"https://api.testnet.aptoslabs.com/keyless/prover/v0",devnet:"https://api.devnet.aptoslabs.com/keyless/prover/v0",local:"https://api.devnet.aptoslabs.com/keyless/prover/v0"},r1=((P=r1||{}).MAINNET="mainnet",P.TESTNET="testnet",P.DEVNET="devnet",P.LOCAL="local",P.CUSTOM="custom",P),r2={mainnet:1,testnet:2,local:4},r8=r(47457),r3=class{constructor(e){this.network=e?.network??"devnet",this.fullnode=e?.fullnode,this.faucet=e?.faucet,this.pepper=e?.pepper,this.prover=e?.prover,this.indexer=e?.indexer,this.client=e?.client??{provider:r8.ZP},this.clientConfig=e?.clientConfig??{},this.fullnodeConfig=e?.fullnodeConfig??{},this.indexerConfig=e?.indexerConfig??{},this.faucetConfig=e?.faucetConfig??{}}getRequestUrl(e){switch(e){case"Fullnode":if(void 0!==this.fullnode)return this.fullnode;if("custom"===this.network)throw Error("Please provide a custom full node url");return rZ[this.network];case"Faucet":if(void 0!==this.faucet)return this.faucet;if("testnet"===this.network)throw Error("There is no way to programmatically mint testnet APT, you must use the minting site at https://aptos.dev/network/faucet");if("mainnet"===this.network)throw Error("There is no mainnet faucet");if("custom"===this.network)throw Error("Please provide a custom faucet url");return rX[this.network];case"Indexer":if(void 0!==this.indexer)return this.indexer;if("custom"===this.network)throw Error("Please provide a custom indexer url");return rY[this.network];case"Pepper":if(void 0!==this.pepper)return this.pepper;if("custom"===this.network)throw Error("Please provide a custom pepper service url");return rQ[this.network];case"Prover":if(void 0!==this.prover)return this.prover;if("custom"===this.network)throw Error("Please provide a custom prover service url");return r0[this.network];default:throw Error(`apiType ${e} is not supported`)}}isPepperServiceRequest(e){return rQ[this.network]===e}isProverServiceRequest(e){return r0[this.network]===e}},r5=r(85197),r4=r(475),r6=r(64902),r9=r(75090),r7=r(54361);let ie=r7.bytesToNumberBE;function it(e,t){if(ir(e),ir(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)r[i]=255&e,e>>>=8;return new Uint8Array(r)}function ir(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function ii(e,t,r){let i;(0,r7.FF)(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:s,m:a,hash:o,expand:c,DST:u}=r;(0,r7.gk)(e),ir(t);let l="string"==typeof u?(0,r7.iY)(u):u,d=Math.ceil((n.toString(2).length+s)/8),f=t*a*d;if("xmd"===c)i=function(e,t,r,i){(0,r7.gk)(e),(0,r7.gk)(t),ir(r),t.length>255&&(t=i((0,r7.eV)((0,r7.iY)("H2C-OVERSIZE-DST-"),t)));let{outputLen:n,blockLen:s}=i,a=Math.ceil(r/n);if(r>65535||a>255)throw Error("expand_message_xmd: invalid lenInBytes");let o=(0,r7.eV)(t,it(t.length,1)),c=it(0,s),u=it(r,2),l=Array(a),d=i((0,r7.eV)(c,e,u,it(0,1),o));l[0]=i((0,r7.eV)(d,it(1,1),o));for(let e=1;e<=a;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r}(d,l[e-1]),it(e+1,1),o];l[e]=i((0,r7.eV)(...t))}return(0,r7.eV)(...l).slice(0,r)}(e,l,f,o);else if("xof"===c)i=function(e,t,r,i,n){if((0,r7.gk)(e),(0,r7.gk)(t),ir(r),t.length>255&&(t=n.create({dkLen:Math.ceil(2*i/8)}).update((0,r7.iY)("H2C-OVERSIZE-DST-")).update(t).digest()),r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return n.create({dkLen:r}).update(e).update(it(r,2)).update(t).update(it(t.length,1)).digest()}(e,l,f,s,o);else if("_internal_pass"===c)i=e;else throw Error('expand must be "xmd" or "xof"');let p=Array(t);for(let e=0;e<t;e++){let t=Array(a);for(let r=0;r<a;r++){let s=d*(r+e*a),o=i.subarray(s,s+d);t[r]=(0,r9.wQ)(ie(o),n)}p[e]=t}return p}function is(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");return{hashToCurve(i,n){let s=ii(i,2,{...r,DST:r.DST,...n}),a=e.fromAffine(t(s[0])),o=e.fromAffine(t(s[1])),c=a.add(o).clearCofactor();return c.assertValidity(),c},encodeToCurve(i,n){let s=ii(i,1,{...r,DST:r.encodeDST,...n}),a=e.fromAffine(t(s[0])).clearCofactor();return a.assertValidity(),a},mapToCurve(r){if(!Array.isArray(r))throw Error("mapToCurve: expected array of bigints");for(let e of r)if("bigint"!=typeof e)throw Error("mapToCurve: expected array of bigints");let i=e.fromAffine(t(r)).clearCofactor();return i.assertValidity(),i}}}var ia=r(95338);let io=BigInt(0),ic=BigInt(1),iu=BigInt(2),il=BigInt(3),id=BigInt(0),ip=BigInt(1),ih=BigInt(2),ig=BigInt(3);function iy(e,t,r,i,n=1,s){let a=BigInt(void 0===s?i:s),o=r**BigInt(i),c=[];for(let s=0;s<n;s++){let n=BigInt(s+1),u=[];for(let s=0,c=ip;s<i;s++){let i=(n*c-n)/a%o;u.push(e.pow(t,i)),c*=r}c.push(u)}return c}let im=BigInt(1),i_=BigInt(2),iw=BigInt(3),ib=BigInt(6),iA=BigInt("4965661367192848881"),iv=(0,r7.Dd)(iA),iE=ib*iA**i_,iS=(0,r9.gN)(BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617")),iz={c0:BigInt("19485874751759354771024239261021720505790618469301721065564631296452457478373"),c1:BigInt("266929791119991161246907387137283842545076965332900288569378510910307636690")},{Fp:iT,Fp2:ix,Fp6:iC,Fp4Square:iU,Fp12:iI}=function(e){let{ORDER:t}=e,r=r9.gN(t),i=r.create(e.NONRESIDUE||BigInt(-1)),n=r9.IN(t),s=r.div(r.ONE,ih),a=iy(r,i,r.ORDER,2)[0],o=({c0:e,c1:t},{c0:i,c1:n})=>({c0:r.add(e,i),c1:r.add(t,n)}),c=({c0:e,c1:t},{c0:i,c1:n})=>({c0:r.sub(e,i),c1:r.sub(t,n)}),u=({c0:e,c1:t},i)=>{if("bigint"==typeof i)return{c0:r.mul(e,i),c1:r.mul(t,i)};let{c0:n,c1:s}=i,a=r.mul(e,n),o=r.mul(t,s);return{c0:r.sub(a,o),c1:r.sub(r.mul(r.add(e,t),r.add(n,s)),r.add(a,o))}},l=({c0:e,c1:t})=>{let i=r.add(e,t),n=r.sub(e,t),s=r.add(e,e);return{c0:r.mul(i,n),c1:r.mul(s,t)}},d=e=>{if(2!==e.length)throw Error("invalid tuple");let t=e.map(e=>r.create(e));return{c0:t[0],c1:t[1]}},f=t*t,p=d(e.FP2_NONRESIDUE),h={ORDER:f,isLE:r.isLE,NONRESIDUE:p,BITS:(0,r7.Dd)(f),BYTES:Math.ceil((0,r7.Dd)(f)/8),MASK:(0,r7.dQ)((0,r7.Dd)(f)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>"bigint"==typeof e&&"bigint"==typeof t,is0:({c0:e,c1:t})=>r.is0(e)&&r.is0(t),eql:({c0:e,c1:t},{c0:i,c1:n})=>r.eql(e,i)&&r.eql(t,n),neg:({c0:e,c1:t})=>({c0:r.neg(e),c1:r.neg(t)}),pow:(e,t)=>r9.Q(h,e,t),invertBatch:e=>r9.Eg(h,e),add:o,sub:c,mul:u,sqr:l,addN:o,subN:c,mulN:u,sqrN:l,div:(e,t)=>h.mul(e,"bigint"==typeof t?r.inv(r.create(t)):h.inv(t)),inv:({c0:e,c1:t})=>{let i=r.inv(r.create(e*e+t*t));return{c0:r.mul(i,r.create(e)),c1:r.mul(i,r.create(-t))}},sqrt:t=>{if(e.Fp2sqrt)return e.Fp2sqrt(t);let{c0:a,c1:o}=t;if(r.is0(o))return r.eql(n(r,a),r.ONE)?h.create({c0:r.sqrt(a),c1:r.ZERO}):h.create({c0:r.ZERO,c1:r.sqrt(r.div(a,i))});let c=r.sqrt(r.sub(r.sqr(a),r.mul(r.sqr(o),i))),u=r.mul(r.add(c,a),s),l=n(r,u);r.is0(l)||r.eql(l,r.ONE)||(u=r.sub(u,c));let d=r.sqrt(u),f=h.create({c0:d,c1:r.div(r.mul(o,s),d)});if(!h.eql(h.sqr(f),t))throw Error("Cannot find square root");let p=h.neg(f),{re:g,im:y}=h.reim(f),{re:m,im:_}=h.reim(p);return y>_||y===_&&g>m?f:p},isOdd:e=>{let{re:t,im:r}=h.reim(e),i=t%ih,n=r%ih;return BigInt(i||t===id&&n)==ip},fromBytes(e){if(e.length!==h.BYTES)throw Error("fromBytes invalid length="+e.length);return{c0:r.fromBytes(e.subarray(0,r.BYTES)),c1:r.fromBytes(e.subarray(r.BYTES))}},toBytes:({c0:e,c1:t})=>(0,r7.eV)(r.toBytes(e),r.toBytes(t)),cmov:({c0:e,c1:t},{c0:i,c1:n},s)=>({c0:r.cmov(e,i,s),c1:r.cmov(t,n,s)}),reim:({c0:e,c1:t})=>({re:e,im:t}),mulByNonresidue:({c0:e,c1:t})=>h.mul({c0:e,c1:t},p),mulByB:e.Fp2mulByB,fromBigTuple:d,frobeniusMap:({c0:e,c1:t},i)=>({c0:e,c1:r.mul(t,a[i%2])})},g=({c0:e,c1:t,c2:r},{c0:i,c1:n,c2:s})=>({c0:h.add(e,i),c1:h.add(t,n),c2:h.add(r,s)}),y=({c0:e,c1:t,c2:r},{c0:i,c1:n,c2:s})=>({c0:h.sub(e,i),c1:h.sub(t,n),c2:h.sub(r,s)}),m=({c0:e,c1:t,c2:r},i)=>{if("bigint"==typeof i)return{c0:h.mul(e,i),c1:h.mul(t,i),c2:h.mul(r,i)};let{c0:n,c1:s,c2:a}=i,o=h.mul(e,n),c=h.mul(t,s),u=h.mul(r,a);return{c0:h.add(o,h.mulByNonresidue(h.sub(h.mul(h.add(t,r),h.add(s,a)),h.add(c,u)))),c1:h.add(h.sub(h.mul(h.add(e,t),h.add(n,s)),h.add(o,c)),h.mulByNonresidue(u)),c2:h.sub(h.add(c,h.mul(h.add(e,r),h.add(n,a))),h.add(o,u))}},_=({c0:e,c1:t,c2:r})=>{let i=h.sqr(e),n=h.mul(h.mul(e,t),ih),s=h.mul(h.mul(t,r),ih),a=h.sqr(r);return{c0:h.add(h.mulByNonresidue(s),i),c1:h.add(h.mulByNonresidue(a),n),c2:h.sub(h.sub(h.add(h.add(n,h.sqr(h.add(h.sub(e,t),r))),s),i),a)}},[w,b]=iy(h,p,r.ORDER,6,2,3),A={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:(0,r7.dQ)(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:e=>e,isValid:({c0:e,c1:t,c2:r})=>h.isValid(e)&&h.isValid(t)&&h.isValid(r),is0:({c0:e,c1:t,c2:r})=>h.is0(e)&&h.is0(t)&&h.is0(r),neg:({c0:e,c1:t,c2:r})=>({c0:h.neg(e),c1:h.neg(t),c2:h.neg(r)}),eql:({c0:e,c1:t,c2:r},{c0:i,c1:n,c2:s})=>h.eql(e,i)&&h.eql(t,n)&&h.eql(r,s),sqrt:r7.EQ,div:(e,t)=>A.mul(e,"bigint"==typeof t?r.inv(r.create(t)):A.inv(t)),pow:(e,t)=>r9.Q(A,e,t),invertBatch:e=>r9.Eg(A,e),add:g,sub:y,mul:m,sqr:_,addN:g,subN:y,mulN:m,sqrN:_,inv:({c0:e,c1:t,c2:r})=>{let i=h.sub(h.sqr(e),h.mulByNonresidue(h.mul(r,t))),n=h.sub(h.mulByNonresidue(h.sqr(r)),h.mul(e,t)),s=h.sub(h.sqr(t),h.mul(e,r)),a=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(r,n),h.mul(t,s))),h.mul(e,i)));return{c0:h.mul(a,i),c1:h.mul(a,n),c2:h.mul(a,s)}},fromBytes:e=>{if(e.length!==A.BYTES)throw Error("fromBytes invalid length="+e.length);return{c0:h.fromBytes(e.subarray(0,h.BYTES)),c1:h.fromBytes(e.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(e.subarray(2*h.BYTES))}},toBytes:({c0:e,c1:t,c2:r})=>(0,r7.eV)(h.toBytes(e),h.toBytes(t),h.toBytes(r)),cmov:({c0:e,c1:t,c2:r},{c0:i,c1:n,c2:s},a)=>({c0:h.cmov(e,i,a),c1:h.cmov(t,n,a),c2:h.cmov(r,s,a)}),fromBigSix:e=>{if(!Array.isArray(e)||6!==e.length)throw Error("invalid Fp6 usage");return{c0:h.fromBigTuple(e.slice(0,2)),c1:h.fromBigTuple(e.slice(2,4)),c2:h.fromBigTuple(e.slice(4,6))}},frobeniusMap:({c0:e,c1:t,c2:r},i)=>({c0:h.frobeniusMap(e,i),c1:h.mul(h.frobeniusMap(t,i),w[i%6]),c2:h.mul(h.frobeniusMap(r,i),b[i%6])}),mulByFp2:({c0:e,c1:t,c2:r},i)=>({c0:h.mul(e,i),c1:h.mul(t,i),c2:h.mul(r,i)}),mulByNonresidue:({c0:e,c1:t,c2:r})=>({c0:h.mulByNonresidue(r),c1:e,c2:t}),mul1:({c0:e,c1:t,c2:r},i)=>({c0:h.mulByNonresidue(h.mul(r,i)),c1:h.mul(e,i),c2:h.mul(t,i)}),mul01({c0:e,c1:t,c2:r},i,n){let s=h.mul(e,i),a=h.mul(t,n);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(t,r),n),a)),s),c1:h.sub(h.sub(h.mul(h.add(i,n),h.add(e,t)),s),a),c2:h.add(h.sub(h.mul(h.add(e,r),i),s),a)}}},v=iy(h,p,r.ORDER,12,1,6)[0],E=({c0:e,c1:t},{c0:r,c1:i})=>({c0:A.add(e,r),c1:A.add(t,i)}),S=({c0:e,c1:t},{c0:r,c1:i})=>({c0:A.sub(e,r),c1:A.sub(t,i)}),z=({c0:e,c1:t},r)=>{if("bigint"==typeof r)return{c0:A.mul(e,r),c1:A.mul(t,r)};let{c0:i,c1:n}=r,s=A.mul(e,i),a=A.mul(t,n);return{c0:A.add(s,A.mulByNonresidue(a)),c1:A.sub(A.mul(A.add(e,t),A.add(i,n)),A.add(s,a))}},T=({c0:e,c1:t})=>{let r=A.mul(e,t);return{c0:A.sub(A.sub(A.mul(A.add(A.mulByNonresidue(t),e),A.add(e,t)),r),A.mulByNonresidue(r)),c1:A.add(r,r)}},x={ORDER:h.ORDER,isLE:A.isLE,BITS:2*h.BITS,BYTES:2*h.BYTES,MASK:(0,r7.dQ)(2*h.BITS),ZERO:{c0:A.ZERO,c1:A.ZERO},ONE:{c0:A.ONE,c1:A.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>A.isValid(e)&&A.isValid(t),is0:({c0:e,c1:t})=>A.is0(e)&&A.is0(t),neg:({c0:e,c1:t})=>({c0:A.neg(e),c1:A.neg(t)}),eql:({c0:e,c1:t},{c0:r,c1:i})=>A.eql(e,r)&&A.eql(t,i),sqrt:r7.EQ,inv:({c0:e,c1:t})=>{let r=A.inv(A.sub(A.sqr(e),A.mulByNonresidue(A.sqr(t))));return{c0:A.mul(e,r),c1:A.neg(A.mul(t,r))}},div:(e,t)=>x.mul(e,"bigint"==typeof t?r.inv(r.create(t)):x.inv(t)),pow:(e,t)=>r9.Q(x,e,t),invertBatch:e=>r9.Eg(x,e),add:E,sub:S,mul:z,sqr:T,addN:E,subN:S,mulN:z,sqrN:T,fromBytes:e=>{if(e.length!==x.BYTES)throw Error("fromBytes invalid length="+e.length);return{c0:A.fromBytes(e.subarray(0,A.BYTES)),c1:A.fromBytes(e.subarray(A.BYTES))}},toBytes:({c0:e,c1:t})=>(0,r7.eV)(A.toBytes(e),A.toBytes(t)),cmov:({c0:e,c1:t},{c0:r,c1:i},n)=>({c0:A.cmov(e,r,n),c1:A.cmov(t,i,n)}),fromBigTwelve:e=>({c0:A.fromBigSix(e.slice(0,6)),c1:A.fromBigSix(e.slice(6,12))}),frobeniusMap(e,t){let{c0:r,c1:i,c2:n}=A.frobeniusMap(e.c1,t),s=v[t%12];return{c0:A.frobeniusMap(e.c0,t),c1:A.create({c0:h.mul(r,s),c1:h.mul(i,s),c2:h.mul(n,s)})}},mulByFp2:({c0:e,c1:t},r)=>({c0:A.mulByFp2(e,r),c1:A.mulByFp2(t,r)}),conjugate:({c0:e,c1:t})=>({c0:e,c1:A.neg(t)}),mul014:({c0:e,c1:t},r,i,n)=>{let s=A.mul01(e,r,i),a=A.mul1(t,n);return{c0:A.add(A.mulByNonresidue(a),s),c1:A.sub(A.sub(A.mul01(A.add(t,e),r,h.add(i,n)),s),a)}},mul034:({c0:e,c1:t},r,i,n)=>{let s=A.create({c0:h.mul(e.c0,r),c1:h.mul(e.c1,r),c2:h.mul(e.c2,r)}),a=A.mul01(t,i,n),o=A.mul01(A.add(e,t),h.add(r,i),n);return{c0:A.add(A.mulByNonresidue(a),s),c1:A.sub(o,A.add(s,a))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:r,Fp2:h,Fp6:A,Fp4Square:function(e,t){let r=h.sqr(e),i=h.sqr(t);return{first:h.add(h.mulByNonresidue(i),r),second:h.sub(h.sub(h.sqr(h.add(e,t)),r),i)}},Fp12:x}}({ORDER:BigInt("21888242871839275222246405745257275088696311157297823662689037894645226208583"),FP2_NONRESIDUE:[BigInt(9),im],Fp2mulByB:e=>ix.mul(e,iz),Fp12cyclotomicSquare:({c0:e,c1:t})=>{let{c0:r,c1:i,c2:n}=e,{c0:s,c1:a,c2:o}=t,{first:c,second:u}=iU(r,a),{first:l,second:d}=iU(s,n),{first:f,second:p}=iU(i,o),h=ix.mulByNonresidue(p);return{c0:iC.create({c0:ix.add(ix.mul(ix.sub(c,r),i_),c),c1:ix.add(ix.mul(ix.sub(l,i),i_),l),c2:ix.add(ix.mul(ix.sub(f,n),i_),f)}),c1:iC.create({c0:ix.add(ix.mul(ix.add(h,s),i_),h),c1:ix.add(ix.mul(ix.add(u,a),i_),u),c2:ix.add(ix.mul(ix.add(d,o),i_),d)})}},Fp12cyclotomicExp(e,t){let r=iI.ONE;for(let i=iv-1;i>=0;i--)r=iI._cyclotomicSquare(r),(0,r7.H_)(t,i)&&(r=iI.mul(r,e));return r},Fp12finalExponentiate:e=>{let t=e=>iI.conjugate(iI._cyclotomicExp(e,iA)),r=iI.mul(iI.conjugate(e),iI.inv(e)),i=iI.mul(iI.frobeniusMap(r,2),r),n=iI._cyclotomicSquare(t(i)),s=iI.mul(iI._cyclotomicSquare(n),n),a=t(s),o=t(iI._cyclotomicSquare(a)),c=iI.mul(iI.mul(iI.conjugate(o),a),iI.conjugate(s)),u=iI.mul(c,n);return iI.mul(iI.frobeniusMap(iI.mul(iI.conjugate(i),u),3),iI.mul(iI.frobeniusMap(c,2),iI.mul(iI.frobeniusMap(u,1),iI.mul(iI.mul(c,a),i))))}}),{G2psi:ik,psi:iP}=function(e,t,r){let i=t.pow(r,(e.ORDER-ip)/ig),n=t.pow(r,(e.ORDER-ip)/ih);function s(e,r){return[t.mul(t.frobeniusMap(e,1),i),t.mul(t.frobeniusMap(r,1),n)]}let a=t.pow(r,(e.ORDER**ih-ip)/ig),o=t.pow(r,(e.ORDER**ih-ip)/ih);if(!t.eql(o,t.neg(t.ONE)))throw Error("psiFrobenius: PSI2_Y!==-1");function c(e,r){return[t.mul(e,a),t.neg(r)]}let u=e=>(t,r)=>{let i=r.toAffine(),n=e(i.x,i.y);return t.fromAffine({x:n[0],y:n[1]})},l=u(s),d=u(c);return{psi:s,psi2:c,G2psi:l,G2psi2:d,PSI_X:i,PSI_Y:n,PSI2_X:a,PSI2_Y:o}}(iT,ix,ix.NONRESIDUE),iN=Object.freeze({DST:"BN254G2_XMD:SHA-256_SVDW_RO_",encodeDST:"BN254G2_XMD:SHA-256_SVDW_RO_",p:iT.ORDER,m:2,k:128,expand:"xmd",hash:r4.JQ}),iB=function(e){let t;let{Fp:r,Fr:i,Fp2:n,Fp6:s,Fp12:a}=e.fields,o=e.params.xNegative,c=e.params.twistType,u=(0,ia.su)({n:i.ORDER,...e.G1}),l=Object.assign(u,is(u.ProjectivePoint,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),d=(0,ia.su)({n:i.ORDER,...e.G2}),f=Object.assign(d,is(d.ProjectivePoint,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));if("multiplicative"===c)t=(e,t,r,i,s,o)=>a.mul014(i,e,n.mul(t,s),n.mul(r,o));else if("divisive"===c)t=(e,t,r,i,s,o)=>a.mul034(i,n.mul(r,o),n.mul(t,s),e);else throw Error("bls: unknown twist type");let p=n.div(n.ONE,n.mul(n.ONE,iu));function h(e,t,r,i,s,a){let o=n.sub(r,n.mul(a,i)),c=n.sub(t,n.mul(s,i)),u=n.sub(n.mul(o,s),n.mul(c,a)),l=n.neg(o);e.push([u,l,c]);let d=n.sqr(c),f=n.mul(d,c),p=n.mul(d,t),h=n.add(n.sub(f,n.mul(p,iu)),n.mul(n.sqr(o),i));return{Rx:t=n.mul(c,h),Ry:r=n.sub(n.mul(n.sub(p,h),o),n.mul(f,r)),Rz:i=n.mul(i,f)}}let g=function(e){let t=[];for(;e>ic;e>>=ic)(e&ic)===io?t.unshift(0):(e&il)===il?(t.unshift(-1),e+=ic):t.unshift(1);return t}(e.params.ateLoopSize),y=(0,r7.H9)(t=>{let{x:r,y:i}=t.toAffine(),s=n.neg(i),a=r,o=i,c=n.ONE,u=[];for(let e of g){let t=[];({Rx:a,Ry:o,Rz:c}=function(e,t,r,i){let s=n.sqr(r),a=n.sqr(i),o=n.mulByB(n.mul(a,il)),c=n.mul(o,il),u=n.sub(n.sub(n.sqr(n.add(r,i)),a),s),l=n.sub(o,s),d=n.mul(n.sqr(t),il),f=n.neg(u);return e.push([l,d,f]),{Rx:t=n.mul(n.mul(n.mul(n.sub(s,c),t),r),p),Ry:r=n.sub(n.sqr(n.mul(n.add(s,c),p)),n.mul(n.sqr(o),il)),Rz:i=n.mul(s,u)}}(t,a,o,c)),e&&({Rx:a,Ry:o,Rz:c}=h(t,a,o,c,r,-1===e?s:i)),u.push(t)}if(e.postPrecompute){let t=u[u.length-1];e.postPrecompute(a,o,c,r,i,h.bind(null,t))}return u});function m(e,r=!1){let i=a.ONE;if(e.length){let r=e[0][0].length;for(let n=0;n<r;n++)for(let[r,s,o]of(i=a.sqr(i),e))for(let[e,a,c]of r[n])i=t(e,a,c,i,s,o)}return o&&(i=a.conjugate(i)),r?a.finalExponentiate(i):i}function _(e,t=!0){let r=[];for(let{g1:t,g2:i}of(l.ProjectivePoint.normalizeZ(e.map(({g1:e})=>e)),f.ProjectivePoint.normalizeZ(e.map(({g2:e})=>e)),e)){if(t.equals(l.ProjectivePoint.ZERO)||i.equals(f.ProjectivePoint.ZERO))throw Error("pairing is not available for ZERO point");t.assertValidity(),i.assertValidity();let e=t.toAffine();r.push([y(i),e.x,e.y])}return m(r,t)}let{ShortSignature:w}=e.G1,{Signature:b}=e.G2;function A(e){return e instanceof l.ProjectivePoint?e:l.ProjectivePoint.fromHex(e)}function v(e,t){return e instanceof l.ProjectivePoint?e:l.hashToCurve((0,r7.ql)("point",e),t)}function E(e){return e instanceof f.ProjectivePoint?e:b.fromHex(e)}function S(e,t){return e instanceof f.ProjectivePoint?e:f.hashToCurve((0,r7.ql)("point",e),t)}function z(e){if(!Array.isArray(e)||0===e.length)throw Error("expected non-empty array")}return l.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(e){return l.ProjectivePoint.fromPrivateKey(e).toRawBytes(!0)},getPublicKeyForShortSignatures:function(e){return f.ProjectivePoint.fromPrivateKey(e).toRawBytes(!0)},sign:function(e,t,r){let i=S(e,r);i.assertValidity();let n=i.multiply(l.normPrivateKeyToScalar(t));return e instanceof f.ProjectivePoint?n:b.toRawBytes(n)},signShortSignature:function(e,t,r){let i=v(e,r);i.assertValidity();let n=i.multiply(l.normPrivateKeyToScalar(t));return e instanceof l.ProjectivePoint?n:w.toRawBytes(n)},verify:function(e,t,r,i){let n=A(r),s=S(t,i),o=l.ProjectivePoint.BASE,c=E(e),u=_([{g1:n.negate(),g2:s},{g1:o,g2:c}]);return a.eql(u,a.ONE)},verifyBatch:function(e,t,r,i){if(z(t),r.length!==t.length)throw Error("amount of public keys and messages should be equal");let n=E(e),s=t.map(e=>S(e,i)),o=r.map(A),c=new Map;for(let e=0;e<o.length;e++){let t=o[e],r=s[e],i=c.get(r);void 0===i&&(i=[],c.set(r,i)),i.push(t)}let u=[];try{for(let[e,t]of c){let r=t.reduce((e,t)=>e.add(t));u.push({g1:r,g2:e})}return u.push({g1:l.ProjectivePoint.BASE.negate(),g2:n}),a.eql(_(u),a.ONE)}catch{return!1}},verifyShortSignature:function(e,t,r,i){let n=E(r),s=v(t,i),o=f.ProjectivePoint.BASE,c=_([{g1:s,g2:n},{g1:A(e),g2:o.negate()}]);return a.eql(c,a.ONE)},aggregatePublicKeys:function(e){z(e);let t=e.map(A).reduce((e,t)=>e.add(t),l.ProjectivePoint.ZERO);return e[0]instanceof l.ProjectivePoint?(t.assertValidity(),t):t.toRawBytes(!0)},aggregateSignatures:function(e){z(e);let t=e.map(E).reduce((e,t)=>e.add(t),f.ProjectivePoint.ZERO);return e[0]instanceof f.ProjectivePoint?(t.assertValidity(),t):b.toRawBytes(t)},aggregateShortSignatures:function(e){z(e);let t=e.map(A).reduce((e,t)=>e.add(t),l.ProjectivePoint.ZERO);return e[0]instanceof l.ProjectivePoint?(t.assertValidity(),t):w.toRawBytes(t)},millerLoopBatch:m,pairing:function(e,t,r=!0){return _([{g1:e,g2:t}],r)},pairingBatch:_,G1:l,G2:f,Signature:b,ShortSignature:w,fields:{Fr:i,Fp:r,Fp2:n,Fp6:s,Fp12:a},params:{ateLoopSize:e.params.ateLoopSize,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:{randomPrivateKey:()=>{let t=(0,r9.PS)(i.ORDER);return(0,r9.Us)(e.randomBytes(t),i.ORDER)},calcPairingPrecomputes:y}}}({fields:{Fp:iT,Fp2:ix,Fp6:iC,Fp12:iI,Fr:iS},G1:{Fp:iT,h:BigInt(1),Gx:BigInt(1),Gy:BigInt(2),a:iT.ZERO,b:iw,htfDefaults:{...iN,m:1,DST:"BN254G2_XMD:SHA-256_SVDW_RO_"},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:r7.EQ,fromBytes:r7.EQ,toBytes:r7.EQ,ShortSignature:{fromHex:r7.EQ,toRawBytes:r7.EQ,toHex:r7.EQ}},G2:{Fp:ix,h:BigInt("21888242871839275222246405745257275088844257914179612981679871602714643921549"),Gx:ix.fromBigTuple([BigInt("10857046999023057135944570762232829481370756359578518086990519993285655852781"),BigInt("11559732032986387107991004021392285783925812861821192530917403151452391805634")]),Gy:ix.fromBigTuple([BigInt("8495653923123431417604973247489272438418190587263600148770280649306958101930"),BigInt("4082367875863433681332203403145435568316851327593401208105741076214120093531")]),a:ix.ZERO,b:iz,hEff:BigInt("21888242871839275222246405745257275088844257914179612981679871602714643921549"),htfDefaults:{...iN},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>t.multiplyUnsafe(iE).equals(ik(e,t)),mapToCurve:r7.EQ,fromBytes:r7.EQ,toBytes:r7.EQ,Signature:{fromHex:r7.EQ,toRawBytes:r7.EQ,toHex:r7.EQ}},params:{ateLoopSize:iA*ib+i_,r:iS.ORDER,xNegative:!1,twistType:"divisive"},htfDefaults:iN,hash:r4.JQ,randomBytes:q.O6,postPrecompute:(e,t,r,i,n,s)=>{let a=iP(i,n);({Rx:e,Ry:t,Rz:r}=s(e,t,r,a[0],a[1]));let o=iP(a[0],a[1]);s(e,t,r,o[0],ix.neg(o[1]))}});(0,ia.e4)({a:BigInt(0),b:BigInt(3),Fp:iT,n:BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617"),Gx:BigInt(1),Gy:BigInt(2),h:BigInt(1),...(0,r6.X)(r4.JQ)});var iK=r(13959),iR=class e extends to{constructor(e,t){super(),this.jwkAddress=eh.from(e),this.keylessPublicKey=t}authKey(){let e=new J;return e.serializeU32AsUleb128(4),e.serializeFixedBytes(this.bcsToBytes()),tg.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return oL({...e,publicKey:this}),!0}catch{return!1}}serialize(e){this.jwkAddress.serialize(e),this.keylessPublicKey.serialize(e)}static deserialize(t){return new e(eh.deserialize(t),oD.deserialize(t))}static isPublicKey(t){return t instanceof e}async verifySignatureAsync(e){return oq({...e,publicKey:this})}static create(t){return new e(t.jwkAddress,oD.create(t))}static fromJwtAndPepper(t){return new e(t.jwkAddress,oD.fromJwtAndPepper(t))}static isInstance(e){return"jwkAddress"in e&&e.jwkAddress instanceof eh&&"keylessPublicKey"in e&&e.keylessPublicKey instanceof oD}},i$=class e extends to{constructor(e){if(super(),this.publicKey=e,e instanceof t_)this.variant=0;else if(e instanceof td)this.variant=1;else if(e instanceof oD)this.variant=3;else if(e instanceof iR)this.variant=4;else throw Error("Unsupported public key type")}verifySignature(e){let{message:t,signature:r}=e;if(this.publicKey instanceof oD)throw Error("Use verifySignatureAsync to verify Keyless signatures");return this.publicKey.verifySignature({message:t,signature:r.signature})}async verifySignatureAsync(e){if(!(e.signature instanceof iF)){if(e.options?.throwErrorWithReason)throw Error("Signature must be an instance of AnySignature");return!1}return await this.publicKey.verifySignatureAsync({...e,signature:e.signature.signature})}authKey(){return tg.fromSchemeAndBytes({scheme:2,input:this.toUint8Array()})}toUint8Array(){return this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.publicKey.serialize(e)}static deserialize(t){let r=t.deserializeUleb128AsU32(),i;switch(r){case 0:i=t_.deserialize(t);break;case 1:i=td.deserialize(t);break;case 3:i=oD.deserialize(t);break;case 4:i=iR.deserialize(t);break;default:throw Error(`Unknown variant index for AnyPublicKey: ${r}`)}return new e(i)}static isPublicKey(t){return t instanceof e}isEd25519(){return this.publicKey instanceof t_}isSecp256k1PublicKey(){return this.publicKey instanceof td}static isInstance(e){return"publicKey"in e&&"variant"in e}},iF=class e extends tc{constructor(e){if(super(),this.signature=e,e instanceof tv)this.variant=0;else if(e instanceof th)this.variant=1;else if(e instanceof oM)this.variant=3;else throw Error("Unsupported signature type")}toUint8Array(){return console.warn("[Aptos SDK] Calls to AnySignature.toUint8Array() will soon return the underlying signature bytes. Use AnySignature.bcsToBytes() instead."),this.bcsToBytes()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let r=t.deserializeUleb128AsU32(),i;switch(r){case 0:i=tv.deserialize(t);break;case 1:i=th.deserialize(t);break;case 3:i=oM.deserialize(t);break;default:throw Error(`Unknown variant index for AnySignature: ${r}`)}return new e(i)}static isInstance(e){return"signature"in e&&"object"==typeof e.signature&&null!==e.signature&&"toUint8Array"in e.signature}},iO=class extends to{constructor(e){super(),this.publicKeys=e.publicKeys}createBitmap(e){let{bits:t}=e,r=new Uint8Array([0,0,0,0]),i=new Set;return t.forEach((e,t)=>{if(t+1>this.publicKeys.length)throw Error(`Signature index ${t+1} is out of public keys range, ${this.publicKeys.length}.`);if(i.has(e))throw Error(`Duplicate bit ${e} detected.`);i.add(e);let n=Math.floor(e/8),s=r[n];s|=128>>e%8,r[n]=s}),r}getIndex(e){let t=this.publicKeys.findIndex(t=>t.toString()===e.toString());if(-1!==t)return t;throw Error(`Public key ${e} not found in multi key set ${this.publicKeys}`)}},iD=class e extends iO{constructor(e){let{publicKeys:t,signaturesRequired:r}=e;if(super({publicKeys:t}),r<1)throw Error("The number of required signatures needs to be greater than 0");if(t.length<r)throw Error(`Provided ${t.length} public keys is smaller than the ${r} required signatures`);this.publicKeys=t.map(e=>e instanceof i$?e:new i$(e)),this.signaturesRequired=r}verifySignature(e){let{message:t,signature:r}=e;if(r.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let i=r.bitMapToSignerIndices();for(let e=0;e<r.signatures.length;e+=1){let n=r.signatures[e];if(!this.publicKeys[i[e]].verifySignature({message:t,signature:n}))return!1}return!0}async verifySignatureAsync(e){let{signature:t}=e;try{if(!(t instanceof iL))throw Error("Signature is not a MultiKeySignature");if(t.signatures.length!==this.signaturesRequired)throw Error("The number of signatures does not match the number of required signatures");let r=t.bitMapToSignerIndices();for(let i=0;i<t.signatures.length;i+=1){let n=t.signatures[i];if(!await this.publicKeys[r[i]].verifySignatureAsync({...e,signature:n}))return!1}return!0}catch(t){if(e.options?.throwErrorWithReason)throw t;return!1}}authKey(){return tg.fromSchemeAndBytes({scheme:3,input:this.toUint8Array()})}serialize(e){e.serializeVector(this.publicKeys),e.serializeU8(this.signaturesRequired)}static deserialize(t){return new e({publicKeys:t.deserializeVector(i$),signaturesRequired:t.deserializeU8()})}getIndex(e){let t=e instanceof i$?e:new i$(e);return super.getIndex(t)}static isInstance(e){return"publicKeys"in e&&"signaturesRequired"in e}},iq=class e extends tc{constructor(t){super();let{signatures:r,bitmap:i}=t;if(r.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=r.map(e=>e instanceof iF?e:new iF(e)),i instanceof Uint8Array){if(i.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=i}else this.bitmap=e.createBitmap({bits:i});let n=this.bitmap.reduce((e,t)=>{let r;return e+(r=t,r-=r>>1&1431655765,((r=(858993459&r)+(r>>2&858993459))+(r>>4)&252645135)*16843009>>24)},0);if(n!==this.signatures.length)throw Error(`Expecting ${n} signatures from the bitmap, but got ${this.signatures.length}`)}static createBitmap(t){let{bits:r}=t,i=new Uint8Array([0,0,0,0]),n=new Set;return r.forEach(t=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");n.add(t);let r=Math.floor(t/8),s=i[r];s|=128>>t%8,i[r]=s}),i}bitMapToSignerIndices(){let e=[];for(let t=0;t<this.bitmap.length;t+=1){let r=this.bitmap[t];for(let i=0;i<8;i+=1)r&128>>i&&e.push(8*t+i)}return e}serialize(e){e.serializeVector(this.signatures),e.serializeBytes(this.bitmap)}static deserialize(t){return new e({signatures:t.deserializeVector(iF),bitmap:t.deserializeBytes()})}};iq.BITMAP_LEN=4,iq.MAX_SIGNATURES_SUPPORTED=8*iq.BITMAP_LEN;var iL=iq,iV=class e extends iO{constructor(t){let{publicKeys:r,threshold:i}=t;if(super({publicKeys:r}),r.length>e.MAX_KEYS||r.length<e.MIN_KEYS)throw Error(`Must have between ${e.MIN_KEYS} and ${e.MAX_KEYS} public keys, inclusive`);if(i<e.MIN_THRESHOLD||i>r.length)throw Error(`Threshold must be between ${e.MIN_THRESHOLD} and ${r.length}, inclusive`);this.publicKeys=r,this.threshold=i}verifySignature(e){let{message:t,signature:r}=e;if(!(r instanceof iM))return!1;let i=[];for(let e=0;e<4;e+=1)for(let t=0;t<8;t+=1)if((r.bitmap[e]&1<<7-t)!=0){let r=8*e+t;i.push(r)}if(i.length!==r.signatures.length)throw Error("Bitmap and signatures length mismatch");if(i.length<this.threshold)throw Error("Not enough signatures");for(let e=0;e<i.length;e+=1)if(!this.publicKeys[i[e]].verifySignature({message:t,signature:r.signatures[e]}))return!1;return!0}async verifySignatureAsync(e){return this.verifySignature(e)}authKey(){return tg.fromSchemeAndBytes({scheme:1,input:this.toUint8Array()})}toUint8Array(){let e=new Uint8Array(this.publicKeys.length*t_.LENGTH+1);return this.publicKeys.forEach((t,r)=>{e.set(t.toUint8Array(),r*t_.LENGTH)}),e[this.publicKeys.length*t_.LENGTH]=this.threshold,e}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let r=t.deserializeBytes(),i=r[r.length-1],n=[];for(let e=0;e<r.length-1;e+=t_.LENGTH){let t=e;n.push(new t_(r.subarray(t,t+t_.LENGTH)))}return new e({publicKeys:n,threshold:i})}getIndex(e){return super.getIndex(e)}};iV.MAX_KEYS=32,iV.MIN_KEYS=2,iV.MIN_THRESHOLD=1;var iH=class e extends tc{constructor(t){super();let{signatures:r,bitmap:i}=t;if(r.length>e.MAX_SIGNATURES_SUPPORTED)throw Error(`The number of signatures cannot be greater than ${e.MAX_SIGNATURES_SUPPORTED}`);if(this.signatures=r,i instanceof Uint8Array){if(i.length!==e.BITMAP_LEN)throw Error(`"bitmap" length should be ${e.BITMAP_LEN}`);this.bitmap=i}else this.bitmap=e.createBitmap({bits:i})}toUint8Array(){let t=new Uint8Array(this.signatures.length*tv.LENGTH+e.BITMAP_LEN);return this.signatures.forEach((e,r)=>{t.set(e.toUint8Array(),r*tv.LENGTH)}),t.set(this.bitmap,this.signatures.length*tv.LENGTH),t}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(t){let r=t.deserializeBytes(),i=r.subarray(r.length-4),n=[];for(let e=0;e<r.length-i.length;e+=tv.LENGTH){let t=e;n.push(new tv(r.subarray(t,t+tv.LENGTH)))}return new e({signatures:n,bitmap:i})}static createBitmap(t){let{bits:r}=t,i=new Uint8Array([0,0,0,0]),n=new Set;return r.forEach((t,s)=>{if(t>=e.MAX_SIGNATURES_SUPPORTED)throw Error(`Cannot have a signature larger than ${e.MAX_SIGNATURES_SUPPORTED-1}.`);if(n.has(t))throw Error("Duplicate bits detected.");if(s>0&&t<=r[s-1])throw Error("The bits need to be sorted in ascending order.");n.add(t);let a=Math.floor(t/8),o=i[a];o|=128>>t%8,i[a]=o}),i}};iH.MAX_SIGNATURES_SUPPORTED=32,iH.BITMAP_LEN=4;var iM=iH,ij=class extends W{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return iG.load(e);case 1:return iW.load(e);case 2:return iJ.load(e);case 3:return iY.load(e);case 4:return iZ.load(e);case 5:return iX.load(e);default:throw Error(`Unknown variant index for AccountAuthenticator: ${t}`)}}isEd25519(){return this instanceof iG}isMultiEd25519(){return this instanceof iW}isSingleKey(){return this instanceof iJ}isMultiKey(){return this instanceof iY}},iG=class e extends ij{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(t_.deserialize(t),tv.deserialize(t))}},iW=class e extends ij{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(iV.deserialize(t),iM.deserialize(t))}},iJ=class e extends ij{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(2),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(i$.deserialize(t),iF.deserialize(t))}},iY=class e extends ij{constructor(e,t){super(),this.public_keys=e,this.signatures=t}serialize(e){e.serializeU32AsUleb128(3),this.public_keys.serialize(e),this.signatures.serialize(e)}static load(t){return new e(iD.deserialize(t),iL.deserialize(t))}},iZ=class e extends ij{serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},iX=class e extends ij{constructor(e,t,r,i){if(super(),!eI(e))throw Error(`Invalid function info ${e} passed into AccountAuthenticatorAbstraction`);this.functionInfo=e,this.authenticator=r,this.signingMessageDigest=V.fromHexInput(V.fromHexInput(t).toUint8Array()),this.accountIdentity=i}serialize(e){e.serializeU32AsUleb128(5);let{moduleAddress:t,moduleName:r,functionName:i}=eU(this.functionInfo);eh.fromString(t).serialize(e),e.serializeStr(r),e.serializeStr(i),this.accountIdentity?e.serializeU32AsUleb128(1):e.serializeU32AsUleb128(0),e.serializeBytes(this.signingMessageDigest.toUint8Array()),this.accountIdentity?e.serializeBytes(this.authenticator):e.serializeFixedBytes(this.authenticator),this.accountIdentity&&e.serializeBytes(this.accountIdentity)}static load(t){let r=eh.deserialize(t),i=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeUleb128AsU32();if(0===s)return new e(`${r}::${i}::${n}`,t.deserializeBytes(),t.deserializeFixedBytes(t.remaining()));if(1===s)return new e(`${r}::${i}::${n}`,t.deserializeBytes(),t.deserializeBytes(),t.deserializeBytes());throw Error(`Unknown variant index for AccountAuthenticatorAbstraction: ${s}`)}},iQ=class e extends W{constructor(e,t){super(),this.address=e,this.name=t}static fromStr(t){let r=t.split("::");if(2!==r.length)throw Error("Invalid module id.");return new e(eh.fromString(r[0]),new eW(r[1]))}serialize(e){this.address.serialize(e),this.name.serialize(e)}static deserialize(t){return new e(eh.deserialize(t),eW.deserialize(t))}},i0=class e extends W{deserialize(t){return new nn(eh.deserialize(t),eW.deserialize(t),eW.deserialize(t),t.deserializeVector(e))}static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return i1.load(e);case 1:return i2.load(e);case 2:return i5.load(e);case 3:return i4.load(e);case 4:return i9.load(e);case 5:return i7.load(e);case 6:return nr.load(e);case 7:return ni.load(e);case 8:return i8.load(e);case 9:return i3.load(e);case 10:return i6.load(e);case 255:return nt.load(e);default:throw Error(`Unknown variant index for TypeTag: ${t}`)}}isBool(){return this instanceof i1}isAddress(){return this instanceof i9}isGeneric(){return this instanceof nt}isSigner(){return this instanceof i7}isVector(){return this instanceof nr}isStruct(){return this instanceof ni}isU8(){return this instanceof i2}isU16(){return this instanceof i8}isU32(){return this instanceof i3}isU64(){return this instanceof i5}isU128(){return this instanceof i4}isU256(){return this instanceof i6}isPrimitive(){return this instanceof i7||this instanceof i9||this instanceof i1||this instanceof i2||this instanceof i8||this instanceof i3||this instanceof i5||this instanceof i4||this instanceof i6}},i1=class e extends i0{toString(){return"bool"}serialize(e){e.serializeU32AsUleb128(0)}static load(t){return new e}},i2=class e extends i0{toString(){return"u8"}serialize(e){e.serializeU32AsUleb128(1)}static load(t){return new e}},i8=class e extends i0{toString(){return"u16"}serialize(e){e.serializeU32AsUleb128(8)}static load(t){return new e}},i3=class e extends i0{toString(){return"u32"}serialize(e){e.serializeU32AsUleb128(9)}static load(t){return new e}},i5=class e extends i0{toString(){return"u64"}serialize(e){e.serializeU32AsUleb128(2)}static load(t){return new e}},i4=class e extends i0{toString(){return"u128"}serialize(e){e.serializeU32AsUleb128(3)}static load(t){return new e}},i6=class e extends i0{toString(){return"u256"}serialize(e){e.serializeU32AsUleb128(10)}static load(t){return new e}},i9=class e extends i0{toString(){return"address"}serialize(e){e.serializeU32AsUleb128(4)}static load(t){return new e}},i7=class e extends i0{toString(){return"signer"}serialize(e){e.serializeU32AsUleb128(5)}static load(t){return new e}},ne=class e extends i0{constructor(e){super(),this.value=e}toString(){return`&${this.value.toString()}`}serialize(e){e.serializeU32AsUleb128(254)}static load(t){return new e(i0.deserialize(t))}},nt=class e extends i0{constructor(e){if(super(),this.value=e,e<0)throw Error("Generic type parameter index cannot be negative")}toString(){return`T${this.value}`}serialize(e){e.serializeU32AsUleb128(255),e.serializeU32(this.value)}static load(t){return new e(t.deserializeU32())}},nr=class e extends i0{constructor(e){super(),this.value=e}toString(){return`vector<${this.value.toString()}>`}static u8(){return new e(new i2)}serialize(e){e.serializeU32AsUleb128(6),this.value.serialize(e)}static load(t){return new e(i0.deserialize(t))}},ni=class e extends i0{constructor(e){super(),this.value=e}toString(){let e="";return this.value.typeArgs.length>0&&(e=`<${this.value.typeArgs.map(e=>e.toString()).join(", ")}>`),`${this.value.address.toString()}::${this.value.moduleName.identifier}::${this.value.name.identifier}${e}`}serialize(e){e.serializeU32AsUleb128(7),this.value.serialize(e)}static load(t){return new e(nn.deserialize(t))}isTypeTag(e,t,r){return this.value.moduleName.identifier===t&&this.value.name.identifier===r&&this.value.address.equals(e)}isString(){return this.isTypeTag(eh.ONE,"string","String")}isOption(){return this.isTypeTag(eh.ONE,"option","Option")}isObject(){return this.isTypeTag(eh.ONE,"object","Object")}isDelegationKey(){return this.isTypeTag(eh.ONE,"permissioned_delegation","DelegationKey")}isRateLimiter(){return this.isTypeTag(eh.ONE,"rate_limiter","RateLimiter")}},nn=class e extends W{constructor(e,t,r,i){super(),this.address=e,this.moduleName=t,this.name=r,this.typeArgs=i}serialize(e){e.serialize(this.address),e.serialize(this.moduleName),e.serialize(this.name),e.serializeVector(this.typeArgs)}static deserialize(t){return new e(eh.deserialize(t),eW.deserialize(t),eW.deserialize(t),t.deserializeVector(i0))}};function ns(){return new nn(eh.ONE,new eW("string"),new eW("String"),[])}function na(e){return new nn(eh.ONE,new eW("object"),new eW("Object"),[e])}var no=class extends W{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return nc.load(e);case 2:return nu.load(e);case 3:return nl.load(e);default:throw Error(`Unknown variant index for TransactionPayload: ${t}`)}}},nc=class e extends no{constructor(e){super(),this.script=e}serialize(e){e.serializeU32AsUleb128(0),this.script.serialize(e)}static load(t){return new e(nf.deserialize(t))}},nu=class e extends no{constructor(e){super(),this.entryFunction=e}serialize(e){e.serializeU32AsUleb128(2),this.entryFunction.serialize(e)}static load(t){return new e(nd.deserialize(t))}},nl=class e extends no{constructor(e){super(),this.multiSig=e}serialize(e){e.serializeU32AsUleb128(3),this.multiSig.serialize(e)}static load(t){return new e(np.deserialize(t))}},nd=class e{constructor(e,t,r,i){this.module_name=e,this.function_name=t,this.type_args=r,this.args=i}static build(t,r,i,n){return new e(iQ.fromStr(t),new eW(r),i,n)}serialize(e){this.module_name.serialize(e),this.function_name.serialize(e),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForEntryFunction(e)})}static deserialize(t){let r=iQ.deserialize(t),i=eW.deserialize(t),n=t.deserializeVector(i0),s=t.deserializeUleb128AsU32(),a=[];for(let e=0;e<s;e+=1){let e=t.deserializeUleb128AsU32(),r=rx.deserialize(t,e);a.push(r)}return new e(r,i,n,a)}},nf=class e{constructor(e,t,r){this.bytecode=e,this.type_args=t,this.args=r}serialize(e){e.serializeBytes(this.bytecode),e.serializeVector(this.type_args),e.serializeU32AsUleb128(this.args.length),this.args.forEach(t=>{t.serializeForScriptFunction(e)})}static deserialize(t){let r=t.deserializeBytes(),i=t.deserializeVector(i0),n=t.deserializeUleb128AsU32(),s=[];for(let e=0;e<n;e+=1){let e=function(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return et.deserialize(e);case 1:return en.deserialize(e);case 2:return es.deserialize(e);case 3:return eh.deserialize(e);case 4:return ec.deserialize(e,et);case 5:return ee.deserialize(e);case 6:return er.deserialize(e);case 7:return ei.deserialize(e);case 8:return ea.deserialize(e);case 9:return eu.deserialize(e);default:throw Error(`Unknown variant index for ScriptTransactionArgument: ${t}`)}}(t);s.push(e)}return new e(r,i,s)}},np=class e{constructor(e,t){this.multisig_address=e,this.transaction_payload=t}serialize(e){this.multisig_address.serialize(e),void 0===this.transaction_payload?e.serializeBool(!1):(e.serializeBool(!0),this.transaction_payload.serialize(e))}static deserialize(t){let r=eh.deserialize(t),i;return t.deserializeBool()&&(i=nh.deserialize(t)),new e(r,i)}},nh=class e extends W{constructor(e){super(),this.transaction_payload=e}serialize(e){e.serializeU32AsUleb128(0),this.transaction_payload.serialize(e)}static deserialize(t){return t.deserializeUleb128AsU32(),new e(nd.deserialize(t))}},ng=class e extends W{constructor(e,t,r,i,n,s,a){super(),this.sender=e,this.sequence_number=t,this.payload=r,this.max_gas_amount=i,this.gas_unit_price=n,this.expiration_timestamp_secs=s,this.chain_id=a}serialize(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)}static deserialize(t){return new e(eh.deserialize(t),t.deserializeU64(),no.deserialize(t),t.deserializeU64(),t.deserializeU64(),t.deserializeU64(),eG.deserialize(t))}},ny=class extends W{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return nm.load(e);case 1:return n_.load(e);default:throw Error(`Unknown variant index for RawTransactionWithData: ${t}`)}}},nm=class e extends ny{constructor(e,t){super(),this.raw_txn=e,this.secondary_signer_addresses=t}serialize(e){e.serializeU32AsUleb128(0),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses)}static load(t){return new e(ng.deserialize(t),t.deserializeVector(eh))}},n_=class e extends ny{constructor(e,t,r){super(),this.raw_txn=e,this.secondary_signer_addresses=t,this.fee_payer_address=r}serialize(e){e.serializeU32AsUleb128(1),this.raw_txn.serialize(e),e.serializeVector(this.secondary_signer_addresses),this.fee_payer_address.serialize(e)}static load(t){return new e(ng.deserialize(t),t.deserializeVector(eh),eh.deserialize(t))}},nw=class extends W{static deserialize(e){let t=e.deserializeUleb128AsU32();switch(t){case 0:return nb.load(e);case 1:return nA.load(e);case 2:return nv.load(e);case 3:return nE.load(e);case 4:return nS.load(e);default:throw Error(`Unknown variant index for TransactionAuthenticator: ${t}`)}}isEd25519(){return this instanceof nb}isMultiEd25519(){return this instanceof nA}isMultiAgent(){return this instanceof nv}isFeePayer(){return this instanceof nE}isSingleSender(){return this instanceof nS}},nb=class e extends nw{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(0),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(t_.deserialize(t),tv.deserialize(t))}},nA=class e extends nw{constructor(e,t){super(),this.public_key=e,this.signature=t}serialize(e){e.serializeU32AsUleb128(1),this.public_key.serialize(e),this.signature.serialize(e)}static load(t){return new e(iV.deserialize(t),iM.deserialize(t))}},nv=class e extends nw{constructor(e,t,r){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=r}serialize(e){e.serializeU32AsUleb128(2),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers)}static load(t){return new e(ij.deserialize(t),t.deserializeVector(eh),t.deserializeVector(ij))}},nE=class e extends nw{constructor(e,t,r,i){super(),this.sender=e,this.secondary_signer_addresses=t,this.secondary_signers=r,this.fee_payer=i}serialize(e){e.serializeU32AsUleb128(3),this.sender.serialize(e),e.serializeVector(this.secondary_signer_addresses),e.serializeVector(this.secondary_signers),this.fee_payer.address.serialize(e),this.fee_payer.authenticator.serialize(e)}static load(t){return new e(ij.deserialize(t),t.deserializeVector(eh),t.deserializeVector(ij),{address:eh.deserialize(t),authenticator:ij.deserialize(t)})}},nS=class e extends nw{constructor(e){super(),this.sender=e}serialize(e){e.serializeU32AsUleb128(4),this.sender.serialize(e)}static load(t){return new e(ij.deserialize(t))}},nz=class e extends W{constructor(e,t){super(),this.raw_txn=e,this.authenticator=t}serialize(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)}static deserialize(t){return new e(ng.deserialize(t),nw.deserialize(t))}},nT=class e extends W{constructor(e,t){super(),this.rawTransaction=e,this.feePayerAddress=t}serialize(e){this.rawTransaction.serialize(e),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let r=ng.deserialize(t),i;return t.deserializeBool()&&(i=eh.deserialize(t)),new e(r,i)}},nx=class e extends W{constructor(e,t,r){super(),this.rawTransaction=e,this.feePayerAddress=r,this.secondarySignerAddresses=t}serialize(e){this.rawTransaction.serialize(e),e.serializeVector(this.secondarySignerAddresses),void 0===this.feePayerAddress?e.serializeBool(!1):(e.serializeBool(!0),this.feePayerAddress.serialize(e))}static deserialize(t){let r=ng.deserialize(t),i=t.deserializeVector(eh),n;return t.deserializeBool()&&(n=eh.deserialize(t)),new e(r,i,n)}};function nC(e){return e.feePayerAddress?new n_(e.rawTransaction,e.secondarySignerAddresses??[],e.feePayerAddress):e.secondarySignerAddresses?new nm(e.rawTransaction,e.secondarySignerAddresses):e.rawTransaction}function nU(e,t){let r=e_.DZ.create();if(!t.startsWith("APTOS::"))throw Error(`Domain separator needs to start with 'APTOS::'.  Provided - ${t}`);r.update(t);let i=r.digest(),n=new Uint8Array(i.length+e.length);return n.set(i),n.set(e,i.length),n}function nI(e){let t=nC(e);return e.feePayerAddress?nU(t.bcsToBytes(),rc):e.secondarySignerAddresses?nU(t.bcsToBytes(),rc):nU(t.bcsToBytes(),"APTOS::RawTransaction")}var nk=class e{constructor(e){this.signingScheme=0;let{privateKey:t,address:r}=e;this.privateKey=t,this.publicKey=t.publicKey(),this.accountAddress=r?eh.from(r):this.publicKey.authKey().derivedAddress()}static generate(){return new e({privateKey:tb.generate()})}static fromDerivationPath(t){let{path:r,mnemonic:i}=t;return new e({privateKey:tb.fromDerivationPath(r,i)})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new iG(this.publicKey,this.privateKey.sign(e))}signTransactionWithAuthenticator(e){return new iG(this.publicKey,this.signTransaction(e))}sign(e){return this.privateKey.sign(e)}signTransaction(e){return this.sign(nI(e))}};function nP(e){return"object"==typeof e&&null!==e&&"getAnyPublicKey"in e&&"function"==typeof e.getAnyPublicKey}var nN=class e{constructor(e){this.signingScheme=2;let{privateKey:t,address:r}=e;this.privateKey=t,this.publicKey=new i$(t.publicKey()),this.accountAddress=r?eh.from(r):this.publicKey.authKey().derivedAddress()}getAnyPublicKey(){return this.publicKey}static generate(t={}){let{scheme:r=0}=t,i;switch(r){case 0:i=tb.generate();break;case 2:i=tf.generate();break;default:throw Error(`Unsupported signature scheme ${r}`)}return new e({privateKey:i})}static fromDerivationPath(t){let{scheme:r=0,path:i,mnemonic:n}=t,s;switch(r){case 0:s=tb.fromDerivationPath(i,n);break;case 2:s=tf.fromDerivationPath(i,n);break;default:throw Error(`Unsupported signature scheme ${r}`)}return new e({privateKey:s})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new iJ(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new iJ(this.publicKey,this.signTransaction(e))}sign(e){return new iF(this.privateKey.sign(e))}signTransaction(e){return this.sign(nI(e))}static fromEd25519Account(t){return new e({privateKey:t.privateKey,address:t.accountAddress})}},nB=class{static generate(e={}){let{scheme:t=0,legacy:r=!0}=e;return 0===t&&r?nk.generate():nN.generate({scheme:t})}static fromPrivateKey(e){let{privateKey:t,address:r,legacy:i=!0}=e;return t instanceof tb&&i?new nk({privateKey:t,address:r}):new nN({privateKey:t,address:r})}static fromPrivateKeyAndAddress(e){return this.fromPrivateKey(e)}static fromDerivationPath(e){let{scheme:t=0,mnemonic:r,path:i,legacy:n=!0}=e;return 0===t&&n?nk.fromDerivationPath({mnemonic:r,path:i}):nN.fromDerivationPath({scheme:t,mnemonic:r,path:i})}static authKey(e){let{publicKey:t}=e;return t.authKey()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync(e)}},nK=class e extends W{constructor(e){let t;super();let{privateKey:r,expiryDateSecs:i,blinder:n}=e;this.privateKey=r,this.publicKey=new tE(r.publicKey()),this.expiryDateSecs=i||((t=new Date(1e3*(ez()+1209600))).setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),Math.floor(t.getTime()/1e3)),this.blinder=void 0!==n?V.fromHexInput(n).toUint8Array():(0,q.O6)(nK.BLINDER_LENGTH);let s=eX(this.publicKey.bcsToBytes(),93);s.push(BigInt(this.expiryDateSecs)),s.push(eQ(this.blinder));let a=e1(s);this.nonce=a.toString()}getPublicKey(){return this.publicKey}isExpired(){return Math.floor(Date.now()/1e3)>this.expiryDateSecs}serialize(e){e.serializeU32AsUleb128(this.publicKey.variant),e.serializeBytes(this.privateKey.toUint8Array()),e.serializeU64(this.expiryDateSecs),e.serializeFixedBytes(this.blinder)}static deserialize(t){let r=t.deserializeUleb128AsU32(),i;if(0===r)i=tb.deserialize(t);else throw Error(`Unknown variant index for EphemeralPublicKey: ${r}`);let n=t.deserializeU64(),s=t.deserializeFixedBytes(31);return new e({privateKey:i,expiryDateSecs:Number(n),blinder:s})}static fromBytes(t){return e.deserialize(new eo(t))}static generate(t){return t?.scheme,new e({privateKey:tb.generate(),expiryDateSecs:t?.expiryDateSecs})}sign(e){if(this.isExpired())throw Error("EphemeralKeyPair has expired");return new tS(this.privateKey.sign(e))}};function nR(e){return null!=e&&"function"==typeof e.checkKeylessAccountValidity}nK.BLINDER_LENGTH=31;var n$=class e extends W{constructor(t){super(),this.signingScheme=2;let{address:r,ephemeralKeyPair:i,publicKey:n,uidKey:s,uidVal:a,aud:o,pepper:c,proof:u,proofFetchCallback:l,jwt:d,verificationKeyHash:f}=t;if(this.ephemeralKeyPair=i,this.publicKey=n,this.accountAddress=r?eh.from(r):this.publicKey.authKey().derivedAddress(),this.uidKey=s,this.uidVal=a,this.aud=o,this.jwt=d,this.emitter=new iK.Z,this.proofOrPromise=u,u instanceof oQ)this.proof=u;else{if(void 0===l)throw Error("Must provide callback for async proof fetch");this.emitter.on("proofFetchFinish",async e=>{await l(e),this.emitter.removeAllListeners()}),this.init(u)}let p=V.fromHexInput(c).toUint8Array();if(p.length!==e.PEPPER_LENGTH)throw Error(`Pepper length in bytes should be ${e.PEPPER_LENGTH}`);if(this.pepper=p,void 0!==f){if(32!==V.hexInputToUint8Array(f).length)throw Error("verificationKeyHash must be 32 bytes");this.verificationKeyHash=V.hexInputToUint8Array(f)}}getAnyPublicKey(){return new i$(this.publicKey)}async init(e){try{this.proof=await e,this.emitter.emit("proofFetchFinish",{status:"Success"})}catch(e){e instanceof Error?this.emitter.emit("proofFetchFinish",{status:"Failed",error:e.toString()}):this.emitter.emit("proofFetchFinish",{status:"Failed",error:"Unknown"})}}serialize(e){if(this.accountAddress.serialize(e),e.serializeStr(this.jwt),e.serializeStr(this.uidKey),e.serializeFixedBytes(this.pepper),this.ephemeralKeyPair.serialize(e),void 0===this.proof)throw Error("Cannot serialize - proof undefined");this.proof.serialize(e),e.serializeOption(this.verificationKeyHash,32)}static partialDeserialize(e){return{address:eh.deserialize(e),jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:nK.deserialize(e),proof:oQ.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}isExpired(){return this.ephemeralKeyPair.isExpired()}signWithAuthenticator(e){let t=new iF(this.sign(e));return new iJ(new i$(this.publicKey),t)}signTransactionWithAuthenticator(e){let t=new iF(this.signTransaction(e));return new iJ(new i$(this.publicKey),t)}async waitForProofFetch(){this.proofOrPromise instanceof Promise&&await this.proofOrPromise}async checkKeylessAccountValidity(t){if(this.isExpired())throw eK.fromErrorType({type:0});if(await this.waitForProofFetch(),void 0===this.proof)throw eK.fromErrorType({type:2});let r=(0,r5.o)(this.jwt,{header:!0});if(void 0===r.kid)throw eK.fromErrorType({type:12,details:"checkKeylessAccountValidity failed. JWT is missing 'kid' in header. This should never happen."});if(void 0!==this.verificationKeyHash){let{verificationKey:e}=await o2({aptosConfig:t});if(V.hexInputToString(e.hash())!==V.hexInputToString(this.verificationKeyHash))throw eK.fromErrorType({type:4})}else console.warn("[Aptos SDK] The verification key hash was not set. Proof may be invalid if the verification key has rotated.");await e.fetchJWK({aptosConfig:t,publicKey:this.publicKey,kid:r.kid})}sign(e){let t,r,{expiryDateSecs:i}=this.ephemeralKeyPair;if(this.isExpired())throw eK.fromErrorType({type:0});if(void 0===this.proof)throw eK.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let n=this.ephemeralKeyPair.getPublicKey(),s=this.ephemeralKeyPair.sign(e);return new oM({jwtHeader:(r=(t=this.jwt.split(".")[0].replace(/-/g,"+").replace(/_/g,"/"))+"==".substring(0,(3-t.length%3)%3),(0,eA.Jx)(r)),ephemeralCertificate:new oj(this.proof,0),expiryDateSecs:i,ephemeralPublicKey:n,ephemeralSignature:s})}signTransaction(e){if(void 0===this.proof)throw eK.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});let t=new nO(nC(e),this.proof.proof).hash();return this.sign(t)}getSigningMessage(e){if(void 0===this.proof)throw eK.fromErrorType({type:1,details:"Proof not found - make sure to call `await account.checkKeylessAccountValidity()` before signing."});return new nO(nC(e),this.proof.proof).hash()}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e})}static async fetchJWK(e){return oV(e)}};n$.PEPPER_LENGTH=31;var nF=n$,nO=class extends W{constructor(e,t){super(),this.domainSeparator="APTOS::TransactionAndProof",this.transaction=e,this.proof=t}serialize(e){e.serializeFixedBytes(this.transaction.bcsToBytes()),e.serializeOption(this.proof)}hash(){return nU(this.bcsToBytes(),this.domainSeparator)}},nD=class e extends nF{constructor(e){let t=oD.create(e);super({publicKey:t,...e}),this.publicKey=t}serialize(e){super.serialize(e)}static deserialize(t){let{address:r,proof:i,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=nF.partialDeserialize(t),{iss:u,aud:l,uidVal:d}=o8({jwt:s,uidKey:a});return new e({address:r,proof:i,ephemeralKeyPair:n,iss:u,uidKey:a,uidVal:d,aud:l,pepper:o,jwt:s,verificationKeyHash:c})}static fromBytes(t){return e.deserialize(new eo(V.hexInputToUint8Array(t)))}static create(t){let{address:r,proof:i,jwt:n,ephemeralKeyPair:s,pepper:a,uidKey:o="sub",proofFetchCallback:c,verificationKey:u}=t,{iss:l,aud:d,uidVal:f}=o8({jwt:n,uidKey:o});return new e({address:r,proof:i,ephemeralKeyPair:s,iss:l,uidKey:o,uidVal:f,aud:d,pepper:a,jwt:n,proofFetchCallback:c,verificationKeyHash:u?u.hash():void 0})}},nq=class e extends nF{constructor(e){let t=iR.create(e);super({publicKey:t,...e}),this.publicKey=t,this.audless=e.audless??!1}serialize(e){super.serialize(e),this.publicKey.jwkAddress.serialize(e)}static deserialize(t){let{address:r,proof:i,ephemeralKeyPair:n,jwt:s,uidKey:a,pepper:o,verificationKeyHash:c}=nF.partialDeserialize(t),u=eh.deserialize(t),{iss:l,aud:d,uidVal:f}=o8({jwt:s,uidKey:a});return new e({address:r,proof:i,ephemeralKeyPair:n,iss:l,uidKey:a,uidVal:f,aud:d,pepper:o,jwt:s,verificationKeyHash:c,jwkAddress:u})}static fromBytes(t){return e.deserialize(eo.fromHex(t))}static create(t){let{address:r,proof:i,jwt:n,ephemeralKeyPair:s,pepper:a,jwkAddress:o,uidKey:c="sub",proofFetchCallback:u,verificationKey:l}=t,{iss:d,aud:f,uidVal:p}=o8({jwt:n,uidKey:c});return new e({address:r,proof:i,ephemeralKeyPair:s,iss:d,uidKey:c,uidVal:p,aud:f,pepper:a,jwkAddress:eh.from(o),jwt:n,proofFetchCallback:u,verificationKeyHash:l?l.hash():void 0})}},nL=class e{constructor(e){this.signingScheme=3;let{multiKey:t,address:r}=e,i=e.signers.map(e=>e instanceof nk?nN.fromEd25519Account(e):e);if(t.signaturesRequired>i.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${t.signaturesRequired} signers, but only ${i.length} provided`);if(t.signaturesRequired<i.length)throw Error(`More signers provided than required. Need ${t.signaturesRequired} signers, but ${i.length} provided`);this.publicKey=t,this.accountAddress=r?eh.from(r):this.publicKey.authKey().derivedAddress();let n=[];for(let e of i)n.push(this.publicKey.getIndex(e.getAnyPublicKey()));let s=i.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndicies=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}static fromPublicKeysAndSigners(t){let{address:r,publicKeys:i,signaturesRequired:n,signers:s}=t;return new e({multiKey:new iD({publicKeys:i,signaturesRequired:n}),signers:s,address:r})}static isMultiKeySigner(t){return t instanceof e}signWithAuthenticator(e){return new iY(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new iY(this.publicKey,this.signTransaction(e))}async waitForProofFetch(){let e=this.signers.filter(e=>e instanceof nF).map(async e=>e.waitForProofFetch());await Promise.all(e)}async checkKeylessAccountValidity(e){let t=this.signers.filter(e=>e instanceof nF).map(t=>t.checkKeylessAccountValidity(e));await Promise.all(t)}sign(e){let t=[];for(let r of this.signers)t.push(r.sign(e));return new iL({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){let t=[];for(let r of this.signers)t.push(r.signTransaction(e));return new iL({signatures:t,bitmap:this.signaturesBitmap})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return await this.publicKey.verifySignatureAsync(e)}},nV=class{constructor(e){this.signingScheme=1;let{signers:t,publicKey:r,address:i}=e;if(this.publicKey=r,this.accountAddress=i?eh.from(i):this.publicKey.authKey().derivedAddress(),r.threshold>t.length)throw Error(`Not enough signers provided to satisfy the required signatures. Need ${r.threshold} signers, but only ${t.length} provided`);if(r.threshold<t.length)throw Error(`More signers provided than required. Need ${r.threshold} signers, but ${t.length} provided`);let n=[];for(let e of t)n.push(this.publicKey.getIndex(e.publicKey()));let s=t.map((e,t)=>[e,n[t]]);s.sort((e,t)=>e[1]-t[1]),this.signers=s.map(e=>e[0]),this.signerIndices=s.map(e=>e[1]),this.signaturesBitmap=this.publicKey.createBitmap({bits:n})}verifySignature(e){return this.publicKey.verifySignature(e)}async verifySignatureAsync(e){return this.publicKey.verifySignatureAsync({...e,signature:e.signature})}signWithAuthenticator(e){return new iW(this.publicKey,this.sign(e))}signTransactionWithAuthenticator(e){return new iW(this.publicKey,this.signTransaction(e))}sign(e){let t=[];for(let r of this.signers)t.push(r.sign(e));return new iM({signatures:t,bitmap:this.signaturesBitmap})}signTransaction(e){return this.sign(nI(e))}};function nH(e,t){if(t.serializeStr(e.jwt),t.serializeStr(e.uidKey),t.serializeFixedBytes(e.pepper),e.ephemeralKeyPair.serialize(t),void 0===e.proof)throw Error("Cannot serialize - proof undefined");e.proof.serialize(t),t.serializeOption(e.verificationKeyHash,32)}function nM(e){return{jwt:e.deserializeStr(),uidKey:e.deserializeStr(),pepper:e.deserializeFixedBytes(31),ephemeralKeyPair:nK.deserialize(e),proof:oQ.deserialize(e),verificationKeyHash:e.deserializeOption("fixedBytes",32)}}(e=>{function t(e){let r=new J;switch(r.serializeU32AsUleb128(e.signingScheme),e.accountAddress.serialize(r),e.signingScheme){case 0:return e.privateKey.serialize(r),r.toUint8Array();case 2:{if(!nP(e))throw Error("Account is not a SingleKeySigner");let t=e.getAnyPublicKey();switch(r.serializeU32AsUleb128(t.variant),t.variant){case 3:return nH(e,r),r.toUint8Array();case 4:return nH(e,r),e.publicKey.jwkAddress.serialize(r),r.serializeBool(e.audless),r.toUint8Array();case 1:case 0:return e.privateKey.serialize(r),r.toUint8Array();default:throw Error(`Invalid public key variant: ${t.variant}`)}}case 3:return e.publicKey.serialize(r),r.serializeU32AsUleb128(e.signers.length),e.signers.forEach(e=>{r.serializeFixedBytes(t(e))}),r.toUint8Array();default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${e.signingScheme}`)}}function r(e){let{address:t,signingScheme:i}=function(e){let t=e.deserializeUleb128AsU32();if(!Object.values(rG).includes(t))throw Error(`Deserialization of Account failed: SigningScheme variant ${t} is invalid`);return{address:eh.deserialize(e),signingScheme:t}}(e);switch(i){case 0:return new nk({privateKey:tb.deserialize(e),address:t});case 2:{let r=e.deserializeUleb128AsU32();switch(r){case 0:return new nN({privateKey:tb.deserialize(e),address:t});case 1:return new nN({privateKey:tf.deserialize(e),address:t});case 3:{let t=nM(e),r=o8(t);return new nD({...t,...r})}case 4:{let t=nM(e),r=eh.deserialize(e),i=e.deserializeBool(),n=o8(t);return new nq({...t,...n,jwkAddress:r,audless:i})}default:throw Error(`Unsupported public key variant ${r}`)}}case 3:{let i=iD.deserialize(e),n=e.deserializeUleb128AsU32(),s=[];for(let t=0;t<n;t+=1){let t=r(e);if(!nP(t)&&!(t instanceof nk))throw Error("Deserialization of MultiKeyAccount failed. Signer is not a SingleKeySigner or Ed25519Account");s.push(t)}return new nL({multiKey:i,signers:s,address:t})}default:throw Error(`Deserialization of Account failed: invalid signingScheme value ${i}`)}}function i(e){return r(eo.fromHex(e))}e.toBytes=t,e.toHexStringWithoutPrefix=function(e){return V.hexInputToStringWithoutPrefix(t(e))},e.toHexString=function(e){return V.hexInputToString(t(e))},e.deserialize=r,e.keylessAccountFromHex=function(e){let t=i(e);if(!(t instanceof nD))throw Error("Deserialization of KeylessAccount failed");return t},e.federatedKeylessAccountFromHex=function(e){let t=i(e);if(!(t instanceof nq))throw Error("Deserialization of FederatedKeylessAccount failed");return t},e.multiKeyAccountFromHex=function(e){let t=i(e);if(!(t instanceof nL))throw Error("Deserialization of MultiKeyAccount failed");return t},e.singleKeyAccountFromHex=function(e){let t=i(e);if(!(t instanceof nN))throw Error("Deserialization of SingleKeyAccount failed");return t},e.ed25519AccountFromHex=function(e){let t=i(e);if(!(t instanceof nk))throw Error("Deserialization of Ed25519Account failed");return t},e.fromHex=i,e.fromBytes=function(e){return i(e)}})($||($={}));function nj(e){return!!e.match(/^[_a-zA-Z0-9]+$/)}function nG(e){return!!e.match(/\s/)}var nW=((N=nW||{}).InvalidTypeTag="unknown type",N.UnexpectedGenericType="unexpected generic type",N.UnexpectedTypeArgumentClose="unexpected '>'",N.UnexpectedWhitespaceCharacter="unexpected whitespace character",N.UnexpectedComma="unexpected ','",N.TypeArgumentCountMismatch="type argument count doesn't match expected amount",N.MissingTypeArgumentClose="no matching '>' for '<'",N.MissingTypeArgument="no type argument before ','",N.UnexpectedPrimitiveTypeArguments="primitive types not expected to have type arguments",N.UnexpectedVectorTypeArgumentCount="vector type expected to have exactly one type argument",N.UnexpectedStructFormat="unexpected struct format, must be of the form 0xaddress::module_name::struct_name",N.InvalidModuleNameCharacter="module name must only contain alphanumeric or '_' characters",N.InvalidStructNameCharacter="struct name must only contain alphanumeric or '_' characters",N.InvalidAddress="struct address must be valid",N),nJ=class extends Error{constructor(e,t){super(`Failed to parse typeTag '${e}', ${t}`)}};function nY(e,t){let r=t?.allowGenerics??!1,i=[],n=[],s=[],a=0,o="",c=1;for(;a<e.length;){let t=e[a];if("<"===t)i.push({savedExpectedTypes:c,savedStr:o,savedTypes:s}),o="",s=[],c=1;else if(">"===t){if(""!==o){let e=nZ(o,n,r);s.push(e)}let t=i.pop();if(void 0===t)throw new nJ(e,"unexpected '>'");if(c!==s.length)throw new nJ(e,"type argument count doesn't match expected amount");let{savedStr:a,savedTypes:u,savedExpectedTypes:l}=t;n=s,s=u,o=a,c=l}else if(","===t){if(0===i.length)throw new nJ(e,"unexpected ','");if(0===o.length)throw new nJ(e,"no type argument before ','");let t=nZ(o,n,r);n=[],s.push(t),o="",c+=1}else if(nG(t)){let t=!1;if(0!==o.length){let e=nZ(o,n,r);n=[],s.push(e),o="",t=!0}a=function(e,t){let r=t;for(;r<e.length&&nG(e[r]);r+=1);return r}(e,a);let i=e[a];if(a<e.length&&t&&","!==i&&">"!==i)throw new nJ(e,"unexpected whitespace character");continue}else o+=t;a+=1}if(i.length>0)throw new nJ(e,"no matching '>' for '<'");switch(s.length){case 0:return nZ(o,n,r);case 1:if(""===o)return s[0];throw new nJ(e,"unexpected ','");default:throw new nJ(e,"unexpected whitespace character")}}function nZ(e,t,r){let i=e.trim();if(function(e){switch(e){case"signer":case"address":case"bool":case"u8":case"u16":case"u32":case"u64":case"u128":case"u256":return!0;default:return!1}}(i.toLowerCase())&&t.length>0)throw new nJ(e,"primitive types not expected to have type arguments");switch(i.toLowerCase()){case"signer":return new i7;case"bool":return new i1;case"address":return new i9;case"u8":return new i2;case"u16":return new i8;case"u32":return new i3;case"u64":return new i5;case"u128":return new i4;case"u256":return new i6;case"vector":if(1!==t.length)throw new nJ(e,"vector type expected to have exactly one type argument");return new nr(t[0]);default:let n;if(i.match(/^&.+$/))return new ne(nZ(i.substring(1),t,r));if(i.match(/^T[0-9]+$/)){if(r)return new nt(Number(i.split("T")[1]));throw new nJ(e,"unexpected generic type")}if(!i.match(/:/))throw new nJ(e,"unknown type");let s=i.split("::");if(3!==s.length)throw new nJ(e,"unexpected struct format, must be of the form 0xaddress::module_name::struct_name");try{n=eh.fromString(s[0])}catch{throw new nJ(e,"struct address must be valid")}if(!nj(s[1]))throw new nJ(e,"module name must only contain alphanumeric or '_' characters");if(!nj(s[2]))throw new nJ(e,"struct name must only contain alphanumeric or '_' characters");return new ni(new nn(n,new eW(s[1]),new eW(s[2]),t))}}function nX(e){return"string"==typeof e}function nQ(e){return"number"==typeof e?e:nX(e)&&""!==e?Number.parseInt(e,10):void 0}function n0(e){return"number"==typeof e||"bigint"==typeof e||"string"==typeof e}function n1(e){return e instanceof ee}function n2(e){return e instanceof eh}function n8(e){return e instanceof el}function n3(e){return e instanceof et}function n5(e){return e instanceof er}function n4(e){return e instanceof ei}function n6(e){return e instanceof en}function n9(e){return e instanceof es}function n7(e){return e instanceof ea}function se(e,t){throw Error(`Type mismatch for argument ${t}, expected '${e}'`)}var st=new TextEncoder;function sr(e){return e?.map(e=>nX(e)?nY(e):e)??[]}async function si(e,t,r){return(await sI({aptosConfig:r,accountAddress:e,moduleName:t})).abi}async function sn(e,t,r,i){let n=await si(e,t,i);if(!n)throw Error(`Could not find module ABI for '${e}::${t}'`);return n.exposed_functions.find(e=>e.name===r)}async function ss(e,t,r,i){let n,s=await sn(e,t,r,i);if(!s)throw Error(`Could not find entry function ABI for '${e}::${t}::${r}'`);if(!s.is_entry)throw Error(`'${e}::${t}::${r}' is not an entry function`);let a=(n=s.params.findIndex(e=>"signer"!==e&&"&signer"!==e))<0?s.params.length:n,o=[];for(let e=a;e<s.params.length;e+=1)o.push(nY(s.params[e],{allowGenerics:!0}));return{signers:a,typeParameters:s.generic_type_params,parameters:o}}async function sa(e,t,r,i){let n=await sn(e,t,r,i);if(!n)throw Error(`Could not find view function ABI for '${e}::${t}::${r}'`);if(!n.is_view)throw Error(`'${e}::${t}::${r}' is not an view function`);let s=[];for(let e=0;e<n.params.length;e+=1)s.push(nY(n.params[e],{allowGenerics:!0}));let a=[];for(let e=0;e<n.return.length;e+=1)a.push(nY(n.return[e],{allowGenerics:!0}));return{typeParameters:n.generic_type_params,parameters:s,returnTypes:a}}function so(e,t,r,i,n,s){let a;if("exposed_functions"in t){let r=t.exposed_functions.find(t=>t.name===e);if(!r)throw Error(`Could not find function ABI for '${t.address}::${t.name}::${e}'`);if(i>=r.params.length)throw Error(`Too many arguments for '${e}', expected ${r.params.length}`);a=nY(r.params[i],{allowGenerics:!0})}else{if(i>=t.parameters.length)throw Error(`Too many arguments for '${e}', expected ${t.parameters.length}`);a=t.parameters[i]}return sc(r,a,i,n,"exposed_functions"in t?t:void 0,s)}function sc(e,t,r,i,n,s){return n1(e)||n3(e)||n5(e)||n4(e)||n6(e)||n9(e)||n7(e)||n2(e)||n8(e)||e instanceof rT||e instanceof ec||e instanceof ed?(function e(t,r,i){if(t.isBool()){if(n1(r))return;se("Bool",i)}if(t.isAddress()){if(n2(r))return;se("AccountAddress",i)}if(t.isU8()){if(n3(r))return;se("U8",i)}if(t.isU16()){if(n5(r))return;se("U16",i)}if(t.isU32()){if(n4(r))return;se("U32",i)}if(t.isU64()){if(n6(r))return;se("U64",i)}if(t.isU128()){if(n9(r))return;se("U128",i)}if(t.isU256()){if(n7(r))return;se("U256",i)}if(t.isVector()){if(r instanceof ec){r.values.length>0&&e(t.value,r.values[0],i);return}se("MoveVector",i)}if(t instanceof ni){if(t.isString()){if(n8(r))return;se("MoveString",i)}if(t.isObject()){if(n2(r))return;se("AccountAddress",i)}if(t.isOption()){if(r instanceof ed){void 0!==r.value&&e(t.value.typeArgs[0],r.value,i);return}se("MoveOption",i)}}throw Error(`Type mismatch for argument ${i}, expected '${t.toString()}'`)}(t,e,r),e):function(e,t,r,i,n,s){if(t.isBool()){if("boolean"==typeof e)return new ee(e);if(nX(e)){if("true"===e)return new ee(!0);if("false"===e)return new ee(!1)}se("boolean",r)}if(t.isAddress()){if(nX(e))return eh.fromString(e);se("string | AccountAddress",r)}if(t.isU8()){let t=nQ(e);if(void 0!==t)return new et(t);se("number | string",r)}if(t.isU16()){let t=nQ(e);if(void 0!==t)return new er(t);se("number | string",r)}if(t.isU32()){let t=nQ(e);if(void 0!==t)return new ei(t);se("number | string",r)}if(t.isU64()){if(n0(e))return new en(BigInt(e));se("bigint | number | string",r)}if(t.isU128()){if(n0(e))return new es(BigInt(e));se("bigint | number | string",r)}if(t.isU256()){if(n0(e))return new ea(BigInt(e));se("bigint | number | string",r)}if(t.isGeneric()){let s=t.value;if(s<0||s>=i.length)throw Error(`Generic argument ${t.toString()} is invalid for argument ${r}`);return sc(e,i[s],r,i,n)}if(t.isVector()){if(t.value.isU8()){if(nX(e))return ec.U8(st.encode(e));if(e instanceof Uint8Array)return ec.U8(e);if(e instanceof ArrayBuffer)return ec.U8(new Uint8Array(e))}if(nX(e)&&e.startsWith("["))return sc(JSON.parse(e),t,r,i);if(Array.isArray(e))return new ec(e.map(e=>sc(e,t.value,r,i,n)));throw Error(`Type mismatch for argument ${r}, type '${t.toString()}'`)}if(t.isStruct()){if(t.isString()){if(nX(e))return new el(e);se("string",r)}if(t.isObject()){if(nX(e))return eh.fromString(e);se("string | AccountAddress",r)}if(t.isDelegationKey()||t.isRateLimiter()){if(e instanceof Uint8Array)return new rT(e);se("Uint8Array",r)}if(t.isOption())return null==e?(t.value.typeArgs[0],new ed(null)):new ed(sc(e,t.value.typeArgs[0],r,i,n));if(n?.structs.find(e=>e.name===t.value.name.identifier)?.fields.length===0&&e instanceof Uint8Array)return new rT(e);if(e instanceof Uint8Array&&s?.allowUnknownStructs)return console.warn(`Unsupported struct input type for argument ${r}. Continuing since 'allowUnknownStructs' is enabled.`),new rT(e);throw Error(`Unsupported struct input type for argument ${r}, type '${t.toString()}'`)}throw Error(`Type mismatch for argument ${r}, type '${t.toString()}'`)}(e,t,r,i,n,s)}async function su(e){if("bytecode"in e)return new nc(new nf(V.fromHexInput(e.bytecode).toUint8Array(),sr(e.typeArguments),e.functionArguments));let{moduleAddress:t,moduleName:r,functionName:i}=eU(e.function),n=await sh({key:"entry-function",moduleAddress:t,moduleName:r,functionName:i,aptosConfig:e.aptosConfig,abi:e.abi,fetch:ss});return function(e){let t=e.abi,{moduleAddress:r,moduleName:i,functionName:n}=eU(e.function),s=sr(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=e.functionArguments.map((r,i)=>so(e.function,t,r,i,s));if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${r}::${i}::${n}', expected ${t.parameters.length} but got ${a.length}`);let o=nd.build(`${r}::${i}`,n,s,a);return"multisigAddress"in e?new nl(new np(eh.from(e.multisigAddress),new nh(o))):new nu(o)}({...e,abi:n})}async function sl(e){let{moduleAddress:t,moduleName:r,functionName:i}=eU(e.function);return function(e){let t=e.abi,{moduleAddress:r,moduleName:i,functionName:n}=eU(e.function),s=sr(e.typeArguments);if(s.length!==t.typeParameters.length)throw Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${s.length}`);let a=e?.functionArguments?.map((r,i)=>so(e.function,t,r,i,s))??[];if(a.length!==t.parameters.length)throw Error(`Too few arguments for '${r}::${i}::${n}', expected ${t.parameters.length} but got ${a.length}`);return nd.build(`${r}::${i}`,n,s,a)}({abi:await sh({key:"view-function",moduleAddress:t,moduleName:r,functionName:i,aptosConfig:e.aptosConfig,abi:e.abi,fetch:sa}),...e})}async function sd(e){let{aptosConfig:t,sender:r,payload:i,options:n,feePayerAddress:s}=e,a=async()=>r2[t.network]?{chainId:r2[t.network]}:{chainId:(await t6({aptosConfig:t})).chain_id},o=async()=>n?.gasUnitPrice?{gasEstimate:n.gasUnitPrice}:{gasEstimate:(await rf({aptosConfig:t})).gas_estimate},c=async()=>{let e=async()=>n?.accountSequenceNumber!==void 0?n.accountSequenceNumber:(await eH({aptosConfig:t,accountAddress:r})).sequence_number;if(!(s&&eh.from(s).equals(eh.ZERO)))return e();try{return await e()}catch{return 0}},[{chainId:u},{gasEstimate:l},d]=await Promise.all([a(),o(),c()]),{maxGasAmount:f,gasUnitPrice:p,expireTimestamp:h}={maxGasAmount:n?.maxGasAmount?BigInt(n.maxGasAmount):BigInt(2e5),gasUnitPrice:n?.gasUnitPrice??BigInt(l),expireTimestamp:n?.expireTimestamp??BigInt(Math.floor(Date.now()/1e3)+20)};return new ng(eh.from(r),BigInt(d),i,BigInt(f),BigInt(p),BigInt(h),new eG(u))}async function sf(e){let{aptosConfig:t,sender:r,payload:i,options:n,feePayerAddress:s}=e,a=await sd({aptosConfig:t,sender:r,payload:i,options:n,feePayerAddress:s});return"secondarySignerAddresses"in e?new nx(a,e.secondarySignerAddresses?.map(e=>eh.from(e))??[],e.feePayerAddress?eh.from(e.feePayerAddress):void 0):new nT(a,e.feePayerAddress?eh.from(e.feePayerAddress):void 0)}function sp(e){if(!e)return new iZ;let t=oD.isInstance(e)||iR.isInstance(e)||td.isInstance(e)?new i$(e):e,r=new tv(new Uint8Array(64));if(t_.isInstance(t))return new iG(t,r);if(i$.isInstance(t))return oD.isInstance(t.publicKey)?new iJ(t,new iF(oM.getSimulationSignature())):new iJ(t,new iF(r));if(iD.isInstance(t))return new iY(t,new iL({signatures:t.publicKeys.map(e=>new iF(oD.isInstance(e.publicKey)||iR.isInstance(e.publicKey)?oM.getSimulationSignature():r)),bitmap:t.createBitmap({bits:Array(t.publicKeys.length).fill(0).map((e,t)=>t)})}));throw Error("Unsupported PublicKey used for simulations")}async function sh({key:e,moduleAddress:t,moduleName:r,functionName:i,aptosConfig:n,abi:s,fetch:a}){return void 0!==s?s:em(async()=>a(t,r,i,n),`${e}-${n.network}-${t}-${r}-${i}`,3e5)()}!function(e){let t=e_.DZ.create();for(let r of e)t.update(r);t.digest()}(["APTOS::Transaction"]);var sg=class e{constructor(e){this.config=e,this.builder=void 0}async init(){if(!e.transactionComposer){let{TransactionComposer:t,initSync:i}=await Promise.resolve().then(r.bind(r,46669));rC.ScriptComposerWasm.isInitialized||rC.ScriptComposerWasm.init(),i({module:rC.ScriptComposerWasm.wasm}),e.transactionComposer=t}this.builder=e.transactionComposer.single_signer()}async addBatchedCalls(e){let{moduleAddress:t,moduleName:r,functionName:i}=eU(e.function),n=this.config.getRequestUrl("Fullnode");if(await this.builder.load_module(n,`${t}::${r}`),void 0!==e.typeArguments)for(let t of e.typeArguments)await this.builder.load_type_tag(n,t.toString());let s=sr(e.typeArguments),a=await si(t,r,this.config);if(!a)throw Error(`Could not find module ABI for '${t}::${r}'`);let o=a?.exposed_functions.find(e=>e.name===i);if(!o)throw Error(`Could not find function ABI for '${t}::${r}::${i}'`);if(s.length!==o.generic_type_params.length)throw Error(`Type argument count mismatch, expected ${o?.generic_type_params.length}, received ${s.length}`);let c=e.functionArguments.map((e,t)=>e instanceof rC.CallArgument?e:rC.CallArgument.newBytes(so(i,a,e,t,s,{allowUnknownStructs:!0}).bcsToBytes()));return this.builder.add_batched_call(`${t}::${r}`,i,s.map(e=>e.toString()),c)}build(){return this.builder.generate_batched_calls(!0)}};async function sy(e){let t=await sm(e);return s_(e,t)}async function sm(e){let{aptosConfig:t,data:r}=e,i,n;return"bytecode"in r?n=await su(r):(i="multisigAddress"in r?{aptosConfig:t,multisigAddress:r.multisigAddress,function:r.function,functionArguments:r.functionArguments,typeArguments:r.typeArguments,abi:r.abi}:{aptosConfig:t,function:r.function,functionArguments:r.functionArguments,typeArguments:r.typeArguments,abi:r.abi},n=await su(i)),n}async function s_(e,t){let{aptosConfig:r,sender:i,options:n}=e,s;if(!0===e.withFeePayer&&(s=eh.ZERO.toString()),"secondarySignerAddresses"in e){let{secondarySignerAddresses:a}=e;return sf({aptosConfig:r,sender:i,payload:t,options:n,secondarySignerAddresses:a,feePayerAddress:s})}return sf({aptosConfig:r,sender:i,payload:t,options:n,feePayerAddress:s})}function sw(e){let{signer:t,transaction:r}=e;return t.signTransactionWithAuthenticator(r)}function sb(e){let{signer:t,transaction:r}=e;if(!r.feePayerAddress)throw Error(`Transaction ${r} is not a Fee Payer transaction`);return r.feePayerAddress=t.accountAddress,sw({signer:t,transaction:r})}async function sA(e){let{aptosConfig:t,transaction:r,signerPublicKey:i,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}=e,o=function(e){let t,{signerPublicKey:r,transaction:i,secondarySignersPublicKeys:n,feePayerPublicKey:s}=e,a=sp(r);if(i.feePayerAddress){let e=new n_(i.rawTransaction,i.secondarySignerAddresses??[],i.feePayerAddress),t=[];i.secondarySignerAddresses&&(t=n?n.map(e=>sp(e)):Array.from({length:i.secondarySignerAddresses.length},()=>sp(void 0)));let r=sp(s),o=new nE(a,i.secondarySignerAddresses??[],t,{address:i.feePayerAddress,authenticator:r});return new nz(e.raw_txn,o).bcsToBytes()}if(i.secondarySignerAddresses){let e=new nm(i.rawTransaction,i.secondarySignerAddresses),t=[];t=n?n.map(e=>sp(e)):Array.from({length:i.secondarySignerAddresses.length},()=>sp(void 0));let r=new nv(a,i.secondarySignerAddresses,t);return new nz(e.raw_txn,r).bcsToBytes()}if(a instanceof iG)t=new nb(a.public_key,a.signature);else if(a instanceof iJ||a instanceof iY)t=new nS(a);else if(a instanceof iZ)t=new nS(a);else throw Error("Invalid public key");return new nz(i.rawTransaction,t).bcsToBytes()}({transaction:r,signerPublicKey:i,secondarySignersPublicKeys:n,feePayerPublicKey:s,options:a}),{data:c}=await t2({aptosConfig:t,body:o,path:"transactions/simulate",params:{estimate_gas_unit_price:e.options?.estimateGasUnitPrice??!1,estimate_max_gas_amount:e.options?.estimateMaxGasAmount??!1,estimate_prioritized_gas_unit_price:e.options?.estimatePrioritizedGasUnitPrice??!1},originMethod:"simulateTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return c}async function sv(e){let{aptosConfig:t}=e,r=function(e){let t;let{transaction:r,feePayerAuthenticator:i,additionalSignersAuthenticators:n}=e,s=(t=new eo(e.senderAuthenticator.bcsToBytes()),ij.deserialize(t)),a;if(r.feePayerAddress){if(!i)throw Error("Must provide a feePayerAuthenticator argument to generate a signed fee payer transaction");a=new nE(s,r.secondarySignerAddresses??[],n??[],{address:r.feePayerAddress,authenticator:i})}else if(r.secondarySignerAddresses){if(!n)throw Error("Must provide a additionalSignersAuthenticators argument to generate a signed multi agent transaction");a=new nv(s,r.secondarySignerAddresses,n)}else a=s instanceof iG?new nb(s.public_key,s.signature):s instanceof iW?new nA(s.public_key,s.signature):new nS(s);return new nz(r.rawTransaction,a).bcsToBytes()}({...e});try{let{data:e}=await t2({aptosConfig:t,body:r,path:"transactions",originMethod:"submitTransaction",contentType:"application/x.aptos.signed_transaction+bcs"});return e}catch(i){let e=nz.deserialize(new eo(r));throw e.authenticator.isSingleSender()&&e.authenticator.sender.isSingleKey()&&(e.authenticator.sender.public_key.publicKey instanceof oD||e.authenticator.sender.public_key.publicKey instanceof iR)&&await nF.fetchJWK({aptosConfig:t,publicKey:e.authenticator.sender.public_key.publicKey,kid:e.authenticator.sender.signature.signature.getJwkKid()}),i}}async function sE(e){let{aptosConfig:t,signer:r,feePayer:i,transaction:n}=e;nR(r)&&await r.checkKeylessAccountValidity(t),nR(i)&&await i.checkKeylessAccountValidity(t);let s=e.feePayerAuthenticator||i&&sb({signer:i,transaction:n}),a=sw({signer:r,transaction:n});return sv({aptosConfig:t,transaction:n,senderAuthenticator:a,feePayerAuthenticator:s})}async function sS(e){let{aptosConfig:t,senderAuthenticator:r,feePayer:i,transaction:n}=e;nR(i)&&await i.checkKeylessAccountValidity(t);let s=sb({signer:i,transaction:n});return sv({aptosConfig:t,transaction:n,senderAuthenticator:r,feePayerAuthenticator:s})}var sz={typeParameters:[],parameters:[nr.u8(),new nr(nr.u8())]};async function sT(e){let{aptosConfig:t,account:r,metadataBytes:i,moduleBytecode:n,options:s}=e,a=n.map(e=>ec.U8(e));return sy({aptosConfig:t,sender:eh.from(r),data:{function:"0x1::code::publish_package_txn",functionArguments:[ec.U8(i),new ec(a)],abi:sz},options:s})}async function sx(e){return eH(e)}async function sC(e){let{aptosConfig:t,accountAddress:r,options:i}=e;return eL({aptosConfig:t,originMethod:"getModules",path:`accounts/${eh.from(r).toString()}/modules`,params:{ledger_version:i?.ledgerVersion,limit:i?.limit??1e3}})}async function sU(e){let{aptosConfig:t,accountAddress:r,options:i}=e,{response:n,cursor:s}=await eV({aptosConfig:t,originMethod:"getModulesPage",path:`accounts/${eh.from(r).toString()}/modules`,params:{ledger_version:i?.ledgerVersion,cursor:i?.cursor,limit:i?.limit??100}});return{modules:n.data,cursor:s}}async function sI(e){return eM(e)}async function sk(e){let{aptosConfig:t,accountAddress:r,options:i}=e;return eq({aptosConfig:t,originMethod:"getTransactions",path:`accounts/${eh.from(r).toString()}/transactions`,params:{start:i?.offset,limit:i?.limit}})}async function sP(e){let{aptosConfig:t,accountAddress:r,options:i}=e;return eL({aptosConfig:t,originMethod:"getResources",path:`accounts/${eh.from(r).toString()}/resources`,params:{ledger_version:i?.ledgerVersion,limit:i?.limit??999}})}async function sN(e){let{aptosConfig:t,accountAddress:r,options:i}=e,{response:n,cursor:s}=await eV({aptosConfig:t,originMethod:"getResourcesPage",path:`accounts/${eh.from(r).toString()}/resources`,params:{ledger_version:i?.ledgerVersion,cursor:i?.cursor,limit:i?.limit??100}});return{resources:n.data,cursor:s}}async function sB(e){let{aptosConfig:t,accountAddress:r,resourceType:i,options:n}=e,{data:s}=await eD({aptosConfig:t,originMethod:"getResource",path:`accounts/${eh.from(r).toString()}/resource/${i}`,params:{ledger_version:n?.ledgerVersion}});return s.data}async function sK(e){let{aptosConfig:t,authenticationKey:r,options:i}=e,{address_map:{handle:n}}=await sB({aptosConfig:t,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:i}),s=eh.from(r);try{let e=await ri({aptosConfig:t,handle:n,data:{key:s.toString(),key_type:"address",value_type:"address"},options:i});return eh.from(e)}catch(e){if(e instanceof eR&&"table_item_not_found"===e.data.error_code)return s;throw e}}async function sR(e){let{aptosConfig:t,accountAddress:r}=e,i={owner_address:{_eq:eh.from(r).toStringLong()},amount:{_gt:0}},n=await t7({aptosConfig:t,query:{query:t$,variables:{where_condition:i}},originMethod:"getAccountTokensCount"});return n.current_token_ownerships_v2_aggregate.aggregate?n.current_token_ownerships_v2_aggregate.aggregate.count:0}async function s$(e){let{aptosConfig:t,accountAddress:r,options:i}=e,n={owner_address:{_eq:eh.from(r).toStringLong()},amount:{_gt:0}};i?.tokenStandard&&(n.token_standard={_eq:i?.tokenStandard});let s={query:tK,variables:{where_condition:n,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function sF(e){let{aptosConfig:t,accountAddress:r,collectionAddress:i,options:n}=e,s={owner_address:{_eq:eh.from(r).toStringLong()},current_token_data:{collection_id:{_eq:eh.from(i).toStringLong()}},amount:{_gt:0}};n?.tokenStandard&&(s.token_standard={_eq:n?.tokenStandard});let a={query:tR,variables:{where_condition:s,offset:n?.offset,limit:n?.limit,order_by:n?.orderBy}};return(await t7({aptosConfig:t,query:a,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function sO(e){let{aptosConfig:t,accountAddress:r,options:i}=e,n={owner_address:{_eq:eh.from(r).toStringLong()}};i?.tokenStandard&&(n.current_collection={token_standard:{_eq:i?.tokenStandard}});let s={query:tB,variables:{where_condition:n,offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function sD(e){let{aptosConfig:t,accountAddress:r}=e,i=eh.from(r).toStringLong(),n=await t7({aptosConfig:t,query:{query:tF,variables:{address:i}},originMethod:"getAccountTransactionsCount"});return n.account_transactions_aggregate.aggregate?n.account_transactions_aggregate.aggregate.count:0}async function sq(e){let{aptosConfig:t,accountAddress:r,options:i}=e,n=eh.from(r).toStringLong(),s={query:tN,variables:{where_condition:{...i?.where,owner_address:{_eq:n}},offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:s,originMethod:"getAccountCoinsData"})).current_fungible_asset_balances}async function sL(e){let{aptosConfig:t,accountAddress:r}=e,i=eh.from(r).toStringLong(),n=await t7({aptosConfig:t,query:{query:tP,variables:{address:i}},originMethod:"getAccountCoinsCount"});if(!n.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return n.current_fungible_asset_balances_aggregate.aggregate.count}async function sV(e){let{aptosConfig:t,accountAddress:r,options:i}=e,n={query:tW,variables:{where_condition:{owner_address:{_eq:eh.from(r).toStringLong()}},offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getAccountOwnedObjects"})).current_objects}async function sH(e){let{aptosConfig:t,privateKey:r}=e,i=new i$(r.publicKey());if(r instanceof tf){let e=tg.fromPublicKey({publicKey:i}).derivedAddress();return nB.fromPrivateKey({privateKey:r,address:e})}if(r instanceof tb){let e=tg.fromPublicKey({publicKey:i});if(await sM({authKey:e,aptosConfig:t})){let t=e.derivedAddress();return nB.fromPrivateKey({privateKey:r,address:t,legacy:!1})}let n=tg.fromPublicKey({publicKey:i.publicKey});if(await sM({authKey:n,aptosConfig:t})){let e=n.derivedAddress();return nB.fromPrivateKey({privateKey:r,address:e,legacy:!0})}}throw Error(`Can't derive account from private key ${r}`)}async function sM(e){let{aptosConfig:t,authKey:r}=e,i=await sK({aptosConfig:t,authenticationKey:r.derivedAddress()});try{return await sx({aptosConfig:t,accountAddress:i}),!0}catch(e){if(404===e.status)return!1;throw Error(`Error while looking for an account info ${i.toString()}`)}}var sj={typeParameters:[],parameters:[new i2,nr.u8(),new i2,nr.u8(),nr.u8(),nr.u8()]};async function sG(e){let t,{aptosConfig:r,fromAccount:i,dangerouslySkipVerification:n}=e;if("toNewPrivateKey"in e)return sW({aptosConfig:r,fromAccount:i,toNewPrivateKey:e.toNewPrivateKey});if("toAccount"in e){if(e.toAccount instanceof nk)return sW({aptosConfig:r,fromAccount:i,toNewPrivateKey:e.toAccount.privateKey});if(e.toAccount instanceof nV)return sW({aptosConfig:r,fromAccount:i,toAccount:e.toAccount});t=e.toAccount.publicKey.authKey()}else if("toAuthKey"in e)t=e.toAuthKey;else throw Error("Invalid arguments");let s=await sY({aptosConfig:r,fromAccount:i,toAuthKey:t});if(!0===n)return s;let a=await rm({aptosConfig:r,transactionHash:s.hash});if(!a.success)throw Error(`Failed to rotate authentication key - ${a}`);let o=await sy({aptosConfig:r,sender:i.accountAddress,data:{function:"0x1::account::set_originating_address",functionArguments:[]}});return sE({aptosConfig:r,signer:e.toAccount,transaction:o})}async function sW(e){let{aptosConfig:t,fromAccount:r}=e,i=await sx({aptosConfig:t,accountAddress:r.accountAddress}),n;n="toNewPrivateKey"in e?nB.fromPrivateKey({privateKey:e.toNewPrivateKey,legacy:!0}):e.toAccount;let s=new eg({sequenceNumber:BigInt(i.sequence_number),originator:r.accountAddress,currentAuthKey:eh.from(i.authentication_key),newPublicKey:n.publicKey}).bcsToBytes(),a=r.sign(s),o=n.sign(s),c=await sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x1::account::rotate_authentication_key",functionArguments:[new et(r.signingScheme),ec.U8(r.publicKey.toUint8Array()),new et(n.signingScheme),ec.U8(n.publicKey.toUint8Array()),ec.U8(a.toUint8Array()),ec.U8(o.toUint8Array())],abi:sj}});return sE({aptosConfig:t,signer:r,transaction:c})}var sJ={typeParameters:[],parameters:[nr.u8()]};async function sY(e){let{aptosConfig:t,fromAccount:r,toAuthKey:i}=e,n=await sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x1::account::rotate_authentication_key_call",functionArguments:[ec.U8(i.toUint8Array())],abi:sJ}});return sE({aptosConfig:t,signer:r,transaction:n})}async function sZ(e){let{aptosConfig:t,payload:r,options:i}=e,n=await sl({...r,aptosConfig:t}),s=new J;n.serialize(s);let a=s.toUint8Array(),{data:o}=await t2({aptosConfig:t,path:"view",originMethod:"view",contentType:"application/x.aptos.view_function+bcs",params:{ledger_version:i?.ledgerVersion},body:a});return o}async function sX(e){let{aptosConfig:t,payload:r,options:i}=e,{data:n}=await t2({aptosConfig:t,originMethod:"viewJson",path:"view",params:{ledger_version:i?.ledgerVersion},body:{function:r.function,type_arguments:r.typeArguments??[],arguments:r.functionArguments??[]}});return n}async function sQ(e){let{aptosConfig:t,sender:r,authenticationFunction:i,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=eU(i);return sy({aptosConfig:t,sender:r,data:{function:"0x1::account_abstraction::add_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new i9,new ni(ns()),new ni(ns())]}},options:n})}async function s0(e){let{aptosConfig:t,sender:r,authenticationFunction:i,options:n}=e,{moduleAddress:s,moduleName:a,functionName:o}=eU(i);return sy({aptosConfig:t,sender:r,data:{function:"0x1::account_abstraction::remove_authentication_function",typeArguments:[],functionArguments:[s,a,o],abi:{typeParameters:[],parameters:[new i9,new ni(ns()),new ni(ns())]}},options:n})}async function s1(e){let{aptosConfig:t,sender:r,options:i}=e;return sy({aptosConfig:t,sender:r,data:{function:"0x1::account_abstraction::remove_authenticator",typeArguments:[],functionArguments:[],abi:{typeParameters:[],parameters:[]}},options:i})}var s2=class{constructor(e){this.config=e,this.isAccountAbstractionEnabled=async e=>{let t=await this.getAuthenticationFunction(e),{moduleAddress:r,moduleName:i,functionName:n}=eU(e.authenticationFunction);return t?.some(e=>eh.fromString(r).equals(e.moduleAddress)&&i===e.moduleName&&n===e.functionName)??!1},this.enableAccountAbstractionTransaction=this.addAuthenticationFunctionTransaction,this.disableAccountAbstractionTransaction=async e=>{let{accountAddress:t,authenticationFunction:r,options:i}=e;return r?this.removeAuthenticationFunctionTransaction({accountAddress:t,authenticationFunction:r,options:i}):this.removeDispatchableAuthenticatorTransaction({accountAddress:t,options:i})}}async addAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:r,options:i}=e;return sQ({aptosConfig:this.config,authenticationFunction:r,sender:t,options:i})}async removeAuthenticationFunctionTransaction(e){let{accountAddress:t,authenticationFunction:r,options:i}=e;return s0({aptosConfig:this.config,sender:t,authenticationFunction:r,options:i})}async removeDispatchableAuthenticatorTransaction(e){let{accountAddress:t,options:r}=e;return s1({aptosConfig:this.config,sender:t,options:r})}async getAuthenticationFunction(e){let{accountAddress:t}=e,[{vec:r}]=await sZ({aptosConfig:this.config,payload:{function:"0x1::account_abstraction::dispatchable_authenticator",functionArguments:[eh.from(t)],abi:{typeParameters:[],parameters:[new i9],returnTypes:[]}}});if(0!==r.length)return r[0].map(e=>({moduleAddress:eh.fromString(e.module_address),moduleName:e.module_name,functionName:e.function_name}))}},s8=class{constructor(e){this.config=e,this.abstraction=new s2(e)}async getAccountInfo(e){return sx({aptosConfig:this.config,...e})}async getAccountModules(e){return sC({aptosConfig:this.config,...e})}async getAccountModulesPage(e){return sU({aptosConfig:this.config,...e})}async getAccountModule(e){return sI({aptosConfig:this.config,...e})}async getAccountTransactions(e){return sk({aptosConfig:this.config,...e})}async getAccountResources(e){return sP({aptosConfig:this.config,...e})}async getAccountResourcesPage(e){return sN({aptosConfig:this.config,...e})}async getAccountResource(e){return sB({aptosConfig:this.config,...e})}async lookupOriginalAccountAddress(e){return sK({aptosConfig:this.config,...e})}async getAccountTokensCount(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),sR({aptosConfig:this.config,...e})}async getAccountOwnedTokens(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),s$({aptosConfig:this.config,...e})}async getAccountOwnedTokensFromCollectionAddress(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sF({aptosConfig:this.config,...e})}async getAccountCollectionsWithOwnedTokens(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),sO({aptosConfig:this.config,...e})}async getAccountTransactionsCount(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"account_transactions_processor"}),sD({aptosConfig:this.config,...e})}async getAccountCoinsData(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),sq({aptosConfig:this.config,...e})}async getAccountCoinsCount(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"fungible_asset_processor"}),sL({aptosConfig:this.config,...e})}async getAccountAPTAmount(e){return this.getAccountCoinAmount({coinType:ro,faMetadataAddress:"0x000000000000000000000000000000000000000000000000000000000000000a",...e})}async getAccountCoinAmount(e){let t,{accountAddress:r,coinType:i,faMetadataAddress:n,minimumLedgerVersion:s}=e;s&&console.warn(`minimumLedgerVersion is not used anymore, here for backward 
        compatibility see https://github.com/aptos-labs/aptos-ts-sdk/pull/519, 
        will be removed in the near future`);let a=i;if(void 0===i&&void 0!==n&&(a=await em(async()=>{try{let e=(await sZ({aptosConfig:this.config,payload:{function:"0x1::coin::paired_coin",functionArguments:[n]}})).at(0);if(e.vec.length>0&&eC(e.vec[0]))return ex(e.vec[0])}catch{}},`coin-mapping-${n.toString()}`,3e5)()),void 0!==i&&void 0!==n)t=eh.from(n).toStringLong();else if(void 0!==i&&void 0===n)t=i===ro?eh.A.toStringLong():eb(eh.A,i).toStringLong();else if(void 0===i&&void 0!==n){let e=eh.from(n);t=e.toStringLong(),e===eh.A&&(a=ro)}else throw Error("Either coinType, faMetadataAddress, or both must be provided");if(void 0!==a){let[e]=await sZ({aptosConfig:this.config,payload:{function:"0x1::coin::balance",typeArguments:[a],functionArguments:[r]}});return parseInt(e,10)}let[o]=await sZ({aptosConfig:this.config,payload:{function:"0x1::primary_fungible_store::balance",typeArguments:["0x1::object::ObjectCore"],functionArguments:[r,t]}});return parseInt(o,10)}async getAccountOwnedObjects(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"default_processor"}),sV({aptosConfig:this.config,...e})}async deriveAccountFromPrivateKey(e){return sH({aptosConfig:this.config,...e})}},s3={typeParameters:[{constraints:[]}],parameters:[new i9,new i5]};async function s5(e){let{aptosConfig:t,sender:r,recipient:i,amount:n,coinType:s,options:a}=e;return sy({aptosConfig:t,sender:r,data:{function:"0x1::aptos_account::transfer_coins",typeArguments:[s??ro],functionArguments:[i,n],abi:s3},options:a})}var s4=class{constructor(e){this.config=e}async transferCoinTransaction(e){return s5({aptosConfig:this.config,...e})}},s6={BOOLEAN:"bool",U8:"u8",U16:"u16",U32:"u32",U64:"u64",U128:"u128",U256:"u256",ADDRESS:"address",STRING:"0x1::string::String",ARRAY:"vector<u8>"},s9="0x4::token::Token";async function s7(e){let{aptosConfig:t,digitalAssetAddress:r}=e,i={token_data_id:{_eq:eh.from(r).toStringLong()}};return(await t7({aptosConfig:t,query:{query:t0,variables:{where_condition:i}},originMethod:"getDigitalAssetData"})).current_token_datas_v2[0]}async function ae(e){let{aptosConfig:t,digitalAssetAddress:r}=e,i={token_data_id:{_eq:eh.from(r).toStringLong()},amount:{_gt:0}};return(await t7({aptosConfig:t,query:{query:tQ,variables:{where_condition:i}},originMethod:"getCurrentDigitalAssetOwnership"})).current_token_ownerships_v2[0]}async function at(e){let{aptosConfig:t,ownerAddress:r,options:i}=e,n={query:tQ,variables:{where_condition:{owner_address:{_eq:eh.from(r).toStringLong()},amount:{_gt:0}},offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getOwnedDigitalAssets"})).current_token_ownerships_v2}async function ar(e){let{aptosConfig:t,digitalAssetAddress:r,options:i}=e,n={query:tX,variables:{where_condition:{token_data_id:{_eq:eh.from(r).toStringLong()}},offset:i?.offset,limit:i?.limit,order_by:i?.orderBy}};return(await t7({aptosConfig:t,query:n,originMethod:"getDigitalAssetActivity"})).token_activities_v2}var ai={typeParameters:[],parameters:[new ni(ns()),new i5,new ni(ns()),new ni(ns()),new i1,new i1,new i1,new i1,new i1,new i1,new i1,new i1,new i1,new i5,new i5]};async function an(e){let{aptosConfig:t,options:r,creator:i}=e;return sy({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::create_collection",functionArguments:[new el(e.description),new en(e.maxSupply??0xffffffffffffffffn),new el(e.name),new el(e.uri),new ee(e.mutableDescription??!0),new ee(e.mutableRoyalty??!0),new ee(e.mutableURI??!0),new ee(e.mutableTokenDescription??!0),new ee(e.mutableTokenName??!0),new ee(e.mutableTokenProperties??!0),new ee(e.mutableTokenURI??!0),new ee(e.tokensBurnableByCreator??!0),new ee(e.tokensFreezableByCreator??!0),new en(e.royaltyNumerator??0),new en(e.royaltyDenominator??1)],abi:ai},options:r})}async function as(e){let{aptosConfig:t,options:r}=e,i=r?.where;r?.tokenStandard&&(i.token_standard={_eq:r?.tokenStandard??"v2"});let n={query:tD,variables:{where_condition:i,offset:r?.offset,limit:r?.limit}};return(await t7({aptosConfig:t,query:n,originMethod:"getCollectionData"})).current_collections_v2[0]}async function aa(e){let{aptosConfig:t,creatorAddress:r,collectionName:i,options:n}=e,s={collection_name:{_eq:i},creator_address:{_eq:eh.from(r).toStringLong()}};return n?.tokenStandard&&(s.token_standard={_eq:n?.tokenStandard??"v2"}),as({aptosConfig:t,options:{...n,where:s}})}async function ao(e){let{aptosConfig:t,creatorAddress:r,options:i}=e,n={creator_address:{_eq:eh.from(r).toStringLong()}};return i?.tokenStandard&&(n.token_standard={_eq:i?.tokenStandard??"v2"}),as({aptosConfig:t,options:{...i,where:n}})}async function ac(e){let{aptosConfig:t,collectionId:r,options:i}=e,n={collection_id:{_eq:eh.from(r).toStringLong()}};return i?.tokenStandard&&(n.token_standard={_eq:i?.tokenStandard??"v2"}),as({aptosConfig:t,options:{...i,where:n}})}async function au(e){let{creatorAddress:t,collectionName:r,options:i,aptosConfig:n}=e,s={collection_name:{_eq:r},creator_address:{_eq:eh.from(t).toStringLong()}};return i?.tokenStandard&&(s.token_standard={_eq:i?.tokenStandard??"v2"}),(await as({aptosConfig:n,options:{where:s}})).collection_id}var al={typeParameters:[],parameters:[new ni(ns()),new ni(ns()),new ni(ns()),new ni(ns()),new nr(new ni(ns())),new nr(new ni(ns())),new nr(nr.u8())]};async function ad(e){let{aptosConfig:t,options:r,creator:i,collection:n,description:s,name:a,uri:o,propertyKeys:c,propertyTypes:u,propertyValues:l}=e,d=u?.map(e=>s6[e]);return sy({aptosConfig:t,sender:i.accountAddress,data:{function:"0x4::aptos_token::mint",functionArguments:[new el(n),new el(s),new el(a),new el(o),ec.MoveString(c??[]),ec.MoveString(d??[]),aF(l??[],d??[])],abi:al},options:r})}var af={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new i9]};async function ap(e){let{aptosConfig:t,sender:r,digitalAssetAddress:i,recipient:n,digitalAssetType:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x1::object::transfer",typeArguments:[s??s9],functionArguments:[eh.from(i),eh.from(n)],abi:af},options:a})}var ah={typeParameters:[],parameters:[new ni(ns()),new ni(ns()),new ni(ns()),new ni(ns()),new nr(new ni(ns())),new nr(new ni(ns())),new nr(nr.u8()),new i9]};async function ag(e){let{aptosConfig:t,account:r,collection:i,description:n,name:s,uri:a,recipient:o,propertyKeys:c,propertyTypes:u,propertyValues:l,options:d}=e;if(c?.length!==l?.length)throw Error("Property keys and property values counts do not match");if(u?.length!==l?.length)throw Error("Property types and property values counts do not match");let f=u?.map(e=>s6[e]);return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::mint_soul_bound",functionArguments:[i,n,s,a,ec.MoveString(c??[]),ec.MoveString(f??[]),aF(l??[],f??[]),o],abi:ah},options:d})}var ay={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0)))]};async function am(e){let{aptosConfig:t,creator:r,digitalAssetAddress:i,digitalAssetType:n,options:s}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::burn",typeArguments:[n??s9],functionArguments:[eh.from(i)],abi:ay},options:s})}var a_={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0)))]};async function aw(e){let{aptosConfig:t,creator:r,digitalAssetAddress:i,digitalAssetType:n,options:s}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::freeze_transfer",typeArguments:[n??s9],functionArguments:[i],abi:a_},options:s})}var ab={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0)))]};async function aA(e){let{aptosConfig:t,creator:r,digitalAssetAddress:i,digitalAssetType:n,options:s}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::unfreeze_transfer",typeArguments:[n??s9],functionArguments:[i],abi:ab},options:s})}var av={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns())]};async function aE(e){let{aptosConfig:t,creator:r,description:i,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::set_description",typeArguments:[s??s9],functionArguments:[eh.from(n),new el(i)],abi:av},options:a})}var aS={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns())]};async function az(e){let{aptosConfig:t,creator:r,name:i,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::set_name",typeArguments:[s??s9],functionArguments:[eh.from(n),new el(i)],abi:aS},options:a})}var aT={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns())]};async function ax(e){let{aptosConfig:t,creator:r,uri:i,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::set_uri",typeArguments:[s??s9],functionArguments:[eh.from(n),new el(i)],abi:aT},options:a})}var aC={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns()),new ni(ns()),nr.u8()]};async function aU(e){let{aptosConfig:t,creator:r,propertyKey:i,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::add_property",typeArguments:[o??s9],functionArguments:[eh.from(a),new el(i),new el(s6[n]),ec.U8(aO(s,s6[n]))],abi:aC},options:c})}var aI={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns())]};async function ak(e){let{aptosConfig:t,creator:r,propertyKey:i,digitalAssetAddress:n,digitalAssetType:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::remove_property",typeArguments:[s??s9],functionArguments:[eh.from(n),new el(i)],abi:aI},options:a})}var aP={typeParameters:[{constraints:["key"]}],parameters:[new ni(na(new nt(0))),new ni(ns()),new ni(ns()),nr.u8()]};async function aN(e){let{aptosConfig:t,creator:r,propertyKey:i,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::update_property",typeArguments:[o??s9],functionArguments:[eh.from(a),new el(i),new el(s6[n]),aO(s,s6[n])],abi:aP},options:c})}var aB={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new ni(na(new nt(0))),new ni(ns()),new nt(1)]};async function aK(e){let{aptosConfig:t,creator:r,propertyKey:i,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::add_typed_property",typeArguments:[o??s9,s6[n]],functionArguments:[eh.from(a),new el(i),s],abi:aB},options:c})}var aR={typeParameters:[{constraints:["key"]},{constraints:[]}],parameters:[new ni(na(new nt(0))),new ni(ns()),new nt(1)]};async function a$(e){let{aptosConfig:t,creator:r,propertyKey:i,propertyType:n,propertyValue:s,digitalAssetAddress:a,digitalAssetType:o,options:c}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x4::aptos_token::update_typed_property",typeArguments:[o??s9,s6[n]],functionArguments:[eh.from(a),new el(i),s],abi:aR},options:c})}function aF(e,t){let r=[];return t.forEach((t,i)=>{r.push(aO(e[i],t))}),r}function aO(e,t){return sc(e,nY(t),0,[]).bcsToBytes()}var aD=class{constructor(e){this.config=e}async getCollectionData(e){await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"});let{creatorAddress:t,collectionName:r,options:i}=e,n={collection_name:{_eq:r},creator_address:{_eq:eh.from(t).toStringLong()}};return i?.tokenStandard&&(n.token_standard={_eq:i?.tokenStandard??"v2"}),as({aptosConfig:this.config,options:{where:n}})}async getCollectionDataByCreatorAddressAndCollectionName(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),aa({aptosConfig:this.config,...e})}async getCollectionDataByCreatorAddress(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ao({aptosConfig:this.config,...e})}async getCollectionDataByCollectionId(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ac({aptosConfig:this.config,...e})}async getCollectionId(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),au({aptosConfig:this.config,...e})}async getDigitalAssetData(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),s7({aptosConfig:this.config,...e})}async getCurrentDigitalAssetOwnership(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ae({aptosConfig:this.config,...e})}async getOwnedDigitalAssets(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),at({aptosConfig:this.config,...e})}async getDigitalAssetActivity(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"token_v2_processor"}),ar({aptosConfig:this.config,...e})}async createCollectionTransaction(e){return an({aptosConfig:this.config,...e})}async mintDigitalAssetTransaction(e){return ad({aptosConfig:this.config,...e})}async transferDigitalAssetTransaction(e){return ap({aptosConfig:this.config,...e})}async mintSoulBoundTransaction(e){return ag({aptosConfig:this.config,...e})}async burnDigitalAssetTransaction(e){return am({aptosConfig:this.config,...e})}async freezeDigitalAssetTransaferTransaction(e){return aw({aptosConfig:this.config,...e})}async unfreezeDigitalAssetTransaferTransaction(e){return aA({aptosConfig:this.config,...e})}async setDigitalAssetDescriptionTransaction(e){return aE({aptosConfig:this.config,...e})}async setDigitalAssetNameTransaction(e){return az({aptosConfig:this.config,...e})}async setDigitalAssetURITransaction(e){return ax({aptosConfig:this.config,...e})}async addDigitalAssetPropertyTransaction(e){return aU({aptosConfig:this.config,...e})}async removeDigitalAssetPropertyTransaction(e){return ak({aptosConfig:this.config,...e})}async updateDigitalAssetPropertyTransaction(e){return aN({aptosConfig:this.config,...e})}async addDigitalAssetTypedPropertyTransaction(e){return aK({aptosConfig:this.config,...e})}async updateDigitalAssetTypedPropertyTransaction(e){return a$({aptosConfig:this.config,...e})}},aq=e=>{if(e&&e.length>300)throw Error("Event type length exceeds the maximum length of 300")};async function aL(e){let{aptosConfig:t,eventType:r,options:i}=e,n={_or:[{account_address:{_eq:r.split("::")[0]}},{account_address:{_eq:"0x0000000000000000000000000000000000000000000000000000000000000000"},sequence_number:{_eq:0},creation_number:{_eq:0}}],indexed_type:{_eq:r}};return aM({aptosConfig:t,options:{...i,where:n}})}async function aV(e){let{accountAddress:t,aptosConfig:r,creationNumber:i,options:n}=e,s={account_address:{_eq:eh.from(t).toStringLong()},creation_number:{_eq:i}};return aM({aptosConfig:r,options:{...n,where:s}})}async function aH(e){let{accountAddress:t,aptosConfig:r,eventType:i,options:n}=e,s={account_address:{_eq:eh.from(t).toStringLong()},indexed_type:{_eq:i}};return aM({aptosConfig:r,options:{...n,where:s}})}async function aM(e){let{aptosConfig:t,options:r}=e;aq(r?.where?.indexed_type?._eq);let i={query:tV,variables:{where_condition:r?.where,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:i,originMethod:"getEvents"})).events}var aj=class{constructor(e){this.config=e}async getModuleEventsByEventType(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),aL({aptosConfig:this.config,...e})}async getAccountEventsByCreationNumber(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),aV({aptosConfig:this.config,...e})}async getAccountEventsByEventType(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"events_processor"}),aH({aptosConfig:this.config,...e})}async getEvents(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"events_processor"}),aM({aptosConfig:this.config,...e})}};async function aG(e){let{aptosConfig:t,accountAddress:r,amount:i,options:n}=e,s=n?.timeoutSecs||20,{data:a}=await t3({aptosConfig:t,path:"fund",body:{address:eh.from(r).toString(),amount:i},originMethod:"fundAccount"}),o=a.txn_hashes[0],c=await rm({aptosConfig:t,transactionHash:o,options:{timeoutSecs:s,checkSuccess:n?.checkSuccess}});if("user_transaction"===c.type)return c;throw Error(`Unexpected transaction received for fund account: ${c.type}`)}var aW=class{constructor(e){this.config=e}async fundAccount(e){let t=await aG({aptosConfig:this.config,...e});return(e.options?.waitForIndexer===void 0||e.options?.waitForIndexer)&&await r_({aptosConfig:this.config,minimumLedgerVersion:BigInt(t.version),processorType:"fungible_asset_processor"}),t}};async function aJ(e){let{aptosConfig:t,options:r}=e,i={query:tM,variables:{where_condition:r?.where,limit:r?.limit,offset:r?.offset}};return(await t7({aptosConfig:t,query:i,originMethod:"getFungibleAssetMetadata"})).fungible_asset_metadata}async function aY(e){let{aptosConfig:t,options:r}=e,i={query:tH,variables:{where_condition:r?.where,limit:r?.limit,offset:r?.offset}};return(await t7({aptosConfig:t,query:i,originMethod:"getFungibleAssetActivities"})).fungible_asset_activities}async function aZ(e){let{aptosConfig:t,options:r}=e,i={query:tq,variables:{where_condition:r?.where,limit:r?.limit,offset:r?.offset}};return(await t7({aptosConfig:t,query:i,originMethod:"getCurrentFungibleAssetBalances"})).current_fungible_asset_balances}var aX={typeParameters:[{constraints:[]}],parameters:[nY("0x1::object::Object"),new i9,new i5]};async function aQ(e){let{aptosConfig:t,sender:r,fungibleAssetMetadataAddress:i,recipient:n,amount:s,options:a}=e;return sy({aptosConfig:t,sender:r.accountAddress,data:{function:"0x1::primary_fungible_store::transfer",typeArguments:["0x1::fungible_asset::Metadata"],functionArguments:[i,n,s],abi:aX},options:a})}var a0=class{constructor(e){this.config=e}async getFungibleAssetMetadata(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),aJ({aptosConfig:this.config,...e})}async getFungibleAssetMetadataByAssetType(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),(await aJ({aptosConfig:this.config,options:{where:{asset_type:{_eq:e.assetType}}}}))[0]}async getFungibleAssetMetadataByCreatorAddress(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),await aJ({aptosConfig:this.config,options:{where:{creator_address:{_eq:eh.from(e.creatorAddress).toStringLong()}}}})}async getFungibleAssetActivities(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),aY({aptosConfig:this.config,...e})}async getCurrentFungibleAssetBalances(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"fungible_asset_processor"}),aZ({aptosConfig:this.config,...e})}async transferFungibleAsset(e){return aQ({aptosConfig:this.config,...e})}},a1=class{constructor(e){this.config=e}async getLedgerInfo(){return t6({aptosConfig:this.config})}async getChainId(){return(await this.getLedgerInfo()).chain_id}async getBlockByVersion(e){return rA({aptosConfig:this.config,...e})}async getBlockByHeight(e){return rv({aptosConfig:this.config,...e})}async view(e){return sZ({aptosConfig:this.config,...e})}async viewJson(e){return sX({aptosConfig:this.config,...e})}async getChainTopUserTransactions(e){return t9({aptosConfig:this.config,...e})}async queryIndexer(e){return t7({aptosConfig:this.config,...e})}async getIndexerLastSuccessVersion(){return rt({aptosConfig:this.config})}async getProcessorStatus(e){return rr({aptosConfig:this.config,processorType:e})}},a2="A name must be between 3 and 63 characters long, and can only contain lowercase a-z, 0-9, and hyphens. A name may not start or end with a hyphen.";function a8(e){return!(!e||e.length<3||e.length>63||!/^[a-z\d][a-z\d-]{1,61}[a-z\d]$/.test(e))}function a3(e){let[t,r,...i]=e.replace(/\.apt$/,"").split(".");if(i.length>0)throw Error(`${e} is invalid. A name can only have two parts, a domain and a subdomain separated by a "."`);if(!a8(t))throw Error(`${t} is not valid. ${a2}`);if(r&&!a8(r))throw Error(`${r} is not valid. ${a2}`);return{domainName:r||t,subdomainName:r?t:void 0}}var a5=((B=a5||{})[B.Independent=0]="Independent",B[B.FollowsDomain=1]="FollowsDomain",B);function a4(e){if(!e)return!1;let t=new Date(e.domain_expiration_timestamp).getTime()<Date.now(),r=new Date(e.expiration_timestamp).getTime()<Date.now();return(!e.subdomain||!t)&&(!!e.subdomain&&1===e.subdomain_expiration_policy||!r)}var a6={testnet:"0x5f8fd2347449685cf41d4db97926ec3a096eaf381332be4f1318ad4d16a8497c",mainnet:"0x867ed1f6bf916171b1de3ee92849b8978b7d1b9e0a8cc982a3d19d535dfd9c0c",local:"0x585fc9f0f0c54183b039ffc770ca282ebd87307916c215a3e692f2f8e4305e82",custom:null,devnet:null};function a9(e){let t=a6[e.network];if(!t)throw Error(`The ANS contract is not deployed to ${e.network}`);return t}var a7=e=>{if(e&&"object"==typeof e&&"vec"in e&&Array.isArray(e.vec))return e.vec[0]};async function oe(e){let{aptosConfig:t,name:r}=e,i=a9(t),{domainName:n,subdomainName:s}=a3(r),a=a7((await sZ({aptosConfig:t,payload:{function:`${i}::router::get_owner_addr`,functionArguments:[n,s]}}))[0]);return a?eh.from(a):void 0}async function ot(e){let{aptosConfig:t,expiration:r,name:i,sender:n,targetAddress:s,toAddress:a,options:o,transferable:c}=e,u=a9(t),{domainName:l,subdomainName:d}=a3(i),f="subdomain:independent"===r.policy||"subdomain:follow-domain"===r.policy;if(d&&!f)throw Error("Subdomains must have an expiration policy of either 'subdomain:independent' or 'subdomain:follow-domain'");if(f&&!d)throw Error(`Policy is set to ${r.policy} but no subdomain was provided`);if("domain"===r.policy){let e=r.years??1;if(1!==e)throw Error("For now, names can only be registered for 1 year at a time");return await sy({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_domain`,functionArguments:[l,31536e3*e,s,a]},options:o})}if(!d)throw Error(`${r.policy} requires a subdomain to be provided.`);let p=await or({aptosConfig:t,name:l});if(!p)throw Error("The domain does not exist");let h="subdomain:independent"===r.policy?r.expirationDate:p;if(h>p)throw Error("The subdomain expiration time cannot be greater than the domain expiration time");return await sy({aptosConfig:t,sender:n.accountAddress.toString(),data:{function:`${u}::router::register_subdomain`,functionArguments:[l,d,Math.round(h/1e3),"subdomain:follow-domain"===r.policy?1:0,!!c,s,a]},options:o})}async function or(e){let{aptosConfig:t,name:r}=e,i=a9(t),{domainName:n,subdomainName:s}=a3(r);try{let e=await sZ({aptosConfig:t,payload:{function:`${i}::router::get_expiration`,functionArguments:[n,s]}});return 1e3*Number(e[0])}catch{return}}async function oi(e){let{aptosConfig:t,address:r}=e,i=a9(t),n=await sZ({aptosConfig:t,payload:{function:`${i}::router::get_primary_name`,functionArguments:[eh.from(r).toString()]}}),s=a7(n[1]),a=a7(n[0]);if(s)return[a,s].filter(Boolean).join(".")}async function on(e){let{aptosConfig:t,sender:r,name:i,options:n}=e,s=a9(t);if(!i)return await sy({aptosConfig:t,sender:r.accountAddress.toString(),data:{function:`${s}::router::clear_primary_name`,functionArguments:[]},options:n});let{domainName:a,subdomainName:o}=a3(i);return await sy({aptosConfig:t,sender:r.accountAddress.toString(),data:{function:`${s}::router::set_primary_name`,functionArguments:[a,o]},options:n})}async function os(e){let{aptosConfig:t,name:r}=e,i=a9(t),{domainName:n,subdomainName:s}=a3(r),a=a7((await sZ({aptosConfig:t,payload:{function:`${i}::router::get_target_addr`,functionArguments:[n,s]}}))[0]);return a?eh.from(a):void 0}async function oa(e){let{aptosConfig:t,sender:r,name:i,address:n,options:s}=e,a=a9(t),{domainName:o,subdomainName:c}=a3(i);return await sy({aptosConfig:t,sender:r.accountAddress.toString(),data:{function:`${a}::router::set_target_addr`,functionArguments:[o,c,n]},options:s})}async function oo(e){let{aptosConfig:t,name:r}=e,{domainName:i,subdomainName:n=""}=a3(r),s=(await t7({aptosConfig:t,query:{query:tj,variables:{where_condition:{domain:{_eq:i},subdomain:{_eq:n}},limit:1}},originMethod:"getName"})).current_aptos_names[0];return s&&(s=oh(s)),a4(s)?s:void 0}async function oc(e){let{aptosConfig:t,options:r,accountAddress:i}=e,n=await of({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountNames",query:{query:tj,variables:{limit:r?.limit,offset:r?.offset,order_by:r?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:i.toString()},expiration_timestamp:{_gte:n}}}}})).current_aptos_names.map(oh)}async function ou(e){let{aptosConfig:t,options:r,accountAddress:i}=e,n=await of({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountDomains",query:{query:tj,variables:{limit:r?.limit,offset:r?.offset,order_by:r?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:i.toString()},expiration_timestamp:{_gte:n},subdomain:{_eq:""}}}}})).current_aptos_names.map(oh)}async function ol(e){let{aptosConfig:t,options:r,accountAddress:i}=e,n=await of({aptosConfig:t});return(await t7({aptosConfig:t,originMethod:"getAccountSubdomains",query:{query:tj,variables:{limit:r?.limit,offset:r?.offset,order_by:r?.orderBy,where_condition:{...e.options?.where??{},owner_address:{_eq:i.toString()},expiration_timestamp:{_gte:n},subdomain:{_neq:""}}}}})).current_aptos_names.map(oh)}async function od(e){let{aptosConfig:t,options:r,domain:i}=e;return(await t7({aptosConfig:t,originMethod:"getDomainSubdomains",query:{query:tj,variables:{limit:r?.limit,offset:r?.offset,order_by:r?.orderBy,where_condition:{...e.options?.where??{},domain:{_eq:i},subdomain:{_neq:""}}}}})).current_aptos_names.map(oh).filter(a4)}async function of(e){let{aptosConfig:t}=e,r=a9(t),[i]=await sZ({aptosConfig:t,payload:{function:`${r}::config::reregistration_grace_sec`,functionArguments:[]}}),n=()=>new Date;return new Date(n().setDate(n().getDate()-i/60/60/24)).toISOString()}async function op(e){let{aptosConfig:t,sender:r,name:i,years:n=1,options:s}=e,a=a9(t),{domainName:o,subdomainName:c}=a3(i);if(c)throw Error("Subdomains cannot be renewed");if(1!==n)throw Error("Currently, only 1 year renewals are supported");return await sy({aptosConfig:t,sender:r.accountAddress.toString(),data:{function:`${a}::router::renew_domain`,functionArguments:[o,31536e3*n]},options:s})}function oh(e){return{...e,expiration_timestamp:new Date(e.expiration_timestamp).getTime()}}var og=class{constructor(e){this.config=e}async getOwnerAddress(e){return oe({aptosConfig:this.config,...e})}async getExpiration(e){return or({aptosConfig:this.config,...e})}async getTargetAddress(e){return os({aptosConfig:this.config,...e})}async setTargetAddress(e){return oa({aptosConfig:this.config,...e})}async getPrimaryName(e){return oi({aptosConfig:this.config,...e})}async setPrimaryName(e){return on({aptosConfig:this.config,...e})}async registerName(e){return ot({aptosConfig:this.config,...e})}async renewDomain(e){return op({aptosConfig:this.config,...e})}async getName(e){return oo({aptosConfig:this.config,...e})}async getAccountNames(e){return oc({aptosConfig:this.config,...e})}async getAccountDomains(e){return ou({aptosConfig:this.config,...e})}async getAccountSubdomains(e){return ol({aptosConfig:this.config,...e})}async getDomainSubdomains(e){return od({aptosConfig:this.config,...e})}};async function oy(e){let{aptosConfig:t,poolAddress:r}=e,i=eh.from(r).toStringLong(),n=await t7({aptosConfig:t,query:{query:tG,variables:{where_condition:{pool_address:{_eq:i}}}}});return n.num_active_delegator_per_pool[0]?n.num_active_delegator_per_pool[0].num_active_delegator:0}async function om(e){let{aptosConfig:t,options:r}=e,i={query:tG,variables:{order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:i})).num_active_delegator_per_pool}async function o_(e){let{aptosConfig:t,delegatorAddress:r,poolAddress:i}=e,n={query:tL,variables:{delegatorAddress:eh.from(r).toStringLong(),poolAddress:eh.from(i).toStringLong()}};return(await t7({aptosConfig:t,query:n})).delegated_staking_activities}var ow=class{constructor(e){this.config=e}async getNumberOfDelegators(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),oy({aptosConfig:this.config,...e})}async getNumberOfDelegatorsForAllPools(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),om({aptosConfig:this.config,...e})}async getDelegatedStakingActivities(e){return await rS({config:this.config,minimumLedgerVersion:e?.minimumLedgerVersion,processorType:"stake_processor"}),o_({aptosConfig:this.config,...e})}},ob=class{constructor(e){this.config=e}async simple(e){return sy({aptosConfig:this.config,...e})}async scriptComposer(e){let t=new sg(this.config);await t.init();let r=(await e.builder(t)).build();return new nT(await sd({aptosConfig:this.config,payload:nc.load(new eo(r)),...e}),!0===e.withFeePayer?eh.ZERO:void 0)}async multiAgent(e){return sy({aptosConfig:this.config,...e})}},oA=class{constructor(e){this.config=e}async simple(e){return sA({aptosConfig:this.config,...e})}async multiAgent(e){return sA({aptosConfig:this.config,...e})}};G([tT],oA.prototype,"simple",1),G([tT],oA.prototype,"multiAgent",1);var ov=class{constructor(e){this.config=e}async simple(e){return sv({aptosConfig:this.config,...e})}async multiAgent(e){return sv({aptosConfig:this.config,...e})}};G([tz],ov.prototype,"simple",1),G([tz],ov.prototype,"multiAgent",1);var oE=class{constructor(e,t,r,i,n){this.lastUncommintedNumber=null,this.currentNumber=null,this.lock=!1,this.aptosConfig=e,this.account=t,this.maxWaitTime=r,this.maximumInFlight=i,this.sleepTime=n}async nextSequenceNumber(){for(;this.lock;)await eE(this.sleepTime);this.lock=!0;let e=BigInt(0);try{if((null===this.lastUncommintedNumber||null===this.currentNumber)&&await this.initialize(),this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight){await this.update();let e=ez();for(;this.currentNumber-this.lastUncommintedNumber>=this.maximumInFlight;)await eE(this.sleepTime),ez()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):await this.update()}e=this.currentNumber,this.currentNumber+=BigInt(1)}catch(e){console.error("error in getting next sequence number for this account",e)}finally{this.lock=!1}return e}async initialize(){let{sequence_number:e}=await sx({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});this.currentNumber=BigInt(e),this.lastUncommintedNumber=BigInt(e)}async update(){let{sequence_number:e}=await sx({aptosConfig:this.aptosConfig,accountAddress:this.account.accountAddress});return this.lastUncommintedNumber=BigInt(e),this.lastUncommintedNumber}async synchronize(){if(this.lastUncommintedNumber!==this.currentNumber){for(;this.lock;)await eE(this.sleepTime);this.lock=!0;try{await this.update();let e=ez();for(;this.lastUncommintedNumber!==this.currentNumber;)ez()-e>this.maxWaitTime?(console.warn(`Waited over 30 seconds for a transaction to commit, re-syncing ${this.account.accountAddress.toString()}`),await this.initialize()):(await eE(this.sleepTime),await this.update())}catch(e){console.error("error in synchronizing this account sequence number with the one on chain",e)}finally{this.lock=!1}}}},oS="fulfilled",oz=((K=oz||{}).TransactionSent="transactionSent",K.TransactionSendFailed="transactionSendFailed",K.TransactionExecuted="transactionExecuted",K.TransactionExecutionFailed="transactionExecutionFailed",K.ExecutionFinish="executionFinish",K),oT=class extends iK.Z{constructor(e,t,r=30,i=100,n=10){super(),this.taskQueue=new F,this.transactionsQueue=new F,this.outstandingTransactions=new F,this.sentTransactions=[],this.executedTransactions=[],this.aptosConfig=e,this.account=t,this.started=!1,this.accountSequnceNumber=new oE(e,t,r,i,n)}async submitNextTransaction(){try{for(;;){let e=await this.accountSequnceNumber.nextSequenceNumber();if(null===e)return;let t=await this.generateNextTransaction(this.account,e);if(!t)return;let r=sE({aptosConfig:this.aptosConfig,transaction:t,signer:this.account});await this.outstandingTransactions.enqueue([r,e])}}catch(e){if(e instanceof O)return;throw Error(`Submit transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async processTransactions(){try{for(;;){let e=[],t=[],[r,i]=await this.outstandingTransactions.dequeue();for(e.push(r),t.push(i);!this.outstandingTransactions.isEmpty();)[r,i]=await this.outstandingTransactions.dequeue(),e.push(r),t.push(i);let n=await Promise.allSettled(e);for(let e=0;e<n.length&&e<t.length;e+=1){let r=n[e];i=t[e],r.status===oS?(this.sentTransactions.push([r.value.hash,i,null]),this.emit("transactionSent",{message:`transaction hash ${r.value.hash} has been committed to chain`,transactionHash:r.value.hash}),await this.checkTransaction(r,i)):(this.sentTransactions.push([r.status,i,r.reason]),this.emit("transactionSendFailed",{message:`failed to commit transaction ${this.sentTransactions.length} with error ${r.reason}`,error:r.reason}))}this.emit("executionFinish",{message:`execute ${n.length} transactions finished`})}}catch(e){if(e instanceof O)return;throw Error(`Process execution failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async checkTransaction(e,t){try{let r=[];r.push(rm({aptosConfig:this.aptosConfig,transactionHash:e.value.hash}));let i=await Promise.allSettled(r);for(let r=0;r<i.length;r+=1){let n=i[r];n.status===oS?(this.executedTransactions.push([n.value.hash,t,null]),this.emit("transactionExecuted",{message:`transaction hash ${n.value.hash} has been executed on chain`,transactionHash:e.value.hash})):(this.executedTransactions.push([n.status,t,n.reason]),this.emit("transactionExecutionFailed",{message:`failed to execute transaction ${this.executedTransactions.length} with error ${n.reason}`,error:n.reason}))}}catch(e){throw Error(`Check transaction failed for ${this.account.accountAddress.toString()} with error ${e}`)}}async push(e,t){this.transactionsQueue.enqueue([e,t])}async generateNextTransaction(e,t){if(this.transactionsQueue.isEmpty())return;let[r,i]=await this.transactionsQueue.dequeue();return sy({aptosConfig:this.aptosConfig,sender:e.accountAddress,data:r,options:{...i,accountSequenceNumber:t}})}async run(){try{for(;!this.taskQueue.isCancelled();)await (await this.taskQueue.dequeue())()}catch(e){throw Error(`Unable to start transaction batching: ${e}`)}}start(){if(this.started)throw Error("worker has already started");this.started=!0,this.taskQueue.enqueue(()=>this.submitNextTransaction()),this.taskQueue.enqueue(()=>this.processTransactions()),this.run()}stop(){if(this.taskQueue.isCancelled())throw Error("worker has already stopped");this.started=!1,this.taskQueue.cancel()}},ox=class extends iK.Z{constructor(e){super(),this.config=e}start(e){let{sender:t}=e;this.account=t,this.transactionWorker=new oT(this.config,t),this.transactionWorker.start(),this.registerToEvents()}push(e){let{data:t,options:r}=e;for(let e of t)this.transactionWorker.push(e,r)}registerToEvents(){this.transactionWorker.on("transactionSent",async e=>{this.emit("transactionSent",e)}),this.transactionWorker.on("transactionSendFailed",async e=>{this.emit("transactionSendFailed",e)}),this.transactionWorker.on("transactionExecuted",async e=>{this.emit("transactionExecuted",e)}),this.transactionWorker.on("transactionExecutionFailed",async e=>{this.emit("transactionExecutionFailed",e)}),this.transactionWorker.on("executionFinish",async e=>{this.emit("executionFinish",e)})}forSingleAccount(e){try{let{sender:t,data:r,options:i}=e;this.start({sender:t}),this.push({data:r,options:i})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}},oC=class{constructor(e){this.config=e,this.build=new ob(this.config),this.simulate=new oA(this.config),this.submit=new ov(this.config),this.batch=new ox(this.config)}async getTransactions(e){return rd({aptosConfig:this.config,...e})}async getTransactionByVersion(e){return rp({aptosConfig:this.config,...e})}async getTransactionByHash(e){return rh({aptosConfig:this.config,...e})}async isPendingTransaction(e){return rg({aptosConfig:this.config,...e})}async waitForTransaction(e){return rm({aptosConfig:this.config,...e})}async getGasPriceEstimation(){return rf({aptosConfig:this.config})}getSigningMessage(e){return function(e){let{transaction:t}=e;return nI(t)}(e)}async publishPackageTransaction(e){return sT({aptosConfig:this.config,...e})}async rotateAuthKey(e){return sG({aptosConfig:this.config,...e})}sign(e){return sw({...e})}signAsFeePayer(e){return sb({...e})}async batchTransactionsForSingleAccount(e){try{let{sender:t,data:r,options:i}=e;this.batch.forSingleAccount({sender:t,data:r,options:i})}catch(e){throw Error(`failed to submit transactions with error: ${e}`)}}async signAndSubmitTransaction(e){return sE({aptosConfig:this.config,...e})}async signAndSubmitAsFeePayer(e){return sS({aptosConfig:this.config,...e})}};async function oU(e){let{aptosConfig:t,jwt:r,ephemeralKeyPair:i,uidKey:n="sub",derivationPath:s}=e,a={jwt_b64:r,epk:i.getPublicKey().bcsToHex().toStringWithoutPrefix(),exp_date_secs:i.expiryDateSecs,epk_blinder:V.fromHexInput(i.blinder).toStringWithoutPrefix(),uid_key:n,derivation_path:s},{data:o}=await t5({aptosConfig:t,path:"fetch",body:a,originMethod:"getPepper",overrides:{WITH_CREDENTIALS:!1}});return V.fromHexInput(o.pepper).toUint8Array()}async function oI(e){let{aptosConfig:t,jwt:r,ephemeralKeyPair:i,pepper:n=await oU(e),uidKey:s="sub",maxExpHorizonSecs:a=(await o2({aptosConfig:t})).maxExpHorizonSecs}=e;if(V.fromHexInput(n).toUint8Array().length!==nD.PEPPER_LENGTH)throw Error(`Pepper needs to be ${nD.PEPPER_LENGTH} bytes`);let o=(0,r5.o)(r);if("number"!=typeof o.iat)throw Error("iat was not found");if(a<i.expiryDateSecs-o.iat)throw Error(`The EphemeralKeyPair is too long lived.  It's lifespan must be less than ${a}`);let c={jwt_b64:r,epk:i.getPublicKey().bcsToHex().toStringWithoutPrefix(),epk_blinder:V.fromHexInput(i.blinder).toStringWithoutPrefix(),exp_date_secs:i.expiryDateSecs,exp_horizon_secs:a,pepper:V.fromHexInput(n).toStringWithoutPrefix(),uid_key:s},{data:u}=await t4({aptosConfig:t,path:"prove",body:c,originMethod:"getProof",overrides:{WITH_CREDENTIALS:!1}}),l=u.proof;return new oQ({proof:new oX(new oY({a:l.a,b:l.b,c:l.c}),0),trainingWheelsSignature:tS.fromHex(u.training_wheels_signature),expHorizonSecs:a})}async function ok(e){let{aptosConfig:t,jwt:r,jwkAddress:i,uidKey:n,proofFetchCallback:s,pepper:a=await oU(e)}=e,{verificationKey:o,maxExpHorizonSecs:c}=await o2({aptosConfig:t}),u=oI({...e,pepper:a,maxExpHorizonSecs:c}),l=s?u:await u;if(void 0!==i){let c=iR.fromJwtAndPepper({jwt:r,pepper:a,jwkAddress:i,uidKey:n}),u=await sK({aptosConfig:t,authenticationKey:c.authKey().derivedAddress()});return nq.create({...e,address:u,proof:l,pepper:a,proofFetchCallback:s,jwkAddress:i,verificationKey:o})}let d=oD.fromJwtAndPepper({jwt:r,pepper:a,uidKey:n}),f=await sK({aptosConfig:t,authenticationKey:d.authKey().derivedAddress()});return nD.create({...e,address:f,proof:l,pepper:a,proofFetchCallback:s,verificationKey:o})}async function oP(e){let t,{aptosConfig:r,sender:i,iss:n,options:s}=e,{jwksUrl:a}=e;void 0===a&&(a=rl.test(n)?"https://www.googleapis.com/service_accounts/v1/jwk/securetoken@system.gserviceaccount.com":n.endsWith("/")?`${n}.well-known/jwks.json`:`${n}/.well-known/jwks.json`);try{if(!(t=await fetch(a)).ok)throw Error(`${t.status} ${t.statusText}`)}catch(t){let e;throw e=t instanceof Error?`${t.message}`:`error unknown - ${t}`,eK.fromErrorType({type:14,details:`Failed to fetch JWKS at ${a}: ${e}`})}let o=await t.json();return sy({aptosConfig:r,sender:i.accountAddress,data:{function:"0x1::jwks::update_federated_jwk_set",functionArguments:[n,ec.MoveString(o.keys.map(e=>e.kid)),ec.MoveString(o.keys.map(e=>e.alg)),ec.MoveString(o.keys.map(e=>e.e)),ec.MoveString(o.keys.map(e=>e.n))]},options:s})}var oN=class{constructor(e){this.config=e}async getPepper(e){return oU({aptosConfig:this.config,...e})}async getProof(e){return oI({aptosConfig:this.config,...e})}async deriveKeylessAccount(e){return ok({aptosConfig:this.config,...e})}async updateFederatedKeylessJwkSetTransaction(e){return oP({aptosConfig:this.config,...e})}};async function oB(e){let{aptosConfig:t,options:r}=e,i={query:tW,variables:{where_condition:r?.where,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await t7({aptosConfig:t,query:i,originMethod:"getObjectData"})).current_objects}async function oK(e){let{aptosConfig:t,objectAddress:r,options:i}=e,n={object_address:{_eq:eh.from(r).toStringLong()}};return(await oB({aptosConfig:t,options:{...i,where:n}}))[0]}var oR=class{constructor(e){this.config=e}async getObjectDataByObjectAddress(e){return await rS({config:this.config,minimumLedgerVersion:e.minimumLedgerVersion,processorType:"objects_processor"}),oK({aptosConfig:this.config,...e})}},o$=class{constructor(e){this.config=new r3(e),this.account=new s8(this.config),this.abstraction=new s2(this.config),this.ans=new og(this.config),this.coin=new s4(this.config),this.digitalAsset=new aD(this.config),this.event=new aj(this.config),this.faucet=new aW(this.config),this.fungibleAsset=new a0(this.config),this.general=new a1(this.config),this.staking=new ow(this.config),this.transaction=new oC(this.config),this.table=new rz(this.config),this.keyless=new oN(this.config),this.object=new oR(this.config)}};function oF(e,t,r){Object.getOwnPropertyNames(t.prototype).forEach(i=>{let n=Object.getOwnPropertyDescriptor(t.prototype,i);n&&(n.value=function(...e){return this[r][i](...e)},Object.defineProperty(e.prototype,i,n))})}oF(o$,s8,"account"),oF(o$,s2,"abstraction"),oF(o$,og,"ans"),oF(o$,s4,"coin"),oF(o$,aD,"digitalAsset"),oF(o$,aj,"event"),oF(o$,aW,"faucet"),oF(o$,a0,"fungibleAsset"),oF(o$,a1,"general"),oF(o$,ow,"staking"),oF(o$,oC,"transaction"),oF(o$,rz,"table"),oF(o$,oN,"keyless"),oF(o$,oR,"object");var oO=class e extends to{constructor(t,r){super();let i=V.fromHexInput(r).toUint8Array();if(i.length!==e.ID_COMMITMENT_LENGTH)throw Error(`Id Commitment length in bytes should be ${e.ID_COMMITMENT_LENGTH}`);this.iss=t,this.idCommitment=i}authKey(){let e=new J;return e.serializeU32AsUleb128(3),e.serializeFixedBytes(this.bcsToBytes()),tg.fromSchemeAndBytes({scheme:2,input:e.toUint8Array()})}verifySignature(e){try{return oL({...e,publicKey:this}),!0}catch(e){if(e instanceof eK)return!1;throw e}}async verifySignatureAsync(e){return oq({...e,publicKey:this})}serialize(e){e.serializeStr(this.iss),e.serializeBytes(this.idCommitment)}static deserialize(t){return new e(t.deserializeStr(),t.deserializeBytes())}static load(t){return new e(t.deserializeStr(),t.deserializeBytes())}static isPublicKey(t){return t instanceof e}static create(t){return oH(t),new e(t.iss,oH(t))}static fromJwtAndPepper(t){let{jwt:r,pepper:i,uidKey:n="sub"}=t,s=(0,r5.o)(r);if("string"!=typeof s.iss)throw Error("iss was not found");if("string"!=typeof s.aud)throw Error("aud was not found or an array of values");let a=s[n];return e.create({iss:s.iss,uidKey:n,uidVal:a,aud:s.aud,pepper:i})}static isInstance(e){return"iss"in e&&"string"==typeof e.iss&&"idCommitment"in e&&e.idCommitment instanceof Uint8Array}};oO.ID_COMMITMENT_LENGTH=32;var oD=oO;async function oq(e){let{aptosConfig:t,publicKey:r,message:i,signature:n,jwk:s,keylessConfig:a=await o2({aptosConfig:t}),options:o}=e;try{if(!(n instanceof oM))throw eK.fromErrorType({type:26,details:"Not a keyless signature"});return oL({message:i,publicKey:r,signature:n,jwk:s||await oV({aptosConfig:t,publicKey:r,kid:n.getJwkKid()}),keylessConfig:a}),!0}catch(e){if(o?.throwErrorWithReason)throw e;return!1}}function oL(e){let{publicKey:t,message:r,signature:i,keylessConfig:n,jwk:s}=e,{verificationKey:a,maxExpHorizonSecs:o,trainingWheelsPubkey:c}=n;if(!(i instanceof oM))throw eK.fromErrorType({type:26,details:"Not a keyless signature"});if(!(i.ephemeralCertificate.signature instanceof oQ))throw eK.fromErrorType({type:26,details:"Unsupported ephemeral certificate variant"});let u=i.ephemeralCertificate.signature;if(!(u.proof.proof instanceof oY))throw eK.fromErrorType({type:26,details:"Unsupported proof variant for ZeroKnowledgeSig"});let l=u.proof.proof;if(i.expiryDateSecs<ez())throw eK.fromErrorType({type:27,details:"The expiryDateSecs is in the past"});if(u.expHorizonSecs>o)throw eK.fromErrorType({type:28});if(!i.ephemeralPublicKey.verifySignature({message:r,signature:i.ephemeralSignature}))throw eK.fromErrorType({type:29});let d=function(e){let{publicKey:t,signature:r,jwk:i,keylessConfig:n}=e,s=t instanceof oD?t:t.keylessPublicKey;if(!(r.ephemeralCertificate.signature instanceof oQ))throw Error("Signature is not a ZeroKnowledgeSig");let a=r.ephemeralCertificate.signature,o=[];return o.push(...eX(r.ephemeralPublicKey.toUint8Array(),n.maxCommitedEpkBytes)),o.push(eQ(s.idCommitment)),o.push(r.expiryDateSecs),o.push(a.expHorizonSecs),o.push(eZ(s.iss,n.maxIssValBytes)),a.extraField?(o.push(1n),o.push(eZ(a.extraField,n.maxExtraFieldBytes))):(o.push(0n),o.push(eZ(" ",n.maxExtraFieldBytes))),o.push(eZ((0,eA.cv)(r.jwtHeader,!0)+".",n.maxJwtHeaderB64Bytes)),o.push(i.toScalar()),a.overrideAudVal?(o.push(eZ(a.overrideAudVal,120)),o.push(1n)):(o.push(eZ("",120)),o.push(0n)),e1(o)}({publicKey:t,signature:i,jwk:s,keylessConfig:n});if(!a.verifyProof({publicInputsHash:d,groth16Proof:l}))throw eK.fromErrorType({type:32});if(c){if(!u.trainingWheelsSignature)throw eK.fromErrorType({type:30});let e=new oZ(l,d);if(!c.verifySignature({message:e.hash(),signature:u.trainingWheelsSignature}))throw eK.fromErrorType({type:31})}}async function oV(e){let{aptosConfig:t,publicKey:r,kid:i}=e,{iss:n}=r instanceof oD?r:r.keylessPublicKey,s,a=r instanceof iR?r.jwkAddress:void 0;try{s=await o4({aptosConfig:t,jwkAddr:a})}catch(e){throw eK.fromErrorType({type:24,error:e,details:`Failed to fetch ${a?"Federated":"Patched"}JWKs ${a?`for address ${a}`:"0x1"}`})}let o=s.get(n);if(void 0===o)throw eK.fromErrorType({type:7,details:`JWKs for issuer ${n} not found.`});let c=o.find(e=>e.kid===i);if(void 0===c)throw eK.fromErrorType({type:6,details:`JWK with kid '${i}' for issuer '${n}' not found.`});return c}function oH(e){let{uidKey:t,uidVal:r,aud:i,pepper:n}=e;return e0(e1([eQ(V.fromHexInput(n).toUint8Array()),eZ(i,120),eZ(r,330),eZ(t,30)]),oD.ID_COMMITMENT_LENGTH)}var oM=class e extends tc{constructor(e){super();let{jwtHeader:t,ephemeralCertificate:r,expiryDateSecs:i,ephemeralPublicKey:n,ephemeralSignature:s}=e;this.jwtHeader=t,this.ephemeralCertificate=r,this.expiryDateSecs=i,this.ephemeralPublicKey=n,this.ephemeralSignature=s}getJwkKid(){return function(e){try{let t=JSON.parse(e);if(void 0===t.kid)throw Error("JWT header missing kid");return t}catch{throw Error("Failed to parse JWT header.")}}(this.jwtHeader).kid}serialize(e){this.ephemeralCertificate.serialize(e),e.serializeStr(this.jwtHeader),e.serializeU64(this.expiryDateSecs),this.ephemeralPublicKey.serialize(e),this.ephemeralSignature.serialize(e)}static deserialize(t){let r=oj.deserialize(t),i=t.deserializeStr(),n=t.deserializeU64(),s=tE.deserialize(t),a=tS.deserialize(t);return new e({jwtHeader:i,expiryDateSecs:Number(n),ephemeralCertificate:r,ephemeralPublicKey:s,ephemeralSignature:a})}static getSimulationSignature(){return new e({jwtHeader:"{}",ephemeralCertificate:new oj(new oQ({proof:new oX(new oY({a:new Uint8Array(32),b:new Uint8Array(64),c:new Uint8Array(32)}),0),expHorizonSecs:0}),0),expiryDateSecs:0,ephemeralPublicKey:new tE(new t_(new Uint8Array(32))),ephemeralSignature:new tS(new tv(new Uint8Array(64)))})}static isSignature(t){return t instanceof e}},oj=class e extends tc{constructor(e,t){super(),this.signature=e,this.variant=t}toUint8Array(){return this.signature.toUint8Array()}serialize(e){e.serializeU32AsUleb128(this.variant),this.signature.serialize(e)}static deserialize(t){let r=t.deserializeUleb128AsU32();if(0===r)return new e(oQ.deserialize(t),r);throw Error(`Unknown variant index for EphemeralCertificate: ${r}`)}},oG=class e extends W{constructor(e){if(super(),this.data=V.fromHexInput(e).toUint8Array(),32!==this.data.length)throw Error("Input needs to be 32 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(32))}toArray(){let e=this.toProjectivePoint();return[e.x.toString(),e.y.toString(),e.pz.toString()]}toProjectivePoint(){let t=new Uint8Array(this.data);t.reverse();let r=(128&t[0])>>7,{Fp:i}=iB.fields,n=i.create(oW(t)),s=i.sqrt(i.add(i.pow(n,3n),e.B)),a=i.neg(s),o=s>a==(1===r)?s:a;return iB.G1.ProjectivePoint.fromAffine({x:n,y:o})}};function oW(e){if(32!==e.length)throw Error("Input should be 32 bytes");let t=new Uint8Array(e);return t[0]=63&t[0],(0,r7.bytesToNumberBE)(t)}oG.B=iB.fields.Fp.create(3n);var oJ=class e extends W{constructor(e){if(super(),this.data=V.fromHexInput(e).toUint8Array(),64!==this.data.length)throw Error("Input needs to be 64 bytes")}serialize(e){e.serializeFixedBytes(this.data)}static deserialize(t){return new e(t.deserializeFixedBytes(64))}toArray(){let e=this.toProjectivePoint();return[[e.x.c0.toString(),e.x.c1.toString()],[e.y.c0.toString(),e.y.c1.toString()],[e.pz.c0.toString(),e.pz.c1.toString()]]}toProjectivePoint(){let t=new Uint8Array(this.data),r=t.slice(0,32).reverse(),i=t.slice(32,64).reverse(),n=(128&i[0])>>7,{Fp2:s}=iB.fields,a=s.fromBigTuple([oW(r),oW(i)]),o=s.sqrt(s.add(s.pow(a,3n),e.B)),c=s.neg(o),u=(o.c1>c.c1||o.c1===c.c1&&o.c0>c.c0)==(1===n)?o:c;return iB.G2.ProjectivePoint.fromAffine({x:a,y:u})}};oJ.B=iB.fields.Fp2.fromBigTuple([0x2b149d40ceb8aaae81be18991be06ac3b5b4c5e559dbefa33267e6dc24a138e5n,0x9713b03af0fed4cd2cafadeed8fdf4a74fa084e52d1852e4a2bd0685c315d2n]);var oY=class e extends e2{constructor(e){super();let{a:t,b:r,c:i}=e;this.a=new oG(t),this.b=new oJ(r),this.c=new oG(i)}serialize(e){this.a.serialize(e),this.b.serialize(e),this.c.serialize(e)}static deserialize(t){return new e({a:oG.deserialize(t).bcsToBytes(),b:oJ.deserialize(t).bcsToBytes(),c:oG.deserialize(t).bcsToBytes()})}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",pi_a:this.a.toArray(),pi_b:this.b.toArray(),pi_c:this.c.toArray()}}},oZ=class e extends W{constructor(e,t){if(super(),this.domainSeparator="APTOS::Groth16ProofAndStatement",this.proof=e,this.publicInputsHash="bigint"==typeof t?e0(t,32):V.fromHexInput(t).toUint8Array(),32!==this.publicInputsHash.length)throw Error("Invalid public inputs hash")}serialize(e){this.proof.serialize(e),e.serializeFixedBytes(this.publicInputsHash)}static deserialize(t){return new e(oY.deserialize(t),t.deserializeFixedBytes(32))}hash(){return nU(this.bcsToBytes(),this.domainSeparator)}},oX=class e extends W{constructor(e,t){super(),this.proof=e,this.variant=t}serialize(e){e.serializeU32AsUleb128(this.variant),this.proof.serialize(e)}static deserialize(t){let r=t.deserializeUleb128AsU32();if(0===r)return new e(oY.deserialize(t),r);throw Error(`Unknown variant index for ZkProof: ${r}`)}},oQ=class e extends tc{constructor(e){super();let{proof:t,expHorizonSecs:r,trainingWheelsSignature:i,extraField:n,overrideAudVal:s}=e;this.proof=t,this.expHorizonSecs=r,this.trainingWheelsSignature=i,this.extraField=n,this.overrideAudVal=s}static fromBytes(t){return e.deserialize(new eo(t))}serialize(e){this.proof.serialize(e),e.serializeU64(this.expHorizonSecs),e.serializeOption(this.extraField),e.serializeOption(this.overrideAudVal),e.serializeOption(this.trainingWheelsSignature)}static deserialize(t){let r=oX.deserialize(t),i=Number(t.deserializeU64()),n=t.deserializeOption("string"),s=t.deserializeOption("string");return new e({proof:r,expHorizonSecs:i,trainingWheelsSignature:t.deserializeOption(tS),extraField:n,overrideAudVal:s})}},o0=class e{constructor(e){let{verificationKey:t,trainingWheelsPubkey:r,maxExpHorizonSecs:i=1e7,maxExtraFieldBytes:n=350,maxJwtHeaderB64Bytes:s=300,maxIssValBytes:a=120,maxCommitedEpkBytes:o=93}=e;this.verificationKey=t,this.maxExpHorizonSecs=i,r&&(this.trainingWheelsPubkey=new tE(new t_(r))),this.maxExtraFieldBytes=n,this.maxJwtHeaderB64Bytes=s,this.maxIssValBytes=a,this.maxCommitedEpkBytes=o}static create(t,r){return new e({verificationKey:new o1({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2}),maxExpHorizonSecs:Number(r.max_exp_horizon_secs),trainingWheelsPubkey:r.training_wheels_pubkey.vec[0],maxExtraFieldBytes:r.max_extra_field_bytes,maxJwtHeaderB64Bytes:r.max_jwt_header_b64_bytes,maxIssValBytes:r.max_iss_val_bytes,maxCommitedEpkBytes:r.max_commited_epk_bytes})}},o1=class e{constructor(e){let{alphaG1:t,betaG2:r,deltaG2:i,gammaAbcG1:n,gammaG2:s}=e;this.alphaG1=new oG(t),this.betaG2=new oJ(r),this.deltaG2=new oJ(i),this.gammaAbcG1=[new oG(n[0]),new oG(n[1])],this.gammaG2=new oJ(s)}hash(){let e=new J;return this.serialize(e),e_.DZ.create().update(e.toUint8Array()).digest()}serialize(e){this.alphaG1.serialize(e),this.betaG2.serialize(e),this.deltaG2.serialize(e),this.gammaAbcG1[0].serialize(e),this.gammaAbcG1[1].serialize(e),this.gammaG2.serialize(e)}static fromGroth16VerificationKeyResponse(t){return new e({alphaG1:t.alpha_g1,betaG2:t.beta_g2,deltaG2:t.delta_g2,gammaAbcG1:t.gamma_abc_g1,gammaG2:t.gamma_g2})}verifyProof(e){let{publicInputsHash:t,groth16Proof:r}=e;try{let e=r.a.toProjectivePoint(),i=r.b.toProjectivePoint(),n=r.c.toProjectivePoint(),s=this.alphaG1.toProjectivePoint(),a=this.betaG2.toProjectivePoint(),o=this.gammaG2.toProjectivePoint(),c=this.deltaG2.toProjectivePoint(),u=this.gammaAbcG1.map(e=>e.toProjectivePoint()),{Fp12:l}=iB.fields,d=u[0].add(u[1].multiply(t)),f=iB.pairing(d,o),p=iB.pairing(e,i),h=iB.pairing(s,a),g=iB.pairing(n,c),y=l.mul(h,l.mul(f,g));return l.eql(p,y)}catch(e){throw eK.fromErrorType({type:32,error:e,details:"Error encountered when checking zero knowledge relation"})}}toSnarkJsJson(){return{protocol:"groth16",curve:"bn128",nPublic:1,vk_alpha_1:this.alphaG1.toArray(),vk_beta_2:this.betaG2.toArray(),vk_gamma_2:this.gammaG2.toArray(),vk_delta_2:this.deltaG2.toArray(),IC:this.gammaAbcG1.map(e=>e.toArray())}}};async function o2(e){let{aptosConfig:t}=e;try{return await em(async()=>{let[t,r]=await Promise.all([o3(e),o5(e)]);return o0.create(r,t)},`keyless-configuration-${t.network}`,3e5)()}catch(e){throw e instanceof eK?e:eK.fromErrorType({type:25,error:e})}}function o8(e){let{jwt:t,uidKey:r="sub"}=e,i;try{i=(0,r5.o)(t)}catch(e){throw eK.fromErrorType({type:12,details:`Failed to parse JWT - ${eS(e)}`})}if("string"!=typeof i.iss)throw eK.fromErrorType({type:12,details:"JWT is missing 'iss' in the payload. This should never happen."});if("string"!=typeof i.aud)throw eK.fromErrorType({type:12,details:"JWT is missing 'aud' in the payload or 'aud' is an array of values."});let n=i[r];return{iss:i.iss,aud:i.aud,uidVal:n}}async function o3(e){let{aptosConfig:t,options:r}=e;try{let{data:e}=await eD({aptosConfig:t,originMethod:"getKeylessConfigurationResource",path:`accounts/${eh.from("0x1").toString()}/resource/0x1::keyless_account::Configuration`,params:{ledger_version:r?.ledgerVersion}});return e.data}catch(e){throw eK.fromErrorType({type:22,error:e})}}async function o5(e){let{aptosConfig:t,options:r}=e;try{let{data:e}=await eD({aptosConfig:t,originMethod:"getGroth16VerificationKeyResource",path:`accounts/${eh.from("0x1").toString()}/resource/0x1::keyless_account::Groth16VerificationKey`,params:{ledger_version:r?.ledgerVersion}});return e.data}catch(e){throw eK.fromErrorType({type:23,error:e})}}async function o4(e){let{aptosConfig:t,jwkAddr:r,options:i}=e,n;if(r){let{data:e}=await eD({aptosConfig:t,originMethod:"getKeylessJWKs",path:`accounts/${eh.from(r).toString()}/resource/0x1::jwks::FederatedJWKs`,params:{ledger_version:i?.ledgerVersion}});n=e}else{let{data:e}=await eD({aptosConfig:t,originMethod:"getKeylessJWKs",path:"accounts/0x1/resource/0x1::jwks::PatchedJWKs",params:{ledger_version:i?.ledgerVersion}});n=e}let s=new Map;for(let e of n.data.jwks.entries){let t=[];for(let r of e.jwks){let{data:e}=r.variant,i=new eo(V.fromHexInput(e).toUint8Array()),n=o6.deserialize(i);t.push(n)}s.set(H(e.issuer),t)}return s}var o6=class e extends W{constructor(e){super();let{kid:t,kty:r,alg:i,e:n,n:s}=e;this.kid=t,this.kty=r,this.alg=i,this.e=n,this.n=s}serialize(e){e.serializeStr(this.kid),e.serializeStr(this.kty),e.serializeStr(this.alg),e.serializeStr(this.e),e.serializeStr(this.n)}static fromMoveStruct(t){let{data:r}=t.variant,i=new eo(V.fromHexInput(r).toUint8Array());return e.deserialize(i)}toScalar(){if("RS256"!==this.alg)throw eK.fromErrorType({type:32,details:"Failed to convert JWK to scalar when calculating the public inputs hash. Only RSA 256 is supported currently"});let e=(function(e){let t=[];for(let r=0;r<e.length;r+=24){let i=e.slice(r,Math.min(r+24,e.length));if(i.length<24){let e=new Uint8Array(24);e.set(i),t.push(e)}else t.push(i)}return t})((function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4!=0;)t+="=";return new Uint8Array(ev.from(t,"base64"))})(this.n).reverse()).map(e=>eQ(e));return e.push(256n),e1(e)}static deserialize(t){let r=t.deserializeStr(),i=t.deserializeStr(),n=t.deserializeStr(),s=t.deserializeStr();return new e({kid:r,kty:i,alg:n,n:t.deserializeStr(),e:s})}},o9=((R=o9||{})[R.V1=0]="V1",R[R.DerivableV1=1]="DerivableV1",R)},98279:function(e,t,r){r.d(t,{r:function(){return n}});var i=r(94554);class n extends i.py{}},5193:function(e,t,r){r.d(t,{O:function(){return h}});var i=r(94554),n=r(82259),s=r(50112),a=r(41148),o=r(31858),c=r(9500),u=r(15272),l=r(98279),d=r(74171),f=r(63920),p=r(12974);class h extends i.X2{static _platform=d.c0;constructor(e,t){super(e,t??(0,n.X5)(e,h._platform))}getRpc(e){if(e in this.config){let t="Mainnet"===this.network?u.ZcK.MAINNET:u.ZcK.TESTNET,r=new u.ScN({fullnode:this.config[e].rpc,network:t});return new u.gZG(r)}throw Error("No configuration available for chain: "+e)}getChain(e,t){if(e in this.config)return new l.r(e,this);throw Error("No configuration available for chain: "+e)}static nativeTokenId(e,t){if(!this.isSupportedChain(t))throw Error(`invalid chain: ${t}`);return s.D.tokenId(t,p.E)}static isNativeTokenId(e,t,r){return!!this.isSupportedChain(t)&&r.chain===t&&this.nativeTokenId(e,t)==r}static isSupportedChain(e){return(0,a.fm)(e)===h._platform}static async getDecimals(e,t,r){if((0,i.tY)(r)||r===p.E)return o.K(h._platform);let n=r.toString();return(await t.getFungibleAssetMetadataByAssetType({assetType:n})).decimals}static async getBalance(e,t,r,n){let s=(0,i.tY)(n)?p.E:n.toString();try{let e=await t.getCurrentFungibleAssetBalances({options:{where:{owner_address:{_eq:r},asset_type:{_eq:s}}}});return e[0]?.amount??null}catch(e){if(404===e.status)return null;throw e}}static async getBalances(e,t,r,n){return(await Promise.all(n.map(async n=>{let s=await this.getBalance(e,t,r,n);return{[(0,i.tY)(n)?"native":new f.fy(n).toString()]:s}}))).reduce((e,t)=>Object.assign(e,t),{})}static async sendWait(e,t,r){let i=[];for(let e of r){let r=await t.transaction.submit.simple(e.transaction),n=await t.waitForTransaction({transactionHash:r.hash});i.push(n.hash)}return i}static async getLatestBlock(e){return Number((await e.getLedgerInfo()).block_height)}static async getLatestFinalizedBlock(e){return Number((await e.getLedgerInfo()).block_height)}static chainFromChainId(e){let t=c.I(h._platform,BigInt(e));if(!t)throw Error(`No matching chainId to determine network and chain: ${e}`);let[r,i]=t;return[r,i]}static async chainFromRpc(e){let t=await e.getLedgerInfo();return this.chainFromChainId(t.chain_id.toString())}}},23299:function(e,t,r){r.r(t),r.d(t,{default:function(){return f}});var i=r(63920),n=r(5193),s=r(85261),a=r(15272);async function o(e,t){let[r,i]=await n.O.chainFromRpc(e);return new c(i,a.mRj.fromPrivateKey({privateKey:new a.qN7(s.$v.decode(t))}),e)}class c{_chain;_account;_rpc;_debug;constructor(e,t,r,i){this._chain=e,this._account=t,this._rpc=r,this._debug=i}chain(){return this._chain}address(){return this._account.accountAddress.toString()}async signAndSend(e){let t=[];for(let r of e){let{description:e,transaction:i}=r;this._debug&&console.log(`Signing: ${e} for ${this.address()}`);let n=await this._rpc.transaction.build.simple({sender:this._account.accountAddress,data:i}),{hash:s}=await this._simSignSend(n);t.push(s)}return t}async _simSignSend(e){return await this._rpc.transaction.simulate.simple({signerPublicKey:this._account.publicKey,transaction:e}).then(e=>e.forEach(e=>{if(!e.success)throw Error(`Transaction failed: ${e.vm_status}
${JSON.stringify(e,null,2)}`)})),this._rpc.signAndSubmitTransaction({signer:this._account,transaction:e}).then(e=>this._rpc.waitForTransaction({transactionHash:e.hash}))}}var u=r(98279),l=r(74171),d=r(82259),f={Address:i.fy,Platform:n.O,getSigner:o,protocols:{WormholeCore:()=>r.e(338).then(r.bind(r,54338)),TokenBridge:()=>r.e(407).then(r.bind(r,73407)),CircleBridge:()=>r.e(752).then(r.bind(r,66752))},getChain:(e,t,r)=>new u.r(t,new n.O(e,(0,d.C_)(e,l.c0,{[t]:r})))}}}]);